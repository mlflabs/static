{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","modules/market/models.ts","modules/loading/loadingService.ts","modules/loading/loading.component.tsx","modules/auth/components/user.page.tsx","modules/data/models.ts","pages/habits/models.ts","env.ts","modules/gamify/utilsGamify.ts","pages/habits/utilsHabits.ts","modules/data/utilsData.ts","pages/todo/models.ts","components/animatedIcon.tsx","modules/parties/models.ts","modules/data/adapters/dexie.ts","modules/messages/models.ts","modules/localStorage/localStorageService.ts","utils.ts","modules/ajax/ajax.ts","modules/toast/toastService.ts","modules/auth/authService.ts","modules/data/sync.ts","modules/data/dataService.ts","modules/social/models.ts","modules/social/social.service.ts","modules/gamify/gamifyService.ts","modules/gamify/models.ts","pages/todo/todo.service.ts","pages/todo/todo.new.component.tsx","colors.ts","pages/todo/todo.edit.inline.component.tsx","pages/todo/Todo.listitem.component.tsx","pages/todo/hooks/todos.hook.ts","pages/habits/habits.service.ts","pages/habits/hooks/habits.hook.ts","components/HeaderWithProgress.tsx","components/tooltip.tsx","pages/todo/Todos.page.tsx","modules/auth/components/intro.page.tsx","modules/parties/party.service.ts","i18n.ts","modules/app/hooks/appStatus.hook.ts","modules/app/appService.ts","modules/social/components/Landscape.component.tsx","modules/social/components/Friends.list.component.tsx","modules/messages/components/Messages.list.component.tsx","pages/Home.tsx","pages/NotFound.tsx","modules/forms/myInput.tsx","modules/forms/myForm.tsx","modules/auth/components/auth.menu.component.tsx","modules/auth/components/login.page.tsx","modules/auth/components/register.page.tsx","modules/auth/unauthenticatedRoute.tsx","pages/habits/habit.plant.component.tsx","pages/habits/Habit.listitem.component.tsx","pages/habits/Habit.add.component.tsx","pages/habits/Habits.page.tsx","components/MenuHeaderWithProgress.tsx","pages/todo/list.inline.add.component.tsx","pages/todo/todo.menu.item.tsx","pages/todo/todo.menulist.component.tsx","modules/menu/hooks/menu.hook.tsx","components/Menu.tsx","modules/parties/components/Party.edit.component.tsx","modules/parties/components/Party.listitem.component.tsx","modules/parties/pages/Parties.page.tsx","modules/parties/components/Challenge.member.scoreHistory.tsx","modules/parties/components/Members.list.component.tsx","modules/parties/components/Challenge.members.item.component.tsx","modules/parties/components/Challenge.add.note.action.component.tsx","modules/parties/components/Challenge.listitem.component.tsx","modules/parties/components/Challenge.add.component.tsx","modules/parties/components/Challenge.list.component.tsx","modules/parties/pages/Party.view.page.tsx","pages/Settings.tsx","modules/market/pages/market.tsx","components/slides/Slide.tsx","components/slides/tutorial1.tsx","routes.tsx","modules/toast/toast.component.tsx","modules/app/AppModals.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","MarketItemType","loadingService","_loading","loading$","BehaviorSubject","show","this","msg","next","Loading","useState","state","setState","useEffect","subscriptions","subscribe","res","it","unsubscribe","isOpen","message","UserPage","Doc","String","fromCharCode","values","undefined","name","deleted","created","Date","now","updated","creator","type","dirty","rev","assign","ProjectItem","note","access","habitStage","habitIntervals","habitDifficulty","getMarketItem","itemType","price","difficulty","quantity","defaultSeed","seed","MarketItems","printDifficulty","hab","trivial","easy","medium","hard","extreme","Habit","stage","current","regularityInterval","day","regularityIntervalGoal","regularityEachDayGoal","actions","lastCalculatedDate","currentTimeperiedStreak","currentTimeperiodLastDay","currentStreak","biggestStreak","newRewards","seedItem","plantId","plantName","plantLevel","plantExp","plantNextLevelExp","plantDifficultyLevel","ulog","level","TRACE","detail","process","REACT_APP_STAGE","SYNC_SERVER","AUTH_API_URL","env","APP_ID","ACCESS_META_KEY","SERVER_ACCESS_META_KEY","MOMENT_DATE_FORMAT","GAMIFY_HABIT_GOLD_BASE_REWARD","GAMIFY_HABIT_EXPERIENCE_BASE_REWARD","HABIT_REWARDS_GOLD_BASE","HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE","HABIT_REWARDS_EXPERIENCE_BASE","HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE","HABIT_REWARDS_NEW_GOLD","HABIT_REWARDS_NEW_EXPERIENCE","TODO_NEW_GOLD_REWARDS","TODO_DONE_GOLD_REWARDS","TODO_NEW_EXPERIENCE_REWARDS","TODO_DONE_EXPERIENCE_REWARDS","MESSAGE_DURATION","TOKEN_EXPIRATION","calculateLevelExperience","exp","x","Math","floor","pow","calculatePlantExperience","diff","d","calculateDoneTodoGold","todo","days","date","moment","rew","calculateDoneTodoExperience","getInitGamifyRewards","base","gold","experience","items","sortByDate","a","b","calculateCurrentStreak","habit","r","rewards","sort","forEach","action","isBefore","isSame","isAfter","calculateDailyChallengeStreak","calculateWeeklyChallengeStreak","calculateMonthlyChallengeStreak","rewards1","rewards2","newHabit","addPlantExperience","console","log","h","currentAction","subtract","format","currentDateMoment","add","isSameOrBefore","value","calculateGoldByStreak","calculateExperienceByStreak","analizeDay","nextTimeperiodFirstDay","nextWeekFirstDay","streak","baseXP","exponent","getPlantSeedPic","item","startsWith","replace","getPlantPic","getLandscapePlantPic","tree","error","generateUserChannelId","userid","getDefaultProject","uuid","generateProjectUUID","genrateMetaData","generateUUID","ok","shortid","generate","substring","getProjectChildId","length","getChannelFromProjectId","app","generateCollectionId","projectid","collection","waitMS","ms","setTimeout","saveIntoArray","ary","idKey","i","getIndexById","slice","getDocumentRights","user","channel","split","getChannelNameFromId","canEditProject","rights","canEditProjectByRights","getDefaultTodoList","project","TodoList","folder","icon","secondaryType","fullname","color","_new","getDefaultTodoTag","TodoTag","animatedIcon","Todo","done","list","tags","parent","subTodos","showSubTodos","showDone","doneRewards","AnimatedIcon","ChallengeState","ChallengeType","ChallengeTypeUnit","ChallengeDifficulty","ChallengeIntervals","iconsvg","actionFunc","isStopped","isPaused","defaultOptions","loop","autoplay","render","animationData","rendererSettings","clearCanvas","scaleMode","preserveAspectRatio","actionHandler","onClick","className","options","height","width","DexieAdapter","scheme","db","_ready","ready$","_subscriptions","changes$","Subject","Dexie","stores","tables","t","columns","version","_init","open","sub","get","bulkGet","filter","doc","field","operator","where","equals","toArray","docs","notEqual","put","bulkPut","PartyProject","members","moneyTypeSingle","moneyTypeMultiple","moneyColor","Challenge","waiting","challengeType","checkin","challengeTypeUnit","Other","chalengeTypeOther","challengePointMultiplier","chalengeTypeNoteVote","newMessage","messageType","messageSubType","data","localStorageService","localStorage","getItem","val","JSON","parse","str","stringify","setItem","capitalize","s","charAt","toUpperCase","printDateRelative","timestamp","m","fromNow","getNested","obj","args","reduce","saveIntoDocList","ToastType","getAjaxMessage","success","status","errors","getPostRequest","url","form","getErrorMessage","location","post","showLoading","loadingMessage","axios","hideLoading","info","response","AuthStatus","toastService","messages$","default","milliseconds","toast","autoClose","duration","err","showMessage","getUser","username","email","token","token_expiery","expires","isGuest","getGuestUser","authService","_user","_authStatus","authStatus$","username$","loadAuth","User","forceLogout","setAuthStatus","setObject","isEqual","Guest","getObject","updateUser","warn","password","history","prev","push","printServerErrors","organizeData","channels","checkpoints","syncData","props","syncurl","checkpoint","chpoints","types","databaseScheme","sync","dataService","authId","_ready$","addSyncCall$","pipe","throttleTime","_syncRemote","getDoc","getBulk","queryByProperty","getProjectItems","save","remoteSync","oldDoc","_","getToken","gotNewRightsToken","renewToken","doc2","doctype","channelname","asObservable","change","property","projectChildId","event","complete","authid","syncRemote","dbSub","ready","_createSettingsDoc","getSettingsDocId","ts","red","Number","requestMaxSize","saveFromSync","initSocialState","friends","socialService","_subscription","_userid","_state","state$","updateSocialUsers","msgDoc","gamifyService","_userId","maxExperience","userItems","landscape","trees","calculateFinishedTodoRewards","addGold","messageReceivedGold","addExperience","messageReceivedExperience","messageLostGold","messageLostExperience","calculateNewTodo","calculateNewHabitRewards","addRewards","updateLandscapeHabit","dataSub","getReadySub","loadInitDocs","_save","sub2","subscribeDocChanges","getGamifyDocId","find","sendMessage","plant","habitId","position","random","i18n","equal","initEqual","TodoService","_projectid","selectedTodo","tag","tagDocs","doneTodos","orderFilter","orderAsync","showNewTagFilter","listName","tagName","getTags","reloadTodos","subscribeProjectTypeChanges","filterAndSaveTodos","filtered","filterDoneParentFunction","orderFunction","todoId","parentId","parentTodo","concat","saveNewTags","addSubTodoToParent","tagDoc","printSimpleError","saveRes","remove","removeSubTodoFromParent","todoService","TodoNewComp","focus","closeFunc","saveFunc","projectId","useReducer","payload","title","showTags","closeFocus","_dispatch","inputEl","useRef","searchTags$","dispatch","setDelayedFocusOnInput","setFocus","searchTags","getTagsByStartingName","debounceTime","distinctUntilChanged","switchMap","term","regex","tag2","match","otherTags","index","trim","newDoc","onInputFocus","onSubAction","lastIndexOf","closeToolbar","fill","key","size","src","printSmallTagFromName","class","autofocus","ref","placeholder","onKeyPress","onIonChange","onIonBlur","onIonFocus","getDefaultState","showDeleteWarrning","text","mergeText","TodoEditInlineComponent","dataFunctions","hideRemoveWarrning","handleTagChange","newtags","includes","printTag","autoGrow","exec","newState","select","close","trash","onDidDismiss","header","buttons","role","cssClass","handler","reducer","TodoListItemComp","doneHandler","handleSelectTodo","printEdit","button","lines","slot","restart","check","getInitHabitsState","selected","habits","stageFilter","HabitsService","_project","_docs","docs$","getAllByProject","filterhabits","filterFunction","removeUserItem","useHabitsCollectionFacade","habitsService","changeStageFilter","getProject","init","HeaderWithProgress","showDetail","habitsState","getPlantSize","getPlantTop","style","right","alt","top","left","bottom","leaf","trailWidth","percent","strokeWidth","strokeColor","fontSize","HelpTooltip","iconStyle","paddingLeft","paddingRight","nativeEvent","helpCircleOutline","Keyboard","Plugins","Device","TodosPage","useLocation","useTranslation","params","useParams","pathname","selectList","changeDoneFilter","changeOrderFilter","showNewTag","useTodosCollectionFacade","dataFunc","getInfo","devInfo","operatingSystem","addListener","keyboardHeight","setKeyboard","listname","tagname","printTitle","onIonRefresh","refresh","checkmarkCircleOutline","radioButtonOff","arrowDownOutline","arrowUpOutline","lastChild","vertical","horizontal","edge","IntroPage","initPartyState","partyService","sub1","subscribeChanges","party","channelid","partyProject","_createParty","saveNewProject","challenge","_createChallenge","saveSystemDoc","msgId","replied","accepted","newMsg","challengeid","saveFromServer","use","initReactI18next","Backend","interpolation","escapeValue","lng","fallbackLng","backend","loadPath","react","wait","useSuspense","debug","AppStatus","loadPreferedLanguage","getSettingsDoc","language","changeLanguage","appService","showTutorial","tutorialStartingSlide","_settingsDoc","updateStateFromSettingsDoc","LandscapeComp","getTreeSize","showAddModal","FriendsListComponent","hideAddUser","friend","inputs","addFriend","messages","MessagesListComponent","loadMsgs","subscribeChannelTypeChanges","getAllByChannel","msgs","printMessageIcon","mail","peopleCircle","personAdd","documentTextOutline","printReplyStatus","happy","sad","printMessage","from","printFrom","printFriend","printChannel","acceptPartyInvitation","rejectPartyInviation","printClubRequestAcceptRejectButtons","acceptFriendInvitation","rejectFriendInviation","printFriendRequestAcceptRejectButtons","challengeName","dangerouslySetInnerHTML","__html","Home","NotFound","padding","MyInput","updateFunction","displayName","hasValidation","target","printErrors","submitButtonText","getFormOptions","settings","getValidator","MyForm","submitFunction","valid","initForm","model","Array","isArray","validateItem","validators","validateForm","updateItem","validate","findById","validator","isEmpty","isLength","isEmail","disabled","AuthMenuComponent","page","useHistory","LoginPage","submitButtongText","min","max","submit","loginAndRedirect","paddingTop","logIn","RegisterPage","register","UnauthenticatedRoute","exact","path","component","to","initState","HabitPlantComponent","margin","changePlantPosition","caretBackOutline","caretForwardOutline","HabitListItemComponent","showEditModalFunction","showPlantStats","printDate","active","printDayIcon","updatehabit","hidePlantModal","plantModalDismissFunc","cog","getPlantPosition","getRegularityValues","interval","week","month","HabitAddComponent","dismissFunc","getDefaultRegularityState","regularity","handleChange","handlerRegularityValue","handleDifficultyChange","selectSeed","seedId","getUserSeeds","newReg","handlerRegularityIntervalChange","debounce","printDifficultyLabel","showModal","modalHabit","getAction","HabitsPage","addhabit","MenuHeaderWithProgress","ListAddInlineComponent","encodeURI","newList","saveList","TodoMenuItemButtonComponet","actonFunc","sun","star","routerLink","routerDirection","initialState","tagsOpen","lists","openLists","showDeleteListAlert","deleteList","l","TodoMenuListComponent","subTodoList","loadInitTodoLists","tagsList","subscribeByPropertyChange","loadInitTags","todolists","tagButtonClickHandler","listItem","side","tagItem","subHeader","getMenuState","appPages","home","ribbon","apps","lastComponent","basket","withRouter","useMenuHookFacade","contentId","appPage","autoHide","PartyEditComponent","PartyListItemComponent","userId","PartiesPage","subs","changes","editParty","saveParty","ChallengeMemberScoreHistory","member","printDay","dateString","score","reward","PartyMembersListComponent","printScore","self","canEditThisProject","addUser","ChallengeMembersItem","ChallengeAddActionNoteComponent","submitFunc","spellCheck","rows","memberDoc","showDoneAlert","showBiggesLooserAcceptAlert","showBiggesGainerAcceptAlert","ChallengeListItemComponent","currentDate","printDoneIcon","checkmarkDone","readerOutline","Cup","cafeOutline","Kilometer","walkOutline","Hour","alarmOutline","Minute","timerOutline","Dollar","cashOutline","looser","trendingDown","gainer","trendingUp","rocketOutline","closeModal","submitModal","submitChallengeActions","getCurrentAction","cAction","finished","future","acceptChallenge","printActionButtons","changeChallengeState","printAdminActionButtons","printEditFabButton","printSubmitFab","currentValue","label","checked","startingValue","ChallengeAddComponent","_challenge","handleNamedChange","handleMultiplierChange","chdiff","regularityValue","times","printRegularityLabel","modalChallenge","challenges","ChallengeListComponent","loadChallenges","addChallenge","ch","hideChallengeModal","saveChallenge","getInitState","loadParty","PartyViewPage","idd","settingsId","SettingsPage","loadSettingsDoc","handleDocPropertyChange","view","Market","marketItems","buyItem","Slide","image","slideOpts","initialSlide","navigation","nextEl","prevEl","pagination","clickable","Tutorial1","_slidesRef","React","createRef","pager","scrollbar","onIonSlideReachEnd","slidePrev","slideNext","Routes","loading","dataReady","appStatus","setAppStatus","setStatusFunction","getIsAuthenticated","getUsername","guest","auth","useAppStatus","newpath","when","getRoutes","Toasts","setMessage","hideProgressBar","newestOnTop","closeOnClick","rtl","draggable","pauseOnHover","AppModals","App","Boolean","window","hostname","ReactDOM","document","getElementById","navigator","serviceWorker","registration","unregister"],"mappings":"y51CAAA,IAAIA,EAAM,CACT,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,qBAAsB,CACrB,IACA,IAED,uCAAwC,CACvC,IACA,IAED,sCAAuC,CACtC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,mCAAoC,CACnC,IACA,IAED,kCAAmC,CAClC,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BA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","file":"static/js/main.caa1d133.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet-ios.entry.js\": [\n\t\t362,\n\t\t37\n\t],\n\t\"./ion-action-sheet-md.entry.js\": [\n\t\t363,\n\t\t38\n\t],\n\t\"./ion-alert-ios.entry.js\": [\n\t\t364,\n\t\t21\n\t],\n\t\"./ion-alert-md.entry.js\": [\n\t\t365,\n\t\t22\n\t],\n\t\"./ion-app_8-ios.entry.js\": [\n\t\t366,\n\t\t10\n\t],\n\t\"./ion-app_8-md.entry.js\": [\n\t\t367,\n\t\t11\n\t],\n\t\"./ion-avatar_3-ios.entry.js\": [\n\t\t368,\n\t\t39\n\t],\n\t\"./ion-avatar_3-md.entry.js\": [\n\t\t369,\n\t\t40\n\t],\n\t\"./ion-back-button-ios.entry.js\": [\n\t\t370,\n\t\t41\n\t],\n\t\"./ion-back-button-md.entry.js\": [\n\t\t371,\n\t\t42\n\t],\n\t\"./ion-backdrop-ios.entry.js\": [\n\t\t372,\n\t\t79\n\t],\n\t\"./ion-backdrop-md.entry.js\": [\n\t\t373,\n\t\t80\n\t],\n\t\"./ion-button_2-ios.entry.js\": [\n\t\t374,\n\t\t43\n\t],\n\t\"./ion-button_2-md.entry.js\": [\n\t\t375,\n\t\t44\n\t],\n\t\"./ion-card_5-ios.entry.js\": [\n\t\t376,\n\t\t45\n\t],\n\t\"./ion-card_5-md.entry.js\": [\n\t\t377,\n\t\t46\n\t],\n\t\"./ion-checkbox-ios.entry.js\": [\n\t\t378,\n\t\t47\n\t],\n\t\"./ion-checkbox-md.entry.js\": [\n\t\t379,\n\t\t48\n\t],\n\t\"./ion-chip-ios.entry.js\": [\n\t\t380,\n\t\t49\n\t],\n\t\"./ion-chip-md.entry.js\": [\n\t\t381,\n\t\t50\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t382,\n\t\t81\n\t],\n\t\"./ion-datetime_3-ios.entry.js\": [\n\t\t383,\n\t\t17\n\t],\n\t\"./ion-datetime_3-md.entry.js\": [\n\t\t384,\n\t\t18\n\t],\n\t\"./ion-fab_3-ios.entry.js\": [\n\t\t385,\n\t\t51\n\t],\n\t\"./ion-fab_3-md.entry.js\": [\n\t\t386,\n\t\t52\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t387,\n\t\t82\n\t],\n\t\"./ion-infinite-scroll_2-ios.entry.js\": [\n\t\t388,\n\t\t35\n\t],\n\t\"./ion-infinite-scroll_2-md.entry.js\": [\n\t\t389,\n\t\t36\n\t],\n\t\"./ion-input-ios.entry.js\": [\n\t\t390,\n\t\t53\n\t],\n\t\"./ion-input-md.entry.js\": [\n\t\t391,\n\t\t54\n\t],\n\t\"./ion-item-option_3-ios.entry.js\": [\n\t\t392,\n\t\t55\n\t],\n\t\"./ion-item-option_3-md.entry.js\": [\n\t\t393,\n\t\t56\n\t],\n\t\"./ion-item_8-ios.entry.js\": [\n\t\t394,\n\t\t57\n\t],\n\t\"./ion-item_8-md.entry.js\": [\n\t\t395,\n\t\t58\n\t],\n\t\"./ion-loading-ios.entry.js\": [\n\t\t396,\n\t\t23\n\t],\n\t\"./ion-loading-md.entry.js\": [\n\t\t397,\n\t\t24\n\t],\n\t\"./ion-menu_3-ios.entry.js\": [\n\t\t398,\n\t\t59\n\t],\n\t\"./ion-menu_3-md.entry.js\": [\n\t\t399,\n\t\t60\n\t],\n\t\"./ion-modal-ios.entry.js\": [\n\t\t400,\n\t\t12\n\t],\n\t\"./ion-modal-md.entry.js\": [\n\t\t401,\n\t\t13\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t402,\n\t\t16\n\t],\n\t\"./ion-popover-ios.entry.js\": [\n\t\t403,\n\t\t14\n\t],\n\t\"./ion-popover-md.entry.js\": [\n\t\t404,\n\t\t15\n\t],\n\t\"./ion-progress-bar-ios.entry.js\": [\n\t\t405,\n\t\t61\n\t],\n\t\"./ion-progress-bar-md.entry.js\": [\n\t\t406,\n\t\t62\n\t],\n\t\"./ion-radio_2-ios.entry.js\": [\n\t\t407,\n\t\t63\n\t],\n\t\"./ion-radio_2-md.entry.js\": [\n\t\t408,\n\t\t64\n\t],\n\t\"./ion-range-ios.entry.js\": [\n\t\t409,\n\t\t65\n\t],\n\t\"./ion-range-md.entry.js\": [\n\t\t410,\n\t\t66\n\t],\n\t\"./ion-refresher_2-ios.entry.js\": [\n\t\t411,\n\t\t25\n\t],\n\t\"./ion-refresher_2-md.entry.js\": [\n\t\t412,\n\t\t26\n\t],\n\t\"./ion-reorder_2-ios.entry.js\": [\n\t\t413,\n\t\t33\n\t],\n\t\"./ion-reorder_2-md.entry.js\": [\n\t\t414,\n\t\t34\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t415,\n\t\t83\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t416,\n\t\t67\n\t],\n\t\"./ion-searchbar-ios.entry.js\": [\n\t\t417,\n\t\t27\n\t],\n\t\"./ion-searchbar-md.entry.js\": [\n\t\t418,\n\t\t28\n\t],\n\t\"./ion-segment_2-ios.entry.js\": [\n\t\t419,\n\t\t68\n\t],\n\t\"./ion-segment_2-md.entry.js\": [\n\t\t420,\n\t\t69\n\t],\n\t\"./ion-select_3-ios.entry.js\": [\n\t\t421,\n\t\t70\n\t],\n\t\"./ion-select_3-md.entry.js\": [\n\t\t422,\n\t\t71\n\t],\n\t\"./ion-slide_2-ios.entry.js\": [\n\t\t423,\n\t\t84\n\t],\n\t\"./ion-slide_2-md.entry.js\": [\n\t\t424,\n\t\t85\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t425,\n\t\t31\n\t],\n\t\"./ion-split-pane-ios.entry.js\": [\n\t\t426,\n\t\t86\n\t],\n\t\"./ion-split-pane-md.entry.js\": [\n\t\t427,\n\t\t87\n\t],\n\t\"./ion-tab-bar_2-ios.entry.js\": [\n\t\t428,\n\t\t72\n\t],\n\t\"./ion-tab-bar_2-md.entry.js\": [\n\t\t429,\n\t\t73\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t430,\n\t\t32\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t431,\n\t\t74\n\t],\n\t\"./ion-textarea-ios.entry.js\": [\n\t\t432,\n\t\t75\n\t],\n\t\"./ion-textarea-md.entry.js\": [\n\t\t433,\n\t\t76\n\t],\n\t\"./ion-toast-ios.entry.js\": [\n\t\t434,\n\t\t29\n\t],\n\t\"./ion-toast-md.entry.js\": [\n\t\t435,\n\t\t30\n\t],\n\t\"./ion-toggle-ios.entry.js\": [\n\t\t436,\n\t\t19\n\t],\n\t\"./ion-toggle-md.entry.js\": [\n\t\t437,\n\t\t20\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t438,\n\t\t88\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 182;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t442,\n\t\t96\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 184;\nmodule.exports = webpackAsyncContext;","export const TYPE_MARKET = 'mkt';\n\nexport const DEFAULT_SEED_NAME = 'Maple';\n\n\nexport enum MarketItemType {\n  seed = 'seed',\n  building = 'building',\n  clothing = 'clothing'\n}\n\nexport const getMarketItem = (id,\n                              name, \n                              itemType: MarketItemType,\n                              price:number,\n                              difficulty:number = 0,):MarketItem => {\n  return {\n    id,\n    name,\n    itemType,\n    price,\n    difficulty,\n    quantity:1\n  }\n}\n\nexport const defaultSeed: MarketItem = \n  getMarketItem('tree.' + DEFAULT_SEED_NAME, DEFAULT_SEED_NAME, MarketItemType.seed, 1, 0);\n\nexport const MarketItems: MarketItem[]  = [\n  getMarketItem('tree.plant1', 'Green Ash', MarketItemType.seed, 10, 1),\n  getMarketItem('tree.plant2', 'River Birch', MarketItemType.seed, 25, 1),\n  getMarketItem('tree.plant3', 'Paper Birch', MarketItemType.seed, 25, 1),\n]\n\n\n\nexport class MarketItem  {\n  name!: string;\n  id!: string;\n  itemType!: MarketItemType;\n  price!: number;\n  difficulty: number = 0; \n  quantity: number = 0;\n\n  constructor(values: Object = {}) {\n    Object.assign(this, values);\n    if(!values['itemType']) throw new Error('MarketItem Doc item type required');\n    if(!values['id']) throw new Error('MarketItem Doc id required');\n    if(!values['name']) throw new Error('MarketItem Doc name required');\n    if(!values['price']) throw new Error('MarketItem Doc price required');\n  }\n}\n","\nimport { BehaviorSubject } from 'rxjs';\n\n\n\nexport class LoadingService {\n  private _loading: boolean = false;\n  \n\n  public loading$ = new BehaviorSubject({show: this._loading, msg: 'Loading...'});\n\n  showLoading(msg = \"Loading...\") {\n    this._loading = true;\n    this.loading$.next({show:true, msg});\n  }\n\n  hideLoading() {\n    this._loading = false;\n    this.loading$.next({show:false, msg:''});\n  }\n\n  public get loading(): boolean {\n    return this._loading;\n  }\n\n\n  startLoadingTimer() {\n\n  }\n\n}\nexport const loadingService = new LoadingService();\n\n\n","import React, { useState, useEffect } from 'react';\nimport { IonLoading } from '@ionic/react';\nimport { Subscription } from 'rxjs';\nimport { loadingService } from './loadingService';\n\nexport const Loading: React.FC = () => {\n  const [state, setState] = useState({show:false, msg: 'Loading...'});\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      loadingService.loading$.subscribe(res =>{\n        setState({show: res.show, msg: res.msg});\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[]);\n\n  \n  //onDidDismiss={() => setShowLoading(false)}\n  return (\n      <IonLoading\n        isOpen={state.show}\n        message={state.msg}\n      />\n  );\n};","import React from 'react';\nimport { IonHeader, IonToolbar, IonPage, IonTitle, IonContent, IonLabel } from '@ionic/react';\n\n\n\nconst UserPage: React.FC = () => {\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>User Page</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonLabel>User</IonLabel>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default UserPage;\n","export const PROJECT_SERVICE = '';\nexport const PROJECT_INDEX_SERVICE = 'ch';\nexport const SYSTEM_DOC = 'sys';\n\nexport const LASTCHAR = String.fromCharCode(65535);\nexport const DIV = '.';\nexport const DOUBLE_DIV = '..';\n\nexport class Doc {\n  public id: string|undefined = undefined;\n  name: string = '';\n  public deleted?: boolean;\n  public created?: number = Date.now();\n  public updated?: number = Date.now();\n  public creator?: string;\n  public type: string = 'doc';\n  public dirty?: number = 0;\n  public rev = 1;\n  constructor(values: Object = {}) {\n      Object.assign(this, values);\n  }\n\n}\n\nexport class ProjectItem extends Doc {\n  public id:string;\n  public name: string = '';\n  public note?: string;\n  public access = [];\n\n  constructor(values: Object = {}) {\n    super();\n    Object.assign(this, values);\n    this.id = values['id'];\n    if(!this.id)\n      this.id = ''; \n  }\n}\n\n\n\n\n\n\n\n\n\n","\nimport { Doc } from '../../modules/data/models'\nimport { GamifyRewards } from './utilsHabits'; \nimport { DEFAULT_SEED_NAME, MarketItem } from '../../modules/market/models';\n\nexport const TYPE_HABBIT = 'hab';\nexport const MOMENT_DATE_FORMAT = 'YYYYMMDD';\n\nexport enum habitStage {\n  'finished',\n  'current',\n  'future',\n  'resting'\n}\n\nexport enum habitIntervals {\n  day = 'day',\n  week = 'week',\n  month = 'month'\n}\n\nexport enum habitDifficulty {\n  trivial, easy, medium, hard, extreme\n}\n\nexport const printDifficulty = (hab:habitDifficulty):string => {\n  switch(hab) {\n    case habitDifficulty.trivial:\n      return 'trivial'; // , easy peasy lemon squeezy\n    case habitDifficulty.easy:\n      return 'easy'; //Piece of Cake , Smooth Sailin'\n    case habitDifficulty.medium:\n      return 'medium'; //Let's Go\n    case habitDifficulty.hard:\n      return 'hard'; //No Pain, No Gain\n    case habitDifficulty.extreme:\n      return 'extreme'; //Death Wish\n  }\n}\n\n\nexport interface HabitAction {\n  value: number, \n  date:string, \n  reward?: GamifyRewards,\n}\n\nexport class Habit extends Doc {\n  name: string = '';\n  note?: string;\n  type:string = TYPE_HABBIT;\n  stage: habitStage = habitStage.current;\n  difficulty:habitDifficulty = habitDifficulty.medium;\n  //regularity\n  regularityInterval:habitIntervals = habitIntervals.day;\n  regularityIntervalGoal: number = 1;\n  regularityEachDayGoal: number = 1;\n\n  actions: {[key: string]: HabitAction } = {};\n  //streaks\n  //member info\n  lastCalculatedDate?:string;\n  currentTimeperiedStreak: number = 0;\n  currentTimeperiodLastDay?: string;\n\n  currentStreak: number = 0;\n  biggestStreak: number = 0;\n\n  newRewards?: GamifyRewards;\n\n  seedItem?: MarketItem;\n  plantId: string = '';\n  plantName: string = DEFAULT_SEED_NAME;\n  plantLevel: number = 0;\n  plantExp: number = 0;\n  plantNextLevelExp: number = 0;\n  plantDifficultyLevel: number = 0;\n  \n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n  }\n}\n\n\n","import  ulog from 'ulog';\nulog.level = ulog.TRACE;\n\nexport const FIRST_DAY_OF_WEEK = 'Monday';\n\n\n\nconst dev = {\n  \n  \n}\n\nconst prod = {\n  SYNC_SERVER: 'https://auth.mlflabs.com',\n  AUTH_API_URL: 'https://auth.mlflabs.com',\n}\nconst detail = process.env.REACT_APP_STAGE === 'production' ? prod: dev;\nexport const env = {...{\n  APP_ID: 'hv',\n  //myenvoy settings\n  ACCESS_META_KEY: 'access',\n  SERVER_ACCESS_META_KEY: 'ch',\n  MOMENT_DATE_FORMAT: 'YYYYMMDD',\n\n  //gamify \n  GAMIFY_HABIT_GOLD_BASE_REWARD:  5,\n  GAMIFY_HABIT_EXPERIENCE_BASE_REWARD:  2,\n\n\n  HABIT_REWARDS_GOLD_BASE: 5,\n  HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE: 0.2,\n  HABIT_REWARDS_EXPERIENCE_BASE: 3,\n  HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE: 0.2,\n  HABIT_REWARDS_NEW_GOLD: 5,\n  HABIT_REWARDS_NEW_EXPERIENCE: 2,\n\n\n  TODO_NEW_GOLD_REWARDS: 1,\n  TODO_DONE_GOLD_REWARDS: 3,\n  TODO_NEW_EXPERIENCE_REWARDS: 2,\n  TODO_DONE_EXPERIENCE_REWARDS: 5,\n\n\n  //messages\n  MESSAGE_DURATION: 2000,\n\n  //Auth\n  TOKEN_EXPIRATION: 300, // how many days\n  SYNC_SERVER: 'https://auth.mlflabs.com',\n  AUTH_API_URL: 'https://auth.mlflabs.com',\n  //SYNC_SERVER: 'http://localhost:3002',\n  //AUTH_API_URL: 'http://localhost:3002',\n}, ...detail}\n","import { Todo } from \"../../pages/todo/models\";\nimport moment from 'moment';\nimport { env } from \"../../env\";\n\n\nexport const calculateLevelExperience = (level:number): number => {\n  let exp = 0;\n    for(let x = 1; x < level; x++){\n      exp += Math.floor((x+100) * Math.pow(2,(x/7)))\n    }\n  return Math.floor(exp/4);\n}\n\n//diff 1-5\nexport const calculatePlantExperience = (level:number, diff = 0): number => {\n  let exp = 0;\n  const d = diff * diff * 10;\n    for(let x = 1; x < level; x++){\n      exp += Math.floor((x+100+d) * Math.pow(2,(x/7)))\n    }\n  return Math.floor(exp/4) + 2;\n}\n\n\nexport const calculateDoneTodoGold = (todo:Todo): number => {\n  let days = 0;\n  //how many days past\n  if(todo.date)\n    days = moment(todo.date).diff(moment(),'hour');\n  const rew = env.TODO_DONE_GOLD_REWARDS + (env.HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE * days);\n  return Math.floor(rew);\n}\n\nexport const calculateDoneTodoExperience = (todo:Todo): number => {\n  let days = 0;\n  //how many days past\n  if(todo.date)\n    days = moment(todo.date).diff(moment(),'hour');\n  const rew =env.TODO_DONE_EXPERIENCE_REWARDS + \n    (env.HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE * days);\n  return Math.floor(rew);\n\n\n}\n\n\n","import { Habit, MOMENT_DATE_FORMAT, HabitAction } from './models';\nimport moment from 'moment';\nimport { FIRST_DAY_OF_WEEK, env } from '../../env';\nimport ulog from 'ulog';\nimport { calculatePlantExperience } from '../../modules/gamify/utilsGamify';\nimport { MarketItem } from '../../modules/market/models';\nimport { LandscapeTree } from '../../modules/gamify/models';\n\nconst log = ulog('utils');\n\nexport interface GamifyRewards {\n  gold:number,\n  experience: number,\n  items:any[]\n}\n\nexport const mergeRewards = (rewards1: GamifyRewards, \n                             rewards2: GamifyRewards): GamifyRewards => {\n  return Object.assign({\n    gold: rewards1.gold + rewards2.gold,\n    experience: rewards1.experience + rewards2.experience,\n    items: [...rewards1.items, ...rewards2.items]\n  });\n}\n\n\n\nexport const getInitGamifyRewards =  (base?:GamifyRewards):GamifyRewards =>  {\n  return {...{ gold: 0, experience: 0, items:[] }, ...base};\n}\n\n\nconst sortByDate = (a, b) =>{\n  if(a.date > b.date) return 1;\n  return -1;\n}\n\nexport const calculateCurrentStreak = (habit: Habit, actions: HabitAction[]) => {\n    //loop through actions and add up rewards\n    let r ={habit: Object.assign(habit), rewards: getInitGamifyRewards()};\n    let rewards: GamifyRewards = getInitGamifyRewards();\n    actions.sort(sortByDate).forEach(action => {\n      //make sure we don't have future day, or past last calculated date day\n      if(r.habit.lastCalculatedDate){\n        if(moment(action.date).isBefore(moment(r.habit.lastCalculatedDate)))\n          throw new Error('Action date is too old, can not modify this action');\n        if(moment(action.date).isSame(moment(r.habit.lastCalculatedDate)))\n          throw new Error('Action for this date already submitted.');\n      }\n      if(moment(action.date).isAfter(moment()))\n        throw new Error('Action date is in the future, cannot modify this action');\n      \n      if(r.habit.regularityInterval === 'day')\n        r = calculateDailyChallengeStreak(r.habit, action)\n      else if(habit.regularityInterval === 'week')\n        r = calculateWeeklyChallengeStreak(r.habit, action)\n      else if(r.habit.regularityInterval === 'month')\n        r = calculateMonthlyChallengeStreak(r.habit, action)\n      else {\n        throw new Error('Challenge has incorrect regularityInterval, ' + \n          r.habit.regularityInterval )\n      }\n      rewards = mergeRewards(r.rewards, rewards);\n    });\n    const newHabit = addPlantExperience(r.habit, r.rewards);\n    console.log(rewards, newHabit);\n    return {habit: newHabit, rewards};\n}\n\nconst addPlantExperience = (habit: Habit, rewards: GamifyRewards): Habit => {\n  const h = Object.assign(habit);\n  h.plantExp += rewards.experience;\n  if(h.plantExp >= h.plantNextLevelExp){\n    h.plantLevel++;\n    h.plantExp = h.plantExp - h.plantNextLevelExp;\n    h.plantNextLevelExp = calculatePlantExperience(h.plantLevel,h.plantDifficultyLevel);\n  }\n  return h\n}\n\n\n//from action and back\nconst calculateDailyChallengeStreak = (habit: Habit, action: HabitAction) => {\n  \n\n  if(!habit.lastCalculatedDate) {\n    habit.actions = {};\n    habit.lastCalculatedDate = moment(action.date).subtract(1,'d').format(MOMENT_DATE_FORMAT);\n    habit.biggestStreak = 0;\n    habit.currentStreak = 0;\n  }\n\n  habit.actions[action.date] = action;\n\n  let currentAction;\n  let currentDateMoment = moment(habit.lastCalculatedDate).add(1, 'd');\n\n  //run this after going action/lastcalculateddate logic\n  while(currentDateMoment.isSameOrBefore(moment(action.date))) {\n    currentAction = habit.actions[currentDateMoment.format(MOMENT_DATE_FORMAT)];\n\n    //see if its null, no action or if contains values\n    if(currentAction) {\n      //do we have a value\n      if(currentAction.value >= habit.regularityEachDayGoal){\n        //success\n        habit.currentStreak++;\n      }\n      else {\n        //we have an action, but not a success\n        habit.currentStreak = 0;\n      }\n    }\n    else {\n        //currentAction is null, failed\n        habit.currentStreak = 0;\n    }\n    if(habit.currentStreak > habit.biggestStreak)\n      habit.biggestStreak = habit.currentStreak;\n\n    currentDateMoment.add(1, 'day');\n  }\n\n  habit.lastCalculatedDate = action.date;\n\n  //calculate rewards\n  let rewards = getInitGamifyRewards();\n  if(habit.currentStreak === 0){\n    rewards.gold = Math.floor(env.GAMIFY_HABIT_GOLD_BASE_REWARD * \n                        (action.value / habit.regularityEachDayGoal));\n    rewards.experience = Math.floor(env.GAMIFY_HABIT_EXPERIENCE_BASE_REWARD * \n                        (action.value / habit.regularityEachDayGoal));\n  }\n  else {\n    rewards.gold = calculateGoldByStreak(habit.currentStreak, \n                                          habit.difficulty,\n                                          env.GAMIFY_HABIT_GOLD_BASE_REWARD);\n    rewards.experience = calculateExperienceByStreak(habit.currentStreak,\n                                          habit.difficulty,\n                                          env.GAMIFY_HABIT_EXPERIENCE_BASE_REWARD);\n  }\n  return {habit: Object.assign(habit), rewards};\n}\n\n\n\nconst analizeDay = (currentAction: HabitAction, \n                     habit:Habit):{habit:Habit, \n                                   rewards:GamifyRewards} => {\n   //see if its null, no action or if contains values\n   let rewards = getInitGamifyRewards();\n   if(currentAction) {\n    //do we have a value\n    if(currentAction.value >= habit.regularityEachDayGoal){\n      //success\n      if(habit.currentTimeperiedStreak < habit.regularityIntervalGoal){\n        habit.currentTimeperiedStreak++;\n        habit.currentStreak++;\n        rewards.gold = calculateGoldByStreak(habit.currentStreak, \n          habit.difficulty,\n          env.GAMIFY_HABIT_GOLD_BASE_REWARD);\n        rewards.experience = calculateExperienceByStreak(habit.currentStreak,\n          habit.difficulty,\n          env.GAMIFY_HABIT_EXPERIENCE_BASE_REWARD);\n      }\n      else\n      {\n        //we made it, but we are over the goal value, just give basic bonus\n        //make it half of even a non streak one\n        rewards.gold = Math.floor(env.GAMIFY_HABIT_GOLD_BASE_REWARD/2);\n        rewards.experience = Math.floor(env.GAMIFY_HABIT_EXPERIENCE_BASE_REWARD/1.5);\n      }\n    } \n    else {\n      //we didn't make it this day, just give a basic, fraction of base reward\n      rewards.gold = calculateGoldByStreak(habit.currentStreak, \n        habit.difficulty,\n        env.GAMIFY_HABIT_GOLD_BASE_REWARD);\n      rewards.experience = calculateExperienceByStreak(habit.currentStreak,\n        habit.difficulty,\n        env.GAMIFY_HABIT_EXPERIENCE_BASE_REWARD);\n    }\n  }\n   \n  if(habit.currentStreak > habit.biggestStreak)\n    habit.biggestStreak = habit.currentStreak;\n  \n  return {habit: Object.assign(habit), rewards};\n}\n\n//from action and back\nconst calculateMonthlyChallengeStreak = (h: Habit, action: HabitAction) => {\n  let habit = Object.assign(h);\n  if(!habit.lastCalculatedDate) {\n    habit.actions = {};\n    habit.lastCalculatedDate = moment(action.date).subtract(1,'d').format(MOMENT_DATE_FORMAT);\n    habit.biggestStreak = 0;\n    habit.currentStreak = 0;\n    habit.currentTimeperiedStreak = 0;\n    habit.currentTimeperiodLastDay = moment(habit.lastCalculatedDate).date(1)\n                                        .add(1, 'month').format(MOMENT_DATE_FORMAT);\n  }\n\n  habit.actions[action.date] = action;\n\n  let currentAction;\n\n  let nextTimeperiodFirstDay = moment(habit.currentTimeperiodLastDay);\n  let currentDateMoment = moment(habit.lastCalculatedDate).add(1, 'd');\n  let rewards = getInitGamifyRewards();\n  //run this after going action/lastcalculateddate logic\n  while(currentDateMoment.isSameOrBefore(moment(action.date))) {\n    currentAction = habit.actions[currentDateMoment.format(MOMENT_DATE_FORMAT)];\n\n    //are we in the same week\n    if(currentDateMoment.isBefore(nextTimeperiodFirstDay)) {\n      const res = analizeDay(currentAction, habit)\n      habit = res.habit;\n      rewards = res.rewards;\n\n    }\n    else{ \n      //starting new timeperiod\n      //see if we made it last period\n      if(habit.currentTimeperiedStreak < habit.regularityIntervalGoal){\n        //we didn't make it, clear the streak\n        habit.currentStreak = 0;\n      }\n      nextTimeperiodFirstDay.add(1, 'month');\n      habit.currentTimeperiodLastDay = nextTimeperiodFirstDay.format(MOMENT_DATE_FORMAT);\n      //if we are before action date, its an error, too big of time span\n      if(currentDateMoment.isAfter(nextTimeperiodFirstDay)){\n        throw new Error('Action dates are too much apart.');\n      }\n      habit.currentTimeperiedStreak = 0;\n      const res = analizeDay(currentAction, habit);\n      habit = res.habit;\n      rewards = res.rewards;\n    }\n    currentDateMoment.add(1, 'day');\n  }\n\n  habit.lastCalculatedDate = action.date;\n  return {habit, rewards};\n}\n\n\n\nconst calculateWeeklyChallengeStreak = (h:Habit, action:HabitAction) => {\n  let habit = h;\n  if(!habit.lastCalculatedDate) {\n    habit.lastCalculatedDate = moment(action.date).subtract(1,'d').format(MOMENT_DATE_FORMAT);\n    habit.biggestStreak = 0;\n    habit.currentStreak = 0;\n    habit.currentTimeperiedStreak = 0;\n    habit.currentTimeperiodLastDay = moment(habit.lastCalculatedDate).day(FIRST_DAY_OF_WEEK)\n                                          .add(1, 'week').format(MOMENT_DATE_FORMAT);\n                                          habit.actions = {};\n  }\n\n  habit.actions[action.date] = action;\n\n  let currentAction;\n\n  let nextWeekFirstDay = moment(habit.currentTimeperiodLastDay);\n  let currentDateMoment = moment(habit.lastCalculatedDate).add(1, 'd');\n  let rewards = getInitGamifyRewards();\n  //run this after going action/lastcalculateddate logic\n  while(currentDateMoment.isSameOrBefore(moment(action.date))) {\n    currentAction = habit.actions[currentDateMoment.format(MOMENT_DATE_FORMAT)];\n\n    //are we in the same week\n    if(currentDateMoment.isBefore(nextWeekFirstDay)) {\n      const res = analizeDay(currentAction, habit)\n      rewards = res.rewards;\n      habit = res.habit;\n    }\n    else{ \n      //starting new timeperiod\n      //see if we made it last period\n      if(habit.currentTimeperiedStreak < habit.regularityIntervalGoal){\n        //we didn't make it, clear the streak\n        habit.currentStreak = 0;\n      }\n      nextWeekFirstDay.add(1, 'week');\n      habit.currentTimeperiodLastDay = nextWeekFirstDay.format(MOMENT_DATE_FORMAT);\n      //if we are before action date, its an error, too big of time span\n      if(currentDateMoment.isAfter(nextWeekFirstDay)){\n        throw new Error('Action dates are too much apart.');\n      }\n      habit.currentTimeperiedStreak = 0;\n      const res = analizeDay(currentAction, habit);\n      habit = res.habit;\n      rewards = res.rewards;\n    }\n    currentDateMoment.add(1, 'day');\n  }\n\n  habit.lastCalculatedDate = action.date;\n  return {habit, rewards};\n}\n\n\nconst calculateExperienceByStreak = (streak, difficulty,  baseXP) => {\n  let exponent = 0.7 + difficulty/5;\n  return Math.floor(baseXP + (streak * exponent))\n  \n}\n\nconst calculateGoldByStreak = (streak, difficulty,  baseXP) => {\n  let exponent = 1 + difficulty/5;\n  return Math.floor(baseXP + (streak * exponent))\n  \n}\n\n\n\nexport const getPlantSeedPic = (item: MarketItem) => {\n  let id = item.id;\n  if(id.startsWith('mi.'))\n    id = id.replace('mi.', 'tree.')\n  return \"assets/plants/\"+ id + '/seed.svg'\n}\n\n\nexport const getPlantPic = (habit: Habit) => {\n  let id = habit.plantId;\n  if(id === '') {\n    if(habit.plantName === 'starter')\n      id = 'tree.Maple'\n    if(habit.plantName === 'plant1')\n      id = 'tree.plant1'\n    if(habit.plantName === 'plant2')\n      id = 'tree.plant2'\n    if(habit.plantName === 'plant3')\n      id = 'tree.plant3'\n  }\n  return '/assets/plants/' + id + '/' + habit.plantLevel+ '.svg'\n}\n\n\n\nexport const getLandscapePlantPic = (tree: LandscapeTree) => {\n  console.error(tree);\n  let id = tree.id || '';\n  if(id === '') id = 'tree.Maple';\n  id = id.replace('mi.', 'tree.').replace('starter', 'Maple');\n  return '/assets/plants/' + id + '/' + tree.level+ '.svg'\n}","import { PROJECT_SERVICE, DIV, PROJECT_INDEX_SERVICE, ProjectItem, Doc } from './models';\nimport shortid from 'shortid';\nimport { env } from '../../env';\n\nexport const TYPE_SETTINGS = 'set';\n\nexport function generateUserChannelId(userid): string {\n  return 'u' + env.APP_ID + userid;\n}\n\nexport function getDefaultProject(userid): ProjectItem {\n  const uuid = 'u' + env.APP_ID + userid;\n  return {\n    id: generateProjectUUID(uuid, ''),\n    rev: 1,\n    name: 'default',\n    access:[],\n    type: TYPE_SETTINGS,\n    updated: 0, //Date.now(),\n    [env.ACCESS_META_KEY]: genrateMetaData(userid), \n  }\n}\n\nexport function generateUUID():string {\n  let id;\n  let ok = false;\n  while (!ok) {\n    id = shortid.generate();\n    if(id.substring(0,1)!== '_' && id.substring(0,1)!== '-')\n      ok = true;\n  }\n\n  return id;\n}\n\nexport function isThisUserProject(id:string|undefined, userid): boolean {\n  return (getChannelFromProjectId(id) === generateUserChannelId(userid));\n}\n\nexport function getChannelNameFromId(id:string|undefined) {\n  if(id === undefined) throw new Error('Id cannot be undefined');\n  return id.split(DIV)[0];\n}\n\nexport function getProjectChildId(id:string|undefined): string {\n  if(id === undefined) throw new Error('Id can not be undefined');\n  let length = PROJECT_INDEX_SERVICE.length + DIV.length;\n  return id.substring(0, id.length-length);\n}\n\nexport function getChannelFromProjectId(id: string|undefined):string {\n  return getProjectChildId(id);\n}\n\nexport function generateProjectUUID(id = generateUUID(), app = env.APP_ID):string {\n  return app + id +  DIV + PROJECT_INDEX_SERVICE;\n}\n\nexport function generateProjectChildId(projectId: string, type: string, id = generateUUID()):string {\n  return PROJECT_SERVICE+ DIV + projectId.split(DIV)[1] + DIV + type +\n          DIV + id;\n}\n\nexport function generateCollectionId(projectid: string, collection, id = generateUUID()): string {\n  //eliminate dots from id, not allowed\n  id = id.replace('.','');\n  \n  if(projectid === undefined) throw new Error(\"Project can't be underfined\");\n  const length = PROJECT_INDEX_SERVICE.length;\n  return projectid.substring(0, projectid.length-length)+collection+ DIV +id; \n}\n\nexport const waitMS = (ms) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\n\nexport function saveIntoArray(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n  Object.assign({}, item),\n  ...ary.slice(i + 1)];\n}\n\nexport function genrateMetaData(userid:string):string[]{\n    return [ 'u'+ env.APP_ID + userid,]; \n}\n\n\n\nexport function getIndexById(id: string, ary: any, idKey: string = 'id'): number {\n  for (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return i;\n    }\n  }\n  // if we don't have a match return null\n  return -1;\n}\n\nexport const extractTypeCollectionFromDocId = (id) => {\n  return id.split(DIV)[2];\n}\n\nexport const extractChannelNameFromDocId = (id) => {\n  return id.split(DIV)[0];\n}\n\n\n//rights functions\n/*\n    Rights, each digit represents different right\n    0.  0 - Not admin 1- Admin, can change everything\n    1.  (Project item) 0 - can't see, 1 - can see, 2 - can edit\n    2.  (Project children) 0 - can't see, 1 - can see own, 2 - can see all items\n    3.  (Project children edit) 0 -can't edit, 1 can edit/make own, 2 can edit all \n*/\n\nexport const getDocumentRights = (id: string|undefined, user):string|undefined => {\n  const channel = getChannelNameFromId(id);\n  return user[env.ACCESS_META_KEY][channel];\n}\n\nexport const canEditProject = (id, user): boolean => {\n  const rights = getDocumentRights(id, user);\n  if(!rights) return false;\n  return canEditProjectByRights(rights);\n} \n\nexport const canEditProjectByRights = (rights: string): boolean => {\n  if(rights.substring(0,1) === '1') return true;\n  if(rights.substring(1,2) === '2') return true;\n  return false;\n}\n\n\nexport const canEditDoc= (doc:Doc, user): boolean => {\n  const rights = getDocumentRights(doc.id, user);\n  if(!rights) return false;\n  return canEditItemByRights(rights, doc.creator === user.id);\n} \n\nexport const canEditOwnedItemByRights = (rights: string): boolean => {\n  if(rights.substring(0,1) === '1') return true;\n  if(rights.substring(3,4) === '1') return true;\n  if(rights.substring(3,4) === '2') return true;\n  return false;\n}\n\nexport const canEditOthersItemByRights = (rights: string): boolean => {\n  if(rights.substring(0,1) === '1') return true;\n  if(rights.substring(3,4) === '2') return true;\n  return false;\n}\n\nexport const canEditItemByRights = (rights: string, myItem:boolean): boolean => {\n  return (myItem)? canEditOwnedItemByRights(rights) : canEditOthersItemByRights(rights);\n}\n\n","import { Doc } from '../../modules/data/models'\nimport { GamifyRewards, getInitGamifyRewards } from '../habits/utilsHabits';\nimport { getProjectChildId } from '../../modules/data/utilsData';\n\nexport const TYPE_TODO = 'todo';\nexport const TYPE_TODO_LIST = 'todolist';\nexport const TYPE_TODO_FOLDER = 'todoFolder';\nexport const TYPE_TODO_TAG = 'todoTag';\n\nexport const FOLDER_BASE_POSITION = 'base';\n\nexport const getDefaultTodoList = (name:string = 'tasks', projectid:string):TodoList => {\n  const project = getProjectChildId(projectid);\n  return new TodoList({\n    id: undefined,\n    folder: undefined,\n    type: TYPE_TODO_LIST,\n    icon: 'check',\n    secondaryType: TYPE_TODO_LIST,\n    name,\n    fullname: project + name,\n  })\n}\n\nexport class TodoList extends Doc {\n  folder: string = FOLDER_BASE_POSITION;\n  type: string = TYPE_TODO_LIST;\n  project?: string;\n  icon?:string;\n  color?:string;\n  _new?: boolean;\n  fullname:string;\n  secondaryType:'todolist'|'todoFolder'  = TYPE_TODO_LIST\n\n  constructor(values: Object = {}) {\n    super();\n    Object.assign(this, values);\n    this.fullname = values['fullname'];\n  }\n}\n\nexport const getDefaultTodoTag = (name:string = 'tasks', icon:string ='check'):TodoTag => {\n  return new TodoTag({\n    id: undefined,\n    type: TYPE_TODO_TAG,\n    icon,\n    name,\n  })\n}\n\nexport class TodoTag extends Doc {\n  type: string = TYPE_TODO_TAG;\n  icon?:string;\n  animatedIcon?:any;\n  color?:string;\n  _new?: boolean;\n  constructor(values: Object = {}) {\n    super();\n    Object.assign(this, values);\n    //this.fullname = values['fullname'];\n  }\n}\n\nexport class Todo extends Doc {\n  note?: string;\n  type: string = TYPE_TODO;\n\n  done: boolean;\n  date: number|null;\n  list: string = 'default';\n  tags: string[];\n\n\n  _new?: boolean; // for saving new docs, temp solution\n    //sub tasks\n  parent: string | null;\n  subTodos: string[];\n  showSubTodos: boolean;\n  showDone: boolean;\n\n  newRewards: GamifyRewards;\n  doneRewards: GamifyRewards;\n  \n  constructor(values: Object = {}) {\n    super();\n    this.done = false;\n    this.date = null;\n    this.tags = [];\n    this.parent = null;\n    this.subTodos = [];\n\n    this.showSubTodos = false;\n    this.showDone = false;\n\n    this.newRewards = getInitGamifyRewards();\n    this.doneRewards = getInitGamifyRewards();\n    \n    Object.assign(this, values);\n\n  }\n}","import React, { useState } from 'react'\nimport Lottie from 'react-lottie';\nimport './default.css'\n\nexport const waitMS = (ms: number) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\n\nfunction AnimatedIcon({iconsvg, actionFunc}:\n    {iconsvg:any, actionFunc:Function}) {\n  const [state, setState] = useState({isStopped:true, isPaused:true})\n\n\n  const defaultOptions = {\n    loop: true,\n    autoplay: false, \n    render: 'svg',\n    animationData: iconsvg,\n    rendererSettings: {\n      clearCanvas: true,\n      scaleMode: 'noScale',\n      preserveAspectRatio: 'xMidYMid slice'\n    }\n  }; \n\n  const actionHandler = async() => {\n    setState({isStopped:false, isPaused:false});\n    \n\n    await waitMS(1000);\n    actionFunc();\n    setState({isStopped:true, isPaused:true});\n  }\n\n  return (\n    <div onClick={() => actionHandler()} className =\"animatedfunction\">\n      <Lottie  options={defaultOptions}\n          height={25}\n          width={25}\n          isStopped={state.isPaused}\n          isPaused={state.isStopped}/>\n    </div>\n  )\n}\n\nexport default AnimatedIcon;\n","import { Doc, ProjectItem } from \"../data/models\";\n\nexport const TYPE_PARTY = 'party';\n\nexport enum ChallengeState {\n  finished = 'finished',\n  current = 'current',\n  future = 'future',\n  waiting = 'waiting',\n  resting = 'resting',\n}\n\nexport enum ChallengeType {\n  checkin = 'Check-In',\n  value = 'Value',\n  note = 'Note',\n  quizz = 'Quizz',\n  looser = 'Biggest Looser',\n  gainer = 'Biggest Gainer'\n}\n\nexport enum ChallengeTypeUnit {\n  Cup = 'Cup',\n  Dollar = \"Dollar\",\n  Page = 'Page',\n  Minute = 'Minute',\n  Hour = 'Hour',\n  Meter = 'Meter',\n  Kilometer = 'Kilometer',\n  Other = 'Other'\n}\n\n\nexport enum ChallengeDifficulty {\n  trivial, easy, medium, hard, extreme\n}\n\nexport enum ChallengeIntervals {\n  day = 'day',\n  week = 'week',\n  month = 'month'\n}\n\nexport interface PartyMember {\n  id: string,\n  username: string,\n  rights: string,\n  score: {reward: number},\n  scoreHistory: {[key:string]: {reward:number}};\n}\n\nexport interface ChallengeRewards {\n  value: number,\n  item?: any,\n}\n\nexport interface ChallengeAction {\n  date: string,\n  value: number, \n  reward: ChallengeRewards,\n  data?: any,\n}\nexport interface ChallengeMember {\n  id: string,\n  username: string,\n  score: {reward: number},\n  joinDate: number,\n  actions: { [key:string]: ChallengeAction },\n  lastCalculatedDate?: string,\n  currentStreak?: number,\n  biggestStreak?: number,\n}\n\n\nexport class PartyProject extends ProjectItem {\n  type: string = TYPE_PARTY\n  secondaryType: string = 'project'\n  creator: string = '';\n  dirty: number = 0;\n  members: PartyMember[]  = []\n\n  moneyTypeSingle: string = 'Ruby';\n  moneyTypeMultiple: string =  'Rubies';\n  moneyColor: string = '#ff0000'\n\n\n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n  }\n}\n\nexport class Challenge extends Doc {\n  name: string = '';\n  note?: string;\n  type:string = TYPE_PARTY;\n  access: string = ''\n  secondaryType: string = 'challenge'\n  state: ChallengeState = ChallengeState.waiting;\n  difficulty:ChallengeDifficulty = ChallengeDifficulty.medium;\n  //regularity\n  regularityInterval:ChallengeIntervals = ChallengeIntervals.day;\n  regularityIntervalGoal: number = 1;\n  regularityEachDayGoal: number = 1;\n\n  //type\n  challengeType: ChallengeType = ChallengeType.checkin;\n  challengeTypeUnit: ChallengeTypeUnit = ChallengeTypeUnit.Other;\n  chalengeTypeOther: string = '';\n  challengePointMultiplier: number = 1;\n\n  chalengeTypeNoteVote: boolean = false;\n\n  //members\n  members: ChallengeMember[]  = []\n\n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n  }\n}\n","import Dexie from 'dexie';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { DataChangeEvent } from '../dataService';\nimport { Subscription } from 'rxjs';\nimport { env } from '../../../env';\nimport ulog from 'ulog';\n\nconst log = ulog('dexie');\n\nexport interface DatabaseScheme {\n  name: string,\n  version: number,\n  tables: TableScheme[],\n}\n\nexport interface TableScheme {\n  name: string,\n  columns: string,\n  sync: boolean,\n}\n\n\nexport default class DexieAdapter {\n\n  private db;\n  private _ready = false;\n  public ready$ = new BehaviorSubject(this._ready);\n  private _subscriptions:Subscription[] = [];\n\n  public changes$ = new Subject<DataChangeEvent>();\n\n  constructor(scheme: DatabaseScheme) {\n    this.db = new Dexie(env.APP_ID +  scheme.name+ '_dexie');\n    const stores = {};\n    scheme.tables.forEach(t => {\n      stores[t.name] = t.columns;\n    });\n    this.db.version(scheme.version).stores(stores);\n    this._init();\n  }\n\n  private async _init() {\n    try {\n      await this.db.open();\n      this._ready = true;\n      this.ready$.next(true);\n    }\n    catch(e) {\n      log.error(e);\n    }\n  }\n\n  public async destroy() {\n    this._subscriptions.forEach(sub => {\n      if(sub)sub.unsubscribe();\n    })\n  }\n\n  public async getDoc(id: string, collection: string): Promise<any> {\n    //const res = await this.db[collection].where('id').equals(id).first();\n    const res = await this.db[collection].get({id});\n    if(res) return res;\n    return null;\n  }\n\n  public async getBulk(ids: string[], collection: string): Promise<any> {\n    const res = await this.db[collection].bulkGet(ids);\n    return res.filter(doc => doc !== undefined)\n  }\n\n  public async queryByProperty(field: string, operator: string, \n      value: any, collection: string): Promise<any> {\n    switch(operator) {\n      case 'equals':\n        const docs = await this.db[collection].where(field).equals(value).toArray();\n        return docs;\n      case 'startsWith':\n        return await this.db[collection].where(field).startsWith(value).toArray();\n      case 'notEqual':\n        return await this.db[collection].where(field).notEqual(value).toArray();\n      default:\n        throw new Error('Missing proper operator, given: '+ operator);\n    }\n  }\n\n  public async getProjectItems(projectid: string, collection: string) {\n    const res = await this.db[collection].where('id').startsWith(projectid).toArray();\n    return res;\n  }\n\n  public async save(doc: any, collection: string, setDirty = true){\n    if(setDirty)\n      doc.dirty = 1;\n    const res = await this.db[collection].put(doc);\n    if(res) {\n      this.changes$.next({doc});\n      return true\n    }\n    return false;\n  }\n\n  public async saveFromSync(docs: any[], collection: string){\n    const res = await this.db[collection].bulkPut(docs);\n    if(res) {\n      docs.forEach(doc => {\n        this.changes$.next({doc});\n      })\n      return true\n    }\n    return false;\n  }\n\n\n}","\n\nexport const TYPE_MSG = 'msg';\n\nexport interface Msg {\n  id:string,\n  to:string, \n  from:string, \n  type:string, \n  messageType: string,\n  message:string, \n  data: any\n  replied?: {accepted: boolean, date:number},\n  deleted?: boolean\n}\n\n\nexport const newMessage = ( message, \n                            messageType=\"event\",\n                            messageSubType=\"\",\n                            data={}): MessageItem => {\n  return {\n    message,\n    messageType,\n    messageSubType,\n    data\n  }\n\n}\n\nexport class MessageItem {\n  id?:string;\n  to?:string; \n  from?:string; \n  type?:string; \n  messageType?: string;\n  messageSubType?: string;\n  message?:string;\n  data?: any\n  replied?: {accepted: boolean, date:number};\n  deleted?: boolean\n\n\n  constructor(values: Object = {}) {\n    Object.assign(this, values);\n  }\n}","\n\nclass LocalStorageService {\n  \n  async getItem(id: string){\n    return localStorage.getItem(id);\n  }\n\n  async getString(id: string):Promise<string>{\n    let val:string;\n    val = localStorage.getItem(id) || '';\n    return val;\n  }\n\n  async getObject(id: string):Promise<object|null> {\n    const val = localStorage.getItem(id);\n    if(!val)return null;\n    return JSON.parse(val);\n\n  }\n\n  async setObject(id: string, val: object):Promise<boolean> {\n    try {\n      const str = JSON.stringify(val);\n      await localStorage.setItem(id, str);\n      return true;\n    }\n    catch(e){\n      console.log(e);\n      return false;\n    }\n    \n\n  }\n\n\n\n  async setString(id: string, val: string) {\n    localStorage.setItem(id, val);\n  }\n  \n}\n\nconst localStorageService = new LocalStorageService();\n\nexport default localStorageService;","import moment from 'moment';\nimport ulog from 'ulog'\n\nconst log = ulog('utils');\n\nexport const capitalize = (s: string) => {\n  if (typeof s !== 'string') return ''\n  return s.charAt(0).toUpperCase() + s.slice(1)\n}\n\nexport const printDateRelative = (timestamp: number) => {\n  try {\n    const m = moment(timestamp);\n\n    if(moment().diff(m, 'd') < 3){\n      return m.fromNow();\n    }\n    else {\n      return m.format('DD-MM-YYYY');\n    }\n  }\n  catch(e){\n    log.error(e);\n  }\n}\n\nexport function getNested(obj: any, ...args: string[]) {\n  return args.reduce((obj, level) => obj && obj[level], obj)\n}\n\nexport const waitMS = (ms: number) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\nexport function getAction(todo:string, data = {}){\n  return {type:todo, data:data};\n}\n\nexport function printCleanNote(text: string) {\n  const t = text.replace(/(\\r\\n|\\n|\\r)/gm,\" \");\n  if(t.length > 40)\n    return t.substring(0,37)+'...';\n  return t;\n}\n\nexport function saveIntoArray(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n          Object.assign({}, item),\n          ...ary.slice(i + 1)];\n}\n\nexport function saveIntoDocList(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  if(item['deleted']){\n    return ary.filter(d => d[idKey] !== item[idKey])\n  }\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n          Object.assign({}, item),\n          ...ary.slice(i + 1)];\n}\n\nexport function getIndexById(id: string, ary: any, idKey: string = 'id'): number {\n  for (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nexport function findById(id:any, ary: any[], idKey: string = \"id\"): any {\nfor (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return ary[i];\n    }\n  }\n  return null;\n}\n\nexport function removeFromArrayById(id: any, ary:Array<any>, idKey = 'id') {\n  return ary.filter(o => o[idKey] !== id);\n}\n\nexport function clamp(val:number, max:number, min:number = 0): number {\n  if(val > max) return max;\n  if(val < min) return min;\n  return val;\n}","import axios from 'axios';\nimport { getNested } from '../../utils';\nimport { loadingService } from '../loading/loadingService';\nimport ulog from 'ulog';\n\nconst log = ulog('ajax');\n\n\nexport interface ajaxResponse {\n  success: boolean,\n  data: any,\n  status?: number,\n  errors?: errorMessage[]\n}\n\n\nexport const getAjaxMessage = (success:boolean, data:any, \n    status:number = 0, errors: errorMessage[] = []): ajaxResponse => {\n  return {success, data, status, errors}\n}\n\nexport const getAjaxErrorMessage = (errorMessage: string, \n  location='system', status:number = 404 ) => {\n    return getAjaxMessage(false, null, status, \n      [{location, msg:errorMessage}])\n}\n\nexport interface errorMessage {\n  location: string,\n  msg: string\n}\n\nexport interface postRequest {\n  url: string,\n  type: string,\n  form: object,\n  options?: object,\n}\n\nexport interface getRequest {\n  url: string,\n  type: string,\n  form: object,\n  options?: object,\n}\n\nexport const getPostRequest = (url:string, form:object, options:object = {}, ) => {\n    return {url, type:'post', form, options};\n}\n\n\n\nexport const getErrorMessage = (msg: string, location:string = \"Server\"):errorMessage => {\n  return {msg, location};\n}\n\nexport const post = async (req: postRequest, showLoading = true, loadingMessage=\"Loading...\"):Promise<ajaxResponse> => {\n  try {\n    if(showLoading)\n      loadingService.showLoading(loadingMessage);\n    const res = await axios.post(req.url, req.form, req.options);\n\n    loadingService.hideLoading();\n    log.info(res);\n    return getAjaxMessage(true, res.data, 200);\n  }\n  catch(err) {\n    loadingService.hideLoading();\n    const response = getNested(err, 'response');\n    if(!response || !response.status) {\n      return getAjaxMessage(false, null, 503, [getErrorMessage(\"Service is temporarly unavailable\")]);\n    }\n    else if(response.status === 422){\n      return getAjaxMessage(false, null, response.data.status, response.data.errors);\n    }\n    else if(response.status === 404) {\n      return getAjaxMessage(false, null, 404, [getErrorMessage(\"Could not connect to server\")]);\n    }\n    else {\n      return getAjaxMessage(false, null, response.status, [getErrorMessage(\"Could not connect to server\")]);\n    }\n  }\n}\n","import { Subject } from 'rxjs';\nimport { ajaxResponse } from '../ajax/ajax';\nimport { toast } from 'react-toastify';\n\nexport interface ToastMessage {\n  message: string,\n  duration: number,\n  key?: number,\n}\n\nexport enum ToastType {\n  default = \"default\", \n  info = \"info\", \n  success = \"success\", \n  warning = \"warning\", \n  error = \"error\"\n}\n\n\nexport class ToastService {\n\n  public messages$ = new Subject<ToastMessage>();\n\n  showMessage(message: string, type:ToastType = ToastType.default, milliseconds: number = 3000) {\n    toast(message, {\n      type: type,\n      autoClose: milliseconds,\n    })\n  }\n\n  printSimpleError (msg:string, duration = 2000) {\n    toast( msg, {type: ToastType.error, autoClose: duration})\n  }\n\n  //TODO: for now only prints the first error\n  printServerErrors (res:ajaxResponse) {\n    const errors = res.errors || [];\n    if(errors.length > 0){\n      errors.forEach(err => this.showMessage(err.msg, ToastType.error))\n    }\n  }\n\n\n\n}\nexport const toastService = new ToastService();\n\n\n","\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport * as moment from 'moment';\nimport { isEqual } from 'lodash';\nimport localStorageService from '../localStorage/localStorageService';\nimport {env} from '../../env';\nimport  { getPostRequest, post, ajaxResponse } from '../ajax/ajax';\nimport { toastService } from '../toast/toastService';\nimport ulog from 'ulog';\n\nconst log =  ulog('auth');\n\nexport enum AuthStatus {\n  Loading, \n  Guest, //not loged in\n  User // loged in\n}\n\nexport const GUEST = 'Guest';\nexport const AUTH_USER_KEY = 'auth-user-key';\nexport interface AuthEvent {\n  success: boolean;\n  code: number;\n  data: any;\n}\n\nexport interface User {\n  id: string,\n  username: string;\n  email: string|null;\n  token: string|null;\n  token_expiery: number|null;\n  access: any[];\n}\n\n\n\nexport const getUser = (values: any):User => {\n  if(values == null)\n    return {\n      id: 'guest',\n      username: GUEST,\n      email: null,\n      token: null,\n      token_expiery: null,\n      access: []\n    }\n\n  return {\n    id: values.id || 'guest',\n    username: values.username || GUEST,\n    email: values.email||null,\n    token: values.token||null,\n    token_expiery: values.token_expiery||values.expires||null,\n    access: values.access || []\n  }\n}\n\nexport const isGuest = (user:User) => {\n  return user.username === GUEST;\n}\n\nexport function getGuestUser(username:string = 'Guest'):User {\n  return getUser({ username });\n}\n\n\nexport class AuthService {\n  private _user:User = getGuestUser('null');\n  private _authStatus = AuthStatus.Loading;\n  public authStatus$ = new BehaviorSubject(this._authStatus);\n  public username$ = new Subject<string>();\n\n  constructor() {\n    this.loadAuth();\n  }\n\n  getIsAuthenticated():boolean { return this._authStatus === AuthStatus.User; }\n  getUsername() { return this._user.username; }\n  getEmail() { return this._user.email;}\n  getUser() { return this._user };\n\n\n  async updateUser(user: User, forceLogout = false) {\n    // log.info('Userupdate: ', user, forceLogout, this._authStatus);\n    log.info('Update User:: ', user);\n    if(!isGuest(user) || this._user.username ==='null') {\n\n      if(this._authStatus !== AuthStatus.User) {\n        this.setAuthStatus(AuthStatus.User);\n      }\n\n      if(user.username !== this._user.username){\n        this._user = user;\n        await localStorageService.setObject(AUTH_USER_KEY, user)\n        this.username$.next(user.username);\n      }\n      if(!isEqual(this._user, user)) {\n        log.info('New user object, save it', user);\n        this._user = user;\n        await localStorageService.setObject(AUTH_USER_KEY, user)\n      }\n      \n      return;\n    }\n\n    if(this._authStatus !== AuthStatus.Guest){\n      this.setAuthStatus(AuthStatus.Guest)\n  \n      if(forceLogout){\n        await localStorageService.setObject(AUTH_USER_KEY, getGuestUser);\n      }\n    }\n  }\n\n\n\n\n  async loadAuth() {\n    try {\n      const user = getUser(await localStorageService.getObject(AUTH_USER_KEY));\n      log.info('LOADED USER', user);\n\n      if(!user.token || !user.token_expiery) {\n        return this.updateUser(getGuestUser());\n      }\n      const exp = moment.unix(user.token_expiery);\n      if(exp.isAfter(moment.now())) {\n        return this.updateUser(user);\n      }\n      else {\n        log.warn('TOKEN is old');\n        return this.updateUser(getGuestUser())\n      }\n    }\n    catch(e) {\n      log.error(e);\n      return this.updateUser(getGuestUser())\n    }\n  }\n\n\n  public async loginAndRedirect(id: string, password: string, history, location) {\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/login',\n      { id, password, app: env.APP_ID },), true,  'Login in, please wait');\n      if(res.success) {\n        this.updateUser(getUser(res.data))\n        let next;\n        if(location && location.state && location.state.prev){\n          next = location.state.prev.startsWith('/auth/')? '/': location.state.prev;\n        }\n\n        history.push(next || '/');\n      }\n      else {\n        toastService.printServerErrors(res);\n      }\n  }\n\n  public async logout() {\n    \n  }\n\n  public async login(id: string, password: string):Promise<ajaxResponse> {\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/login',\n      { username: id, password: password, app: env.APP_ID }, {}), true,  'Login in, please wait');\n\n    return res;\n  }\n\n\n  public async renewToken() {\n    const res = await post(getPostRequest(env.AUTH_API_URL+'/auth/renewToken',\n                          {token: this._user.token}), false);\n    log.info('Renewed Token: ', res);\n    if(res.success){\n      await this.updateUser({...this._user, ...{token: res.data.token, \n                                [env.ACCESS_META_KEY]: res.data[env.SERVER_ACCESS_META_KEY],\n                                token_expiery: res.data.expires}})\n      return true;\n    }\n    else {\n      //is it bad token, or just no internet\n      if(res.status && res.status === 422){\n        await this.updateUser(getGuestUser());\n        return false;\n      }\n    }\n\n\n  }\n\n  public async register(username:string, email: string, password: string): Promise<boolean> {\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/register',\n                      { username, password, email }),\n                      true,  'Registering, please wait');\n    if(res.success) {\n        return true;\n    }\n    else {\n      toastService.printServerErrors(res);\n      return false;\n    }\n  }\n\n  public async forgotPassword() {\n    //const res = await this.http.post(environment.auth_api+'/auth/forgotpassword'\n  }\n\n\n  private setAuthStatus(status:AuthStatus){\n    this._authStatus = status;\n    this.authStatus$.next(status);\n  }\n\n  public getAuthStatus():AuthStatus {\n    return this._authStatus;\n  }\n\n  public getToken():string {\n    return this._user.token || '';\n  }\n\n  public get userid(): string {\n    return this._user.id || '';\n  }\n\n\n\n}\nexport const authService = new AuthService();\n\n","import { post, getPostRequest } from '../ajax/ajax';\nimport { DIV } from './models';\nimport localStorageService from '../localStorage/localStorageService';\nimport ulog from 'ulog';\n\nconst log = ulog('sync');\n\nexport interface SyncDataChannel {\n  name: string,\n  docs: any[],\n}\n\n\nexport const organizeData = async (data: any[]) => {\n  const channels = {};\n  let channel;\n\n  data.forEach(doc => {\n    channel = doc.id.split(DIV)[0];\n    if(!channels[channel]) channels[channel] = [];\n    channels[channel].push({...{}, ...doc});\n\n  });\n  //now load channel checkpoints\n  const checkpoints = await localStorageService.getObject('channel_checkpoints') || {};\n  return {channels: channels, checkpoints};\n}\n\nexport const syncData = async (props:{  data:any[],\n                                        syncurl: string, \n                                        token: string, \n                                        checkpoint: number,\n                                        requestMaxSize:number}) => {\n  //TODO: check our size of docs, if its bigger than max size\n  try {\n    //get checkpoint\n    const data =  await organizeData(props.data);\n    const res = await post(getPostRequest(props.syncurl + '/sync/sync', {\n      token: props.token,\n      checkpoint: props.checkpoint,\n      data,\n    }),false,'');\n\n    if(res) {\n      //if error skipt\n      if(!res.data) {\n        log.warn(res)\n        return null;\n      }\n      //merge the 2 checkpoints\n      const chpoints = await localStorageService.getObject('channel_checkpoints') || {};\n      console.log(res);\n      await localStorageService.setObject('channel_checkpoints',{...chpoints, ...res.data.checkpoints})\n      return res.data.types;\n    }\n    return null;\n  }\n  catch(e){\n    log.error(e);\n   }\n}\n\n","import { Observable, Subject, BehaviorSubject } from 'rxjs';\nimport { map, filter, throttleTime } from 'rxjs/operators';\nimport { getProjectChildId, generateCollectionId, \n  TYPE_SETTINGS, waitMS, getChannelFromProjectId, getDefaultProject } from './utilsData';\n\nimport { ProjectItem, DIV } from './models';\nimport _ from 'lodash';\nimport DexieAdapter, { DatabaseScheme } from './adapters/dexie';\nimport { TYPE_HABBIT } from '../../pages/habits/models';\nimport { TYPE_TODO, TYPE_TODO_LIST, TYPE_TODO_TAG } from '../../pages/todo/models';\nimport { TYPE_PARTY } from '../parties/models';\nimport { TYPE_MSG } from '../messages/models';\nimport { env } from '../../env';\nimport { authService } from '../auth/authService';\nimport localStorageService from '../localStorage/localStorageService';\nimport { syncData } from './sync';\nimport { post, getPostRequest } from '../ajax/ajax';\nimport ulog from 'ulog';\nimport { TYPE_SOCIAL } from '../social/models';\nimport { RefresherEventDetail } from '@ionic/core';\n\nconst log = ulog('dataService');\n\nexport interface DataChangeEvent {\n  doc: any,\n  old?: any,\n}\n\nconst databaseScheme: DatabaseScheme =  {\n  name: 'guest_dx',\n  version: 21,\n  tables: [\n    {\n      name: TYPE_SETTINGS,\n      columns: 'id, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_PARTY,\n      columns: 'id, dirty, party, type, secondaryType',\n      sync: true\n    },\n    {\n      name: TYPE_TODO,\n      columns: 'id, *tags, list ,dirty',\n      sync: true\n    },\n    {\n      name: TYPE_TODO_LIST,\n      columns: 'id, dirty, folder, secondaryType, fullname',\n      sync: true\n    },\n    {\n      name: TYPE_TODO_TAG,\n      columns: 'id, name, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_HABBIT,\n      columns: 'id, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_MSG,\n      columns: 'id, messageType, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_SOCIAL,\n      columns: 'id, name, dirty, secondaryType',\n      sync: true\n    },\n  ]\n}\n\n\n\nclass DataService {\n  private db;\n  private authId:string = '';\n  private _ready = false;\n  public _ready$ = new BehaviorSubject(this._ready);\n  public addSyncCall$ = new Subject(); // do we need to sync with server\n  constructor() {\n    //subscriptions\n    this.addSyncCall$.pipe(\n      throttleTime(5000),\n    ).subscribe(() => {\n        log.info('Syncing.......')\n        this._syncRemote();\n      })\n  }\n\n  async getDoc(id: string|undefined,  collection: string): Promise<any> {\n    if(id === undefined){\n      throw new Error('Doc Id cannot be undefined, check logic.');\n    }\n    return await this.db.getDoc(id, collection);\n  }\n\n  async getBulk(ids: string[], collection: string): Promise<any> {\n   return await this.db.getBulk(ids, collection);\n  }\n\n  //operators: equals, startsWith, above, below, notEqual\n  async queryByProperty(field:string, operator: 'equals'|'startsWith'|'notEqual', \n      value: any, collection: string): Promise<any> {\n    return await this.db.queryByProperty(field, operator, value, collection);\n  }\n\n  async getAllByProject(projectid, collection): Promise<any> {\n    return await this.db.getProjectItems(getProjectChildId(projectid) + DIV, collection);\n  }\n\n  async getAllByChannel(channel, collection): Promise<any> {\n    return await this.db.getProjectItems(channel + DIV, collection);\n  }\n\n  //save without making it diryt\n  async saveFromServer(doc:any, type:string) {\n    await this.db.save(doc, type, false);\n  }\n\n  async save(doc:any, collection: string, props:{projectid?: string, \n    oldDoc?: any,remoteSync?:boolean} = {}): Promise<any> {  \n      log.info('SAVING DOC', doc, props, collection);\n      if(!props) props = {remoteSync: true};\n      if(props.remoteSync === undefined) props.remoteSync = true;\n    \n      try {\n        let oldDoc = {};\n        if (doc.id && props.oldDoc == null) {\n          oldDoc = await this.getDoc(doc.id, collection);\n        }\n        if (_.isEqual(oldDoc, doc)) {\n          return false; \n        }\n    \n        if(!doc.id) {\n          console.log(doc, props);\n          if(!props.projectid) throw new Error('Saving new doc requires valid props.project')\n            // @ts-ignore:  we made this check at the begining\n          doc.id = generateCollectionId(props.projectid, collection);\n          doc.created = Date.now();\n        }\n        doc.dirty = true;\n        if(!doc.rev)doc.rev = 1;\n        doc.rev ++;\n        const res = await this.db.save(doc, collection);\n        if (props.remoteSync)\n          this.addSyncCall$.next();\n        if (res.ok)\n          return res;\n        else\n          return false;\n        }\n      catch (e) {\n        log.error('DEXIE error: ', e);\n        return false;\n      }\n  }\n\n  \n\n  \n\n\n  async saveNewProject(project:ProjectItem, collection: string): Promise<any> {\n    const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/addNewChannel',\n                      {token: authService.getToken(), \n                       doc: project,\n                       name: project.name}, {} ),  false) ;\n    log.info('Making new project, ajax result: ', res);\n    if(!res.success)\n      return res;\n\n    const channel = res.data.channel;\n    let gotNewRightsToken = false;\n    while(!gotNewRightsToken){\n      await authService.renewToken()\n      const user = authService.getUser();\n      if(user[env.ACCESS_META_KEY][channel]){\n        gotNewRightsToken = true;\n      }\n      else {\n        await waitMS(2000);\n      }\n    }\n    return await this.db.save(res.data.doc, collection, false);\n  }\n\n  async saveSystemDoc(doc: any, project:ProjectItem, collection: string): Promise<any> {\n    if(doc.id){\n      log.warn('Editing SystemDoc, ', doc);\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/editSystemDoc',\n                            { token: authService.getToken(), doc}, {} ), false) ;\n      if(!res.success)\n        return res;\n  \n      return await this.db.save(res.data.doc, collection, false);\n    }\n    else {\n      log.warn('Saving new SystemDoc, ', doc);\n      const doc2 = {}\n      if(!doc.type) \n        throw new Error('Saving system doc requires doc to have type property');\n      if(doc.secondaryType)\n        doc2['secondaryType'] = doc.secondaryType;\n  \n      const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/addNewSystemDoc',\n                        {...{ token: authService.getToken(), \n                          doctype: doc.type,\n                          channelname: getChannelFromProjectId(project.id),\n                          doc: doc }, ...doc2}, {} ), false) ;\n      if(!res.success)\n        return res;\n  \n      return await this.db.save(res.data.doc, collection, false);\n    }\n    \n\n  }\n\n\n\n\n  public async remove(id: string, collection: string, remoteSync:boolean = true) {\n    try {\n      const doc = await this.getDoc(id, collection);\n      if(!doc) return false;\n      log.warn('Deleting doc: ',id);\n      log.warn(doc);\n      const res =  this.db.save({...doc, ...{deleted: true}}, collection);\n      log.info(res);\n      if (remoteSync)\n        this.addSyncCall$.next();\n      return res;\n    }\n    catch(e) {\n      log.error(e);\n      return null;\n    }\n  }\n\n  public async removeProject() {\n\n    /*\n    try {\n      //load all project children and remove them\n      //TODO, on server side, if notice project deleted, make sure all server children are also deleted\n      const res = await this._pouch.allDocs({\n        include_docs: true,\n        startkey: getProjectChildId(project._id),\n        endkey: getProjectChildId(project._id) + LASTCHAR\n      });\n      const docs = res.rows.map(row => Object.assign(\n        row.doc, { _deleted: true, updated: Date.now() }));\n\n      docs.push(Object.assign(project, { _deleted: true, updated: Date.now() }));\n      const res2 = await this._pouch.bulkDocs(docs);\n\n      if (syncRemote)\n        this.addSyncCall$.next();\n\n      return res2;\n    }\n    catch (e) {\n      console.log('Remove Project Error: ', e);\n    }\n    */ return false;\n  }\n\n\n\n  // streams\n\n  subscribeChanges(): Observable<any> {\n    return this.db.changes$.asObservable().pipe(\n      map((change:DataChangeEvent) => change.doc )\n    );\n  }\n  \n\n  subscribeDocChanges(id: string): Observable<any> {\n    return this.db.changes$.asObservable().pipe(\n      filter((change: DataChangeEvent) => change.doc.id === id),\n      map((change: DataChangeEvent) => change.doc)\n    );\n  }\n\n\n  subscribeByPropertyChange(\n    property: string,\n    value: any): Observable<any> {\n    return this.db.changes$.asObservable().pipe(\n      filter((change: DataChangeEvent) => { \n        return (change.doc[property] === value);\n      }),\n      map((change: DataChangeEvent) => change.doc)\n    ); \n  }\n\n  subscribeProjectTypeChanges(projectid: string|undefined, type: string): Observable<any> {\n    if(projectid === undefined) \n      throw new Error('Project id, can not be undefined, can not subscribe to id') ;\n    const projectChildId = getProjectChildId(projectid);\n    return this.db.changes$.asObservable().pipe(\n      filter((change: DataChangeEvent) => { \n        return change.doc.id.startsWith(projectChildId + DIV + type + DIV);\n      }),\n      map((change: DataChangeEvent) => change.doc)\n    ); \n  }\n\n  //project id and channel only difference is the suffic at end of proejctid\n  subscribeChannelTypeChanges(channel: string|undefined, type: string): Observable<any> {\n    if(channel === undefined) \n      throw new Error('Channel can not be undefined, can not subscribe to id') ;\n    return this.db.changes$.asObservable().pipe(\n      filter((change: DataChangeEvent) => { \n        return change.doc.id.startsWith(channel + DIV + type + DIV);\n      }),\n      map((change: DataChangeEvent) => change.doc)\n    ); \n  }\n\n\n  public get ready() {\n    return this._ready;\n  }\n\n  public getReadySub() {\n    return this._ready$;\n  }\n\n  public set ready(value: boolean) {\n    this._ready = value;\n    if(value)\n      this._ready$.next(value);\n  }\n\n  public async refresh(event: CustomEvent<RefresherEventDetail>) {\n    await this._syncRemote();\n    event.detail.complete();\n  }\n\n  public async init(authid: string , syncRemote = true) {\n    log.info('Init DB', authid)\n    const scheme = databaseScheme;\n    scheme.name = authid;\n    this.db = new DexieAdapter(scheme);\n    const dbSub = this.db.ready$.subscribe(ready => {\n      log.info('Dexie Sub: ', ready);\n      if(!ready) return;\n\n      this.ready = true;\n      if (syncRemote)\n        this.addSyncCall$.next();\n\n      this._createSettingsDoc(authid)\n      dbSub.unsubscribe();\n      \n    });\n  }\n\n  public getSettingsDocId(): string {\n    const defaultProject = getDefaultProject(authService.userid);\n    const id =  generateCollectionId(defaultProject.id, 'settings', '');\n    return id.substring(0, id.length-1);\n  }\n\n  public async getSettingsDoc(): Promise<any> {\n    const id = this.getSettingsDocId();\n    if(id === '')return;\n\n    return await this.getDoc(id, TYPE_SETTINGS);\n  }\n\n\n  private async _createSettingsDoc(userid:string) {\n    log.info('CreateSettingsDoc', userid);\n    try {\n      const id =  this.getSettingsDocId();\n      const s = await dataService.getDoc(id, TYPE_SETTINGS);\n      console.log(s);\n      if(s) return s;\n      const ts = Date.now();   \n      log.info('Compare ids ', userid + ' ' + authService.userid);\n      if(userid === authService.userid){  //half second pased, see if state changed\n        log.info('Saving new Settings Doc::: ', id)\n        const res = await dataService.save({\n          id,\n          type: TYPE_SETTINGS,\n          userid: userid,\n          created: ts,\n          updated: ts\n        }, TYPE_SETTINGS)\n      return res;\n      }\n    }\n    catch(e) {\n      log.error(e.red, userid);\n    }    \n  }\n\n  private async _syncRemote() {\n    console.log('Sync Remote:::')\n    let ck = Number(await localStorageService.getItem('SYNC_CHECKPOINT'));\n    if(!ck) ck = 0; \n    \n    let docs: any[] = [];\n    for(let i = 0; i < databaseScheme.tables.length; i++) {\n      if(!databaseScheme.tables[i].sync){\n        continue;\n      }\n      const res = await this.db.queryByProperty('dirty', 'equals', 1, databaseScheme.tables[i].name);\n      docs.push(...res);\n    }\n    const res = await syncData({  data: docs, \n                                  syncurl: env.SYNC_SERVER,\n                                  token: authService.getToken(),\n                                  checkpoint: 0,\n                                  requestMaxSize: 1000});\n    //save checkpoint\n    if(res) {\n      const keys = Object.keys(res);\n      for(let i = 0; i < keys.length; i++){\n        await this.db.saveFromSync(\n          res[keys[i]].map(doc => Object.assign(doc, {dirty: 0})), \n          keys[i]);\n      }\n    }\n    console.log('Finished sync');\n  }\n\n\n\n}\n\nexport const dataService = new DataService();\n","import { Doc } from \"../data/models\";\nimport { Landscape } from '../gamify/models';\n\nexport const TYPE_SOCIAL = 'social';\n\n\n\nexport class Friend extends Doc {\n  username!: string;\n  id!: string;\n  landscape!: Landscape;\n  secondaryType?: string;\n\n\n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n    if(!values['username']) throw new Error('Friend Doc username required')\n    if(!values['id']) throw new Error('Friend Doc id required')\n    if(!values['landscape']) throw new Error('Friend Doc landscape required')\n  }\n}\n\n\n","import { Subscription, BehaviorSubject } from \"rxjs\";\nimport { getPostRequest, post } from '../ajax/ajax';\nimport { env } from \"../../env\";\nimport { authService } from '../auth/authService';\nimport { toastService, ToastType } from \"../toast/toastService\";\nimport { dataService } from \"../data/dataService\";\nimport { waitMS } from '../data/utilsData';\nimport { Friend } from \"./models\";\nimport { MessageItem } from \"../messages/models\";\n\nexport interface SocialState {\n  friends: Friend[],\n}\n\nexport const initSocialState = {\n  friends: []\n}\n\n\n\nexport class SocialService {\n  private _subscription: Array<Subscription> = [];\n  private _userid = ''\n  private _state: SocialState = initSocialState;\n  public state$ = new BehaviorSubject(this._state);\n  \n  async init(userid){\n    if(userid === this._userid) return;\n    this._userid = userid;\n    this.unsubscribe();\n    this._init();\n  }\n\n  private async _init() {\n    this.updateSocialUsers()\n  }\n\n\n\n  public async updateSocialUsers() {\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/social/getFriendsProgress',\n                      { token: authService.getToken(), \n                      }), \n                      false);\n      \n      console.log(res);\n\n      if(res.success)\n        this.state = {...this.state, ...{friends:res.data}};\n      \n    }\n    catch (e) {\n      console.log(e);\n    }\n    \n  }\n\n\n\n\n\n  public async addFriend(username?:string) {\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/social/sendAddFriendRequest',\n                      { token: authService.getToken(), \n                        username,\n                      }), \n                      true, 'Sending invitatin request, please wait');\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Friend invitation sent', ToastType.success);\n\n      waitMS(3000);\n\n      dataService.addSyncCall$.next();\n    }\n    catch (e) {\n      console.log(e);\n    }\n    \n  }\n\n\n\n  public async sendMessage(msgDoc: MessageItem) {\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/social/sendMessage',\n                      { token: authService.getToken(), \n                        msgDoc,\n                      }), \n                      true, 'Sending message, please wait');\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      await waitMS(3000);\n    }\n    catch (e) {\n      console.log(e);\n    }\n  }\n\n\n\n\n\n  public get state(): SocialState {\n    return this._state;\n  }\n  public set state(value: SocialState) {\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\nexport const socialService = new SocialService();","import { BehaviorSubject } from 'rxjs';\nimport { toast } from 'react-toastify';\nimport { Todo } from '../../pages/todo/models';\nimport { Habit } from '../../pages/habits/models';\nimport { dataService } from '../data/dataService';\nimport { calculateLevelExperience, calculateDoneTodoGold, calculateDoneTodoExperience, calculatePlantExperience } from './utilsGamify';\nimport { throttleTime } from '../../../node_modules/rxjs/operators';\nimport { isEqual } from 'lodash';\nimport { getInitGamifyRewards, GamifyRewards } from '../../pages/habits/utilsHabits';\nimport { generateCollectionId, TYPE_SETTINGS, getDefaultProject } from '../data/utilsData';\nimport { env } from '../../env';\nimport { authService } from '../auth/authService';\nimport ulog from 'ulog';\nimport { MarketItem, MarketItemType, DEFAULT_SEED_NAME, defaultSeed } from '../market/models';\nimport { socialService } from '../social/social.service';\nimport { newMessage } from '../messages/models';\nimport i18n from 'i18next';\nimport { Landscape, getDefaultLandscape, LandscapeTree } from './models';\nconst log = ulog('gamify');\n\n\n\n\nexport interface GamifyState {\n  experience: number,\n  maxExperience: number,\n  level: number,\n  gold: number,\n\n  userItems: MarketItem[],\n  landscape: Landscape\n}\n\nexport const getInitGamifyState = () => {\n  return {\n    experience: 0,\n    maxExperience: 20,\n    level: 1,\n    gold: 0,\n    userItems: [],\n    landscape: getDefaultLandscape(),\n    \n  }\n}\n\nexport class GamifyService {\n\n  private _userId = '';\n  private _subscriptions:any[] = [];\n  private _state: GamifyState = getInitGamifyState();\n\n  public state$ = new BehaviorSubject<GamifyState>(this._state);\n  \n\n  public async init(userid: string) {\n    this.unsubscribe();\n    this._userId = userid;\n    const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n      if(!ready) return;\n      const doc = await this.loadInitDocs(userid);\n      const sub = this.state$.pipe(throttleTime(10000)).subscribe(()=>{\n        this._save();\n      })\n  \n      const sub2 = dataService.subscribeDocChanges(this.getGamifyDocId())\n        .subscribe(doc => {\n          console.log(doc, this.state);\n          const equal = isEqual(this._state, doc.state);\n          if(!equal)\n            this.state = {...this.state, ...doc.state};\n        });\n  \n      this._subscriptions.push(sub);\n      this._subscriptions.push(sub2);\n      //load the init stae\n      console.log(this.state, doc);\n      if(doc){\n        this.state = {...this.state, ...doc.state};\n      }\n        \n\n      dataSub.unsubscribe();\n    })\n  }\n\n  public buyItem(item:MarketItem) {\n    if(item.price > this.state.gold) return;\n    this._state.gold -= item.price;\n    const i = this._state.userItems.find(i => i.name === item.name);\n    if(i){\n      i.quantity++;\n    }\n    else{\n      this._state.userItems.push({...item, ...{quantity: 1}});\n    }\n    this.state = Object.assign(this._state);\n  }\n\n  public getUserSeeds(): MarketItem[] {\n    return [...[defaultSeed],\n            ...this.state.userItems.filter(i => i.itemType === MarketItemType.seed)]\n  }\n  \n\n  public calculateFinishedTodoRewards = (todo: Todo): Todo => {\n    if(!todo.doneRewards || !todo.doneRewards.gold){\n      todo.newRewards = getInitGamifyRewards({\n        gold: calculateDoneTodoGold(todo),\n        experience: calculateDoneTodoExperience(todo),\n        items: []\n      });\n    }\n\n    if(todo.done){\n      this.addGold(todo.newRewards.gold);\n      this.messageReceivedGold(todo.newRewards.gold);\n      this.addExperience(todo.newRewards.experience);\n      this.messageReceivedExperience(todo.newRewards.experience)\n    }\n    else {\n      this.addGold(todo.newRewards.gold * -1);\n      this.messageLostGold(todo.newRewards.gold);\n      this.addExperience(todo.newRewards.experience * -1);\n      this.messageLostExperience(todo.newRewards.experience);\n    }\n\n    return {...{}, ...todo};\n  }\n\n  public calculateNewTodo = (todo: Todo): Todo => {\n    todo.newRewards = getInitGamifyRewards({\n      gold: env.TODO_NEW_GOLD_REWARDS,\n      experience: env.TODO_NEW_EXPERIENCE_REWARDS,\n      items: [],\n    });\n\n    this.addGold(todo.newRewards.gold);\n    this.messageReceivedGold(todo.newRewards.gold)\n    this.addExperience(todo.newRewards.experience);\n    this.messageReceivedExperience(todo.newRewards.experience)\n\n    return {...{} ,...todo};\n  }\n\n  public calculateNewHabitRewards = (habit:Habit): Habit => {\n    if(!habit.seedItem) throw new Error('Seed item cannot be undefined');\n    \n    habit.newRewards = getInitGamifyRewards({\n      gold: env.HABIT_REWARDS_NEW_GOLD,\n      experience: env.HABIT_REWARDS_NEW_EXPERIENCE,\n      items: [],\n    });\n\n    habit.plantName = habit.seedItem.name;\n    habit.plantLevel = 1;\n    habit.plantExp = 0;\n    habit.plantDifficultyLevel = habit.seedItem.difficulty;\n    habit.plantNextLevelExp = calculatePlantExperience(habit.plantLevel, habit.plantDifficultyLevel);\n\n    this.addGold(habit.newRewards.gold);\n    this.messageReceivedGold(habit.newRewards.gold)\n    this.addExperience(habit.newRewards.experience);\n    this.messageReceivedExperience(habit.newRewards.experience)\n\n    return {...{}, ...habit};\n  }\n\n  public removeUserItem(name:string) {\n    console.log(name, this._state)\n    if(name === DEFAULT_SEED_NAME) return;\n    const item = this._state.userItems.find(i => i.name === name);\n    if(!item) throw new Error('Item does not exist');\n\n    item.quantity--;\n    console.log('Removing item, ', item);\n    if(item.quantity < 1) {\n      console.log('0 left, so need to filter');\n      this._state.userItems = this._state.userItems.filter(i => i.quantity > 0);\n    }\n    this.state = Object.assign(this._state);\n  }\n\n  private addGold(value:number, save = true) {\n    this._state = {...this._state, ...{gold: this._state.gold + value}};\n    if(save)this.state = this._state;\n  }\n\n  private addExperience(value: number, save = true) {\n    let experience = this._state.experience + value;\n    \n    if(experience > this._state.maxExperience){\n      const level = this._state.level + 1;\n      experience = (this._state.maxExperience - experience) * -1;\n      this._state = {...this._state, \n        ...{maxExperience: calculateLevelExperience(this._state.level+1),\n            level}}\n\n      socialService.sendMessage(newMessage('New level reached', 'userLevelUp', '', { level }));\n    }\n    this._state = {...this._state, ...{experience}}\n    if(save) this.state = this._state;\n  }\n\n  public addRewards = (rewards:GamifyRewards, habit?:Habit) => {\n    if(rewards.gold > 0) {\n      this.messageReceivedGold(rewards.gold);\n      this.addGold(rewards.gold, false);\n    }\n    if(rewards.experience > 0){\n      this.messageReceivedExperience(rewards.experience);\n      this.addExperience(rewards.experience, false)\n    }\n\n    if(habit) {\n      this._state.landscape = this.updateLandscapeHabit(habit);\n    }\n\n\n\n    if(rewards.gold > 0 && rewards.experience > 0) {\n      this.state = this._state;\n    }\n  }\n\n  public updateLandscapeHabit(habit:Habit):Landscape {\n    const landscape: Landscape = Object.assign(this.state.landscape);\n    const plant = landscape.trees.find(tree => tree.habitId === habit.id)\n    console.log(plant);\n    if(!plant) {\n      //lalculate position\n      let position = Math.floor(Math.random() * 350) + 25;  \n      const tree:LandscapeTree = {\n        id: habit.seedItem?.id || \"\",\n        name: habit.plantName,\n        habitId: habit.id!,\n        level: habit.plantLevel,\n        position,\n      }\n      landscape.trees.push(tree);\n    } \n    else {\n      plant.id = habit.seedItem?.id || \"\";\n      plant.name = habit.plantName;\n      plant.habitId = habit.id!;\n      plant.level = habit.plantLevel;\n    }\n    return landscape;\n  }\n\n  public changePlantPosition(habit: Habit, position:number): Landscape|undefined {\n    const landscape: Landscape = Object.assign(this.state.landscape);\n    const plant = landscape.trees.find(tree => tree.habitId === habit.id)\n    console.log(plant);\n    if(!plant) return;\n   \n    plant.position =  position; \n\n    this.state = {...this.state, ...{landscape}};\n    return landscape;\n  }\n\n  public getPlantPosition(habit: Habit): number {\n    const item = this.state.landscape.trees.find(t => t.habitId === habit.id)\n    if(!item) return 0;\n\n    return item.position;\n  }\n\n  private messageReceivedGold(gold: number) {\n    const msg = i18n.t('gamify.messages.received') + \n                \" \" + gold + \" \" + i18n.t('market.gold');\n    toast.success(msg,{autoClose: env.MESSAGE_DURATION});\n  }\n\n  private messageLostGold(gold:number) {\n    const msg = i18n.t('gamify.messages.lost') + \n                \" \" + gold + \" \" + i18n.t('market.gold');\n    toast.error(msg,{autoClose: env.MESSAGE_DURATION});\n  }\n\n  private messageReceivedExperience(exp: number) {\n    const msg = i18n.t('gamify.messages.received') + \n                \" \" + exp + \" \" + i18n.t('gamify.exp');\n    toast.success(msg,{autoClose: env.MESSAGE_DURATION});\n  }\n\n  private messageLostExperience(exp:number) {\n    const msg = i18n.t('gamify.messages.lost') + \n                \" \" + exp + \" \" + i18n.t('gamify.exp');\n    toast.error(msg,{autoClose: env.MESSAGE_DURATION});\n  }\n  \n  private async _save() {\n    try{\n      const doc = await dataService.getDoc(this.getGamifyDocId(), TYPE_SETTINGS);\n\n      if(!doc){\n        return;\n      }\n\n      const equal = isEqual(this._state, doc.state);\n      //make sure we are not saving the init state\n      const initEqual = isEqual(this.state, getInitGamifyState());\n      if(!equal && !initEqual && doc.userid ===  this._userId) {\n        dataService.save({...doc, ...{state: this._state}}, TYPE_SETTINGS);\n      }\n    }\n    catch(e) {\n      log.error(e);\n    }\n    \n  }\n\n  private getGamifyDocId(): string {\n    const defaultProject = getDefaultProject(authService.userid);\n    const id =  generateCollectionId(defaultProject.id, 'gamify', '');\n    return id.substring(0, id.length-1);\n  }\n\n  private async loadInitDocs(id: string): Promise<any> {\n    try {\n      const s = await dataService.getDoc(this.getGamifyDocId(), TYPE_SETTINGS);\n      if(s) return s;\n      const ts = Date.now();   \n      if(id === this._userId){  //half second pased, see if state changed\n        const res = await dataService.save({\n          id: this.getGamifyDocId(),\n          state: getInitGamifyState(),\n          type: TYPE_SETTINGS,\n          userid: id,\n          created: ts,\n          updated: ts\n        }, TYPE_SETTINGS)\n      return res;\n      }\n    }\n    catch(e) {\n      log.error(e.red, id);\n    }    \n  }\n\n  public get state(): GamifyState {\n    return this._state;\n  }\n  public set state(value: GamifyState) {\n\n    this._state = value;\n    this.state$.next(value);\n  }\n\n  private unsubscribe() {\n    this._subscriptions.forEach(s=>{\n      if(s)s.unsubscribe();\n    })\n  }\n\n\n}\nexport const gamifyService = new GamifyService();\n\n\n","\n\n\nexport interface LandscapeTree {\n  name: string;\n  id: string;\n  habitId: string;\n  level:number; \n  position: number;\n}\n\nexport const getDefaultLandscape = () => {\n  return {\n    trees: []\n  }\n}\n\n\nexport interface Landscape {\n  trees: LandscapeTree[],\n}\n","\nimport { Todo, TYPE_TODO, TodoList, TYPE_TODO_LIST, TodoTag, getDefaultTodoList, getDefaultTodoTag, TYPE_TODO_TAG } from './models';\nimport { BehaviorSubject, Subscription } from 'rxjs';\nimport { dataService } from '../../modules/data/dataService';\nimport { waitMS, getProjectChildId } from '../../modules/data/utilsData';\nimport _ from 'lodash';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport ulog from 'ulog';\nimport { toastService } from '../../modules/toast/toastService';\n\n\nconst log = ulog('todo');\n\n\nexport interface TodoState {\n  selectedTodo: Todo|null,\n  list: TodoList|undefined,\n  tag: TodoTag|undefined,\n  docs: Todo[],\n  tagDocs: TodoTag[],\n  doneTodos: boolean,\n  orderFilter: string,\n  orderAsync: number,\n  showNewTagFilter: boolean,\n}\n\nexport const getInitTodoState = (): TodoState => {\n  return {\n    selectedTodo:null,\n    list: undefined,\n    tag: undefined,\n    docs: [],\n    tagDocs: [],\n    doneTodos: false,\n    orderFilter: 'created',\n    orderAsync: 1,\n    showNewTagFilter: false,\n  }\n}\n\nexport class TodoService {\n  \n  // @ts-ignore: it will be initialized in init\n  private _projectid: string;\n  private _state: TodoState = getInitTodoState();\n  public state$ = new BehaviorSubject(this._state);\n  private _subscription: Array<Subscription> = [];\n\n  public init(projectid: string, list:string|undefined, tag:string|undefined) {\n    //first unsubscribe\n    this.unsubscribe();\n    const dataSub = dataService.getReadySub().subscribe( async (ready) => {\n      if(!ready) return;\n      \n      this._init(projectid, list, tag);\n\n      await waitMS(5000);\n      dataSub.unsubscribe();\n    });\n  }\n\n  async _init(projectid: string, listName: string|undefined, tagName: string|undefined) {\n\n    if(this._projectid  === projectid && \n        this._state.list?.fullname === listName && \n        this._state.tag?.name === tagName) return;\n\n    let list, tag\n    if(!listName && !tagName){\n      list = getDefaultTodoList('default', projectid)     \n    }\n    if(listName)\n      list = getDefaultTodoList(listName, projectid)    \n    if(tagName)\n      tag = getDefaultTodoTag(tagName, projectid);\n\n    this._state = {...this.state, ...{\n      tag, \n      list,\n      tagDocs: this.getTags()}};\n    \n      log.warn(this._state);\n    \n    this._projectid = projectid;\n    \n    log.info(this.state);\n\n    this.reloadTodos();\n\n    const sub = dataService.subscribeProjectTypeChanges(projectid,TYPE_TODO)\n      .subscribe((doc: Todo) => {\n        log.log(\"TodoService subscription: \", doc); \n        this.reloadTodos();\n      });\n    this._subscription.push(sub);\n\n  }\n\n  async reloadTodos() {\n    log.info('RELOADING TODOS::: ', this.state)\n      let docs;\n    if(this.state.list){\n        log.info('Todo Query by List')\n        docs = await dataService.queryByProperty(\n          'list', 'equals', this.state.list.fullname, TYPE_TODO);\n    }\n     else if(this.state.tag){\n        log.info('Todo Query by Tags')\n        docs = await dataService.queryByProperty(\n          'tags', 'equals', this.state.tag.name, TYPE_TODO);\n    }\n\n    this.filterAndSaveTodos(docs);\n   \n  }\n\n  public async getTagsByStartingName(value){\n    return await dataService.queryByProperty(\n      'name', 'startsWith', value, TYPE_TODO_TAG); \n  }\n\n  private filterAndSaveTodos(docs: Todo[]):Todo[] {\n    const filtered = docs.filter(doc => this.filterDoneParentFunction(doc))\n                        .sort((a,b) => this.orderFunction(a,b));\n    this.state = {...this.state, ...{docs: filtered}};\n    return filtered;\n  }\n\n  private orderFunction(a:Todo, b:Todo) {\n    return (a[this._state.orderFilter] > b[this._state.orderFilter])?\n     (1 * this._state.orderAsync) : (-1 * this._state.orderAsync)\n  }\n\n\n  private filterDoneParentFunction(doc:Todo) {\n      if (doc.done !== this._state.doneTodos) return false;\n      return true;\n  }\n\n\n \n  public get state(): TodoState {\n    return this._state;\n  }\n  public set state(value: TodoState) {\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n  public async addSubTodoToParent (todoId: string, parentId: string) {\n    try {\n      const parentTodo: Todo = await dataService.getDoc(parentId, TYPE_TODO);\n      if (parentTodo) {\n        if(!parentTodo.subTodos) parentTodo.subTodos = [];\n        parentTodo.subTodos = _.concat(parentTodo.subTodos, todoId);\n        this.save(parentTodo);\n      }\n    }\n    catch(e) {\n      log.error(e);\n    }\n  }\n\n  public async removeSubTodoFromParent (todoId: string, parentId) {\n    try {\n      const parentTodo: Todo = await dataService.getDoc(parentId, TYPE_TODO);\n      if (parentTodo) {\n        if(!parentTodo.subTodos) parentTodo.subTodos = [];\n        parentTodo.subTodos = _.filter(parentTodo.subTodos, t=>t!== todoId);\n        this.save(parentTodo);\n      }\n    }\n    catch(e) {\n      log.error(e);\n    }\n  }\n\n\n  public async save(doc:Todo, parentId: string|null = null) {\n    log.info(\"Save: \", doc, this._projectid, TYPE_TODO);\n    //see if its new\n    if(doc._new) {\n      delete(doc._new);\n      \n      if(this.state.list)\n        doc.list = this.state.list.fullname;\n      else\n        doc.list = getProjectChildId(this._projectid)+'default'\n      if(!doc.tags){\n        doc.tags = [];\n      }\n      await this.saveNewTags(doc.tags);\n      doc = gamifyService.calculateNewTodo(doc);\n    }\n    const res = await dataService.save({...{done: false}, ...doc}, TYPE_TODO, {projectid: this._projectid});\n    if(parentId && doc.id) {\n      this.addSubTodoToParent(doc.id, parentId)\n    }\n    return res;\n\n  }\n\n  public async saveNewTags(tags:string[]) {\n    console.log('Tags::: ', tags);\n    let tagDoc;\n    for(let i = 0; i < tags.length; i++) {\n      console.log(tags[i]);\n      tagDoc = await dataService.queryByProperty('name', 'equals', tags[i], TYPE_TODO_TAG);\n      console.log(tagDoc);\n      if(tagDoc.length === 0) {\n        //save new tag\n        await dataService.save(new TodoTag({\n          name: tags[i], \n        }), TYPE_TODO_TAG, {projectid: this._projectid, remoteSync:true });\n      }\n    }\n  }\n\n  public async saveList(doc:TodoList) {\n    log.info('Save New TodoList: ', doc);\n    if(doc._new) {\n      //make sure its not a duplicate\n      const res = await dataService.getDoc(doc.id, TYPE_TODO_LIST);\n      if(res){\n        //error, its a duplicate\n        toastService.printSimpleError('List Already Exists');\n        return;\n      }\n      delete doc._new;;\n      const saveRes = await dataService.save(doc, TYPE_TODO_LIST);\n      log.info(saveRes);\n      return saveRes;\n    }\n  }\n\n  public async deleteList(list:TodoList) {\n    //get all docs that are in this list\n    log.warn(list);\n    const docs = await dataService.queryByProperty('list', 'equals', list.fullname,TYPE_TODO);\n    log.warn(docs);\n    //delete all items\n    for(let i = 0; i < docs.length; i ++){\n      dataService.remove(docs[i].id, TYPE_TODO);\n    }\n    if(list.id)\n      dataService.remove(list.id, TYPE_TODO_LIST);\n  }\n\n  public async remove(id: string) {\n    //see if this doc has parent\n    try {\n      const todo: Todo = await dataService.getDoc(id, TYPE_TODO);\n      if (todo) {\n        if(todo.parent) {\n          this.removeSubTodoFromParent(id, todo.parent);\n        }\n      }\n    }\n    catch(e) {\n      log.error(e);\n    }\n    dataService.remove(id, TYPE_TODO);\n  }\n\n  public select(doc:Todo | null) {\n    this.state = {...this._state, ...{ selectedTodo: doc} };\n  }\n\n  public changeDoneFilter(done: boolean) {\n    if(done === this._state.doneTodos) return;\n    this._state = {...this._state, ...{ doneTodos: done} };\n    this.reloadTodos();\n  }\n\n  public showNewTagFilter(show) {\n    this.state = {...this.state, ...{showNewTagFilter: show}};\n  }\n\n  public changeOrderFilter(filter: string) {\n    if(this._state.orderFilter === filter){\n      this._state = {...this._state, ...{ orderFilter: filter, \n        orderAsync: (this._state.orderAsync === 1)? -1:1} };\n    }\n    else {\n      this._state = {...this._state, ...{ orderFilter: filter} };\n    }\n    this.reloadTodos();\n  }\n\n  public getTags():TodoTag[] {\n    const tags =  [\n      new TodoTag({\n        id: undefined,\n        icon: 'sun.svg',\n        name: 'today',\n        fullname: 'today',\n      }),\n      new TodoTag({\n        id: undefined,\n        icon: 'star.svg',\n        name: 'important',\n        fullname: 'important',\n      })\n      //getDefaultTodoTag('today', projectid, 'sun.svg'), \n      //getDefaultTodoTag('important', projectid, 'star.svg')];\n    ]\n    return tags;\n  }\n\n\n  public selectList(list:TodoList) {\n    if(list === this._state.list) return;\n    this._state = {...this._state, ...{ list } };\n    this.reloadTodos();\n  }\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\n\n\nexport  const todoService = new TodoService(); ","import React, { useRef, useReducer, useEffect } from 'react';\nimport { Todo, TYPE_TODO, TodoList, getDefaultTodoList, TodoTag } from './models';\nimport {IonInput, IonButton, IonIcon} from '@ionic/react';\nimport { generateCollectionId } from '../../modules/data/utilsData';\nimport ulog from 'ulog'\nimport { waitMS } from '../../components/animatedIcon';\nimport { todoService } from './todo.service';\nimport { Subject } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, switchMap, filter } from 'rxjs/operators';\nimport { COLOR_SECONDARY } from '../../colors';\nimport './todo.component.css';\n\nconst log = ulog('todo');\n\n\n\nconst TodoNewComp = ({list, tag, focus, closeFunc, saveFunc, projectId}:\n  {list:TodoList|undefined, focus: boolean, \n    tag:string|undefined, closeFunc:Function,\n    projectId: string, saveFunc: Function}) => {\n\n  const reducer = (state, {type, payload}) => {\n      switch(type) {\n        case 'setTitle': \n          //see if we have a tag\n          if(payload[payload.length -1] === '#'){\n            return {...state, ...{title:payload, showTags: true}};\n          }\n          if(payload[payload.length -1] === ' ' && state.showTags === true){\n            return {...state, ...{title:payload, showTags: false}};\n          }\n          return {...state, ...{title:payload}};\n        case 'setFocus':\n          return {...state, ...{focus:payload}};\n        case 'setCloseFocus':\n          console.log('setCloseFocus, ', payload);\n          return {...state, ...{closeFocus:payload}};\n        case 'setState':\n          return payload;\n        case 'setTags':\n          return {...state, ...{tags: payload}};\n        default:\n          log.console.error('Incorrect action, ', type, payload);\n          return state;\n          \n      }\n  }\n    \n  \n  \n  \n    const [state, _dispatch] = useReducer(reducer, {title:'', \n                                                  focus, \n                                                  tags: [],\n                                                  showTags:false,\n                                                  closeFocus: false})\n  const inputEl = useRef(null);\n  const searchTags$ = new Subject<string>();\n\n  useEffect(() => {\n    dispatch('setFocus', focus);\n    if(focus){\n      setDelayedFocusOnInput();\n    }\n  }, [focus])\n\n  const setDelayedFocusOnInput = async () => {\n    await waitMS(200);\n    if(inputEl.current){\n      console.log('Setting focus to input')\n      // @ts-ignore: current is pointing to input\n      inputEl.current.setFocus();\n    }\n  }\n\n\n  const dispatch = (type: 'setTitle'|\n                          'setFocus'|\n                          'setTags'|\n                          'setState'|\n                          'setCloseFocus', payload:any = {}) => {\n    _dispatch({type, payload});\n  }\n\n  //TODOS: testing....\n  const setNewTitle = (e) => {\n    dispatch('setTitle', e.detail.value);\n    if(state.showTags) {\n      const index = e.detail.value.lastIndexOf('#');\n      searchTags$.next(e.detail.value.substring(index));\n       \n    }\n  }\n\n\n  const searchTags = async (value) => {\n    console.log('tags searching, ', value);\n    return await todoService.getTagsByStartingName(value);\n    //use todo service to load tags here\n  }\n\n  searchTags$.pipe(\n    debounceTime(300),\n    distinctUntilChanged(),\n    filter(value => value.length > 2),\n    switchMap(term => searchTags(term.substring(1)))\n  ).subscribe(res => {\n    console.log('SEARCH TAGS:::::: ', res);\n    dispatch('setTags', res);\n  });\n\n\n\n  const onKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      save();\n      dispatch('setTitle', '');\n    }\n  }\n\n  const save = async () => {\n    let fullname;\n    if(!list){\n      fullname = getDefaultTodoList('tasks', projectId).fullname;\n    }\n    else {\n      fullname = list.fullname;\n    }\n\n     //do we have tags in the title\n     const regex = /\\#\\w+\\b/\n     let tag2 = state.title.match(regex);\n     let name = state.title;\n     let otherTags = {};\n     while(tag2) {\n       console.log(tag2);\n       otherTags[tag2[0].substring(1)] = '';\n       name = name.substring(0, tag2.index) + name.substring(tag2.index+tag2[0].length).trim();\n       console.log(name);\n       tag2 = name.match(regex);\n     }\n\n     if(tag){\n      otherTags[tag] = ''\n    }\n    \n    const id = generateCollectionId(projectId, TYPE_TODO)\n    const newDoc = new Todo({\n      id, \n      name: name, \n      list: fullname,\n      tags: Object.keys(otherTags),\n      _new: true});\n\n     await saveFunc(newDoc);\n  };\n\n\n\n  const onInputFocus = async(e) => {\n    await waitMS(510);\n    console.log('Focus', e);\n    dispatch('setFocus', true);\n  }\n\n  const onInputBlur = (e) => {\n    closeToolbar();\n    dispatch('setCloseFocus', true);\n    console.log('Blur ', state,  e);\n  }\n\n  const onSubAction = (type:string, payload:any = {}) => {\n    switch(type) {\n      case 'tag':\n        dispatch('setState', {...state, ...{title: state.title+' #',  closeFocus: false}})\n        break;\n      case 'tagString':\n        console.log(payload);\n        const index = state.title.lastIndexOf('#');\n        dispatch('setState', {...state, ...{\n            title: state.title.substring(0, index+1) + payload + ' ',  \n            closeFocus: false}})\n        break;\n      case 'addTag':\n        dispatch('setState', {...state, ...{\n          title: state.title.trim() + ' ' + payload + ' ',  \n          closeFocus: false}})\n        break;\n      \n    }\n    \n    dispatch('setCloseFocus', false);\n    console.log('Action: ', type, inputEl)\n    if(inputEl){\n      console.log('Setting focus to input')\n      // @ts-ignore: current is pointing to input\n      inputEl.current.setFocus();\n    }\n      \n  }\n\n  const closeToolbar = async () => {\n    //wait 1 sec, if nothing is presssed, then \n    await waitMS(500)\n    console.log('CloseToolbar Focus: ', state);\n    if(state.closeFocus)\n      closeFunc()\n    \n     \n  }\n\n\n  const printSmallTagFromName = (tag:TodoTag) => {\n    if(tag.icon) {\n      return <IonIcon  \n                key={tag.name}\n                size=\"small\" \n                color='success' \n                src={\"/assets/icons/\"+tag.icon} />\n    }\n\n    return <IonIcon  \n                key={tag.name}\n                size=\"small\" \n                color='success' \n                src={\"/assets/icons/tag.svg\"} >\n          {tag.name}  \n          </IonIcon>\n  }\n\n\n  return (\n    <>\n    {state.showTags? (\n      <div>\n        {state.tags.map((tag:TodoTag) => (\n          <IonButton \n            fill=\"clear\"\n            color={COLOR_SECONDARY}\n            onClick={() => onSubAction('tagString', tag.name)}\n            key={tag.name} >\n            {printSmallTagFromName(tag)}\n            {tag.name}\n          </IonButton>\n\n        ))}\n      </div>\n    ) : (<></>)}\n    {state.focus? (\n      <div>\n        <IonButton class=\"newTodoCloseButton\" onClick={() => closeToolbar()} fill=\"clear\" >Close</IonButton>\n        <IonButton onClick={() => onSubAction('tag')} fill=\"clear\" >Tag #</IonButton>\n        <IonButton onClick={() => onSubAction('addTag', '#today')} fill=\"clear\" >\n              <IonIcon  \n                  key={'today'}\n                  size=\"small\" \n                  color='success' \n                  src={\"/assets/icons/sun.svg\"} />\n\n        </IonButton>\n        <IonButton onClick={() => onSubAction('addTag', '#important')} fill=\"clear\" >\n              <IonIcon  \n                  key={'important'}\n                  size=\"small\" \n                  color='success' \n                  src={\"/assets/icons/star.svg\"} />\n\n        </IonButton>\n        <IonInput\n            autofocus={true}\n            ref={inputEl}\n            className=\"new-todo\"\n            placeholder=\"What needs to be done?\"\n            onKeyPress={onKeyPress}\n            onIonChange={setNewTitle}\n            value={state.title}\n            onIonBlur={onInputBlur}\n            onIonFocus={onInputFocus}/>\n      </div>\n    ) : (<></>)}\n    \n    </>\n  )\n\n\n}\n\nexport default TodoNewComp;","export const COLOR_PRIMARY = 'primary';\nexport const COLOR_SECONDARY = 'secondary';\nexport const COLOR_TERTIARY = 'tertiary';\nexport const COLOR_SUCCESS = 'success';\nexport const COLOR_WARNING = 'warning';\nexport const COLOR_DANGER = 'danger';\nexport const COLOR_LIGHT = 'light';\nexport const COLOR_MEDIUM = 'medium';\nexport const COLOR_DARK = 'dark';","import React, { useState, useEffect } from 'react';\nimport { Todo, TodoTag } from './models';\nimport { DataFunctions } from './hooks/todos.hook';\nimport _ from 'lodash';\nimport ulog from 'ulog';\nimport { IonLabel, IonTextarea, IonButton, IonIcon, IonAlert } from '@ionic/react';\nimport './todo.edit.component.css';\nimport { trash, close } from '../../../node_modules/ionicons/icons';\n\n\nconst log = ulog('todo');\n\nconst getDefaultState = (todo:Todo, tagDocs:TodoTag[]) =>  {\n  return {\n  todo: todo,\n  tagDocs,\n  showDeleteWarrning: false,\n  text: mergeText(todo.name, todo.note)\n}}\n\nconst mergeText = (name: string|undefined, note: string|undefined): string => {\n  if(!name) name= '';\n  if(!note) \n    note = '';\n  else\n    note = '\\n'+note;\n  return name + note;\n}\n\n\n\nconst TodoEditInlineComponent = ({todo, tagDocs, dataFunctions}: \n        {todo:Todo,  tagDocs:TodoTag[], dataFunctions: DataFunctions}) => {\n  log.warn(\"Edit Todo Render::: \", todo, tagDocs, tagDocs);\n\n  const [state, setState] = useState(getDefaultState(todo, tagDocs));\n\n  useEffect(() => {\n    setState(getDefaultState(todo, tagDocs));\n  }, [todo, tagDocs])\n\n  const handleTitleChange = (e) => {\n    const text = e.detail.value;\n    var match = /\\r|\\n/.exec(text);\n    if(match){\n      const name = text.substring(0, match.index);\n      const note = text.substring(match.index+1);\n      const newDoc = {...state.todo, ...{name: name, note: note}}\n      const newState = {...state, ...{todo: newDoc, text: text}};\n      setState(newState);\n    }\n    else {\n      const newDoc = {...state.todo, ...{name: text, note: ''}}\n      const newState = {...state, ...{todo: newDoc, text: text}};\n      setState(newState);\n    }\n  }\n\n  const handleBlur = () => {\n    dataFunctions.save(state.todo);\n  }\n\n  const showRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: true}});\n  }\n\n\n  const hideRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: false}});\n  }\n\n  const remove = () => {\n    hideRemoveWarrning();\n    if(state.todo.id)\n      dataFunctions.remove(state.todo.id);\n  }\n\n  const printTag = (tag: TodoTag) => {\n    let color;\n    if(_.includes(state.todo.tags,tag.name)){\n      color = 'success';\n    }\n    else {\n      color = 'light';\n    }\n    return  <IonButton \n                fill=\"clear\"\n                size=\"default\" \n                color={color} \n                key={tag.name + 'editicon'}  \n                onClick={() => handleTagChange(tag)}>\n              <IonIcon  src={\"/assets/icons/\"+tag.icon} /></IonButton>\n  }\n\n\n  const handleTagChange = (tag: TodoTag) => {\n    log.error(tag, tagDocs);\n    if(!state.todo.tags) state.todo.tags = [];\n    const res = state.todo.tags.find(t=>t===tag.name);\n    let newtags;\n    if(res === undefined){\n      newtags = _.concat(state.todo.tags, tag.name);\n    }\n    else {\n      newtags = _.filter(state.todo.tags, t=>t!==tag.name);\n    }\n    dataFunctions.save(Object.assign(state.todo, {tags: newtags}));\n  }\n\n\n  return (\n\n    <div className=\"\">\n        \n        \n        <div key=\"todoEditInlineIconScrollParent\" className=\"todoEditInlineIconScrollParent\">\n          { tagDocs.map(tag => printTag(tag)) }\n        </div>\n        <IonTextarea \n            placeholder=\"Enter todo title and note here\"\n            name=\"note\"\n            class=\"todoEditInlineTextArea\"\n            autoGrow={true}\n            onIonBlur={handleBlur}\n            onIonChange={handleTitleChange}\n            value={state.text}></IonTextarea>\n        \n        \n        <div>\n          <div className=\"todoButtonsLeftAlign\">\n              <IonButton size=\"small\"  fill=\"clear\" color=\"secondary\" onClick={()=>{dataFunctions.select(null)}}>\n                  <IonIcon  icon={close} /><IonLabel>Close</IonLabel>\n              </IonButton>\n          </div>\n          <div className=\"todoButtonsRightAlign\">\n              <IonButton size=\"small\"  fill=\"clear\" color=\"danger\" onClick={showRemoveWarrning}>\n                  <IonIcon  icon={trash} /><IonLabel>Delete</IonLabel>\n              </IonButton>\n          </div>\n        </div>\n        <div className=\"todoInlineEditPadding\"> </div>   \n\n        <IonAlert\n            isOpen={state.showDeleteWarrning}\n            onDidDismiss={() => hideRemoveWarrning}\n            header={'Warrning!!!'}\n            message={'Are you sure you want to <strong>delete</strong> this task and its sub-tasks?'}\n            buttons={[\n              {\n                text: 'Cancel',\n                role: 'cancel',\n                cssClass: 'secondary',\n                \n              },\n              {\n                text: 'Yes Im Sure',\n                handler: () => remove()\n              }\n            ]}\n          />\n    </div>\n\n  );\n\n}\n\nexport default TodoEditInlineComponent;","import React, { useEffect, useReducer } from 'react';\nimport { IonLabel, IonRow, IonCol, \n        IonIcon, IonGrid, IonItem, IonText, IonAvatar } from '@ionic/react';\nimport { Todo, TodoTag } from './models';\nimport _ from 'lodash';\nimport './todo.component.css'\nimport { DataFunctions } from './hooks/todos.hook';\nimport TodoEditInlineComponent from './todo.edit.inline.component';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport ulog from 'ulog'\nimport check from '../../icons/check.json';\nimport restart from '../../icons/restart.json'\nimport AnimatedIcon from '../../components/animatedIcon';\nimport { COLOR_SUCCESS } from '../../colors';\n\nconst log = ulog('todo');\n\nexport interface TodoState {\n  todo: Todo,\n}\n\n\nconst reducer = (state, {type, payload}): TodoState => {\n  switch(type) {\n    case 'updateTodo':\n      return {...state, ...{todo:payload}};\n    \n    default:\n      return state;\n  }\n}\n\n\n//Component Start\nconst TodoListItemComp = ({todo, tagDocs, selectedTodo, dataFunctions}:\n  {todo:Todo, tagDocs:TodoTag[], lastChild: boolean,  selectedTodo: Todo|null,  dataFunctions: DataFunctions}) => {\n  \n\n  const [state, _dispatch] = useReducer(reducer, \n    {todo: todo, })\n\n  useEffect(() => {\n    dispatch('updateTodo', todo);\n  }, [todo])\n  \n  const dispatch = (type:'updateTodo'|\n                          'any', \n                    payload:any = {}) => {\n    _dispatch({type, payload});\n  }\n  \n  const doneHandler = () => {\n    const newDoc = gamifyService.calculateFinishedTodoRewards(\n        {...state.todo, ...{done: !state.todo.done}});\n    dispatch('updateTodo', newDoc);\n    dataFunctions.save(newDoc);\n  }\n\n  const handleSelectTodo = () => {\n    if(selectedTodo && state.todo.id === selectedTodo.id){\n      dataFunctions.select(null);\n    }\n    else {\n      dataFunctions.select(state.todo);\n    }\n  }\n\n  \n\n  const printSmallTagFromName = (name:string) => {\n    //log.warn(tagDocs);\n    const tag = tagDocs.find(t => t.name === name);\n    if(tag && tag.icon) {\n      return <IonIcon  \n                class=\"todoListItemTagIcon\"\n                key={tag.name}\n                size=\"small\" \n                color='success' \n                src={\"/assets/icons/\"+tag.icon} />\n    }\n\n    return <IonText \n              key={name}\n              class=\"todoListItemTag\"\n              color={COLOR_SUCCESS} >\n              <IonIcon  \n                color='success' \n                src={\"/assets/icons/tag.svg\"} />\n          {name}  \n          </IonText>\n  }\n\n  const printTask = () => (\n    <>\n      <IonItem  button \n            color={((selectedTodo && selectedTodo.id === state.todo.id)? 'light' : '')}   \n            lines=\"full\">\n        \n            <IonAvatar onClick={() => {}} slot=\"start\">\n              {state.todo.done? (\n                <AnimatedIcon  iconsvg={restart} actionFunc={doneHandler} />\n              ) : (\n                <AnimatedIcon  iconsvg={check} actionFunc={doneHandler} />\n              )}\n              \n            </IonAvatar>\n              <IonLabel onClick={handleSelectTodo}>\n              <IonText color=\"primary\">\n                  <h2>{state.todo.name}</h2>\n              </IonText>\n              {state.todo.note? (\n                <IonText color=\"secondary\">\n                  <p>{state.todo.note}</p>\n                </IonText> \n              ) : (<></>)}\n               \n              </IonLabel>\n              {state.todo.tags.sort().map(\n                tag=>printSmallTagFromName(tag)\n              )}\n        </IonItem>\n        {printEdit()}\n    </>\n  )\n\n\n  const printEdit = () => {\n    if(!selectedTodo || selectedTodo.id !== state.todo.id) return;\n    return (\n      <IonGrid>\n        <IonRow>\n            <IonCol class=\"todoTitleColumn\" onClick={() => {}}  >\n              <TodoEditInlineComponent \n                          todo={state.todo}\n                          tagDocs={tagDocs}\n                          dataFunctions={dataFunctions} />\n                        \n            </IonCol>\n        </IonRow>\n      </IonGrid>\n    )\n  }\n  \n\n  return printTask();\n};\n\nexport default TodoListItemComp;\n","import { useEffect, useState, useRef } from 'react';\nimport { Subscription } from 'rxjs';\nimport { Todo, TodoList } from '../models';\nimport { TodoService, TodoState, getInitTodoState } from '../todo.service';\nimport ulog from 'ulog';\n\nconst log = ulog('todo');\n\nexport interface DataFunctions {\n  save: {(doc: Todo, parentId?: string|null):Promise<any>},\n  remove: {(id: string)},\n  select: {(doc: Todo | null)},\n  selectList: {(list: TodoList)},\n  changeDoneFilter: {(done:boolean)}\n  changeOrderFilter: {(type: string)},\n  showNewTag: {(show:boolean)}\n}\n\n\n//more simpler then auth hook, just read data\nexport function useTodosCollectionFacade(\n  projectid: string| undefined, list:string|undefined, tag:string|undefined): \n  [TodoState, DataFunctions]{\n  \n  log.warn(projectid, list, tag);\n                           \n  if(!projectid) throw new Error('Projectid can not be undefined');\n  const [state, setState] = useState(getInitTodoState());\n  const todoService = useRef(new TodoService());\n          \n  const dataFunctions = {\n    save: (doc: Todo, parentId?: string|null):Promise<any> => todoService.current.save(doc, parentId),\n    remove: (id) => todoService.current.remove(id), //TODO: allow user to choose, sync or not to sync\n    select: (doc: Todo | null) => todoService.current.select(doc),\n    selectList: (list: TodoList) => todoService.current.selectList(list),\n    changeDoneFilter: (done:boolean) => todoService.current.changeDoneFilter(done),\n    changeOrderFilter: (filter:string) => todoService.current.changeOrderFilter(filter),\n    showNewTag: (show:boolean) => todoService.current.showNewTagFilter(show),\n  }\n\n  useEffect(() => {\n    todoService.current.init(projectid, list, tag)\n    return todoService.current.unsubscribe;\n  }, [projectid, list, tag])\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      todoService.current.state$.subscribe(state => {\n        setState(state);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[projectid]);\n\n\n  return [state, dataFunctions];\n}","\nimport { Habit, habitStage, TYPE_HABBIT } from './models';\nimport { BehaviorSubject, Subscription } from 'rxjs';\nimport { dataService } from '../../modules/data/dataService';\nimport { saveIntoArray, isThisUserProject } from '../../modules/data/utilsData';\nimport { ProjectItem } from '../../modules/data/models';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport _ from 'lodash';\nimport { authService } from '../../modules/auth/authService';\nimport ulog from 'ulog';\n\nconst log = ulog('habits');\n\nexport interface habitsState {\n  selected: Habit | null,\n  habits: Habit[],\n  stageFilter: habitStage\n}\n\nexport const getInitHabitsState = (): habitsState => {\n  return {\n    selected: null,\n    habits: [],\n    stageFilter: habitStage.current\n  }\n}\n\nexport class HabitsService {\n\n  // @ts-ignore:  we force init later on in init function\n  private _project: ProjectItem;\n  public getProject():ProjectItem {return this._project}\n  private _state: habitsState = getInitHabitsState();\n\n  public state$ = new BehaviorSubject(this._state);\n\n  private _docs: Habit[] = [];\n\n  public docs$ = new BehaviorSubject(this._docs);\n\n  private _subscription: Array<Subscription> = [];\n\n  public init(project: ProjectItem) {\n    const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n      if (!ready) return;\n      const equals = _.isEqual(project, this._project);\n      if (equals) return;\n\n      await this._init(project);\n\n      dataSub.unsubscribe();\n    });\n\n  }\n\n  async _init(project: ProjectItem) {\n    if (this._project && this._project.id === project.id) return;\n    this._project = project;\n    this._docs = await dataService.getAllByProject(project.id, TYPE_HABBIT);\n    this.filterhabits();\n\n    //manage changes\n\n    const sub = dataService.subscribeProjectTypeChanges(project.id, TYPE_HABBIT)\n      .subscribe(doc => {\n        if (doc.deleted)\n          this._docs = this._docs.filter(d => d.id !== doc.id);\n        else {\n          this._docs = saveIntoArray(doc, this._docs);\n        }\n        this.filterhabits();\n        //TODO: need to optimize this, maybe start using the view query, see bottom of file\n      });\n    this._subscription.push(sub);\n  }\n\n\n\n  private filterhabits() {\n    const filtered = this._docs.filter(doc => this.filterFunction(doc));\n    this.state = { ...this._state, ...{ habits: filtered } };\n  }\n\n  private filterFunction(doc: Habit) {\n    return (doc.stage === this._state.stageFilter && !doc.deleted)\n  }\n\n\n\n  public get state(): habitsState {\n    return this._state;\n  }\n  public set state(value: habitsState) {\n    this._state = value;\n    this.state$.next(this._state);\n}\n\n  public get docs(): Habit[] {\n    return this._docs;\n  }\n  public set docs(value: Habit[]) {\n    this._docs = value;\n    this.docs$.next(this._docs);\n  }\n\n\n\n  public save(doc: Habit) {\n    log.info(\"Save: \", doc, this._project, TYPE_HABBIT);\n\n    //check if its new, no id, its noew\n    if (!doc.id) {\n      if(isThisUserProject(this._project.id, authService.getUser().id)){\n        doc = Object.assign(gamifyService.calculateNewHabitRewards(doc));\n        gamifyService.removeUserItem(doc.plantName);\n\n        return dataService.save({ ...{ done: false }, ...doc }, TYPE_HABBIT, { projectid: this._project.id });\n      }\n      else {\n\n      }\n    }\n    else\n      dataService.save({ ...{ done: false }, ...doc }, TYPE_HABBIT, { projectid: this._project.id });\n  }\n\n  public remove(id: string) {\n    dataService.remove(id, TYPE_HABBIT);\n  }\n\n  public select(doc: Habit) {\n    this.state = { ...this._state, ...{ selected: doc } };\n  }\n\n  public changeStageFilter(stage: habitStage) {\n    if (stage === this._state.stageFilter) return;\n    this._state = { ...this._state, ...{ stageFilter: stage } };\n    this.filterhabits();\n\n  }\n\n\n  public unsubscribe() {\n    if (!this) return;\n    this._subscription.forEach(sub => {\n      if (sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n","import { useEffect, useState, useRef } from 'react';\nimport { Subscription } from 'rxjs';\nimport { ProjectItem } from '../../../modules/data/models';\nimport { Habit, habitStage } from '../models';\nimport { habitsState, getInitHabitsState,  HabitsService } from '../habits.service';\nimport _ from 'lodash';\n\nexport interface habitDataFunctions {\n  save: {(doc: Habit)},\n  remove: {(id: string)},\n  select: {(doc: Habit)},\n  changeStageFilter: {(stage: habitStage)}\n}\n\n\n//more simpler then auth hook, just read data\nexport function useHabitsCollectionFacade(project: ProjectItem): \n                                        [habitsState, habitDataFunctions]{\n\n  const [state, setState] = useState(getInitHabitsState());\n\n  const habitsService = useRef(new HabitsService());\n  \n          \n  const dataFunctions = {\n    save: (doc: Habit) => {\n      habitsService.current.save(doc)\n    },\n    remove: (id) => habitsService.current.remove(id), //TODO: allow user to choose, sync or not to sync\n    select: (doc: Habit) => habitsService.current.select(doc),\n    changeStageFilter: (stage: habitStage) => habitsService.current.changeStageFilter(stage),\n  }\n\n  useEffect(() => {\n    if(_.isEqual(habitsService.current.getProject(), project)) \n        return;\n    habitsService.current.init(project)\n\n    return habitsService.current.unsubscribe;\n  }, [project])\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      habitsService.current.state$.subscribe(state => {\n        setState(state);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[project]);\n\n\n  return [state, dataFunctions];\n}","import React, { useState, useEffect } from 'react';\nimport { IonHeader, IonIcon, IonBadge } from '@ionic/react';\nimport { Line } from 'rc-progress';\nimport { gamifyService, getInitGamifyState, GamifyState } from '../modules/gamify/gamifyService';\n\n\n\nimport './header.css';\nimport 'rc-progress/assets/index.css';\nimport { heart, leaf } from 'ionicons/icons';\nimport { useHabitsCollectionFacade } from '../pages/habits/hooks/habits.hook';\nimport { getDefaultProject } from '../modules/data/utilsData';\nimport { authService } from '../modules/auth/authService';\nimport { Habit } from '../pages/habits/models';\nimport { getPlantPic, getLandscapePlantPic } from '../pages/habits/utilsHabits';\n\nconst HeaderWithProgress = ({title, showDetail = true}:{title:string, showDetail?:boolean}) => {\n\n  const [state, setState] = useState<GamifyState>(getInitGamifyState())\n  const [habitsState] = useHabitsCollectionFacade(getDefaultProject(authService.userid));\n  \n  const {experience, maxExperience, level, gold} = state;\n\n  const landscape = Object.assign(state.landscape || {});\n  if(!landscape.trees) {\n    landscape.trees = [];\n  }\n\n  console.warn(landscape);\n\n\n  useEffect(() => {\n    const sub = gamifyService.state$.subscribe(s => {\n      setState({...state, ...s});\n\n    })\n    return () => {\n      sub.unsubscribe();\n    };\n  }, [])\n\n  const positionArray = [300, 200, 100, 150, 250, 50, \n      350, 375, 25, 75, 125, 175, 225, 275, 325, 375]\n\n  console.log(habitsState);\n\n  const getPlantSize = (level: number): string => {\n    if(level < 3) return '5px'\n    if(level < 4) return '50px'\n    if(level < 6) return '60px';\n    if(level < 8) return '70px';\n\n    return '100px';\n  }\n\n  const getPlantTop = (level:number): string => {\n    if(level < 3) return '4px'\n    return '9px';\n  }\n\n  return (\n    /*\n        400\n        300200100150250503503752575125175225275325375\n        400/num\n        380/num\n    */\n    <IonHeader className=\"headerWithAvatar\">\n      <div className=\"cityParent\">\n        <img src=\"/assets/pics/hills.svg\" style={{right:'25px'}} className=\"headerHills\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/hills.svg\" style={{right:'200px'}} className=\"headerHills\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/ground.svg\" className=\"headerGround\" alt=\"Ground\"/>\n        <img src=\"/assets/pics/sun.svg\" style={{right:'130px', top: '10px', width:'5%'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud2.svg\" style={{right:'240px', top: '40px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud1.svg\" style={{right:'60px', top: '40px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud2.svg\" style={{right:'140px', top: '15px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n\n        {landscape.trees.map(tree => (\n          <img  src={getLandscapePlantPic(tree)}\n                key={tree.habitId}\n                style={{left: tree.position +'px', bottom: getPlantTop(tree.level), width: getPlantSize(tree.level)}} \n                className=\"habitPlant\" alt=\"Tree\"/>\n        ))}\n\n      </div>\n      {(showDetail? (\n        <div className=\"statsParent\" >\n            <div className=\"statsBarParent\" >\n      \n            </div>\n          <div className=\"statsBarParent\" >\n            <IonIcon class=\"statsBarIcon\" icon={leaf} style={{color: \"#157F1F\"}} />\n              <Line trailWidth={0}  percent={experience/maxExperience * 100} \n                    className=\"statsBarLine\"\n                    strokeWidth={4} strokeColor=\"#157F1F\" />\n              <IonBadge class=\"statsBarBadge\" \n                        color=\"success\" >{experience}/{maxExperience}</IonBadge>\n          </div>\n          <div className=\"statsBarMoneyParent\" >\n            <IonBadge class=\"statsBarMoneyBadge\" \n                      color=\"warning\" >Gold: {gold}</IonBadge>\n            <IonBadge class=\"statsBarMoneyBadge\" \n                      color=\"success\" >Level: {level}</IonBadge>\n          </div>\n        </div>\n      ) : (<></>))}\n      \n      <h1>{title}</h1>\n    </IonHeader>\n  )\n}\n\nexport default HeaderWithProgress;","import React, { useState } from 'react';\nimport { IonIcon, IonPopover } from '@ionic/react';\nimport { helpCircleOutline } from 'ionicons/icons';\n\n\n\nconst style = {\n  fontSize:'32px', \n  position: 'relative',\n  top: '10px'\n}\n\n\nexport const  HelpTooltip = ({message, \n                             iconStyle = style,\n                             fontSize = '32px',\n                             top = '10px'}: \n    {message:string, iconStyle?:{}, fontSize?:string, top?:string}) => {\n      \n  const [state, setState] = useState<{show:boolean, e:any}>({show: false, e:{}});\n\n  const show = (e) => {\n    setState({show:true, e:e});\n  }\n  return (\n    <>\n    <IonPopover\n        isOpen={state.show}\n        event={state.e}\n        onDidDismiss={e => setState({...state, ...{show:false} })}>\n        <p style={{paddingLeft:'10px', paddingRight:'10px'}}>{message} </p>\n    </IonPopover>\n    <IonIcon  \n      onClick={(e)=> setState({show: true, e: e.nativeEvent})}\n      icon={helpCircleOutline} \n      style={ {...iconStyle, ...{fontSize, top} } } />\n  </>\n  )\n}\n","import React from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonButton,\n  IonToolbar,\n  IonIcon,\n  IonFab,\n  IonFabButton,\n  IonRefresher,\n  IonRefresherContent} from '@ionic/react';\nimport { Plugins, KeyboardInfo } from '@capacitor/core';\n\nimport TodoNewComp from './todo.new.component';\nimport TodoListItemComp from './Todo.listitem.component';\nimport { useTodosCollectionFacade } from './hooks/todos.hook';\nimport './todos.page.css';\nimport HeaderWithProgress from '../../components/HeaderWithProgress';\nimport { useParams, useLocation } from 'react-router-dom';\nimport { capitalize } from '../../utils';\nimport { getDefaultProject } from '../../modules/data/utilsData';\nimport { authService } from '../../modules/auth/authService';\nimport ulog from 'ulog';\nimport { checkmarkCircleOutline, radioButtonOff, arrowDownOutline, arrowUpOutline, add } from 'ionicons/icons';\nimport { dataService } from '../../modules/data/dataService';\nimport { useTranslation } from 'react-i18next';\nimport { HelpTooltip } from '../../components/tooltip';\n\nconst log = ulog('todo');\nconst { Keyboard, Device } = Plugins;\n\n\nconst TodosPage  = () => {\n\n  const project = getDefaultProject(authService.userid);\n  const location = useLocation();\n  \n  const {t} = useTranslation();\n\n  let list, tag;\n  const params = useParams();\n  log.info(params, location);\n  if(location.pathname.startsWith('/todos/tag/')){\n   tag = params['tag']\n  }\n  else {\n    list = params['list']\n  }\n\n  const [state, dataFunc] = useTodosCollectionFacade(project.id, list, tag)\n  const { docs, selectedTodo, tagDocs } = state;\n\n  const printTitle = ():string => {\n    console.log(state);\n    if(state.list){\n      let listname = state.list.name;\n      if(listname === 'default')\n        listname = t('todos.default')\n      return t('todosTitle') + ': ' + capitalize(listname);\n    }\n    if(state.tag){\n      let tagname = state.tag.name;\n      if(tagname === 'today')\n        tagname = t('todos.today');\n      if(tagname === 'important')\n        tagname = t('todos.important');\n      return t('todosTitle') + ': ' + capitalize(tagname);\n    }\n    return t('todosTitle');\n  }\n\n  const setKeyboard = async () => {\n    const devInfo = await Device.getInfo();\n    if(devInfo.operatingSystem !== 'ios' &&\n       devInfo.operatingSystem !== 'android') return;\n\n    Keyboard.addListener('keyboardWillShow', (info: KeyboardInfo) => {\n      console.log('keyboard will show with height', info.keyboardHeight);\n    });\n    \n    Keyboard.addListener('keyboardDidShow', (info: KeyboardInfo) => {\n      console.log('keyboard did show with height', info.keyboardHeight);\n    });\n    \n    Keyboard.addListener('keyboardWillHide', () => {\n      console.log('keyboard will hide');\n    });\n    \n    Keyboard.addListener('keyboardDidHide', () => {\n      console.log('keyboard did hide');\n    });\n  }\n\n\n  setKeyboard();\n  \n  return (\n    <IonPage>\n      <HeaderWithProgress title={printTitle()} />\n      <IonContent id=\"todoContent\">\n      <IonRefresher slot=\"fixed\" onIonRefresh={(e) => dataService.refresh(e)}>\n          <IonRefresherContent></IonRefresherContent>\n      </IonRefresher>\n        <div>\n          <IonButton  color={(!state.doneTodos)? 'light':'success'} \n                      class=\"todoHeaderIcons\" \n                      onClick={() => {dataFunc.changeDoneFilter(true)}}\n                      fill=\"clear\">\n                      <IonIcon icon={checkmarkCircleOutline} />\n          </IonButton>\n          <IonButton  color={(state.doneTodos)? 'light':'success'} \n                      class=\"todoHeaderIcons\" \n                      onClick={() => {dataFunc.changeDoneFilter(false)}}\n                      fill=\"clear\">\n                      <IonIcon icon={radioButtonOff} />\n          </IonButton>\n          <IonButton  color={(state.orderFilter!== 'created')? 'light':'success'} \n                      class=\"todoHeaderButtons\" \n                      onClick={() => {dataFunc.changeOrderFilter('created')}}\n                      fill=\"clear\">{t('date')}\n                      {(state.orderFilter === 'created')? (\n                        <IonIcon \n                          icon={((state.orderAsync === -1)? arrowDownOutline : arrowUpOutline)}/>\n                      ) : (<></>) }\n          </IonButton>\n          <IonButton  color={(state.orderFilter !== 'name')? 'light':'success'} \n                      class=\"todoHeaderButtons\" \n                      onClick={() => {dataFunc.changeOrderFilter('name')}}\n                      fill=\"clear\">{t('name')}\n                      {(state.orderFilter === 'name')? (\n                        <IonIcon \n                          icon={((state.orderAsync === -1)? arrowDownOutline : arrowUpOutline)}/>\n                      ) : (<></>) }\n          </IonButton>\n          <HelpTooltip message={t('tooltips.todosSort')} fontSize=\"24px\" />\n        </div>\n        <IonList>\n            {docs.map(todo => (\n              <TodoListItemComp   todo={todo} \n                                  tagDocs={tagDocs}\n                                  lastChild = {false}\n                                  selectedTodo={selectedTodo}                                 \n                                  dataFunctions={dataFunc}\n                                  key={todo.id} />\n            ))}\n        </IonList>\n        <IonFab vertical=\"top\" horizontal=\"end\" slot=\"fixed\" edge>\n          <IonFabButton onClick={() => dataFunc.showNewTag(true)} >\n            <IonIcon icon={add} />\n          </IonFabButton>\n        </IonFab>\n      </IonContent>\n      <IonToolbar>\n          <TodoNewComp \n            list = {state.list}\n            focus = {state.showNewTagFilter}\n            closeFunc = {() => dataFunc.showNewTag(false)}\n            tag = {tag}\n            projectId={project.id||''} \n            saveFunc={dataFunc.save} />\n      </IonToolbar>\n    </IonPage>\n  );\n};\n\nexport default TodosPage;\n\n","import React from 'react';\nimport { IonHeader, IonToolbar, IonPage, IonTitle, IonContent, IonLabel } from '@ionic/react';\n\n\n\nconst IntroPage: React.FC = () => {\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>Loading</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonLabel>Loading.....</IonLabel>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default IntroPage;\n","import { Subscription, BehaviorSubject } from \"rxjs\";\nimport { PartyProject, TYPE_PARTY, Challenge, ChallengeState, ChallengeAction } from \"./models\";\nimport { getPostRequest, post } from '../ajax/ajax';\nimport { env } from \"../../env\";\nimport { loadingService } from \"../loading/loadingService\";\nimport { toastService, ToastType } from \"../toast/toastService\";\nimport { dataService } from \"../data/dataService\";\nimport { waitMS, getChannelFromProjectId } from '../data/utilsData';\nimport { Msg, TYPE_MSG } from \"../messages/models\";\nimport { saveIntoDocList } from \"../../utils\";\nimport ulog from 'ulog';\nimport { authService } from \"../auth/authService\";\n\nconst log = ulog('parties');\n\nexport interface PartyState {\n  docs: PartyProject[],\n}\n\nexport const initPartyState = {\n  docs: []\n}\n\nexport class PartyService {\n  private _subscription: Array<Subscription> = [];\n  \n  private _state: PartyState = initPartyState;\n  public state$ = new BehaviorSubject(this._state);\n  \n  async init(){\n    this.unsubscribe();\n\n\n    const sub1 = dataService.subscribeChanges().subscribe(doc => {\n      if(doc.type === 'party' && doc.secondaryType === 'project'){\n        const docs = saveIntoDocList(doc, this._state.docs);\n        this.state = {...this._state, ...{docs}};\n      }\n    });\n    this._subscription.push(sub1);\n    const docs = await dataService.queryByProperty('secondaryType', 'equals', 'project', TYPE_PARTY);\n    this.state = {...this._state , ...{docs}};\n\n\n  }\n\n  /*\n    Rights, each digit represents different right\n    0.  0 - Not admin 1- Admin, can change everything\n    1.  (Project item) 0 - can't see, 1 - can see, 2 - can edit\n    2.  (Project children) 0 - can't see, 1 - can see own, 2 - can see all items\n    3.  (Project children edit) 0 -can't edit, 1 can edit/make own, 2 can edit all \n  */\n  public async addUser(username:string, party: PartyProject) {\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/sendAddMemberRequest',\n                      { token: authService.getToken(), \n                        channelid: getChannelFromProjectId(party.id),\n                        username,\n                        rights: '0121' //see all, edit own items \n                      }), \n                      true, 'Adding member, please wait');\n\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Member invitation sent', ToastType.success);\n      waitMS(3000);\n      dataService.addSyncCall$.next();\n    }\n    catch (e) {\n      log.error(e);\n    }\n    \n  }\n\n  public saveParty(partyProject: PartyProject){\n    if (!partyProject.id) {\n      this._createParty(partyProject);\n    }\n  }\n\n  //make new party ajax\n  private async _createParty(partyProject: PartyProject) {\n    log.info('Saving party Project::: ', partyProject);\n    loadingService.showLoading('Creating party, please wait, ' +\n                'internet connection required');\n    const res = await dataService.saveNewProject(partyProject, TYPE_PARTY);\n    if(!res.success){\n      return toastService.printServerErrors(res);\n    } \n\n    log.warn('New Party::::: ', res);\n    \n    loadingService.hideLoading();\n  }\n\n  public saveChallenge(challenge:Challenge, party:PartyProject){\n      this._createChallenge(challenge, party);\n  }\n\n  private async _createChallenge(challenge:Challenge, partyProject: PartyProject) {\n    log.info('Saving System Doc::: ', partyProject);\n    loadingService.showLoading('Adding Challenge, please wait, ' +\n                'internet connection required');\n    const res = await dataService.saveSystemDoc(challenge,partyProject, TYPE_PARTY);\n    if(!res.success){\n      return toastService.printServerErrors(res);\n    }\n    loadingService.hideLoading();\n  }\n\n\n  public async acceptPartyInvitation(msg:Msg){\n    //lets send a request\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/acceptChannelInvitation',\n                      { token: authService.getToken(), msgId: msg.id,}, {} ), \n                      true, 'Accept Reply sent, waiting for reply.');\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Pary Membership request sent. Please wait for app update.', ToastType.success);\n      await waitMS(2000);\n      dataService.addSyncCall$.next();\n      msg.replied = {accepted: true, date: Date.now()};\n      dataService.save(msg, TYPE_MSG);\n    }\n    catch (e) {\n      log.error(e);\n    }\n  }\n\n  public async acceptFriendInvitation(msg:Msg){\n    //lets send a request\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/social/acceptFriendInvitation',\n                      { token: authService.getToken(), msgId: msg.id,}, {} ), \n                      true, 'Accept Reply sent, waiting for reply.');\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Friend acceptance reply sent. Please wait for app update.', \n        ToastType.success);\n\n      await waitMS(2000);\n\n      dataService.addSyncCall$.next();\n\n      msg.replied = {accepted: true, date: Date.now()};\n      dataService.save(msg, TYPE_MSG);\n    }\n    catch (e) {\n      log.error(e);\n    }\n  }\n\n  public async rejectPartyInviation(msg:Msg) {\n    const newMsg = {...msg, ...{replied:{accepted: false, date: Date.now()}}}\n    dataService.save(newMsg, TYPE_MSG);\n  }\n\n  public async rejectFriendInviation(msg:Msg) {\n    const newMsg = {...msg, ...{replied:{accepted: false, date: Date.now()}}}\n    dataService.save(newMsg, TYPE_MSG);\n  }\n\n  public async changeChallengeState(challengeid: string|undefined, state:ChallengeState){\n    if(!challengeid) throw new Error('Challengeid cannot be undefined');\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/habits/changeChallengeState',\n                      { token: authService.getToken(), \n                        challengeid, state}, {} ), \n                      true, 'Saving challenge, please wait.');\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n      await dataService.saveFromServer(res.data.doc, TYPE_PARTY);\n\n      toastService.showMessage('Challenge saved.', \n        ToastType.success);\n\n      await waitMS(2000);\n      dataService.addSyncCall$.next();\n      await waitMS(2000);\n      dataService.addSyncCall$.next();\n    }\n    catch (e) {\n      log.error(e);\n    }\n  }\n\n  public async submitChallengeActions(challengeid: string|undefined, actions: ChallengeAction[]){\n    if(!challengeid) throw new Error('Challengeid cannot be undefined');\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/habits/submitChallengeActions',\n                      { token: authService.getToken(), \n                        challengeid, actions}, {} ), \n                      true, 'Saving challenge, please wait.');\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n      if(res.data && res.data.challenge)\n        dataService.saveFromServer(res.data.challenge, TYPE_PARTY);\n\n      if(res.data && res.data.rewards >= 0) {\n        log.info('Shwoing rewards::: ', res.data.rewards);\n        toastService.showMessage('You have recieved '+res.data.rewards, \n        ToastType.success);\n      }\n\n      await waitMS(2000);\n      dataService.addSyncCall$.next();\n      await waitMS(2000);\n      dataService.addSyncCall$.next();\n       \n    }\n    catch (e) {\n      log.error(e);\n    }\n  }\n\n  public async acceptChallenge(challenge:Challenge, data:any = {}){\n    //lets send a request\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/habits/acceptChallenge',\n                      { token: authService.getToken(), \n                        data,\n                        challengeid: challenge.id}, {} ), \n                      true, 'Accept Reply sent, waiting for reply.');\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n      toastService.showMessage('Challenge acceptance request sent', \n        ToastType.success);\n      await dataService.saveFromServer(res.data.doc, TYPE_PARTY);\n      await waitMS(2000);\n      dataService.addSyncCall$.next();\n    }\n    catch (e) {\n      log.error(e);\n    }\n  }\n\n\n  public get state(): PartyState {\n    return this._state;\n  }\n  public set state(value: PartyState) {\n    console.log('State: ', value);\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\nexport const partyService = new PartyService();","import i18n from 'i18next';\nimport { initReactI18next } from \"react-i18next\";\nimport Backend from 'i18next-xhr-backend';\n//import LanguageDetector from 'i18next-browser-languagedetector';\nimport { Globalization } from '@ionic-native/globalization'\nimport { dataService } from './modules/data/dataService';\n\n\n\nconsole.log();\n\n\ni18n\n  .use(initReactI18next) \n  .use(Backend)\n  //.use(LanguageDetector)\n  .init({\n    interpolation: {  escapeValue: false },  // React already does escaping\n    lng: 'en',   \n    fallbackLng: 'en',                           // language to use\n    backend: {\n      loadPath: '/locales/{{lng}}/{{ns}}.json'\n    },\n    react: {\n      wait: true,\n      useSuspense: false,\n    },\n    debug: true,\n    //defaultNS: 'common',\n    //ns: ['common',],\n    \n    //debug: process.env.NODE_ENV !== 'production',\n});\n\n\nexport const loadPreferedLanguage = async () => {\n  //first\n  //see if we have a settings doc\n  let language;\n  const doc = await dataService.getSettingsDoc();\n  if(!doc || !doc.language){\n    language = 'en';\n    //language = await Globalization.getPreferredLanguage()\n    console.log(language);\n    \n  }\n  else {\n    language = doc.language;\n    console.log(doc) \n  }\n  \n  if(!language) return;\n  console.log('Changing to language::: ', language);\n  i18n.changeLanguage(language);\n}\n\nexport default i18n;\n","import { useEffect, useState } from 'react';\nimport { Subscription } from 'rxjs';\nimport { dataService } from '../../data/dataService';\nimport { GUEST, authService } from '../../auth/authService';\nimport { gamifyService } from '../../gamify/gamifyService';\nimport { partyService } from '../../parties/party.service';\nimport ulog from 'ulog';\nimport { loadPreferedLanguage } from '../../../i18n';\nimport { useHistory } from 'react-router-dom';\nimport { TYPE_SETTINGS } from '../../data/utilsData';\nimport { appService } from '../appService';\nimport { socialService } from '../../social/social.service';\n\n\nconst log = ulog('app');\n\nexport enum AppStatus {\n  loading, auth, guest\n}\n\n\n\n// username, authenticated, login, logout, renewToken\nexport function useAppStatus(): [{status:AppStatus, dataReady:boolean, username:string}] {\n\n  const [appStatus, setAppStatus] = useState({status: AppStatus.loading, dataReady: false, username: GUEST});\n  const history = useHistory();\n\n  log.info('APP Router Status: ', appStatus);\n\n  useEffect(() => {\n    log.info('App Stats Effect::');\n    const subscriptions: Subscription[] = [\n      dataService.getReadySub().subscribe(ready => {\n        if(ready === appStatus.dataReady) return;\n          setStatusFunction();\n      }),\n      authService.username$.subscribe(async (username) => {\n        //renew token\n        if(authService.getIsAuthenticated()){\n          authService.renewToken();\n        }\n        setStatusFunction();\n        const userid = authService.getUser().id;\n        await dataService.init( userid, username !== GUEST);\n        await gamifyService.init(userid);\n        await partyService.init();\n        await appService.init();\n        await socialService.init(authService.userid);\n        await loadPreferedLanguage();\n        //load our tutorial if not already watched\n        //await showIntroTutorial();\n        dataService.addSyncCall$.next();\n      }),\n\n    ];\n    // usersService.loadAll();\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[]);\n\n\n  const showIntroTutorial = async () => {\n    const settings = await dataService.getSettingsDoc();\n    if(!settings) return;\n    console.log('Settings: ', settings);\n    if(!settings.tutorialIntro || settings.tutorialIntro < 2) {\n      history.push('/tutorialslides')\n      settings.tutorialIntro = 1;\n      dataService.save(settings, TYPE_SETTINGS);\n    }\n\n    \n  }\n\n\n  const setStatusFunction = () => {\n    const dataReady = dataService.ready;\n    const username = authService.getUsername();\n    if(dataReady === appStatus.dataReady && username === appStatus.username)\n      return;\n    log.info('STATUS:', dataReady, username, appStatus);\n    \n    if(dataReady){\n      if(username === GUEST)\n        setAppStatus({ status:AppStatus.guest, username: username, dataReady: dataReady });\n      else\n        setAppStatus({ status:AppStatus.auth, username: username, dataReady: dataReady });\n    }\n    else {\n      setAppStatus({ status:AppStatus.loading, username: username, dataReady: dataReady });\n    }\n  };\n\n  return [ appStatus ];\n}","\nimport { BehaviorSubject } from 'rxjs';\nimport { dataService } from '../data/dataService';\nimport { TYPE_SETTINGS } from '../data/utilsData';\n\n\nexport interface AppServiceState {\n  showTutorial: boolean,\n  tutorialStartingSlide: number\n}\n\nexport class AppService {\n  private _state:AppServiceState = {\n    showTutorial: false,\n    tutorialStartingSlide: 1};\n\n  private _settingsDoc;\n  public state$ = new BehaviorSubject<AppServiceState>(this._state);\n\n  public async init() {\n    const doc = await dataService.getSettingsDoc();\n    if(doc)\n      this._settingsDoc = doc;\n\n    dataService.subscribeDocChanges(dataService.getSettingsDocId())\n      .subscribe(doc => {\n        this._settingsDoc = doc;\n        this.updateStateFromSettingsDoc(doc);\n    })\n    \n  }\n\n  private updateStateFromSettingsDoc(doc) {\n    this.state = {...this.state, ...{\n      showTutorial: false,// doc.showTutorialModal || true,\n      tutorialStartingSlide: doc.tutorialStartingSlide || 1\n    }}\n  }\n\n  private _saveSettings() {\n    const doc = {...this._settingsDoc, ...this._state};\n    dataService.save(doc, TYPE_SETTINGS);\n    \n  }\n\n\n\n  public showTutorial(show: boolean){\n    console.log('Show Tutorial:::: ', show)\n    this.state = {...this.state, ...{showTutorial: show}}\n  }\n\n\n\n  public get state(): AppServiceState {\n    return this._state;\n  }\n\n  public set state(state:AppServiceState) {\n    this._state = state;\n    this.state$.next(state);\n  }\n\n\n\n}\nexport const appService = new AppService();","import React from 'react';\nimport { IonHeader} from '@ionic/react';\n\n\nimport '../../../components/header.css';\nimport { Landscape } from '../../gamify/models';\n\nconst LandscapeComp = ({username, landscape}:{username:string, landscape:Landscape}) => {\n\n  \n\n  const getTreeSize = (level: number): string => {\n    if(level < 3) return '5px'\n    if(level < 4) return '50px'\n    if(level < 6) return '60px';\n    if(level < 8) return '70px';\n\n    return '100px';\n  }\n\n  const getTreeTop = (level:number): string => {\n    if(level < 3) return '4px'\n    return '10px';\n  }\n\n  return (\n    \n    <IonHeader className=\"headerWithAvatarLandscapeEdition\">\n      <div className=\"cityParentLandscapeEdition\">\n        <img src=\"/assets/pics/hills.svg\" style={{right:'25px'}} className=\"headerHills\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/hills.svg\" style={{right:'200px'}} className=\"headerHills\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/ground.svg\" className=\"headerGround\" alt=\"Ground\"/>\n        \n        {landscape.trees.map(tree => (\n          <img  src={'/assets/plants/' + tree.id+ '/' + tree.level + '.svg'}\n                key={tree.habitId}\n                style={{left: tree.position +'px', bottom: getTreeTop(tree.level), width: getTreeSize(tree.level)}} \n                className=\"habitPlant\" alt=\"Tree\"/>\n        ))}\n\n      </div>\n      <h1>{username}</h1>\n    </IonHeader>\n  )\n}\n\nexport default LandscapeComp;","import React, { useReducer, useEffect } from 'react';\nimport { IonCard, IonCardTitle, IonCardHeader, IonCardContent, IonList, IonItem, IonAlert, IonFooter, IonButton, IonLabel } from '@ionic/react';\nimport  ulog from 'ulog';\nimport { Friend } from '../models';\nimport { socialService } from '../social.service';\nimport { useTranslation } from 'react-i18next';\nimport { HelpTooltip } from '../../../components/tooltip';\nimport LandscapeComp from './Landscape.component';\nconst log = ulog('social');\n\nexport interface FriendsState {\n  showAddModal: boolean,\n  friends: Friend[],\n}\n\n\nconst reducer = (state, {type, payload}): FriendsState => {\n  switch(type) {\n    case 'showAddMemberModal':\n      return {...state, ...{showAddModal: true}};\n    case 'hideAddMemberModal':\n      return {...state, ...{showAddModal: false}};\n    case 'updateFriends':\n      return {...state, friends: payload};\n    default:\n      log.error('Action type is not a match');\n      return state;\n  }\n}\n\nconst FriendsListComponent = () => {\n  const [state, _dispatch] = useReducer(reducer, {\n    showAddModal: false,\n    friends: [],\n  })\n\n  const { t } = useTranslation();\n\n  useEffect(() => {\n    const sub = socialService.state$.subscribe(s => {\n      dispatch('updateFriends', s.friends)\n    });\n    return () => {\n      sub.unsubscribe();\n    }\n  }, [])\n\n  const dispatch = (type: 'showAddMemberModal'|\n                          'hideAddMemberModal'|\n                          'updateFriends', \n                    payload:any = {}) => {\n    _dispatch({type, payload});\n  }\n\n  const addFriend = () => {\n    dispatch(\"showAddMemberModal\");\n    \n  }\n\n  const hideAddUser = () => {\n    dispatch('hideAddMemberModal');\n  }\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>{t('social.friends')}</IonCardTitle>\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n            {state.friends.map(friend => (\n              <IonItem  \n                        lines=\"none\"\n                        key={friend.id}\n                        onClick={() => {}}>\n             <LandscapeComp username={friend.username} \n                            landscape={friend.landscape} />\n            </IonItem>\n            ))}\n        </IonList>\n        \n      </IonCardContent>\n        <IonFooter>\n          <IonButton onClick={()=>addFriend()} fill=\"clear\">{t('social.friendAdd')}</IonButton>\n          <HelpTooltip message={t('tooltips.addFriends')} />\n\n          <IonButton onClick={()=>socialService.updateSocialUsers()} fill=\"clear\">Update</IonButton>\n          \n        </IonFooter>\n      <IonAlert \n        isOpen={state.showAddModal}\n        onDidDismiss={() => hideAddUser()}\n        header= {t('social.friendUsername')}\n        inputs={[\n          {\n            name: 'username',\n            type: 'text',\n            id: 'username',\n\n\n          }\n        ]}\n        buttons={[\n          {\n            text: t('Cancel'),\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: () => {\n              hideAddUser();\n            }\n          },\n          {\n            text: t('social.inviteFriend'),\n            handler: (data) => {\n              socialService.addFriend(data.username);\n              hideAddUser();\n            }\n          }\n        ]}\n      />\n    </IonCard>\n  )\n\n}\nexport default FriendsListComponent;","import React, { useReducer, useEffect } from 'react';\nimport { IonCard, IonCardTitle, IonCardHeader, IonCardContent, IonList, IonItem, IonLabel, IonAvatar, IonIcon, IonText, IonButton } from '@ionic/react';\nimport  ulog from 'ulog';\nimport { Msg } from '../../messages/models';\nimport { dataService } from '../../data/dataService';\nimport { TYPE_MSG, newMessage } from '../models';\nimport { mail, personAdd, happy, sad, peopleCircle, documentTextOutline } from 'ionicons/icons';\nimport { printDateRelative, saveIntoArray } from '../../../utils';\nimport { partyService } from '../../parties/party.service';\nimport { COLOR_SUCCESS, COLOR_WARNING } from '../../../colors';\nimport './messages.css';\nimport { socialService } from '../../social/social.service';\nimport { useTranslation } from 'react-i18next';\nconst log = ulog('messages');\n\nexport interface MessagesState {\n  messages: Msg[],\n}\n\n\nconst reducer = (state, {type, payload}): MessagesState => {\n  switch(type) {\n    case 'setMessages':\n      return {...state, ...{messages: payload}};\n      case 'updateMessage':\n        return {...state, ...{messages: saveIntoArray(payload, state.messages)\n                  .sort((a,b)=>{ if(a.updated < b.updated) return 1;\n                                            return -1;\n                  })}};\n    default:\n      log.error('Action type is not a match');\n      return state;\n  }\n}\n\nconst MessagesListComponent = ({channel}:{channel:string}) => {\n  const {t} = useTranslation();\n  const [state, _dispatch] = useReducer(reducer, {\n    messages: [],\n  })\n  useEffect(() => {\n    loadMsgs()\n    const sub = dataService.subscribeChannelTypeChanges(channel, TYPE_MSG)\n                    .subscribe(doc => {\n                        log.info(doc);\n                        dispatch('updateMessage', doc);\n                    });\n    return () => {\n      sub.unsubscribe();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [channel])\n\n  const dispatch = (type: 'setMessages'|\n                          'updateMessage', \n                    payload:any = {}) => {\n    _dispatch({type, payload});\n  }\n\n  const loadMsgs = async () => {\n    const msgs = await dataService.getAllByChannel(channel, TYPE_MSG);\n    log.warn(msgs);\n    dispatch('setMessages', msgs.sort((a,b)=>{\n      if(a.updated < b.updated) return 1;\n      return -1;\n    }))\n    log.info(msgs, channel);\n  }\n\n  const printMessageIcon = (msg) => {\n    if(msg.messageType === 'event'){\n      return <IonIcon icon={mail}  slot=\"start\" />\n    }\n    else if(msg.messageType === 'channelinvite') {\n      return <IonIcon icon={peopleCircle}  slot=\"start\" />\n    }\n    else if(msg.messageType === 'friendinvite') {\n      return <IonIcon icon={personAdd}  slot=\"start\" />\n    }\n    else if(msg.messageType === 'action' && msg.messageSubType === 'Note2') {\n      return <IonIcon icon={documentTextOutline}  slot=\"start\" />\n    }\n  }\n\n  const printReplyStatus = (msg:Msg) => {\n    if((msg.messageType === 'channelinvite' || msg.messageType === 'friendinvite')\n        && msg.replied !== undefined) {\n      if(msg.replied) {\n        return <IonIcon icon={happy} size='large' \n                        slot=\"end\"\n                        color={COLOR_SUCCESS} />\n      }\n      else {\n        return <IonIcon icon={sad} size='large' \n                        slot=\"end\"\n                        color={COLOR_WARNING} />\n      }\n    }\n  }\n\n  const printClubRequestAcceptRejectButtons = (msg:Msg) => {\n    if(msg.messageType === 'channelinvite' && msg.replied === undefined){\n      return (\n        <div>\n          <IonButton onClick={() => partyService.acceptPartyInvitation(msg)} >\n            {t(\"accept\")}</IonButton>\n          <IonButton onClick={() => partyService.rejectPartyInviation(msg)}> \n            {t(\"reject\")}</IonButton>\n        </div>\n      )\n    }\n  }\n\n  const printFriendRequestAcceptRejectButtons = (msg:Msg) => {\n    if(msg.messageType === 'friendinvite' && msg.replied === undefined){\n      return (\n        <div>\n          <IonButton onClick={() => partyService.acceptFriendInvitation(msg)} >\n          {t(\"accept\")}</IonButton>\n          <IonButton onClick={() => partyService.rejectFriendInviation(msg)}> \n          {t(\"reject\")}</IonButton>\n        </div>\n      )\n    }\n  }\n\n  const printChannel = (data) => {\n    console.log(\"DATA\", data);\n    if(!data.channel) return;\n    return <p>{t('social.channel')}: {data.channel}</p>\n  }\n\n  const printFrom = (data) => {\n    if(!data.from) return;\n    return <p>{t('social.from')}: {data.from}</p>\n  }\n\n  const printFriend = (data) => {\n    if(!data.friend) return;\n    return <p>{t('social.friend')}: {data.friend}</p>\n  }\n\n  const printMessage = (msg) => {\n    if(msg.messageType === 'event'){\n      return <IonItem  button \n                key={msg.id}\n                onClick={() => {}}>\n        {printMessageIcon(msg)}\n        <IonLabel className=\"ion-text-wrap\">\n          <h3>{t(msg.message)}</h3>\n          <IonText color=\"secondary\">\n              {printFrom(msg.data)}\n              {printFriend(msg.data)}\n              {printChannel(msg.data)}\n              <p>{printDateRelative(msg.updated)}</p>\n          </IonText>\n        </IonLabel>\n      </IonItem>\n    }\n    else if(msg.messageType === 'channelinvite') {\n      return <IonItem  button \n                key={msg.id}\n                onClick={() => {}}>\n        {printMessageIcon(msg)}\n        <IonLabel className=\"ion-text-wrap\">\n          <h2>{t(\"social.receivedClashInvitation\") + msg.from + \", \"}\n          <strong>{t(\"social.channel\") + \" \" + msg.data.name}</strong></h2>\n          <IonText  color=\"secondary\">\n            {printDateRelative(msg.updated)}\n          </IonText>\n            {printClubRequestAcceptRejectButtons(msg)}\n          \n        </IonLabel>\n        {printReplyStatus(msg)}\n      </IonItem>\n    }\n    else if(msg.messageType === 'friendinvite') {\n      return <IonItem  button \n                key={msg.id}\n                onClick={() => {}}>\n        {printMessageIcon(msg)}\n        <IonLabel className=\"ion-text-wrap\">\n            <h2>{t(\"social.receivedFriendInvitation\")}\n            <strong> {msg.from} </strong></h2>\n            <IonText  color=\"secondary\">\n              {printDateRelative(msg.updated)}\n            </IonText>\n              {printFriendRequestAcceptRejectButtons(msg)}\n        </IonLabel>\n        {printReplyStatus(msg)}\n      </IonItem>\n    }  \n    else if(msg.messageType === 'action' && msg.messageSubType === 'Note') {\n      return <IonItem  button \n                key={msg.id}\n                onClick={() => {}}>\n        {printMessageIcon(msg)}\n        <IonLabel className=\"ion-text-wrap, messageActionNote\">\n            <h2 className=\"messageActionNoteHeader\">{msg.challengeName}: <strong>{msg.username}</strong></h2>\n            <h3  dangerouslySetInnerHTML={{__html: msg.data.note.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>')}} />\n             \n            <IonText  color=\"secondary\">\n              {printDateRelative(msg.updated)}\n            </IonText>\n        </IonLabel>\n        {printReplyStatus(msg)}\n      </IonItem>\n    }                                     \n  }\n\n  const sendMessage = async () => {\n    const msg = newMessage('Testing message');\n    const res = await socialService.sendMessage(msg);\n    console.log(res);\n    dataService.addSyncCall$.next();\n  }\n\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n  <IonCardTitle>{t(\"messages.messages\")}</IonCardTitle>\n       \n      {/* \n        <IonButton onClick={() => sendMessage()} >\n        {t(\"messages.sendMessage\")}</IonButton>\n      */}\n      \n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n            {state.messages.map(msg=> printMessage(msg))}\n        </IonList>\n        \n      </IonCardContent>\n    </IonCard>\n  )\n\n}\nexport default MessagesListComponent;","import {\n  IonPage,\n  IonContent} from '@ionic/react';\nimport React, { useReducer, useEffect } from 'react';\nimport './Home.css';\nimport HeaderWithProgress from '../components/HeaderWithProgress';\nimport FriendsListComponent from '../modules/social/components/Friends.list.component';\nimport MessagesListComponent from '../modules/messages/components/Messages.list.component';\nimport ulog from 'ulog';\nimport { generateUserChannelId } from '../modules/data/utilsData';\nimport { authService } from '../modules/auth/authService';\nimport { useTranslation } from 'react-i18next';\n\nconst log = ulog('home');\n\n\nexport interface HomeState {\n  userid: string;\n}\n\nconst reducer = (state, {type, payload}:{type:string, payload:any}): HomeState => {\n  switch(type) {\n    case 'setUserid':\n      return {...state, ...{userid: payload}};\n    default:\n      log.error('Action Type is incorrect, default called', type, payload);\n      return state;\n  }\n}\n\nconst Home: React.FC = () => {\n\n  const {t} = useTranslation();\n  const [state, _dispatch] = useReducer(reducer, {\n    userid:''\n  })\n\n  const dispatch = (type:'setUserid', \n                    payload: any = {}) => {\n    _dispatch({type, payload});\n  }\n\n\n  useEffect(() => {\n    const sub = authService.username$.subscribe(() => {\n      log.info('Userid update, ', authService.userid);\n      dispatch('setUserid', authService.userid);\n    });\n    log.info('HOME, ', authService.userid);\n    dispatch('setUserid', authService.userid);\n    log.info('Home State', authService.userid);\n    return () => {\n      sub.unsubscribe();\n    };\n  }, [])\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title={t(\"habitville\")} />\n      <IonContent >\n        <FriendsListComponent />\n        <MessagesListComponent channel={generateUserChannelId(state.userid)} />\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Home;\n\n","import {\n  IonPage,\n  IonContent,\n  IonHeader,\n  IonTitle,\n  IonToolbar} from '@ionic/react';\nimport React, {  } from 'react';\nimport HeaderWithProgress from '../components/HeaderWithProgress';\n\n\nconst NotFound: React.FC = () => {\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title=\"I think it was left or was it right?\" />\n      <IonContent >\n        <div style={{padding:'20px'}}>\n          This page does not exist\n        </div>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default NotFound;\n\n","import React from 'react'\nimport {  IonInput, IonLabel, IonItem,\n  IonNote, IonText } from '@ionic/react';\n\n\nconst MyInput = ({data, updateFunction}) => {\n\n\n\n  //const [_data, setData] = useState<FormValueItem>(data); \n\n  /*\n  useEffect(() => {\n    props.attachToForm({name:props.name, value: props.value});\n\n    return props.detachFromForm({name:props.name, value:props.value});\n  },[props]);\n  */\n\n  //console.log(\"MY Input DATA: \", data);\n\n  const handleChange = (event) => {\n    updateFunction({...data, ...{value: event.target.value, dirty: true}});\n  };\n\n  const handleBlur = (event) => {\n    if(data.dirty === true) return;\n    updateFunction({...data, ...{value: event.target.value, dirty: true}});\n  }\n\n  const printErrors = () => {\n    if(data.dirty){\n      const errors =data.errors.map(m => (\n        <IonNote key={m} color=\"danger\">{m}</IonNote>\n      ))\n      return errors;\n    }\n  }\n\n\n  return (\n    <IonItem>\n      <IonLabel position=\"stacked\">\n        {data.displayName}\n        { data.hasValidation?(\n          <IonText color=\"danger\">*</IonText>\n        ):null}\n      </IonLabel>\n      <IonInput \n        name={data.id}\n        value={data.value}\n        type={data.type}\n        onIonBlur={handleBlur}\n        onIonChange={handleChange}></IonInput>\n        {data.messages.map(m => (\n          <IonNote key={m}>{m}</IonNote>\n        ))}\n        {printErrors()}\n    </IonItem>\n  )\n}\n\nexport default MyInput;","import React, { useEffect, useState } from 'react'\nimport MyInput from './myInput';\nimport { saveIntoArray, findById } from '../../utils';\nimport { IonButton } from '@ionic/react';\nimport validator from 'validator';\n\n\n// use to generate form, usually from outside form passed into here\n// so far we can use, ones that have stars have been tested\n// \"text\", \"password\", \"email\", \"number\", \"search\", \"tel\", and \"url\"\nexport interface FormItem { \n  id: string;\n  displayName?: string;\n  type: string;\n  messages?: string[];\n  validators?: any[];  \n  default?: any;\n}\n\nexport interface ValidatorItem {\n  type: string;\n  message?: string|null;\n  options?: any;\n}\n\n\n// use to hold form state\nexport interface FormValueItem {\n  id: string;\n  displayName: string;\n  type: string;\n  value: string;\n  messages: string[];\n  errors: string[];\n  dirty: boolean;\n  hasValidation:boolean;\n  //status: number; //0: untouched, 1: valid, 2: not valid\n}\n\nexport interface OptionsItem {\n  submitButtonText: string;\n}\n\nexport const defaultOptions:OptionsItem = {\n  submitButtonText: \"Submit\",\n}\n\nexport const getFormOptions = (settings:{}) => {\n  return {...defaultOptions, ...settings};\n}\n\nexport interface Props {\n  items: FormItem[],\n  submitFunction: Function,\n  options?: OptionsItem\n}\n\nexport interface State {\n  items: FormValueItem[],\n  valid: boolean\n}\n\nexport function getValidator(type:string, options:any = null, message:string|null = null):ValidatorItem {\n  return {type, options, message};\n}\n\n\n\nconst MyForm = (props:Props) => {\n  const submitFunction = props.submitFunction;\n  const options = props.options|| defaultOptions;\n\n  const [state, setState] = useState<State>({items:[], valid:false});\n\n  useEffect(() => {\n    initForm(props.items);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[props.items]);\n\n\n  const initForm = (items) => {\n    let model: FormValueItem[] = [];\n    // go thourgh props and generate our model from schema;\n    if(items) { //no schema, do nothing\n      items.forEach((item:FormItem) => {\n        let messages = item.messages;\n        \n        console.log(typeof(messages));\n        if(typeof(messages) === 'string'){\n          console.log('Messages is string');\n        }\n        else if(Array.isArray(messages)){\n          console.log('messages array');\n        }\n        else {\n          messages = [];\n        }\n\n        model.push(validateItem({\n            id: item.id,\n            displayName: item.displayName || item.id, \n            type: item.type,\n            value: item.default||'', \n            messages,\n            errors: [],\n            dirty:false,\n            hasValidation: (Array.isArray(item.validators) && item.validators.length>0)\n        }));\n      });\n      setState({items: model, valid: validateForm(model)});\n      //console.log(state);\n    }\n  }\n\n  //const updateItem = (id:string, displayName: string, type: string, value:any, messages:string[], hasValidation:boolean, touched:boolean) => {\n  const updateItem = (item:FormValueItem) => {\n    //console.log('Update Item, ', item);\n    const items = saveIntoArray(validateItem(item), state.items, 'id')\n    setState({\n      items: items,\n      valid: validateForm(items)\n    });\n  }\n\n\n\n  const validateItem = (item:FormValueItem): FormValueItem => {\n    const errors: string[] = validate(item.id, item.value);\n    //console.log(item)\n    return {...item, ...{errors}}\n  }\n\n  const validate = (id:string, value:any): string[] => {\n    //console.log(typeof(value));\n\n    if(typeof(value) !== 'string') return [];\n    \n    const item:FormItem = findById(id, props.items, 'id');\n    if(!item.validators)\n      item.validators = [];\n\n    const messages: string[] = [];\n    item.validators.forEach((val:ValidatorItem) => {\n      if(val.type === 'isEmpty') {\n        if(validator.isEmpty(value)){\n          messages.push(val.message || 'Value cannot be empty')\n        }\n      }\n      if(val.type === 'isLength'){\n        if(!validator.isLength(value, val.options)){\n          messages.push(val.message || 'Value length is not valid');\n        }\n      }\n      if(val.type === 'isEmail'){\n        if(!validator.isEmail(value, val.options)){\n          messages.push(val.message || 'Valid Email required');\n        }\n      }\n    });\n\n    //lastly check the whole form\n\n    //if(messages.length === 0)\n    //  validateForm();\n\n    return messages;\n  }\n\n\n  const submit = () => {\n    const form = {};\n    state.items.forEach(item => {\n      form[item.id] = { value: item.value };\n    });\n    submitFunction(form);\n    console.log(state);\n  }\n\n  const validateForm = (items = state.items) => {\n    let errors = 0;\n    items.forEach(item => {\n      errors += item.errors.length;\n    });\n\n    return errors === 0;\n  }\n  \n\n  return (\n    <div>\n        { Object.values(state.items).map((i) => (\n          <MyInput key={i.id} data={i} updateFunction={updateItem} />\n        ))}\n          <IonButton  \n            key={'submitButton'}\n            onClick={submit} \n            disabled={!state.valid}\n            color=\"primary\">{options.submitButtonText}</IonButton>\n    </div>\n  )\n\n};\n\nexport default MyForm;\n\n\n\n/*\n  const attachToForm = (component) => {\n    setInputs({...inputs, ...{[component.props.name]: component}});\n    setModel({...model, ...{[component.props.name]: component.state.value}});\n  };\n\n  const detachFromForm = (component) => {\n    const i = Object.assign({}, inputs);\n    delete i[component.props.name]\n    setInputs(i);\n\n    const m = Object.assign({}, model);\n    delete m[component.props.name];\n    setModel(m);\n  }\n\n  const updateModel = () => {\n    const m = Object.assign({}, model);\n    Object.keys(inputs).forEach((name) => {\n      m[name] = inputs[name].state.value;\n    });\n\n    setModel(m);\n  }\n\n  const submit = (event) => {\n    event.preventDefault();\n    updateModel();\n    console.log(model);\n  }\n\n  const getElement = (type) => {\n    if(type === 'string'){\n      return (\n        <div>type</div>\n      )\n    }\n  }\n*/","import React from 'react';\nimport { IonButton } from '@ionic/react';\nimport './auth.css';\nimport { useLocation, useHistory } from 'react-router-dom';\n\n\n\n\n\nconst AuthMenuComponent = ({page}: {page:string}) => {\n  const location = useLocation();\n  const history = useHistory();\n  \n  const push = (url:string) => {\n    if(location.pathname && url !== location.pathname){\n      history.push(url);\n    }\n  }\n\n  return (\n    <div className=\"authMenuParent\" >\n      <IonButton  onClick={() => push('/auth/login')}\n                  size=\"small\"  \n                  color={(page==='login')? 'success':'light'}\n                  fill=\"clear\">\n          Login\n      </IonButton>\n      <IonButton   onClick={() => push('/auth/register')}\n                  size=\"small\"  \n                  color={(page==='register')? 'success':'light'}\n                  fill=\"clear\">\n          Register\n      </IonButton>\n\n    </div>\n  );\n}\nexport default AuthMenuComponent;","import React from 'react';\nimport {\n  IonIcon,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonPage\n} from \"@ionic/react\"; \nimport { logIn} from 'ionicons/icons';\nimport MyForm, { getValidator, FormItem, getFormOptions } from '../../forms/myForm';\nimport { authService } from '../authService';\nimport { useLocation, useHistory } from 'react-router';\nimport AuthMenuComponent from './auth.menu.component';\nimport './auth.css';\n\nconst LoginPage  = () => {\n  const location = useLocation();\n  const history = useHistory();\n  const options = getFormOptions({\n    submitButtongText: \"Login\"\n  });\n  \n  const form: FormItem[] = [\n    {\n      id: 'id',\n      displayName: 'ID (Username or Email): ',\n      type: 'string',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'ID needs to be between 3 to 50 characters')\n  \n      ],\n    },\n    {\n      id: 'password',\n      displayName: \"Password: \",\n      type: 'password',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'ID needs to be between 3 to 50 characters')\n      ]\n    },\n    \n  ]\n  \n  const submit = async (form) => {\n    authService.loginAndRedirect(\n        form['id'].value, \n        form['password'].value,\n        history,\n        location);\n  }\n\n\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Login</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <div style={{paddingTop:'50px'}} className=\"ion-text-center\">\n          <IonIcon icon={logIn} color=\"primary\" className=\"iconFormCenter\" />\n        </div>\n        <AuthMenuComponent page=\"login\" />\n        <div style={{padding:'20px'}}>\n          <MyForm  items={form} options={options} submitFunction={submit} /> \n        </div>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default LoginPage;\n","import React, {  } from 'react';\n\nimport {\n  IonIcon,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonPage\n} from \"@ionic/react\";\nimport { logIn} from 'ionicons/icons';\nimport MyForm, { getValidator, FormItem, getFormOptions } from '../../forms/myForm';\nimport { authService } from '../authService';\nimport { useLocation, useHistory } from 'react-router';\nimport AuthMenuComponent from './auth.menu.component';\nimport './auth.css';\n\nconst RegisterPage  = () => {\n  const location = useLocation();\n  const history = useHistory();\n  const options = getFormOptions({\n    submitButtongText: \"Login\"\n  });\n  \n  const form: FormItem[] = [\n    {\n      id: 'username',\n      displayName: 'Username: ',\n      type: 'string',\n      validators: [\n        getValidator('isLength', {min:3, max:20}, 'Username needs to be between 3 to 20 characters')\n  \n      ],\n    },\n    {\n      id: 'email',\n      displayName: 'Email: ',\n      type: 'string',\n      validators: [\n        getValidator('isEmail',{}, 'Email is not valid')\n  \n      ],\n    },\n    {\n      id: 'password',\n      displayName: \"Password: \",\n      type: 'password',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'Password needs to be between 3 to 50 characters')\n      ]\n    },\n    \n  ]\n  \n  const submit = async (form) => {\n    const res = await authService.register(\n                        form['username'].value, \n                        form['email'].value,\n                        form['password'].value);\n    if(res){\n      authService.loginAndRedirect(\n                        form['username'].value, \n                        form['password'].value,\n                        history,\n                        location)\n    }\n  }\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Register</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <div style={{paddingTop:'50px'}} className=\"ion-text-center\">\n          <IonIcon  color=\"primary\"\n                    icon={logIn} \n                    className=\"iconFormCenter\" />\n        </div>\n        <AuthMenuComponent page=\"register\" />\n        <div style={{padding:'20px'}}>\n          <MyForm  items={form} options={options} submitFunction={submit} /> \n        </div>\n\n        \n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default RegisterPage;\n","import React, { FunctionComponent } from \"react\";\nimport { Route, Redirect, useLocation } from \"react-router-dom\";\nimport LoginPage from './components/login.page';\nimport RegisterPage from './components/register.page';\n\n\nconst UnauthenticatedRoute = ({ exact, path }: \n  { component: FunctionComponent<{}>, exact: boolean, path: string }) => {\n\n  \n  const location = useLocation();\n  // const history = useHistory();\n  // const params = useParams();\n  // const path = location.pathname;\n  \n  // console.log(\"Location:::: \", location);\n  // console.log('HISTORY:::: ', history);\n  // console.log('PARAMS:::: ', params);\n\n\n  const getRoute = () => {\n    if(location.pathname === '/auth/register'){\n      return <Route path={path} \n                    component={RegisterPage} \n                    exact={exact} />;\n    }\n    else if(location.pathname === '/auth/login'){\n      return <Route\n                path='/auth/login'\n                render={() => <LoginPage />}\n              />\n    }\n    else {\n      return <Redirect to={{\n              pathname: \"/auth/login\",\n              state: {prev: location.pathname}\n            }}/>;\n    }\n  }\n  \n\n  return (\n    getRoute()\n  );\n}\n\n\n\n\n\n/*\n\n\n\n\nconst  PrivateRoute = ({ component: Component, ...rest }) => {\n\n  const [authenticated] = useUserFacade();\n  //const location = useLocation();\n\n  //console.log(location);\n\n\n  return (\n    <Route\n      {...rest}\n      render={props =>\n        authenticated ? (\n          <Component {...props} />\n        ) : (\n          <Redirect\n            to={{ pathname: \"/auth/login\"}}\n          />\n        )\n      }\n    />\n  );\n}\n*/\nexport default UnauthenticatedRoute;","import React, { useReducer, useEffect } from 'react';\nimport ulog from 'ulog'\nimport {  IonHeader, IonToolbar, IonContent,  IonButton, IonList, \n  IonItem, IonLabel, IonRange, IonIcon } from '@ionic/react';\nimport { Habit } from './models';\nimport { Line } from 'rc-progress';\nimport { useTranslation } from 'react-i18next';\nimport HeaderWithProgress from '../../components/HeaderWithProgress';\nimport { COLOR_WARNING } from '../../colors';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport { caretBackCircleOutline, caretForwardCircleOutline, caretBackOutline, caretForwardOutline } from 'ionicons/icons';\nimport { getPlantPic } from './utilsHabits';\n\n\nconst log = ulog('default');\n\nconst reducer = (state, {type, payload}) => {\n  switch(type) {\n    case 'setState': \n      return payload;\n    case 'setDoc':\n      return {...state, ...{doc: payload}}\n    default:\n      log.error('Incorrect action, ', type, payload);\n      return state;\n      \n  }\n}\n\nconst initState = {\n  doc: {}\n}\n\n\nexport const HabitPlantComponent = ({doc, position, closeFunc}: \n    {doc: Habit, position: number, closeFunc:Function}) => {\n\n  const {t} = useTranslation();\n  const [state, _dispatch] = useReducer(reducer, initState); \n\n  const dispatch = (type:   'other'|\n                            'setDoc'|\n                            'setState', payload:any = {}) => {\n  _dispatch({type, payload});\n  }\n\n  useEffect(() => {\n    dispatch('setDoc', doc);\n  }, [doc])\n\n  const positionChange = (e) => {\n    console.log(e);\n    gamifyService.changePlantPosition(doc, e.detail.value);\n  }\n\n\n  return (\n    <>\n    <IonHeader>\n      <HeaderWithProgress title=\"\" showDetail={false} />\n    </IonHeader>\n    <IonContent>\n     <IonList>\n       <IonItem>\n          <h2>{t(\"name\")}: {doc.plantName}</h2>\n       </IonItem>\n       <IonItem>\n         <IonLabel>\n           {t(\"level\")}: {doc.plantLevel}\n          </IonLabel>\n       </IonItem>\n       <IonItem>\n         <IonLabel>\n           {t(\"plants.exp\")}: {doc.plantExp}\n          </IonLabel>\n       </IonItem>\n       <IonItem>\n         <IonLabel>\n          {t(\"nextLevelReq\")}: {doc.plantNextLevelExp}\n          </IonLabel>\n       </IonItem>\n     <Line \n            style={{margin:\"20px\"}}\n            trailWidth={0}  \n            percent={(doc.plantExp/doc.plantNextLevelExp*100)} \n            strokeWidth={2} strokeColor=\"#157F1F\" />\n     </IonList>\n       <img \n        alt=\"Plant\"\n        style={{padding:\"20px\", height: '100px'}}\n        src={getPlantPic(doc)}  />\n    </IonContent>\n    <IonToolbar>\n    <IonRange \n      min={0} \n      max={370} \n      value={position}\n      onIonChange={positionChange}\n      color=\"secondary\">\n    </IonRange>\n        <IonIcon size=\"large\" slot=\"start\" icon={caretBackOutline} />\n        <IonIcon size=\"large\" slot=\"end\" icon={caretForwardOutline} />\n    <IonButton\n        slot=\"end\"\n        fill=\"solid\"\n        color={COLOR_WARNING}\n        onClick={()=> closeFunc()} >{t('close')}</IonButton>\n    </IonToolbar>\n  </>\n  )\n}\n","import React, { useState, useEffect } from 'react';\nimport { IonItem, IonCard, IonCardHeader, IonCardTitle, IonIcon, IonFab, IonFabButton, IonCardContent, IonGrid, IonRow, IonCol, IonNote, IonBadge, IonLabel, IonAlert, IonModal } from '@ionic/react';\nimport { COLOR_LIGHT, COLOR_DARK, COLOR_SUCCESS, COLOR_DANGER, COLOR_SECONDARY, COLOR_PRIMARY, COLOR_MEDIUM, COLOR_WARNING } from '../../colors';\nimport { radioButtonOff, checkmarkCircleOutline, cog } from '../../../node_modules/ionicons/icons';\nimport moment from 'moment';\nimport { Habit, MOMENT_DATE_FORMAT, HabitAction } from './models';\nimport { habitDataFunctions } from './hooks/habits.hook';\nimport './Habit.listitem.component.css';\nimport { calculateCurrentStreak, getPlantPic } from './utilsHabits';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport { toastService } from '../../modules/toast/toastService';\nimport { Line } from 'rc-progress';\nimport { HabitPlantComponent } from './habit.plant.component';\nimport { HelpTooltip } from '../../components/tooltip';\nimport { useTranslation } from 'react-i18next';\n\n\n\nconst HabitListItemComponent = ({habit, dataFunctions, showEditModalFunction}:\n  {habit:Habit, dataFunctions: habitDataFunctions, showEditModalFunction:{(habit: Habit)}}) => {\n\n  const {t} = useTranslation();\n  const [state, setState] = useState({\n    doc: new Habit(habit),\n    showPlantStats: false\n  });\n\n  useEffect(() => {\n    setState({...state, ...{doc: new Habit(habit)} });\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [habit])\n\n\n  const printDate = (index:number, active = false) => {\n    const day =  moment().subtract(index, 'day');\n    if(active)\n    {\n      return (\n        <IonLabel\n          color=\"primary\"\n        >\n        {day.format('DD')} <br /> {day.format('dd')}\n        </IonLabel>)\n    }\n    return (\n      <>\n      {day.format('DD')} <br /> {day.format('dd')}\n      </>)\n  }\n\n  const printGoal = () => {\n    if(state.doc.regularityInterval === 'day'){\n      return (\n        <IonItem>\n              <IonNote>\n                Remember, you promised that you will repeat \n                this habit <strong>every day</strong>.\n              </IonNote>\n        </IonItem>\n      )\n    }\n    \n    return (\n      <IonItem>\n        <IonNote>\n          Remember you promised that you will repeat this habit \n          <strong> {state.doc.regularityIntervalGoal} times {state.doc.regularityInterval}</strong>\n        </IonNote>\n      </IonItem>\n    )\n  }\n\n\n\n\n  const printDayIcon = (index: number, active=false) => {\n    const day = moment().subtract(index, 'day');\n\n    let action = state.doc.actions[day.format(MOMENT_DATE_FORMAT)];\n    if(!action)\n      action = {date: day.format(MOMENT_DATE_FORMAT), value: 0};\n    if(active){\n      return (<IonIcon  onClick={() => updatehabit({...action, ...{value: 1}})}\n                      size=\"large\" \n                      key={index}\n                      color={ action.value > 0? COLOR_SUCCESS:  COLOR_DARK } \n                      icon={ action.value > 0? checkmarkCircleOutline : radioButtonOff } />)\n    }\n    // @ts-ignore: undefined, but we are forsing assignment just before this\n    return (<IonIcon  \n                      size=\"large\" \n                      key={index}\n                      color={ action.value > 0? COLOR_SUCCESS:  COLOR_DANGER } \n                      icon={ action.value > 0? checkmarkCircleOutline : radioButtonOff } />)\n\n    \n  }\n\n  const updatehabit = (action: HabitAction) => {\n    try {\n      const {habit, rewards} = calculateCurrentStreak(state.doc, [action])\n      gamifyService.addRewards(rewards, habit);\n\n      console.log(habit, rewards, action)\n      dataFunctions.save(habit);\n    }\n    catch(e) {\n      toastService.printSimpleError(e.message)\n    }\n  }\n\n  const hidePlantModal = () => {\n    setState({...state, ...{showPlantStats: false}});\n  }\n  const showPlantModal = () => {\n    setState({...state, ...{showPlantStats: true}});\n  }\n  const plantModalDismissFunc = (habit: Habit|null, action:'save'|'remove'|'none') => {\n    hidePlantModal();\n    if(action === 'save' && habit != null){\n      \n    }\n    else if(action === 'remove' && habit != null && habit.id){\n      //dataFunc.remove(habit.id);\n    }\n  }\n\n  const print = () => {\n    return (\n        <IonCard>\n          <IonCardHeader>\n            {/*<IonCardSubtitle>Card Subtitle</IonCardSubtitle>*/}\n            <IonCardTitle>{state.doc.name}</IonCardTitle>\n            <IonBadge class=\"habitBadge\" color=\"success\">{state.doc.currentStreak}</IonBadge>\n            <IonBadge class=\"habitBadge\" color=\"tertiary\">{state.doc.biggestStreak}</IonBadge>\n            <HelpTooltip message={t('tooltips.havitStreakBadge')} top=\"-5px\" fontSize=\"24px\"/>\n          </IonCardHeader>\n          <IonItem>\n            <IonGrid>\n              <IonRow class=\"datecell\">\n                <IonCol>{printDate(6)}</IonCol>\n                <IonCol>{printDate(5)}</IonCol>\n                <IonCol>{printDate(4)}</IonCol>\n                <IonCol>{printDate(3)}</IonCol>\n                <IonCol>{printDate(2)}</IonCol>\n                <IonCol>{printDate(1)}</IonCol>\n                <IonCol>{printDate(0, true)}</IonCol>\n              </IonRow>\n              <IonRow class=\"datecell\">\n                <IonCol>{printDayIcon(6)}</IonCol>\n                <IonCol>{printDayIcon(5)}</IonCol>\n                <IonCol>{printDayIcon(4)}</IonCol>\n                <IonCol>{printDayIcon(3)}</IonCol>\n                <IonCol>{printDayIcon(2)}</IonCol>\n                <IonCol>{printDayIcon(1)}</IonCol>\n                <IonCol>{printDayIcon(0, true)}</IonCol>\n              </IonRow>\n            </IonGrid>\n          </IonItem>\n          <IonCardContent>\n            {printGoal()}\n          </IonCardContent>\n          <IonFab horizontal=\"end\" vertical=\"bottom\" edge>\n            <IonFabButton size=\"small\" color={COLOR_MEDIUM} onClick={() => showEditModalFunction(state.doc)}>\n              <IonIcon size=\"large\" icon={cog} />\n            </IonFabButton>\n          </IonFab>\n\n          <IonFab horizontal=\"end\" vertical=\"top\" >\n            <IonFabButton  \n                onClick={() => showPlantModal()}\n                color={COLOR_LIGHT}>\n              <IonIcon \n                class=\"habitPlantIcon\"\n                src={getPlantPic(state.doc)}  />\n            </IonFabButton>\n          </IonFab>\n\n          <IonModal isOpen={state.showPlantStats} onDidDismiss={() => hidePlantModal()}>\n            <HabitPlantComponent \n              doc={state.doc} \n              position={gamifyService.getPlantPosition(state.doc)}\n              closeFunc = {plantModalDismissFunc}  />\n          </IonModal>\n        </IonCard>\n        \n    );\n  }\n  \n  return print();\n};\n\nexport default HabitListItemComponent;\n\n","import React, { useState } from 'react';\nimport { IonItem, IonLabel, IonIcon, IonInput, IonTextarea, IonButton, IonHeader, IonTitle, IonToolbar, IonContent, IonFooter, IonButtons, IonSelect, IonSelectOption, IonRange, IonFab, IonFabButton, IonAlert, IonSegment, IonSegmentButton } from '@ionic/react';\nimport { trash } from '../../../node_modules/ionicons/icons';\nimport { Habit, habitIntervals, habitDifficulty, printDifficulty } from './models';\nimport { capitalize } from '../../utils';\nimport { COLOR_DANGER } from '../../colors';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\n\nimport './habit.css';\nimport { MarketItem } from '../../modules/market/models';\nimport { useTranslation } from 'react-i18next';\nimport { HelpTooltip } from '../../components/tooltip';\nimport { getPlantSeedPic } from './utilsHabits';\n\n\ninterface habitState {\n  regularity: {\n    interval: habitIntervals,\n    min: number,\n    max: number,\n  }\n  doc: Habit,\n  showDeleteWarrning: boolean\n}\n\nconst getRegularityValues = (interval: habitIntervals) => {\n  switch (interval) {\n    case habitIntervals.day:\n      return {interval: interval, min:1, max: 1}\n    case habitIntervals.week:\n      return {interval: interval, min:1, max: 6}\n    case habitIntervals.month:\n      return {interval: interval, min:1, max: 25}\n  }\n}\n\nconst HabitAddComponent = ({habit, dismissFunc}:\n  {habit:Habit, dismissFunc: {(habit:Habit|null, action: 'save'|'remove'|'none')}}) => {\n  \n  const {t} = useTranslation();\n  const getDefaultRegularityState: habitState = {\n    regularity: getRegularityValues(habit.regularityInterval),\n    doc: new Habit(),\n    showDeleteWarrning: false\n  }\n\n  const [state, setState] = useState<habitState>({...getDefaultRegularityState, ...{doc: habit}});\n\n  const handleChange = (e) => {\n    const newDoc = {...state.doc, ...{[e.target.name]:e.detail.value}}\n    const newState = {...state, ...{doc: newDoc}};\n    setState(newState);\n  }\n\n  const handlerRegularityValue = (e) => {\n    const newDoc = {...state.doc, ...{regularityIntervalGoal: e.detail.value}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  const handlerRegularityIntervalChange = (value) => {\n    value = value || 'day';\n    const newDoc = {...state.doc, ...{regularityInterval: value, regularityIntervalGoal: 1}};\n    const newReg = {...state.regularity, ...getRegularityValues(value)};\n    setState({...state, ...{doc:newDoc, regularity: newReg}});\n  }\n\n  const printRegularityLabel = () => {\n    if(state.doc.regularityInterval === 'day'){\n      return t('I will repeat this habit every day')\n    }\n    return t('I will repeat this habit') + \": \" +\n            state.doc.regularityIntervalGoal +\n            t(\"habits.everyinterval.\" + state.doc.regularityInterval)           \n  }\n\n  const handleDifficultyChange = (e) => {\n    const newDoc = {...state.doc, ...{difficulty: e.detail.value}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  const printDifficultyLabel = (hab: habitDifficulty): string => {\n    switch(hab) {\n      case habitDifficulty.trivial:\n        return t(\"habits.difficulty.trivial\");\n      case habitDifficulty.easy:\n        return t(\"habits.difficulty.easy\");\n      case habitDifficulty.medium:\n        return t(\"habits.difficulty.medium\");\n      case habitDifficulty.hard:\n        return t(\"habits.difficulty.hard\");\n      case habitDifficulty.extreme:\n        return t(\"habits.difficulty.extreme\");\n    }\n  }\n\n  const showRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: true}});\n  }\n\n  const hideRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: false}});\n  }\n\n  const removehabit = () => {\n    hideRemoveWarrning();\n    dismissFunc(state.doc, 'remove');\n  }\n\n  const selectSeed = (item:MarketItem):any => {\n    const newDoc = {...state.doc, ...{plantName: item.name, seedItem: item, seedId: item.id}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  if(!state.doc.seedItem){\n    selectSeed(gamifyService.getUserSeeds()[0]);\n  }\n\n\n  const print = () => {\n      return (\n      <>\n        <IonHeader>\n          <IonToolbar>\n            {/*\n            <IonButtons slot=\"start\">\n              <IonButton> <IonIcon size=\"large\" icon={arrowBack} /></IonButton>\n            </IonButtons>\n            */}\n            <IonTitle>{t(\"Add Habit\")}</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonItem>\n              <IonLabel position=\"floating\">{t(\"Name\")}</IonLabel>\n              <IonInput \n                  name=\"name\"\n                  placeholder={t(\"habits.namePlaceholder\")}\n                  onIonChange={handleChange}\n                  value={state.doc.name} />\n          </IonItem>\n          <IonItem>\n              <IonLabel position=\"floating\">{t('note')}</IonLabel>\n              <IonTextarea \n                  placeholder={t(\"habits.notePlaceholder\")}\n                  name=\"note\"\n                  onIonChange={handleChange}\n                  value={state.doc.note}></IonTextarea>\n          </IonItem>\n\n          <h3 style={{paddingLeft:'10px'}}>\n            {t('habits.regularity')}\n            <HelpTooltip top=\"5px\" message={t('tooltips.habitRegularity')} />  \n          </h3>\n\n          <IonItem>\n            <IonSegment value={state.doc.regularityInterval}\n                        onIonChange={(e) => handlerRegularityIntervalChange(e.detail.value)}>\n              <IonSegmentButton value=\"day\">\n                <IonLabel>{t(\"habits.intervalContinious.day\")}</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"week\">\n                <IonLabel>{t(\"habits.intervalContinious.week\")}</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"month\">\n                <IonLabel>{t(\"habits.intervalContinious.month\")}</IonLabel>\n              </IonSegmentButton>\n            </IonSegment>\n          </IonItem>\n\n          {(state.doc.regularityInterval !== 'day')? (\n            <>\n              <IonRange \n                    min={state.regularity.min}\n                    max={state.regularity.max}\n                    debounce={100}\n                    value={state.doc.regularityIntervalGoal}\n                    onIonChange={handlerRegularityValue}\n                    color=\"secondary\" >\n                <IonLabel slot=\"start\">{state.regularity.min}</IonLabel>\n                <IonLabel slot=\"end\">{state.regularity.max}</IonLabel>\n              </IonRange>\n            </>\n          ) : (\n          <></> )}\n          <IonItem>\n            <IonLabel>{printRegularityLabel()}</IonLabel>\n          </IonItem>\n\n\n          <h3 style={{paddingLeft:'10px'}}>\n            {t('habits.difficultyTitle')}\n            <HelpTooltip top=\"5px\" message={t('tooltips.habitDifficultry')} />  \n          </h3>\n\n          <IonRange min={0} \n                    max={4} \n                    debounce={100}\n                    value={state.doc.difficulty}\n                    onIonChange={handleDifficultyChange}\n                    color=\"secondary\">\n              <IonLabel slot=\"start\">{capitalize(printDifficulty(habitDifficulty.trivial))}</IonLabel>\n              <IonLabel slot=\"end\">{capitalize(printDifficulty(habitDifficulty.extreme))}</IonLabel>\n          </IonRange>\n\n          <IonItem> \n            <IonLabel>{printDifficultyLabel(state.doc.difficulty)}</IonLabel>\n          </IonItem>\n\n\n          {(!state.doc.id)? (\n            <>\n            <h3 style={{paddingLeft:'10px'}}>\n              {t('plants.chooseSeed')}\n              <HelpTooltip top=\"5px\" message={t('tooltips.habitsSeed')} />  \n            </h3>\n\n            <IonItem>\n              <IonLabel>{t('plants.chooseSeed')}</IonLabel>\n            </IonItem>\n            </>\n          ) : (<></>)}\n\n          {(!state.doc.id)? (\n            <div>\n              {gamifyService.getUserSeeds().map(item => {\n                return  <IonButton  key={item.name} \n                                    fill={(item.name === state.doc.plantName)?'outline':'clear'} \n                                    onClick={() => selectSeed(item)}>\n                            <IonIcon  class=\"seedSize\" src={getPlantSeedPic(item)} />\n                            <h3> {t(\"plants.names.\"+item.name)} ({item.quantity})</h3>\n                        </IonButton>\n              })}\n            </div>\n          ) : (<></>)}\n          \n              \n        </IonContent> \n\n        <IonFooter>\n          <IonToolbar>\n            <IonTitle>\n              <IonButton onClick={() => dismissFunc(state.doc, 'save')}>{t('save')}</IonButton>\n              <IonButton onClick={() => dismissFunc(null, 'none')}>{t('cancel')}</IonButton>\n            </IonTitle>\n          </IonToolbar>\n        </IonFooter>\n\n        {(state.doc.id)?(\n          <IonFab horizontal=\"end\" vertical=\"bottom\" >\n            <IonFabButton size=\"small\" color={COLOR_DANGER} onClick={() => showRemoveWarrning()}>\n              <IonIcon size=\"large\" icon={trash} />\n            </IonFabButton>\n          </IonFab>\n        ) : (<></>)}\n        \n        <IonAlert\n          isOpen={state.showDeleteWarrning}\n          onDidDismiss={() => hideRemoveWarrning}\n          header={t('warning')}\n          message={t('deleteMessage')}\n          buttons={[\n            {\n              text: t('cancel'),\n              role: 'cancel',\n              cssClass: 'secondary'\n            },\n            {\n              text: t('deleteAccept'),\n              handler: () => removehabit(),\n              cssClass: 'warning'\n            }\n          ]}\n        />\n      </>\n      );\n  }\n\n  return print();\n};\n\nexport default HabitAddComponent;\n","import React, { useReducer } from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonFabButton,\n  IonFab,\n  IonIcon,\n  IonModal} from '@ionic/react';\n\nimport { add } from '../../../node_modules/ionicons/icons';\nimport { useHabitsCollectionFacade } from './hooks/habits.hook';\nimport { Habit } from './models';\nimport HabitListItemComponent from './Habit.listitem.component';\nimport HabitAddComponent from './Habit.add.component';\nimport HeaderWithProgress from '../../components/HeaderWithProgress';\nimport { authService } from '../../modules/auth/authService';\nimport { getDefaultProject } from '../../modules/data/utilsData';\n\n\nexport interface habitPageState {\n  showModal: boolean,\n  modalHabit: Habit|null,\n}\n\nconst reducer = (state, action): habitPageState => {\n  switch(action.type) {\n    case 'showModal':\n      return {...state, ...{showModal: action.data.showModal, modalHabit: action.data.habit} }\n    case 'hideModal':\n      return state;\n    default:\n      return state;\n  }\n}\n\nexport function getAction(todo:'showModal', data = {}){\n  return {type:todo, data:data};\n}\n\n\nconst HabitsPage: React.FC = () => {\n  const [habitsState, dataFunc] = useHabitsCollectionFacade(getDefaultProject(authService.userid));\n  const [state, dispatch] = useReducer(reducer, {\n    showModal:false,\n    modalHabit: null,\n  })\n\n  const { habits } = habitsState;\n\n  const addhabit = (habit:Habit = new Habit()) => {\n    dispatch(getAction('showModal', {showModal: true, habit}));\n  }\n\n  const hidehabitModal = () => {\n    dispatch(getAction('showModal', {showModal: false, habit: null}));\n  }\n\n  const habitDismissFunc = (habit: Habit|null, action:'save'|'remove'|'none') => {\n    dispatch(getAction('showModal', {showModal: false, habit: null}));\n    if(action === 'save' && habit != null){\n      dataFunc.save(habit);\n    }\n    else if(action === 'remove' && habit != null && habit.id){\n      dataFunc.remove(habit.id);\n    }\n  }\n\n  console.log(habits);\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title=\"Habits\" />\n      <IonContent>\n        \n      <IonList>\n        {habits.map(habit => (\n              <HabitListItemComponent\n                        habit={habit} \n                        dataFunctions={dataFunc}\n                        key={habit.id} \n                        showEditModalFunction={addhabit}\n              />\n        ))}\n      </IonList>\n      {state.showModal? (\n        <IonModal isOpen={state.showModal} onDidDismiss={() => hidehabitModal()}>\n        <HabitAddComponent habit={state.modalHabit||new Habit()} \n                            dismissFunc = {habitDismissFunc}  />\n        </IonModal>\n      ) : (\n        <></>\n      )}\n      \n\n      <IonFab vertical=\"top\" horizontal=\"end\" slot=\"fixed\" edge>\n        <IonFabButton onClick={()=> addhabit()}>\n          <IonIcon icon={add} />\n        </IonFabButton>\n      </IonFab>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default HabitsPage;\n\n","import React, {  } from 'react';\nimport { IonHeader } from '@ionic/react';\nimport { useTranslation } from 'react-i18next';\n\n\n\n\n\nconst MenuHeaderWithProgress = () => {\n\n  const {t} = useTranslation();\n  \n  return (\n    <IonHeader className=\"menuHeaderWithAvatar\">\n      <h1>{t('menu')}</h1>\n    </IonHeader>\n  )\n}\n\nexport default MenuHeaderWithProgress;","import React, { useState } from 'react';\nimport { IonInput } from '@ionic/react';\nimport { ProjectItem } from '../../modules/data/models';\nimport { generateCollectionId, getProjectChildId } from '../../modules/data/utilsData';\nimport { TYPE_TODO_LIST, TodoList } from './models';\nimport ulog from 'ulog';\nimport { todoService } from './todo.service';\n\nconst log = ulog('todo');\n\n\nconst ListAddInlineComponent = ({projectid}:{projectid: string}) => {\n\n  const [state, setState] = useState({name:''});\n\n  const setNewTitle = (e) => {\n    setState({name: e.detail.value});\n  }\n  \n  const onKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      save();\n      setState({name: ''});\n    }\n  }\n\n  const save = async () => {\n    const id = generateCollectionId(projectid, TYPE_TODO_LIST, encodeURI(state.name));\n    const newList = new TodoList({\n      id,\n      name: state.name,\n      secondaryType: TYPE_TODO_LIST,\n      //folder??\n      project: getProjectChildId(projectid),\n    })\n    newList._new = true;\n\n    log.info('NEW TODO LIST::::::::::::::: ', newList)\n    const res = await todoService.saveList(newList);\n    log.info(res);\n  };\n\n  return (\n    <IonInput\n      className=\"new-todo\"\n      placeholder=\"Add new List?\"\n      onKeyPress={onKeyPress}\n      onIonChange={setNewTitle}\n      value={state.name}\n    />\n  )\n}\n\nexport default ListAddInlineComponent;","import React, { useState } from 'react'\nimport { IonItem } from '@ionic/react'\nimport Lottie from 'react-lottie';\nimport sun from '../../icons/sun.json';\nimport star from '../../icons/star.json';\nimport './todo.menu.css';\n\nexport const waitMS = (ms: number) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\nconst TodoMenuItemButtonComponet = ({name, color, icon, actonFunc}:\n  {name: string, icon: string, color:string, actonFunc:Function}) => {\n  \n  const [state, setState] = useState({isStopped:true, isPaused:true})\n  \n  \n  const defaultOptions = {\n    loop: true,\n    autoplay: true, \n    animationData: (icon === 'today')? sun : star,\n    rendererSettings: {\n      clearCanvas: true,\n      scaleMode: 'noScale',\n      preserveAspectRatio: 'xMidYMid slice'\n    }\n  }; \n  \n  const actionHandler = async() => {\n    setState({isStopped:false, isPaused:false});\n    actonFunc();\n\n    await waitMS(1000);\n    setState({isStopped:true, isPaused:true});\n  }\n  \n  \n  \n  return (\n    <IonItem  button \n        onClick={() => actionHandler()}\n        color={color}  \n        routerLink={encodeURI('/todos/tag/' + icon)} \n        routerDirection=\"none\"\n        lines=\"none\">\n    <div className =\"lottieicon\">\n      <Lottie  options={defaultOptions}\n          height={25}\n          width={25}\n          isStopped={state.isPaused}\n          isPaused={state.isStopped}/>\n    </div>\n    {name} \n</IonItem>\n  )\n}\n\nexport default TodoMenuItemButtonComponet","import React, { useReducer, useEffect } from 'react';\nimport ListAddInlineComponent from './list.inline.add.component';\nimport ulog from 'ulog';\nimport { TodoTag, TodoList, TYPE_TODO_LIST, TYPE_TODO_TAG } from './models';\nimport { dataService } from '../../modules/data/dataService';\nimport { saveIntoArray } from '../../modules/data/utilsData';\nimport { authService } from '../../modules/auth/authService';\nimport { IonList, IonItem, IonLabel, IonItemDivider, IonItemGroup, IonItemSliding, IonItemOptions, IonItemOption, IonAlert, IonIcon } from '@ionic/react';\nimport { useLocation } from 'react-router';\nimport { todoService } from './todo.service';\nimport TodoMenuItemButtonComponet from './todo.menu.item';\nimport { list } from 'ionicons/icons';\nimport { useTranslation } from 'react-i18next';\n\nconst log = ulog('todo');\n\nconst initialState:{\n  tags:TodoTag[],\n  tagsOpen: boolean\n  lists:TodoList[],\n  openLists: string[],\n  showDeleteListAlert: boolean,\n  deleteList: TodoList,\n} = {\n  tags:[],\n  tagsOpen: false,\n  lists:[],\n  openLists:[],\n  showDeleteListAlert: false,\n  deleteList: new TodoList(),\n}\n\nconst reducer =  (state = initialState, { type, payload }:{type:string, payload:any}) => {\n  switch (type) {\n\n    case 'hideDeleteAlert':\n      return { ...state, ...{ showDeleteListAlert: false} }\n\n    case 'showDeleteAlert': \n    return { ...state, ...{ showDeleteListAlert: true, deleteList: payload } }\n\n    case 'setTodoList': \n      if(payload.deleted)\n      return { ...state, ...{lists: state.lists.filter(l => l.id !== payload.id)} };\n      else\n        return { ...state, ...{lists: saveIntoArray(payload, state.lists)} };\n\n    case 'setTodoLists':\n      //find todos page\n      return { ...state, ...{ lists: payload } };\n    case 'setTags':\n      return {...state, ...{tags: payload}};\n    case 'setTag': \n      if(payload.deleted)\n        return { ...state, ...{tags: state.tags.filter(t => t.id !== payload.id)} };\n      else\n        return { ...state, ...{tags: saveIntoArray(payload, state.tags)\n                                    .sort((a,b) => (a.name > b.name)? 1 : -1)} };\n\n    default:\n      log.error('REDUCER GOT UNHANDLED TYPE ', type, payload);\n      return state\n  }\n}\n\n\nconst TodoMenuListComponent = ({projectid}: {projectid:string}) => {\n  const location = useLocation();\n  const {t} = useTranslation();\n  const path = location.pathname;\n  const [state, _dispatch] = useReducer(reducer, initialState)\n\n  const dispatch = (type: 'setTodoLists'|\n                          'setTags'|\n                          'setTag'|\n                          'hideDeleteAlert'|\n                          'showDeleteAlert'|\n                          'setTodoList', payload = {}) => {\n    _dispatch({type, payload});\n  }\n\n\n  useEffect(() => {\n    const subTodoList = dataService.subscribeProjectTypeChanges(\n      projectid, TYPE_TODO_LIST ).subscribe(change => {\n        log.info('Menu Change: ', change);\n        dispatch('setTodoList', change);\n      })\n    loadInitTodoLists(projectid);\n    const tagsList = dataService.subscribeByPropertyChange('type',\n      'todoTag' ).subscribe(change => {\n        log.info('Tags Changed: ', change);\n         dispatch('setTag', change);\n      })\n    loadInitTags();\n    return () => {\n      subTodoList.unsubscribe();\n      tagsList.unsubscribe();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [authService.userid])\n\n  const loadInitTodoLists = async (projectid:string) => {\n    const todolists = await dataService.getAllByProject(projectid,TYPE_TODO_LIST);\n    log.info(todolists);\n    dispatch('setTodoLists', todolists);\n  }\n\n  const loadInitTags = async () => {\n    const tags = await dataService.queryByProperty('name', 'startsWith', '', TYPE_TODO_TAG);\n    dispatch('setTags', tags);\n  }\n\n  const deleteList = () => {\n      todoService.deleteList(state.deleteList)\n  }\n\n\n  const tagButtonClickHandler = (tag) => {\n    console.log(tag);\n  }\n\n  return (\n    <IonList>\n      {/*}\n       <IonItem  button \n                color={(path ==='/todos/tag/today'? 'light' : '')}  \n                routerLink={encodeURI('/todos/tag/today')} \n                routerDirection=\"none\"\n                lines=\"none\">\n       \n              <IonIcon\n                size=\"large\"\n                src=\"assets/icons/sun.svg\"></IonIcon>\n            Today\n          </IonItem>\n      */}\n      <IonItemGroup key=\"listsGroup\">\n          <TodoMenuItemButtonComponet \n            name={t('todos.today')}\n            icon=\"today\"\n            color={(path ==='/todos/tag/today'? 'light' : '')}  \n            actonFunc = {() => tagButtonClickHandler('today')}\n          /> \n          <TodoMenuItemButtonComponet \n            name={t('todos.important')}\n            icon=\"important\"\n            color={(path ==='/todos/tag/important'? 'light' : '')}  \n            actonFunc = {() => tagButtonClickHandler('important')}\n          /> \n            \n          <IonItemGroup>\n            <h2>{t(\"todos.lists.title\")}</h2>\n          </IonItemGroup>    \n        {state.lists.map( listItem => (\n          <IonItemSliding key={listItem.name+'list'}>\n            <IonItem  button \n                      color={(path ==='/todos/'+listItem.name? 'light' : '')}  \n                      routerLink={encodeURI('/todos/'+listItem.name)} \n                      routerDirection=\"none\"\n                      lines=\"none\">\n              <IonLabel>\n                      <IonIcon  \n                        icon={list}/> \n                {' '+listItem.name}</IonLabel>\n            </IonItem>\n            <IonItemOptions side=\"end\">\n              <IonItemOption  color=\"danger\" \n                              onClick={() => dispatch('showDeleteAlert',list)}>\n                Delete</IonItemOption>\n            </IonItemOptions>\n          </IonItemSliding>\n        ))}\n      </IonItemGroup>\n      <IonItemDivider>\n      </IonItemDivider>\n      <ListAddInlineComponent key=\"addNewItem\" projectid={projectid} />\n\n      <IonItemGroup>\n        <h2>{t('todos.tags.title')}</h2>\n      </IonItemGroup>\n      {state.tags.filter(tag => (tag.name !== 'today' && tag.name !== 'important'))\n        .map( tagItem => (\n          <IonItemSliding key={tagItem.name+'tag'}>\n            <IonItem  button \n                      color={(path ==='/todos/tag/'+tagItem.name? 'light' : '')}  \n                      routerLink={encodeURI('/todos/tag/'+tagItem.name)} \n                      routerDirection=\"none\"\n                      lines=\"none\">\n              <IonLabel>\n                      <IonIcon  \n                        src={\"/assets/icons/tag.svg\"} /> \n                {' '+tagItem.name}</IonLabel>\n            </IonItem>\n            <IonItemOptions side=\"end\">\n              <IonItemOption  color=\"danger\" \n                              onClick={() => {console.log('No delete implemented')} }>\n                Delete</IonItemOption>\n            </IonItemOptions>\n          </IonItemSliding>\n        ))}\n\n      <IonAlert \n        isOpen={state.showDeleteListAlert}\n        onDidDismiss={() => dispatch('hideDeleteAlert')}\n        header={\"Are you sure you want to delete '\" + state.deleteList.name + \"' list?\"}\n        subHeader={'All tasks in this list will be deleted'}\n        buttons={[\n          {\n            text: 'Cancel',\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: () => dispatch('hideDeleteAlert')\n          },\n          {\n            text: 'Delete List',\n            handler: () => deleteList()\n          }\n        ]}\n      />\n    </IonList>\n  )\n\n\n\n}\n\nexport default TodoMenuListComponent;","import React, { useReducer, useEffect } from 'react';\nimport { home, apps, sunny, star, heart, basket, construct, checkmark, refresh, cog, ribbon } from 'ionicons/icons';\nimport { getDefaultProject } from '../../data/utilsData';\nimport { authService } from '../../auth/authService';\nimport ulog from 'ulog';\nimport TodoMenuListComponent from '../../../pages/todo/todo.menulist.component';\n\nconst log = ulog('menu');\n\nexport interface AppPage {\n  url: string;\n  icon: any;\n  title: string;\n  lastComponent?: any;\n}\n\n\nexport interface MenuFunctions {\n\n}\n\nexport interface MenuState {\n  projectid: string,\n  appPages: AppPage[];\n}\n\n\nexport const getMenuState = (projectid: string): MenuState => {\n  return {\n    projectid,\n    appPages: [\n      {\n        title: 'home',\n        url: '/home',\n        icon: home,\n      },\n      {\n        title: 'habitsTitle',\n        url: '/habits',\n        icon: refresh,\n      },\n      {\n        title: 'clashTitle',\n        url: '/clash',\n        icon: ribbon,\n      },\n      {\n        title: 'todosTitle',\n        url: '/todos',\n        icon: apps,\n        lastComponent: <TodoMenuListComponent projectid={projectid}  />\n      },\n      {\n        title: 'market.title',\n        url: '/market',\n        icon: basket,\n      },\n      {\n        title: 'settingsTitle',\n        url: '/settings',\n        icon: cog,\n      },\n    ]\n  }\n};\n\n\nconst reducer = (state, { type, payload }:{type:string, payload:any}):MenuState => {\n  switch (type) {\n  case 'authChange':\n    return getMenuState(getDefaultProject(authService.userid).id);\n  default:\n    log.error('REDUCER GOT UNHANDLED TYPE ', type, payload);\n    return state\n  }\n}\n\n\n\n//more simpler then auth hook, just read data\nexport function useMenuHookFacade(): [MenuState, MenuFunctions] {\n  const project = getDefaultProject(authService.userid);\n  const [state, _dispatch] = useReducer(reducer, getMenuState(project.id))\n\n  useEffect(() => {\n    const sub = authService.username$.subscribe(name => {\n      _dispatch({type: 'authChange', payload: authService.userid});\n    })\n   \n    return () => {sub.unsubscribe()};\n  }, [])\n          \n  const menuFunctions: MenuFunctions = {\n  }\n\n  return [state, menuFunctions];\n}","import {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonMenu,\n  IonMenuToggle,\n  IonGrid,\n  IonCol,\n  IonRow,\n  IonRefresherContent,\n  IonRefresher\n} from '@ionic/react';\nimport React from 'react';\nimport { withRouter, useLocation } from 'react-router-dom';\nimport MenuHeaderWithProgress from './MenuHeaderWithProgress';\nimport { useMenuHookFacade } from '../modules/menu/hooks/menu.hook';\nimport './menu.css';\nimport ulog from 'ulog'\nimport { useTranslation } from 'react-i18next';\nimport { dataService } from '../modules/data/dataService';\n\nconst log = ulog('menu')\n\nconst Menu = () => {\n\n  const [state,] = useMenuHookFacade();\n  const location = useLocation();\n  const path = location.pathname;\n  const { t } = useTranslation();\n  log.warn(path);\n  return (\n    <IonMenu key=\"ionmenu_left\" contentId=\"main\" type=\"overlay\">\n      <MenuHeaderWithProgress key=\"menu_header\" />\n      <IonContent key=\"menu_left\" >\n        <IonRefresher slot=\"fixed\" onIonRefresh={(e) => dataService.refresh(e)}>\n            <IonRefresherContent></IonRefresherContent>\n        </IonRefresher>\n        <IonGrid>\n        {state.appPages.map((appPage, index) => {\n          return (\n            <>\n              <IonRow key={appPage.title.replace(' ', '')+appPage.url + index}>\n                <IonCol class=\"leftMenuCol\">\n                <IonMenuToggle  autoHide={false}>\n                  <IonItem\n                        color={(path === appPage.url? 'light' : '')}   \n                        routerLink={appPage.url} routerDirection=\"none\">\n                    <IonIcon slot=\"start\" icon={appPage.icon} />\n                    <IonLabel>{t(appPage.title)}</IonLabel>\n                  </IonItem>\n                </IonMenuToggle>\n                </IonCol>\n              </IonRow>\n              {appPage.lastComponent? (\n                appPage.lastComponent\n              ) : (<></>)}\n            </>\n        )})}\n        </IonGrid>\n      </IonContent>\n    </IonMenu>\n)};\n\nexport default withRouter(Menu);\n","import React, { useState } from 'react';\nimport { PartyProject } from '../models';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonItem, \n  IonInput, IonLabel, IonTextarea, IonFooter, IonButton } from '@ionic/react';\nimport { useTranslation } from 'react-i18next';\n\n\n\n\nconst PartyEditComponent = ({party, dismissFunc}:\n    {party: PartyProject| null, dismissFunc:{(party: PartyProject|null, action: 'save'| 'remove' | 'none')}}) => {\n\n  const {t} = useTranslation();\n  const [state, setState] = useState({party: party||new PartyProject()})\n\n\n  const handleChange = (e) => {\n    const newDoc = {...state.party, ...{[e.target.name]:e.detail.value}}\n    const newState = {...state, ...{party: newDoc}};\n    setState(newState);\n  }\n\n\n  return (\n    <>\n      <IonHeader>\n            <IonToolbar>\n              <IonTitle>{t(\"clash.editTitle\")}</IonTitle>\n            </IonToolbar>\n      </IonHeader>\n      <IonContent>\n          <IonItem>\n                <IonLabel position=\"floating\">{t('name')}</IonLabel>\n                <IonInput \n                    name=\"name\"\n                    placeholder={t('clash.namePlaceholder')} \n                    onIonChange={handleChange}\n                    value={state.party.name} />\n            </IonItem>\n            <IonItem>\n                <IonLabel position=\"floating\">{t('note')}</IonLabel>\n                <IonTextarea \n                    placeholder={t('clash.notePlaceholder')}\n                    name=\"note\"\n                    onIonChange={handleChange}\n                    value={state.party.note}></IonTextarea>\n            </IonItem>\n            <IonFooter>\n              <IonToolbar>\n                <IonTitle>\n                  <IonButton onClick={() => dismissFunc(state.party, 'save')}>{t('save')}</IonButton>\n                  <IonButton onClick={() => dismissFunc(null, 'none')}>{t('cancel')}</IonButton>\n                </IonTitle>\n              </IonToolbar>\n            </IonFooter>\n      </IonContent>\n    </>\n  );\n}\n\nexport default PartyEditComponent;","import React, { useState, useEffect } from 'react';\nimport { PartyProject } from '../models';\nimport { IonCard, IonCardHeader, IonCardTitle, IonCardSubtitle, IonBadge } from '@ionic/react';\n\n\nconst PartyListItemComponent = ({partyProject, history,  showEditModalFunction}:\n          {partyProject:PartyProject, history, showEditModalFunction:{(party: PartyProject)}}) => {\n\n  const [state, setState] = useState({party: partyProject})\n\n  useEffect(() => {\n    setState({...state, ...{party:partyProject}});\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [partyProject])\n\n  return(\n    <IonCard>\n      <IonCardHeader onClick={() => history.push('/clash/'+ encodeURI(state.party.id||''))}>\n        <IonCardTitle>{state.party.name} \n              <IonBadge>{state.party.members.length}</IonBadge></IonCardTitle>\n        <IonCardSubtitle>{state.party.note}</IonCardSubtitle>\n      </IonCardHeader>\n    </IonCard>\n  )\n\n\n} \n\nexport default PartyListItemComponent;\n\n\n","import React, { useEffect, useReducer } from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonCard,\n  IonCardHeader,\n  IonCardTitle,\n  IonCardContent,\n  IonLabel,\n  IonModal,\n  IonItem,\n  IonRefresher,\n  IonRefresherContent,\n  IonFab,\n  IonFabButton,\n  IonIcon} from '@ionic/react';\nimport HeaderWithProgress from '../../../components/HeaderWithProgress';\nimport { authService } from '../../auth/authService';\nimport { PartyProject } from '../models';\nimport PartyEditComponent from '../components/Party.edit.component';\nimport { partyService } from '../party.service';\nimport PartyListItemComponent from '../components/Party.listitem.component';\nimport { useHistory } from 'react-router-dom';\nimport ulog from 'ulog';\nimport { dataService } from '../../data/dataService';\nimport { useTranslation } from 'react-i18next';\nimport { add } from 'ionicons/icons';\n\n\nconst log = ulog('parties');\n\nexport interface PartiesState {\n  userId: string,\n  showModal: boolean,\n  party: PartyProject|null\n  docs: PartyProject[],\n}\nconst reducer = (state, action:{type:string, data:any}): PartiesState => {\n  switch(action.type) {\n    case 'dismissEdit':\n      return {...state, ...{showModal: false, party: null}}\n    case 'edit':\n      return {...state, ...{showModal: true, party: action.data}}\n    case 'docs':\n      return {...state, ...{docs:action.data}};\n    case 'userid': \n      return {...state, ...{userId: action.data}};\n    default:\n      log.error('ERROR, INCORRECT ACTION TYPE ', action);\n      return state;\n  }\n}\n\n\n\nconst PartiesPage = () => {\n  const history = useHistory();\n  const [state, _dispatch] = useReducer(reducer, {\n    userId: '',\n    showModal: false,\n    party: new PartyProject(),\n    docs: [],\n  })\n\n  const {t} = useTranslation();\n\n  const dispatch = (type: 'userid'|\n                          'dismissEdit'|\n                          'edit'|\n                          'docs', data:any = null) => {\n      _dispatch({type, data});                      \n  }\n\n  useEffect(() => {\n    const subs = [\n      authService.username$.subscribe(username => {\n        dispatch('userid', authService.userid);\n      }),\n      partyService.state$.subscribe(changes => {\n        dispatch('docs', changes.docs);\n      }),\n\n    ]\n    return () => {\n      subs.forEach(sub => {\n        if(sub) sub.unsubscribe();\n      });\n    };\n    // eslint-disable-next-line\n  }, [])\n\n  const editParty = (party:PartyProject = new PartyProject()) => {\n    dispatch('edit', party);\n  }\n\n\n  const modalDismissFunc = (party: PartyProject|null, action:'save'|'remove'|'none') => {\n    dispatch('dismissEdit')\n    if(action === 'save' && party != null){\n      partyService.saveParty(party)\n    }\n    else if(action === 'remove' && party != null && party.id){\n      //dataFunc.remove(habit._id);\n    }\n  }\n\n  const hideModal = () => {\n    dispatch('dismissEdit');\n  }\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title={t('Clash of Farmers')} />\n      <IonContent>\n      <IonRefresher slot=\"fixed\" onIonRefresh={(e) => dataService.refresh(e)}>\n          <IonRefresherContent></IonRefresherContent>\n      </IonRefresher>\n     \n        {state.showModal? (\n          <IonModal isOpen={state.showModal} onDidDismiss={() => hideModal()}>\n            <PartyEditComponent party={state.party} \n                                dismissFunc = {modalDismissFunc}  />\n          </IonModal>\n        ) : (\n          <></>\n        )}\n        <IonCard>\n          <IonCardHeader>\n            <IonCardTitle>\n              {t('clash.header')}\n            </IonCardTitle>\n          </IonCardHeader>\n          <IonCardContent>\n          </IonCardContent>\n        </IonCard>\n        \n      <IonList>\n        {state.docs.map(party => (\n          <PartyListItemComponent partyProject={party} \n                                  history={history}\n                                  key={party.id}\n                                  showEditModalFunction={editParty} />\n        ))}  \n      </IonList>\n     \n      <IonFab vertical=\"top\" horizontal=\"end\" slot=\"fixed\" edge>\n          <IonFabButton onClick={() =>editParty()}>\n            <IonIcon icon={add} />\n          </IonFabButton>\n        </IonFab>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default PartiesPage;\n\n","import React from 'react';\nimport { PartyMember, ChallengeMember } from '../models';\nimport { IonBadge } from '@ionic/react';\nimport { COLOR_LIGHT, COLOR_SUCCESS } from '../../../colors';\nimport moment from 'moment';\nimport { MOMENT_DATE_FORMAT } from '../../../pages/habits/models';\nimport './challenge.css';\n\n\nconst ChallengeMemberScoreHistory = ({member}:\n  {member: any}) => {\n\n\n const printDay = (dateString) => {\n  let score;\n  if(member['actions'])\n    score = member['actions'][dateString];\n  else if(member['scoreHistory'])\n    score = member['scoreHistory'][dateString];\n\n  let color = COLOR_LIGHT;\n  let reward = 0;\n  if(score){\n    color = COLOR_SUCCESS;\n    if(score.reward)\n      reward = score.reward.value || score.reward;\n  }\n  if(!Number(reward)) reward = 0;\n\n\n  return <IonBadge class=\"scoreHistoryBadge\"  color={color}>{reward}</IonBadge>\n }\n\n  \n  return (\n    <>\n      {printDay(moment().subtract(6, 'd').format(MOMENT_DATE_FORMAT))}\n      {printDay(moment().subtract(5, 'd').format(MOMENT_DATE_FORMAT))}\n      {printDay(moment().subtract(4, 'd').format(MOMENT_DATE_FORMAT))}\n      {printDay(moment().subtract(3, 'd').format(MOMENT_DATE_FORMAT))}\n      {printDay(moment().subtract(2, 'd').format(MOMENT_DATE_FORMAT))}\n      {printDay(moment().subtract(1, 'd').format(MOMENT_DATE_FORMAT))}\n      {printDay(moment().subtract(0, 'd').format(MOMENT_DATE_FORMAT))}\n    </>\n  )\n\n}\nexport default ChallengeMemberScoreHistory;","import React, { useReducer, useEffect } from 'react';\nimport { PartyProject, PartyMember } from '../models';\nimport { IonCard, IonCardTitle, IonCardHeader, IonCardContent, IonList, IonItem, IonAlert, IonFooter, IonButton, IonLabel, IonBadge } from '@ionic/react';\nimport { partyService } from '../party.service';\nimport  ulog from 'ulog';\nimport { authService } from '../../auth/authService';\nimport { canEditProjectByRights } from '../../data/utilsData';\nimport { COLOR_LIGHT, COLOR_SUCCESS, COLOR_SECONDARY } from '../../../colors';\nimport ChallengeMemberScoreHistory from './Challenge.member.scoreHistory';\nimport { useTranslation } from 'react-i18next';\nconst log = ulog('memberlist');\n\nexport interface MembersState {\n  showAddModal: boolean,\n  project: PartyProject,\n}\n\n\nconst reducer = (state, action): MembersState => {\n  switch(action.type) {\n    case 'showAddMemberModal':\n      return {...state, ...{showAddModal: true}};\n    case 'hideAddMemberModal':\n      return {...state, ...{showAddModal: false}};\n    case 'setProject':\n      return {...state, project: action.data}\n    default:\n      log.error('Action type is not a match');\n      return state;\n  }\n}\n\nconst PartyMembersListComponent = ({project}:{project:PartyProject}) => {\n  const [state, _dispatch] = useReducer(reducer, {\n    showAddModal: false,\n    project,\n  })\n\n  const {t} = useTranslation();\n\n  useEffect(() => {\n    dispatch('setProject', project);\n    \n  }, [project])\n\n  const dispatch = (type: 'showAddMemberModal'|\n                          'hideAddMemberModal'|\n                          'setProject',\n                    data:any = {}) => {\n    _dispatch({type, data});\n  }\n\n  const addMember = () => {\n    dispatch(\"showAddMemberModal\");\n    \n  }\n\n  const hideAddUser = () => {\n    dispatch('hideAddMemberModal');\n  }\n\n  const canEditThisProject = () => {\n    const self = project.members.find(m => m.id === authService.userid);\n    if(!self) return false;\n    return canEditProjectByRights(self.rights);\n  }\n\n  const printScore = (score, index) =>{\n    let color = COLOR_LIGHT;\n    if(index === 0) color = COLOR_SUCCESS;\n    if(index === 1) color = COLOR_SECONDARY;\n    return <IonBadge slot=\"end\" color={color}>{score.reward}</IonBadge>\n  }\n\n  \n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>{t('social.members')}</IonCardTitle>\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n            {project.members.sort((a,b) => b.score.reward - a.score.reward)\n                            .map((member, i) => (\n          <IonItem key={member.id}>\n            <IonLabel>\n              <h2>{member.username} - \n                  <ChallengeMemberScoreHistory member={member}  />\n              </h2>\n            </IonLabel>\n              {printScore(member.score, i)}\n          </IonItem>\n            ))}\n        </IonList>\n        \n      </IonCardContent>\n      {canEditThisProject()? (\n        <IonFooter>\n          <IonButton onClick={()=>addMember()} fill=\"clear\">{t(\"invite\")}</IonButton>\n        </IonFooter>\n      ) : ( <></>)}\n      <IonAlert \n        isOpen={state.showAddModal}\n        onDidDismiss={() => hideAddUser()}\n        header= {t(\"social.friendUsername\")}\n        inputs={[\n          {\n            name: 'username',\n            type: 'text',\n            id: 'adduserid',\n          }\n        ]}\n        buttons={[\n          {\n            text: t(\"cancel\"),\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: () => {\n              hideAddUser();\n            }\n          },\n          {\n            text: t(\"social.inviteFriend\"),\n            handler: (data) => {\n              partyService.addUser(data.username, project);\n              hideAddUser();\n            }\n          }\n        ]}\n      />\n    </IonCard>\n  )\n\n}\nexport default PartyMembersListComponent;","import React, { useEffect, useReducer } from 'react';\nimport { IonItem, IonLabel, IonList, IonText, IonBadge } from '@ionic/react';\nimport { Challenge } from '../models';\nimport { COLOR_LIGHT, COLOR_SUCCESS, COLOR_SECONDARY } from '../../../colors';\nimport ChallengeMemberScoreHistory from './Challenge.member.scoreHistory';\n\n\nexport interface ChallengeLocalState {\n  challenge: Challenge,\n}\n\nconst reducer = (state, action): ChallengeLocalState => {\n  switch(action.type) {\n    case 'challenge':\n      return {...state, ...{challenge:action.data}}\n\n    default:\n      console.log('ERROR WENT TO DEFAULTS:: ', action);\n      return state;\n  }\n}\n\n\nconst ChallengeMembersItem = ({challenge}:\n  {challenge:Challenge}) => {\n\n  const [state, _dispatch] = useReducer(reducer, {\n    challenge,\n  })\n\n  const dispatch = (type:'challenge', data:any) => {\n    _dispatch({type, data});\n  }\n\n  useEffect(() => {\n    dispatch('challenge', challenge);\n  }, [challenge])\n\n  const printScore = (score, index) =>{\n    if(!score) return;\n    if(!score.reward)return;\n    let color = COLOR_LIGHT;\n    if(index === 0) color = COLOR_SUCCESS;\n    if(index === 1) color = COLOR_SECONDARY;\n    return <IonBadge slot=\"end\" color={color}>{score.reward}</IonBadge>\n  }\n\n  const print = () => {\n    return (\n      <IonList>\n        {state.challenge.members.sort((a,b)=> b.score.reward - a.score.reward)\n          .map((member, i) => (\n            <IonItem key={member.id}>\n              <IonLabel>\n                <h2>{member.username} - - \n                  <ChallengeMemberScoreHistory member={member} />\n                </h2>\n              </IonLabel>\n              {printScore(member.score, i)}\n            </IonItem>\n        ))}\n      </IonList>\n    );\n  }\n  \n  return print();\n};\n\nexport default ChallengeMembersItem;\n\n","import React, { useReducer, useEffect } from 'react';\nimport ulog from 'ulog'\nimport { IonItem, IonHeader, IonToolbar, IonTitle,  IonContent, IonButton, IonTextarea } from '@ionic/react';\nimport { ChallengeAction } from '../models';\n\n\nconst log = ulog('challenge');\n\nconst reducer = (state, {type, payload}) => {\n  switch(type) {\n    case 'setState': \n      return payload;\n    case 'setDoc':\n      return {...state, ...{doc: payload}}\n    default:\n      log.error('Incorrect action, ', type, payload);\n      return state;\n      \n  }\n}\n\n\nconst ChallengeAddActionNoteComponent = ({doc, submitFunc, closeFunc}: \n    {doc:ChallengeAction, submitFunc:Function, closeFunc:Function}) => {\n\n  const [state, _dispatch] = useReducer(reducer, {doc,}); \n  const dispatch = (type:   'other'|\n                            'setDoc'|\n                            'setState', payload:any = {}) => {\n  _dispatch({type, payload});\n  }\n\n  useEffect(() => {\n    dispatch('setDoc', doc);\n  }, [doc])\n\n  const handleChange = (e) => {\n    const newDoc = Object.assign(state.doc);\n    newDoc.data.note =  e.detail.value\n    dispatch('setDoc', newDoc);\n  }\n\n  /*\n  const handleNamedChange = (property, value) => {\n    const newDoc = {...state.doc, ...{[property]: value}}\n    dispatch('setDoc', newDoc)\n  }\n  */\n\n  return (\n  <>\n    <IonHeader>\n      <IonToolbar>\n        <IonTitle>Add Note</IonTitle>\n      </IonToolbar>\n    </IonHeader>\n    <IonContent>\n      <IonItem>\n        <IonTextarea \n          name=\"note\"\n          autofocus={true}\n          autoGrow={false}\n          spellCheck={true}\n          onIonChange={handleChange}\n          value={state.doc.data.note}\n          rows={10}\n          placeholder=\"Enter message here...\"></IonTextarea>\n      </IonItem>\n\n    </IonContent>\n    <IonToolbar>\n      <IonButton\n        onClick={()=> submitFunc({...state.doc, ...{value: 1}})}\n        fill=\"clear\">Submit</IonButton>\n      <IonButton\n        onClick={()=> closeFunc()} \n        fill=\"clear\">Cancel</IonButton>\n    </IonToolbar>\n  </>\n  )\n}\n\n\n\n\nexport default ChallengeAddActionNoteComponent;","import React, { useEffect, useReducer } from 'react';\nimport { IonItem, IonCard, IonCardHeader, IonCardTitle, IonCardContent, IonNote, IonFooter, IonButton, IonLabel, \n   IonFab, IonFabButton, IonIcon, IonAlert, IonModal } from '@ionic/react';\nimport { Challenge, ChallengeState, ChallengeType, ChallengeTypeUnit, ChallengeMember, ChallengeAction } from '../models';\nimport ulog from 'ulog';\nimport { partyService } from '../party.service';\nimport { authService } from '../../auth/authService';\nimport ChallengeMembersItem from './Challenge.members.item.component';\nimport { canEditProject } from '../../data/utilsData';\nimport { cog, checkmarkDone, readerOutline, cafeOutline, walkOutline, alarmOutline, timerOutline, rocketOutline, cashOutline, trendingDown, trendingUp } from 'ionicons/icons';\nimport { COLOR_SUCCESS, COLOR_LIGHT } from '../../../colors';\nimport ChallengeAddActionNoteComponent from './Challenge.add.note.action.component';\nimport { MOMENT_DATE_FORMAT } from '../../../pages/habits/models';\nimport moment from 'moment';\n\nconst log = ulog('clubs');\n\nexport interface ChallengeLocalState {\n  challenge: Challenge,\n  showDoneAlert: boolean,\n  memberDoc: ChallengeMember|undefined,\n  currentDate: string,\n  showBiggesGainerAcceptAlert: boolean,\n  showBiggesLooserAcceptAlert: boolean\n}\n\nconst reducer = (state, action): ChallengeLocalState => {\n  switch(action.type) {\n    case 'setMemberDoc':\n      return {...state, ...{memberDoc: action.data}};\n    case 'challenge':\n      return {...state, ...{challenge:action.data, \n                            memberDoc: action.data.members\n                            .find(m => m.id === authService.userid)}}\n    case 'showDoneAlert':\n        return {...state, ...{showDoneAlert:true, }}\n    case 'hideDoneAlert':\n        return {...state, ...{showDoneAlert:false}}\n    case 'showBiggestLooserAcceptAlert':\n        return {...state, ...{showBiggesLooserAcceptAlert:action.data}}\n    case 'showBiggestGainerAcceptAlert':\n        return {...state, ...{showBiggesGainerAcceptAlert:action.data}}\n\n    default:\n      console.log('ERROR WENT TO DEFAULTS:: ', action);\n      return state;\n  }\n}\n\n\nconst ChallengeListItemComponent = ({challenge, showEditModalFunction}:\n  {challenge:Challenge, showEditModalFunction:{(challenge: Challenge)}}) => {\n\n  const [state, _dispatch] = useReducer(reducer, {\n    challenge,\n    showDoneAlert: false,\n    showBiggesLooserAcceptAlert: false,\n    showBiggesGainerAcceptAlert: false,\n    currentDate: moment().format(MOMENT_DATE_FORMAT),\n    memberDoc: challenge.members.find(m => m.id === authService.userid)\n  })\n\n  const dispatch = (type: 'challenge'|\n                          'setMemberDoc'|\n                          'showBiggestGainerAcceptAlert'|\n                          'showBiggestLooserAcceptAlert'|\n                          'hideDoneAlert'|\n                          'showDoneAlert', data:any = {}) => {\n    _dispatch({type, data});\n  }\n\n  useEffect(() => {\n    dispatch('challenge', challenge);\n  }, [challenge])\n\n  const printTitle = () => {\n    if(state.challenge.state === ChallengeState.waiting){\n      return <IonCardTitle>{state.challenge.name} - Open to joining</IonCardTitle>\n    }\n    else if(state.challenge.state === ChallengeState.current){\n      return <IonCardTitle>{state.challenge.name} </IonCardTitle>\n    }\n    else if(state.challenge.state === ChallengeState.finished) {\n      return <IonCardTitle>{state.challenge.name} - Finished</IonCardTitle>\n    }\n    else if(state.challenge.state === ChallengeState.future) {\n      return <IonCardTitle>{state.challenge.name} - Preivew of future challenge</IonCardTitle>\n    }\n    return <IonCardTitle>{state.challenge.name}</IonCardTitle>\n  }\n\n  const printInfo = () => {\n    if(state.challenge.regularityInterval === 'day'){\n      return (\n        <IonItem>\n          <IonLabel>\n            <h2>{state.challenge.note}</h2>\n            <IonNote>\n              Challenge goal, for <strong>every day</strong>.\n            </IonNote>\n          </IonLabel>\n        </IonItem>\n      )\n    }\n    \n    return (\n      <IonItem>\n        <IonLabel>\n          <h2>{state.challenge.note}</h2>\n          <IonNote>\n            Challenge goal is for \n            <strong> {state.challenge.regularityIntervalGoal} times {state.challenge.regularityInterval}</strong>\n          </IonNote>\n        </IonLabel>\n      </IonItem>\n    )\n  }\n\n  const challengeSubmitForToday = () => {\n\n    return false;\n  }\n\n\n\n  const printActionButtons = () => {\n    if(state.challenge.state === ChallengeState.waiting && state.memberDoc === undefined){\n      if(state.challenge.challengeType === ChallengeType.looser){\n        return <IonButton size=\"small\"   fill=\"clear\"\n                    onClick={() => dispatch('showBiggestLooserAcceptAlert', true)} >\n                    Accept Challenge</IonButton>\n      }\n      else if(state.challenge.challengeType === ChallengeType.gainer){\n        return <IonButton size=\"small\"   fill=\"clear\"\n                    onClick={() => dispatch('showBiggestGainerAcceptAlert', true)} >\n                    Accept Challenge</IonButton>\n      }\n      else{\n        return <IonButton size=\"small\"   fill=\"clear\"\n                    onClick={() => partyService.acceptChallenge(state.challenge)} >\n                    Accept Challenge</IonButton>\n      }\n    }\n    else if(state.challenge.state === ChallengeState.current){\n      if(challengeSubmitForToday()) return;\n      return;\n    }\n    else if(state.challenge.state === ChallengeState.finished) {\n\n    }\n    else if(state.challenge.state === ChallengeState.future) {\n\n    }\n\n  }\n\n  const printSubmitFab = () => {\n    if(state.challenge.state === ChallengeState.current){\n      if(challengeSubmitForToday() && state.challenge.regularityEachDayGoal > 1) return;\n     return <IonFab horizontal=\"end\" vertical=\"top\" >\n              <IonFabButton onClick={() => dispatch('showDoneAlert')}\n                            color={COLOR_SUCCESS}  >\n                {printDoneIcon()}\n              </IonFabButton>\n            </IonFab>\n    }\n  }\n\n  const printEditFabButton = () => {\n    if(!canEditProject(state.challenge.id, authService.getUser())) return;\n    return <IonFab horizontal=\"end\" vertical=\"bottom\" edge>\n              <IonFabButton size=\"small\" \n                            onClick={() => showEditModalFunction(state.challenge)}\n                            color={COLOR_LIGHT}  >\n                <IonIcon size=\"large\" icon={cog} />\n              </IonFabButton>\n            </IonFab>\n  }\n\n  const printAdminActionButtons = () => {\n    if(!canEditProject(state.challenge.id, authService.getUser())) return;\n    if(state.challenge.state === ChallengeState.waiting){\n      return <>\n              <IonButton size=\"small\" fill=\"clear\"\n                onClick={() => partyService.changeChallengeState(state.challenge.id, ChallengeState.current)} >\n                Start Challenge</IonButton>\n              <IonButton size=\"small\" fill=\"clear\"\n                onClick={() => partyService.changeChallengeState(state.challenge.id, ChallengeState.waiting)} >\n                Freeze For Future Use</IonButton>\n            </>\n    }\n    else if(state.challenge.state === ChallengeState.current){\n\n    }\n    else if(state.challenge.state === ChallengeState.finished) {\n\n    }\n    else if(state.challenge.state === ChallengeState.future) {\n\n    }\n\n  }\n\n  const printDoneIcon = () => {\n    if(state.challenge.challengeType === ChallengeType.checkin)\n      return <IonIcon size=\"large\" icon={checkmarkDone} />\n    if(state.challenge.challengeType === ChallengeType.note)\n      return <IonIcon size=\"large\" icon={readerOutline} />\n    if(state.challenge.challengeType === ChallengeType.value &&\n        state.challenge.challengeTypeUnit === ChallengeTypeUnit.Cup)\n      return <IonIcon size=\"large\" icon={cafeOutline} />\n    if(state.challenge.challengeType === ChallengeType.value &&\n        state.challenge.challengeTypeUnit === ChallengeTypeUnit.Kilometer)\n      return <IonIcon size=\"large\" icon={walkOutline} />\n    if(state.challenge.challengeType === ChallengeType.value &&\n        state.challenge.challengeTypeUnit === ChallengeTypeUnit.Hour)\n      return <IonIcon size=\"large\" icon={alarmOutline} />\n    if(state.challenge.challengeType === ChallengeType.value &&\n        state.challenge.challengeTypeUnit === ChallengeTypeUnit.Minute)\n      return <IonIcon size=\"large\" icon={timerOutline} />\n    if(state.challenge.challengeType === ChallengeType.value &&\n        state.challenge.challengeTypeUnit === ChallengeTypeUnit.Dollar)\n      return <IonIcon size=\"large\" icon={cashOutline} />\n    if(state.challenge.challengeType === ChallengeType.looser)\n      return <IonIcon size=\"large\" icon={trendingDown} />\n    if(state.challenge.challengeType === ChallengeType.gainer)\n      return <IonIcon size=\"large\" icon={trendingUp} />\n\n    return <IonIcon size=\"large\" icon={rocketOutline} />\n  }\n\n\n  const closeModal = () => {\n    log.info('Close modal');\n    dispatch('hideDoneAlert');\n  }\n\n  const submitModal = (action: ChallengeAction)  => {\n    log.info('Submit modal::: ', action);\n    partyService.submitChallengeActions(state.challenge.id, [action])\n    dispatch('hideDoneAlert');\n  }\n\n  const getCurrentAction = () => {\n    if(state.memberDoc === undefined) \n      return {date: state.currentDate, value: 0, data:{}, reward: {value: 0}}\n    const cAction = state.memberDoc.actions[state.currentDate];\n    if(!cAction)\n      return {date: state.currentDate, value: 0, data:{}, reward: {value: 0}}\n    if(!cAction.data) cAction.data = {};\n    return cAction;\n  }\n\n\n\n\n  const print = () => {\n    return (\n        <IonCard>\n          <IonCardHeader>\n            {/*<IonCardSubtitle>Card Subtitle</IonCardSubtitle>*/}\n            {printTitle()}\n          </IonCardHeader>\n          <IonCardContent>\n            <ChallengeMembersItem challenge={state.challenge} />\n            {printInfo()}\n          </IonCardContent>\n          <IonFooter>\n            {printActionButtons()}\n            {printAdminActionButtons()}\n          </IonFooter>\n\n          \n          {printEditFabButton()}\n          {printSubmitFab()}\n\n          <IonModal isOpen={(state.showDoneAlert && \n              state.challenge.challengeType === ChallengeType.note)} \n              onDidDismiss={() => closeModal()}>\n            <ChallengeAddActionNoteComponent \n                  doc={getCurrentAction()} \n                  closeFunc = {() => closeModal()}\n                  submitFunc = {submitModal}  />\n            </IonModal>\n\n          \n          <IonAlert \n            isOpen={(state.showDoneAlert && state.challenge.challengeType === ChallengeType.value)}\n            onDidDismiss={() => dispatch('hideDoneAlert')}\n            header=\"Submit Action:\"\n            inputs={[\n              {\n                name: 'value',\n                type: 'number',\n                min: 0,\n                value: Number(getCurrentAction().value)+1\n              },\n            ]}\n            buttons={[\n              {\n                text: 'Cancel',\n                role: 'cancel',\n                cssClass: 'secondary',\n                handler: () => {\n                  dispatch('hideDoneAlert');\n                }\n              },\n              {\n                text: 'Submit',\n                handler: (data) => {\n                  console.log(data);\n                  dispatch('hideDoneAlert');\n                  submitModal({...getCurrentAction(), ...{value: data.value}})\n                }\n              }\n            ]}\n          />\n\n\n          <IonAlert \n            isOpen={(state.showDoneAlert && \n              (state.challenge.challengeType === ChallengeType.looser ||\n               state.challenge.challengeType === ChallengeType.gainer))}\n            onDidDismiss={() => dispatch('hideDoneAlert')}\n            header=\"Submit Current Value:\"\n            inputs={[\n              {\n                name: 'currentValue',\n                type: 'number',\n                min: 0,\n                value: Number(getCurrentAction().value)+1\n              },\n            ]}\n            buttons={[\n              {\n                text: 'Cancel',\n                role: 'cancel',\n                cssClass: 'secondary',\n                handler: () => {\n                  dispatch('hideDoneAlert');\n                }\n              },\n              {\n                text: 'Submit',\n                handler: (data) => {\n                  console.log(data);\n                  dispatch('hideDoneAlert');\n                  submitModal({...getCurrentAction(), ...{value: 1, currentValue: data.currentValue}})\n                }\n              }\n            ]}\n          />\n\n\n          <IonAlert \n            isOpen={(state.showDoneAlert && state.challenge.challengeType === ChallengeType.checkin)}\n            onDidDismiss={() => dispatch('hideDoneAlert')}\n            header=\"Submit Action:\"\n            inputs={[\n              {\n                name: 'checkbox1',\n                id: 'checkbox1',\n                type: 'checkbox',\n                label: 'Check-In',\n                value: '1',\n                checked: false\n              },\n            ]}\n            buttons={[\n              {\n                text: 'Cancel',\n                role: 'cancel',\n                cssClass: 'secondary',\n                handler: () => {\n                  dispatch('hideDoneAlert');\n                }\n              },\n              {\n                text: 'Submit',\n                handler: (data) => {\n                  console.log(data);\n                  if(data[0]){\n                    console.log('Checked in');\n                    dispatch('hideDoneAlert');\n                    submitModal({...getCurrentAction(), ...{value: 1}})\n                  }\n                  else{\n                    console.log('Failed');\n                    dispatch('hideDoneAlert');\n                  }\n                }\n              }\n            ]}\n          />\n\n\n\n          <IonAlert \n            isOpen={(state.showBiggesGainerAcceptAlert)}\n            onDidDismiss={() => dispatch('showBiggestGainerAcceptAlert', false)}\n            header=\"Submit Action:\"\n            subHeader=\"Starting value is private, only used to calculate progress.\"\n            inputs={[\n              {\n                name: 'startingValue',\n                type: 'number',\n                label: 'Starting Value',\n              },\n            ]}\n            buttons={[\n              {\n                text: 'Cancel',\n                role: 'cancel',\n                cssClass: 'secondary',\n                handler: () => {\n                  dispatch('showBiggestGainerAcceptAlert', false);\n                }\n              },\n              {\n                text: 'Submit',\n                handler: (data) => {\n                  console.log(data);\n                  if(data.startingValue){\n                    dispatch('showBiggestGainerAcceptAlert', false);\n                    partyService.acceptChallenge(state.challenge, data)\n                  }\n                  else{\n                    dispatch('showBiggestGainerAcceptAlert', false);\n                  }\n                }\n              }\n            ]}\n          />\n\n          <IonAlert \n            isOpen={(state.showBiggesLooserAcceptAlert)}\n            onDidDismiss={() => dispatch('showBiggestLooserAcceptAlert', false)}\n            header=\"Submit Action:\"\n            subHeader=\"Starting value is private, only used to calculate progress.\"\n            inputs={[\n              {\n                name: 'startingValue',\n                type: 'number',\n                label: 'Starting Value',\n              },\n            ]}\n            buttons={[\n              {\n                text: 'Cancel',\n                role: 'cancel',\n                cssClass: 'secondary',\n                handler: () => {\n                  dispatch('showBiggestLooserAcceptAlert', false);\n                }\n              },\n              {\n                text: 'Submit',\n                handler: (data) => {\n                  console.log(data);\n                  if(data.startingValue){\n                    dispatch('showBiggestLooserAcceptAlert', false);\n                    partyService.acceptChallenge(state.challenge, data)\n                  }\n                  else{\n                    dispatch('showBiggestLooserAcceptAlert', false);\n                  }\n                }\n              }\n            ]}\n          />\n\n\n        </IonCard>\n    );\n  }\n  \n  return print();\n};\n\nexport default ChallengeListItemComponent;\n\n","import React, { useState, useReducer, useEffect } from 'react';\nimport { IonItem, IonLabel, IonIcon, IonInput, IonTextarea, IonButton, \n  IonHeader, IonTitle, IonToolbar, IonContent, IonFooter, \n  IonRange, IonFab, \n  IonFabButton, IonAlert, IonSegment, IonSegmentButton, IonSelectOption, IonSelect, IonCheckbox, IonNote } from '@ionic/react';\nimport { ChallengeIntervals, Challenge, ChallengeDifficulty, ChallengeType, ChallengeTypeUnit } from '../models';\nimport { capitalize } from '../../../utils';\nimport { COLOR_DANGER, COLOR_SUCCESS, COLOR_SECONDARY, COLOR_LIGHT } from '../../../colors';\nimport { trash } from 'ionicons/icons';\nimport ulog from 'ulog';\nimport './challenge.css'\nimport { useTranslation } from 'react-i18next';\n\nconst log = ulog('party');\n\n\ninterface challengeState {\n  regularity: {\n    interval: ChallengeIntervals,\n    min: number,\n    max: number,\n  }\n  doc: Challenge,\n  showDeleteWarrning: boolean\n}\n\nconst getRegularityValues = (interval: ChallengeIntervals) => {\n  switch (interval) {\n    case ChallengeIntervals.day:\n      return {interval: interval, min:1, max: 1}\n    case ChallengeIntervals.week:\n      return {interval: interval, min:1, max: 6}\n    case ChallengeIntervals.month:\n      return {interval: interval, min:1, max: 25}\n  }\n}\n\n\nconst reducer = (state, {type, payload}): challengeState => {\n  switch(type) {\n    case 'challengeChange':\n      const newDoc = {...state.doc, ...payload}\n      return {...state, ...{doc: newDoc}};\n    case 'stateChange':\n      return payload;\n    case 'showRemoveWarrning':\n      return {...state, ...{showDeleteWarrning: true}};\n    case 'hideRemoveWarrning':\n      return {...state, ...{showDeleteWarrning: false}};\n\n    default:\n      log.error('Action type is not a match');\n      return state;\n  }\n}\n\nconst ChallengeAddComponent = ({challenge, dismissFunc}:\n  {challenge:Challenge|null, dismissFunc: {(challenge:Challenge|null, action: 'save'|'remove'|'none')}}) => {\n  const _challenge = challenge|| new Challenge();\n  const getDefaultRegularityState: challengeState = {\n    regularity: getRegularityValues(_challenge.regularityInterval),\n    doc: _challenge,\n    showDeleteWarrning: false\n  }\n  log.warn('ADDDD', challenge);\n  const [state, _dispatch] = useReducer(reducer, getDefaultRegularityState)\n\n  const {t} = useTranslation();\n  useEffect(() => {\n    log.warn('USE EFFECT ADD:: ', challenge);\n    dispatch('challengeChange', challenge);\n  }, [challenge])\n\n  const dispatch = (type: 'challengeChange'|\n                          'stateChange'|\n                          'showRemoveWarrning'|\n                          'hideRemoveWarrning',\n                    payload:any = {}) => {\n  _dispatch({type, payload});\n  }\n\n\n  const handleChange = (e) => {\n    log.info(e);\n    const newDoc = {...state.doc, ...{[e.target.name]:e.detail.value}}\n    dispatch('challengeChange', newDoc)\n  }\n\n  const handleNamedChange = (property, value) => {\n    const newDoc = {...state.doc, ...{[property]: value}}\n    dispatch('challengeChange', newDoc)\n  }\n\n  const handlerRegularityValue = (e) => {\n    console.log(e);\n    const newDoc = {...state.doc, ...{regularityIntervalGoal: e.detail.value}};\n    dispatch('challengeChange', newDoc)\n  }\n\n  const handlerRegularityIntervalChange = (value) => {\n    value = value || 'day';\n    const newDoc = {...state.doc, ...{regularityInterval: value, regularityValue: 1}};\n    const newReg = {...state.regularity, ...getRegularityValues(value)};\n    dispatch('stateChange', {...state, ...{doc:newDoc, regularity: newReg}});\n  }\n\n  const printRegularityLabel = () => {\n\n    const times = (state.doc.regularityIntervalGoal > 1)? ' times a ': ' time a ';\n    if(state.doc.regularityInterval === 'day'){\n      return 'I will repeat this task every day.'\n    }\n    \n    return 'I will repeat this task ' + state.doc.regularityIntervalGoal + times + state.doc.regularityInterval\n  }\n\n  const handleDifficultyChange = (e) => {\n    const newDoc = {...state.doc, ...{difficulty: e.detail.value}};\n    dispatch('challengeChange', newDoc)\n  }\n\n  const handleMultiplierChange = (e) => {\n    if(Number(e.detail.value) <= 0 ) return;\n    const newDoc = {...state.doc, ...{challengePointMultiplier: Number(e.detail.value)}};\n    dispatch('challengeChange', newDoc)\n  }\n\n  const printDifficultyLabel = (chdiff: ChallengeDifficulty): string => {\n    switch(chdiff) {\n      case ChallengeDifficulty.trivial:\n        return t(\"habits.difficulty.trivial\");\n      case ChallengeDifficulty.easy:\n        return t(\"habits.difficulty.easy\");\n      case ChallengeDifficulty.medium:\n        return t(\"habits.difficulty.medium\");\n      case ChallengeDifficulty.hard:\n        return t(\"habits.difficulty.hard\");\n      case ChallengeDifficulty.extreme:\n        return t(\"habits.difficulty.extreme\");\n    }\n  }\n\n  const removehabit = () => {\n    dispatch('showRemoveWarrning');\n    dismissFunc(state.doc, 'remove');\n  }\n\n\n\n  const print = () => {\n    return (\n      <>\n        <IonHeader>\n          <IonToolbar>\n            {/*\n            <IonButtons slot=\"start\">\n              <IonButton> <IonIcon size=\"large\" icon={arrowBack} /></IonButton>\n            </IonButtons>\n            */}\n            <IonTitle>{t('challenges.add')}</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonItem>\n              <IonLabel position=\"floating\">{t('name')}</IonLabel>\n              <IonInput \n                  name=\"name\"\n                  placeholder={t('challenges.namePlaceholder')} \n                  onIonChange={handleChange}\n                  value={state.doc.name} />\n          </IonItem>\n          <IonItem>\n              <IonLabel position=\"floating\">{t('note')}</IonLabel>\n              <IonTextarea \n                  placeholder={t('challenges.notePlaceholder')}\n                  name=\"note\"\n                  onIonChange={handleChange}\n                  value={state.doc.note}></IonTextarea>\n          </IonItem>\n          <IonItem>\n            <IonSegment value={state.doc.regularityInterval}\n                        onIonChange={(e) => handlerRegularityIntervalChange(e.detail.value)}>\n              <IonSegmentButton value=\"day\">\n                <IonLabel>{t(\"habits.intervalContinious.day\")}</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"week\">\n                <IonLabel>{t(\"habits.intervalContinious.week\")}</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"month\">\n                <IonLabel>{t(\"habits.intervalContinious.month\")}</IonLabel>\n              </IonSegmentButton>\n            </IonSegment>\n          </IonItem>\n\n          {(state.doc.regularityInterval !== 'day')? (\n            <>\n              <IonRange \n                    min={state.regularity.min}\n                    max={state.regularity.max}\n                    value={state.doc.regularityIntervalGoal}\n                    onIonChange={handlerRegularityValue}\n                    color=\"secondary\" >\n                <IonLabel slot=\"start\">{state.regularity.min}</IonLabel>\n                <IonLabel slot=\"end\">{state.regularity.max}</IonLabel>\n              </IonRange>\n            </>\n          ) : (\n          <></> )}\n          <IonItem>\n            <IonLabel>{printRegularityLabel()}</IonLabel>\n          </IonItem>\n\n          <IonRange min={0} \n                    max={4} \n                    debounce={100}\n                    value={state.doc.difficulty}\n                    onIonChange={handleDifficultyChange}\n                    color=\"secondary\">\n              <IonLabel slot=\"start\">{capitalize(printDifficultyLabel(ChallengeDifficulty.trivial))}</IonLabel>\n              <IonLabel slot=\"end\">{capitalize(printDifficultyLabel(ChallengeDifficulty.extreme))}</IonLabel>\n          </IonRange>\n\n          <IonItem>\n            <IonLabel>{printDifficultyLabel(state.doc.difficulty)}</IonLabel>\n          </IonItem>\n\n          <div>\n            <IonButton \n              onClick={()=>handleNamedChange('challengeType', ChallengeType.checkin)}\n              color={(state.doc.challengeType === ChallengeType.checkin)?COLOR_SUCCESS : COLOR_LIGHT} >\n                {t('challenges.types.checkin')}</IonButton>\n            <IonButton \n              onClick={()=>handleNamedChange('challengeType', ChallengeType.value)}\n              color={(state.doc.challengeType === ChallengeType.value)?COLOR_SUCCESS : COLOR_LIGHT} >\n                {t('challenges.types.value')}</IonButton>\n            <IonButton \n              onClick={()=>handleNamedChange('challengeType', ChallengeType.note)}\n              color={(state.doc.challengeType === ChallengeType.note)?COLOR_SUCCESS : COLOR_LIGHT} >\n                {t('challenges.types.note')}</IonButton>\n            <IonButton \n              onClick={()=>handleNamedChange('challengeType', ChallengeType.gainer)}\n              color={(state.doc.challengeType === ChallengeType.gainer)?COLOR_SUCCESS : COLOR_LIGHT} >\n                {t('challenges.types.gainer')}</IonButton>\n            <IonButton \n              onClick={()=>handleNamedChange('challengeType', ChallengeType.looser)}\n              color={(state.doc.challengeType === ChallengeType.looser)?COLOR_SUCCESS : COLOR_LIGHT} >\n                {t('challenges.types.looser')}</IonButton>\n          </div>\n\n          {(state.doc.challengeType === 'Value')? (\n            <>\n            <IonItem>\n                  <IonLabel>{t('habits.unitTitle')}</IonLabel>\n                  <IonSelect  value={state.doc.challengeTypeUnit}\n                              onIonChange={(e) => handleNamedChange('challengeTypeUnit', e.detail.value)}\n                              color={COLOR_SECONDARY}\n                              placeholder=\"Select One\">\n                    <IonSelectOption value=\"Cup\">{t('habits.units.cup')}</IonSelectOption>\n                    <IonSelectOption value=\"Dollar\">{t('habits.units.dollar')}</IonSelectOption>\n                    <IonSelectOption value=\"Page\">{t('habits.units.page')}</IonSelectOption>\n                    <IonSelectOption value=\"Minute\">{t('habits.units.minute')}</IonSelectOption>\n                    <IonSelectOption value=\"Hour\">{t('habits.units.hour')}</IonSelectOption>\n                    <IonSelectOption value=\"Meter\">{t('habits.units.meter')}</IonSelectOption>\n                    <IonSelectOption value=\"Kilometer\">{t('habits.units.kilometer')}</IonSelectOption>\n                    <IonSelectOption value=\"Other\">{t('habits.units.other')}</IonSelectOption>\n                  </IonSelect>               \n            </IonItem>\n            <IonItem>\n                  <IonLabel position=\"floating\">{t('habits.valueTitle')}</IonLabel>\n                  <IonInput type=\"number\" \n                            name=\"regularityEachDayGoal\"\n                            onIonChange={handleChange}\n                            value={state.doc.regularityEachDayGoal}/>\n            </IonItem>\n            </>\n          ) : (<></>)}\n          {(state.doc.challengeType === 'Value' &&\n            state.doc.challengeTypeUnit === ChallengeTypeUnit.Other)? (\n            <IonItem>\n                  <IonLabel position=\"floating\">{t('habits.unitTitle')}</IonLabel>\n                  <IonInput name=\"chalengeTypeOther\"\n                            onIonChange={handleChange}\n                            value={state.doc.chalengeTypeOther}/>\n            </IonItem>\n          ) : (<></>)}\n\n          {(state.doc.challengeType === ChallengeType.looser)? (\n            <IonItem>\n                  <IonLabel className=\"paddingDown\" position=\"floating\">\n                    <h2>{t('challenges.typesDesc.multiplier')}</h2>\n                    <IonNote  className=\"ion-text-wrap\">\n                      {t('challenges.typesDesc.looserMultiplier')}\n                    </IonNote>\n                  </IonLabel>\n                  <IonInput name=\"challengePointMultiplier\"\n                            type='number'\n                            onIonChange={handleMultiplierChange}\n                            value={state.doc.challengePointMultiplier}/>\n            </IonItem>\n          ) : (<></>)}\n\n          {(state.doc.challengeType === ChallengeType.gainer)? (\n            <IonItem>\n                  <IonLabel className=\"paddingDown\" position=\"floating\">\n                    <h2>{t('challenges.typesDesc.multiplier')}</h2>\n                    <IonNote  className=\"ion-text-wrap\">\n                      {t('challenges.typesDesc.gainerMultiplier')}\n                    </IonNote>\n                  </IonLabel>\n                  <IonInput name=\"challengePointMultiplier\"\n                            type='number'\n                            onIonChange={handleMultiplierChange}\n                            value={state.doc.challengePointMultiplier}/>\n            </IonItem>\n          ) : (<></>)}\n\n\n\n          {(state.doc.challengeType ===  ChallengeType.note)? (\n            <IonItem>\n              <IonLabel>{t('challenges.typesDesc.voteEnabled')}: </IonLabel>\n              <IonCheckbox  name = \"chalengeTypeNoteVote\"\n                            onIonChange={(e) => handleNamedChange('chalengeTypeNoteVote', e.detail.checked)}\n                            checked={state.doc.chalengeTypeNoteVote} />\n            </IonItem>\n\n          ) : (<></>)}\n        </IonContent> \n\n        <IonFooter>\n          <IonToolbar>\n            <IonTitle>\n              <IonButton onClick={() => dismissFunc(state.doc, 'save')}>{t('save')}</IonButton>\n              <IonButton onClick={() => dismissFunc(null, 'none')}>{t('cancel')}</IonButton>\n            </IonTitle>\n          </IonToolbar>\n        </IonFooter>\n        \n        {(state.doc.id)? (\n          <IonFab horizontal=\"end\" vertical=\"bottom\" >\n            <IonFabButton size=\"small\" color={COLOR_DANGER} onClick={() => dispatch('showRemoveWarrning')}>\n              <IonIcon size=\"large\" icon={trash} />\n            </IonFabButton>\n          </IonFab>\n        ) : (<></>)}\n\n\n        <IonAlert\n          isOpen={state.showDeleteWarrning}\n          onDidDismiss={() => dispatch('hideRemoveWarrning')}\n          header={t('warning')}\n          message={t('deleteMessage')}\n          buttons={[\n            {\n              text: 'Cancel',\n              role: 'cancel',\n              cssClass: 'secondary',\n              \n            },\n            {\n              text: t('deleteAccept'),\n              handler: () => removehabit()\n            }\n          ]}\n        />\n      </>\n      );\n  }\n  \n  return print();\n};\n\nexport default ChallengeAddComponent;\n","import React, { useReducer, useEffect } from 'react';\nimport { IonList, IonModal, IonCard, \n  IonCardContent, IonCardHeader, IonCardTitle, IonButton, IonFooter } from '@ionic/react';\nimport { Challenge, PartyProject, TYPE_PARTY } from '../models';\nimport ChallengeListItemComponent from './Challenge.listitem.component';\nimport ChallengeAddComponent from './Challenge.add.component';\nimport { dataService } from '../../data/dataService';\nimport { partyService } from '../party.service';\nimport { getProjectChildId, canEditProjectByRights } from '../../data/utilsData';\nimport { saveIntoArray } from '../../../utils';\nimport  ulog from 'ulog';\nimport { authService } from '../../auth/authService';\nimport { useTranslation } from 'react-i18next';\n\n//ulog.level = 7;\nconst log = ulog('challengelist');\n\n\nexport interface ChallengeListState {\n  showModal: boolean,\n  modalChallenge: Challenge|null,\n  challenges: Challenge[],\n}\n\nconst reducer = (state, action): ChallengeListState => {\n  switch(action.type) {\n    case 'addChallengeModal': \n      return {...state, ...{showModal: true, modalChallenge: action.data}}\n    case 'hideChallengeModal':\n      return {...state, ...{showModal: false, modalChallenge: null}}\n    case 'loadChallenges': \n      return {...state, ...{challenges: action.data}}\n    case 'challengeChange':\n      return {...state, ...{challenges:saveIntoArray(action.data,state.challenges)}};\n    default:\n      return state;\n  }\n}\n\n\n\n\nconst ChallengeListComponent = ({project}:{project: PartyProject}) => {\n  const [state, _dispatch] = useReducer(reducer, {\n    showModal: false,\n    modalChallenge: null,\n    challenges: [],\n  });\n\n  const {t} = useTranslation();\n  useEffect(() => {\n    const sub = dataService.subscribeByPropertyChange('secondaryType', 'challenge')\n      .subscribe(change => {\n        if(change.id.startsWith(getProjectChildId(project.id)))\n          dispatch('challengeChange', change);\n\n    });\n    if(project.id)\n      loadChallenges(project.id);\n\n    return () => {\n      sub.unsubscribe();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [project.id])\n\n  const loadChallenges = async (id: string) => {\n    const res = await dataService.queryByProperty(\n        'secondaryType', 'equals', 'challenge', TYPE_PARTY);\n    const challenges = res.filter(doc => doc.id.startsWith(getProjectChildId(id)));\n    dispatch('loadChallenges', challenges);\n  };\n\n  const dispatch = (type: 'addChallengeModal'|\n                          'loadChallenges'|\n                          'challengeChange'|\n                          'hideChallengeModal', data:any) => {\n    _dispatch({type, data});\n  }\n  \n  const addChallenge = (ch:Challenge = new Challenge()) => {\n    log.warn('Add Challenge::: ', ch);\n    dispatch('addChallengeModal', ch);\n  }\n\n  const hideChallengeModal = () => {\n    dispatch('hideChallengeModal', null);\n  }\n\n  const challengeDismissFunc = (challenge: Challenge|null, action:'save'|'remove'|'none') => {\n    hideChallengeModal();\n    if(action === 'save' && challenge != null){\n      partyService.saveChallenge(challenge, project);\n    }\n    else if(action === 'remove' && challenge != null && challenge.id){\n      // dataFunc.remove(habit.id);\n    }\n  }\n\n\n  const canEditThisProject = () => {\n    const self = project.members.find(m => m.id === authService.userid);\n    if(!self) return false;\n    return canEditProjectByRights(self.rights);\n  }\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>{t('challenges.title')}</IonCardTitle>\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n          {state.challenges.map(challenge => (\n                <ChallengeListItemComponent\n                          challenge={challenge} \n                          key={challenge.id} \n                          showEditModalFunction={addChallenge}/>\n          ))}\n        </IonList>\n          <IonModal isOpen={state.showModal} onDidDismiss={() => hideChallengeModal()}>\n          <ChallengeAddComponent challenge={state.modalChallenge} \n                              dismissFunc = {challengeDismissFunc}  />\n          </IonModal>\n\n      </IonCardContent>\n      <IonFooter>\n        {canEditThisProject()? (\n          <IonButton    onClick={() => addChallenge()}\n            fill=\"clear\">{t('challenges.add')}</IonButton>\n        ) : ( <></>)}\n      </IonFooter>\n    </IonCard>\n  )\n}\n\n\n\nexport default ChallengeListComponent;","import React, { useState, useEffect, useRef } from 'react';\nimport { IonPage, IonContent, IonRefresher, IonRefresherContent} from '@ionic/react';\nimport HeaderWithProgress from '../../../components/HeaderWithProgress';\nimport { PartyProject, TYPE_PARTY } from '../models';\nimport { useParams, useHistory } from 'react-router-dom';\nimport { dataService } from '../../data/dataService';\nimport PartyMembersListComponent from '../components/Members.list.component';\nimport ChallengeListComponent from '../components/Challenge.list.component';\nimport MessagesListComponent from '../../messages/components/Messages.list.component';\nimport { getChannelFromProjectId } from '../../data/utilsData';\nimport { useTranslation } from 'react-i18next';\n\n\n\ninterface State {\n  party:PartyProject,\n}\n\nconst getInitState = {\n    party: new PartyProject(),\n}\n\n\nconst loadParty = async (id:string, state, setState, history) => {\n\n  const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n    if(!ready) return;\n    const party = await dataService.getDoc(id, TYPE_PARTY);\n    \n    if(!party){\n      dataSub.unsubscribe();\n      history.push('/clash');\n      return\n    }\n    setState({...state, ...{party}})\n    dataSub.unsubscribe();\n  })\n  \n}\n\n//*********** Page Start *************/\nconst PartyViewPage = () => {\n  const {id} = useParams();\n  const history = useHistory();\n  const [state, setState] = useState<State>(getInitState)\n  const {t} = useTranslation();\n \n  useEffect(() => {\n    if(id)\n      loadParty(id, state, setState, history)\n    else {\n      history.push('/clash');\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id])\n  \n  useEffect(() => {\n    const idd = id || '';\n    console.log(idd, id);\n    const sub = dataService.subscribeDocChanges(idd).subscribe(change => {\n      console.log(change);\n      setState({party: change});\n    });\n    return () => {\n      sub.unsubscribe();\n    };\n  }, [id])\n\n\n\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title={t('clash.party')+\": \" + state.party.name} />\n      <IonContent>\n        <IonRefresher slot=\"fixed\" onIonRefresh={(e) => dataService.refresh(e)}>\n            <IonRefresherContent></IonRefresherContent>\n        </IonRefresher>\n      {state.party.id? (\n        <>\n          <PartyMembersListComponent  project={state.party} />\n          <ChallengeListComponent project={state.party} />\n          <MessagesListComponent channel={getChannelFromProjectId(state.party.id)} />\n        </>\n      ):(<></>)}\n\n      </IonContent>\n    </IonPage>\n  )\n}\n\nexport default PartyViewPage;","import {\n  IonPage,\n  IonContent,\n  IonList,\n  IonItem,\n  IonLabel,\n  IonSegmentButton,\n  IonSegment} from '@ionic/react';\nimport React, { useReducer, useEffect } from 'react';\nimport './Home.css';\nimport HeaderWithProgress from '../components/HeaderWithProgress';\nimport ulog from 'ulog';\nimport { authService } from '../modules/auth/authService';\nimport { dataService } from '../modules/data/dataService';\nimport { TYPE_SETTINGS } from '../modules/data/utilsData';\nimport { useTranslation } from 'react-i18next';\n\nconst log = ulog('home');\n\n\nexport interface SettingsState {\n  settingsId: string,\n  doc: any;\n}\n\nconst reducer = (state, {type, payload}:{type:string, payload:any}): SettingsState => {\n  console.log(type, payload)\n  switch(type) {\n    case 'setDoc':\n      dataService.save(payload, TYPE_SETTINGS);\n      return {...state, ...{doc: payload}};\n    case 'setSettingsId':\n      return {...state, ...{settingsId: payload}};\n    case 'setState':\n      return payload;\n    default:\n      log.error('Action Type is incorrect, default called', type, payload);\n      return state;\n  }\n}\n\nconst SettingsPage  = () => {\n\n  const [state, _dispatch] = useReducer(reducer, {\n    settingsId: '',\n    doc: {}\n  })\n\n  const {t} = useTranslation();\n\n  const dispatch = (type: 'setDoc'|\n                          'setState'|\n                          'setSettingsId',\n                    payload: any = {}) => {\n    _dispatch({type, payload});\n  }\n\n  useEffect(() => {\n    const id = dataService.getSettingsDocId();\n    log.info(id);\n    const sub = authService.username$.subscribe(() => {\n      log.info('userID changed, settingsID: ', id);\n      dispatch('setSettingsId', id);\n    });\n    dispatch('setSettingsId', id);\n    \n    return () => {\n      sub.unsubscribe();\n    };\n  }, [])\n\n  useEffect(() => {\n    log.info(state);\n    const sub = dataService.subscribeDocChanges(state.settingsId).subscribe(doc => {\n      log.info('Settings Doc Changed:::::: ', doc);\n      dispatch('setState', {...state, ...{doc}});\n    });\n    loadSettingsDoc();\n    return () => {\n      sub.unsubscribe();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.settingsId])\n\n  const loadSettingsDoc = async () => {\n    log.info('loading settings doc: ', state);\n    if(state.settingsId === \"\")return;\n    const doc = await dataService.getDoc(state.settingsId, TYPE_SETTINGS);\n    log.info(doc);\n    if(doc){\n      log.info(doc);\n      dispatch('setState', {...state, ...{doc}})\n      console.log(state);\n    }\n      \n  }\n\n  useEffect(() => {\n    console.log(state);\n  }, [state]);\n\n  const handleChange = (e) => {\n    const newDoc = {...state.doc, ...{[e.target.name]:e.detail.value}}\n    console.log(newDoc, state, e);\n    dispatch('setDoc', newDoc);\n  }\n\n  const handleDocPropertyChange = (property, value) => {\n    console.log(state);\n    if(!state.doc || !state.doc.id) return;\n    const newDoc = {...state.doc, ...{[property]:value}}\n    console.log(newDoc, state, property, value);\n    dispatch('setDoc', newDoc);\n  }\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title={t('settingsTitle')} />\n      <IonContent >\n        \n        <IonList>\n            <IonItem>\n              <IonLabel>\n                <h1> {t('auth.username')}: {authService.getUser().username} </h1>\n                <h3> {t('auth.ID')}: {authService.userid} </h3>\n                \n                {/* \n                <br/><br/>\n                Records number\n                <br /><br />\n                Change Password\n                <br /><br />*/}\n              </IonLabel>\n          </IonItem>\n              \n          <IonItem key=\"languagestring\">\n              <h2>Language: {state.doc.language}</h2>\n          </IonItem>\n          <IonItem>\n            <IonSegment \n                value={state.doc.language}\n                onIonChange={(e) => handleDocPropertyChange('language', e.detail.value)}>\n              <IonSegmentButton value=\"en\">\n                <IonLabel>English</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"zh\">\n                <IonLabel>Chinese</IonLabel>\n              </IonSegmentButton>\n            </IonSegment>\n          </IonItem>\n          <IonItem>\n            <p>{t('settings.changeLanguageRestartMessage')}</p>\n          </IonItem>\n          {/* \n          <IonItem>\n            <IonButton size=\"large\"\n              onClick={() => appService.showTutorial(true)}\n            >Show Tutorial</IonButton>\n          </IonItem>\n          */}\n        </IonList>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default SettingsPage;\n\n","import React, { useReducer, useEffect } from 'react';\nimport ulog from 'ulog'\nimport { IonContent, IonRefresher, IonRefresherContent, IonPage, IonList, IonListHeader, IonLabel, IonItem, IonAvatar, IonSegmentButton, IonSegment, IonButton, IonIcon, IonBadge } from '@ionic/react';\nimport { dataService } from '../../data/dataService';\nimport HeaderWithProgress from '../../../components/HeaderWithProgress';\nimport \"./market.css\";\nimport { gamifyService } from '../../gamify/gamifyService';\nimport { MarketItem, MarketItems } from '../models';\nimport { useTranslation } from 'react-i18next';\nimport { getPlantSeedPic } from '../../../pages/habits/utilsHabits';\n\nconst log = ulog('default');\n\nconst reducer = (state, {type, payload}) => {\n  log.log(type, payload, state);\n  switch(type) {\n    case 'setView':\n      return {...state, ...{view:payload}};\n    case 'setState': \n      return payload;\n    case 'setDoc':\n      return {...state, ...{doc: payload}}\n    default:\n      log.error('Incorrect action, ', type, payload);\n      return state;\n      \n  }\n}\n\n\nconst Market = () => {\n  const {t} = useTranslation();\n  const [state, _dispatch] = useReducer(reducer, {\n    view:'user', // user or market\n    gold: 0,\n    userItems:[], \n    marketItems:[]}); \n  \n  const dispatch = (type:   'setView'|\n                            'setDoc'|\n                            'setState', payload:any = {}) => {\n  _dispatch({type, payload});\n  }\n\n  useEffect(() => {\n    const sub = gamifyService.state$.subscribe(s => {\n      log.log('State update::: ', s)\n      if(!s.userItems) return;\n      dispatch('setState', {...state, ...{userItems:s.userItems, gold: s.gold}});\n    })\n\n    dispatch('setState', {...state, ...{userItems: gamifyService.state.userItems, \n                                        gold: gamifyService.state.gold}});\n\n    return () => {\n      sub.unsubscribe();\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.view])\n\n  const buyItem = (item:MarketItem) => {\n    gamifyService.buyItem(item);\n  }\n\n\n  return (\n  <IonPage>\n    <HeaderWithProgress title={t('market.title')} />\n    <IonContent>\n      \n      <IonRefresher slot=\"fixed\" onIonRefresh={(e) => dataService.refresh(e)}>\n        <IonRefresherContent></IonRefresherContent>\n      </IonRefresher>\n      <div>\n        <img className=\"marketPic\" src={\"/assets/pics/marketheader.svg\"}  alt=\"MarketLogo\"/>\n      </div>\n      <IonSegment value={state.view} onIonChange={e => dispatch('setView', e.detail.value)}>\n          <IonSegmentButton value=\"user\">\n            <IonLabel>{t('market.userItems')}</IonLabel>\n          </IonSegmentButton>\n          <IonSegmentButton value=\"market\">\n            <IonLabel>{t('market.marketItems')}</IonLabel>\n          </IonSegmentButton>\n      </IonSegment>\n      <IonList>\n        \n\n        {(state.view === 'user')? (\n          <>\n          <IonListHeader lines=\"inset\">\n            <IonLabel>{t('market.userItems')}</IonLabel>\n          </IonListHeader>\n          \n          {state.userItems.map(item => (\n            <IonItem key={item.id}>\n              <IonAvatar slot=\"start\">\n                <img src={getPlantSeedPic(item)} alt=\"item\" />\n              </IonAvatar>\n              <IonLabel><h2>{t('plants.names.' + item.name)}</h2></IonLabel>\n              <IonBadge slot=\"end\" color=\"primary\">\n                {item.quantity}\n              </IonBadge>\n            </IonItem>\n          ))}\n          </>\n        ) : (\n          <>\n          <IonListHeader lines=\"inset\">\n            <IonLabel>{t('market.marketItems')}</IonLabel>\n          </IonListHeader>\n          {MarketItems.map(item => (\n            <IonItem key={item.id}>\n              <IonAvatar slot=\"start\">\n                <img src={getPlantSeedPic(item)} alt=\"item\" />\n              </IonAvatar>\n              <IonLabel><h2>{t('plants.names.' + item.name)}</h2></IonLabel>\n              <IonButton  disabled={item.price > state.gold} \n                          onClick={() => buyItem(item)}\n                          slot=\"end\">\n                {t('market.buy')}<br />\n                {item.price} {t('market.gold')}\n              </IonButton>\n            </IonItem>\n  \n          ))}\n          </>\n        )}\n        \n      </IonList>\n\n\n     \n    </IonContent>\n  </IonPage>\n  )\n}\n\n\n\n\nexport default Market;","import React from 'react';\nimport { IonSlides, IonSlide, IonContent, IonImg, IonLabel, IonGrid, IonRow, IonCol } from '@ionic/react';\nimport './slides.css'\n\nexport const Slide  = ({image}:{image:string}) => (\n      <IonSlide>\n         <IonImg src={'/assets/slides/'+image} alt=\"\"  ></IonImg>\n        \n      </IonSlide>\n);\n\n","import React from 'react';\nimport { IonSlides, IonContent } from '@ionic/react';\nimport { Slide } from './Slide';\nimport { useHistory } from 'react-router-dom';\n\n// Optional parameters to pass to the swiper instance. See http://idangero.us/swiper/api/ for valid options.\nconst slideOpts = {\n  initialSlide: 1,\n  //spaceBetween: 100,\n  //speed: 40,\n  navigation: {\n    nextEl: '.swiper-button-next',\n    prevEl: '.swiper-button-prev',\n  },\n  pagination: {\n    clickable: true,\n  },\n};\n\nexport const Tutorial1: React.FC = () => {\n\n  const _slidesRef = React.createRef<any>();\n\n  const history = useHistory();\n  \n  const nextSlide = () => {\n    console.log('Next');\n    _slidesRef.current.slideNext()\n  }\n\n  const prevSlide = () => {\n    console.log('Prev');\n    _slidesRef.current.slidePrev()\n  }\n\n  const onSlideFinish = () => {\n    console.log('slide finished')\n    history.push('/');\n  }\n\n\n  return <IonContent>\n    <IonSlides \n      ref={_slidesRef}\n      pager={true} \n      scrollbar={true} \n      onIonSlideReachEnd={onSlideFinish}\n      options={slideOpts}>\n\n      <Slide image=\"1.png\" ></Slide>\n      <Slide image=\"2.png\"></Slide>\n      <Slide image=\"3.png\"></Slide>\n      <Slide image=\"4.png\"></Slide>\n      <Slide image=\"5.png\"></Slide>\n      <Slide image=\"6.png\"></Slide>\n    </IonSlides>\n    <div onClick={()=>prevSlide()} className=\"swiper-button-prev\">\n\n    </div>\n    <div onClick={()=>nextSlide()} className=\"swiper-button-next\"></div>\n  </IonContent>\n};\n\n","import React, {  } from 'react';\nimport { Redirect, Route, useHistory, useLocation } from 'react-router-dom';\nimport UserPage from './modules/auth/components/user.page';\nimport TodosPage from './pages/todo/Todos.page';\nimport IntroPage from './modules/auth/components/intro.page';\nimport { useAppStatus, AppStatus } from './modules/app/hooks/appStatus.hook';\nimport Home from './pages/Home';\nimport NotFound from './pages/NotFound';\nimport UnauthenticatedRoute from './modules/auth/unauthenticatedRoute';\nimport HabitsPage from './pages/habits/Habits.page';\nimport { IonSplitPane, IonRouterOutlet } from '../node_modules/@ionic/react';\nimport Menu from './components/Menu';\nimport PartiesPage from './modules/parties/pages/Parties.page';\nimport PartyViewPage from './modules/parties/pages/Party.view.page';\nimport SettingsPage from './pages/Settings';\nimport Market from './modules/market/pages/market';\nimport { Tutorial1 } from './components/slides/tutorial1';\n\nexport const Routes = () => {\n  const [appStatus] = useAppStatus();\n  const history = useHistory();\n  const location = useLocation();\n\n  if(appStatus.status === AppStatus.auth && location.pathname.startsWith('/auth/')){\n    if(location.state){\n      const newpath = location.state['prev'] || '/';\n      history.push(newpath);\n    }\n  }\n  \n  const getRoutes = () => {\n    switch(appStatus.status){\n      case AppStatus.auth:\n        return (\n          <IonSplitPane when=\"sm\" contentId=\"main\">\n            <Menu key=\"menumain\"/>\n            <IonRouterOutlet id=\"main\">\n                <Route path=\"/home\" component={Home} exact={true} /> \n                <Route path=\"/tutorialslides\" component={Tutorial1} exact={true} /> \n                <Route path=\"/settings\" component={SettingsPage} exact={true} />    \n                <Route path=\"/market\" component={Market} exact={true} />       \n                <Route exact path=\"/auth/user\" component={UserPage} />\n                <Route path=\"/todos\" component={TodosPage} exact={true} />\n                <Route path=\"/todos/:list\" component={TodosPage} exact={true} />\n                <Route path=\"/todos/tag/:tag\" component={TodosPage} exact={true} />\n                <Route path=\"/habits\" component={HabitsPage} exact={true} />\n                <Route path=\"/clash\" component={PartiesPage} exact={true} />\n                <Route path=\"/clash/:id\" component={PartyViewPage} exact={true} />\n                <Route path=\"/\" render={() => <Redirect to=\"/home\" />} exact={true} />\n                <Route path=\"/404\" component={NotFound} />\n                <Redirect to=\"/404\" />\n            </IonRouterOutlet>\n        </IonSplitPane>\n        )\n      case AppStatus.guest:\n          return (\n            <IonRouterOutlet>\n              <UnauthenticatedRoute exact path=\"*\" component={Home} />\n            </IonRouterOutlet>\n          );\n      default:\n          return (\n            <IonRouterOutlet>\n              <Route exact path=\"*\"  component={IntroPage} />\n            </IonRouterOutlet>\n          );\n      \n\n    }\n  }\n\n  return getRoutes();\n}","import React, { useState, useEffect } from 'react';\nimport { Subscription } from 'rxjs';\nimport { toastService, ToastMessage } from './toastService';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nexport const Toasts: React.FC = () => {\n  const [message, setMessage] = useState<ToastMessage | null>(null);\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      toastService.messages$.subscribe((m: ToastMessage) =>{\n        setMessage(m);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[message]);\n\n  return (\n    <div className='toastDiv' >\n      <ToastContainer\n          position=\"top-right\"\n          autoClose={5000}\n          hideProgressBar\n          newestOnTop={false}\n          closeOnClick\n          rtl={false}\n          draggable\n          pauseOnHover\n          />\n    </div>\n  );\n};","import React, { useReducer, useEffect } from 'react';\nimport ulog from 'ulog'\nimport { IonModal } from '@ionic/react';\nimport { appService, AppServiceState } from './appService';\nimport { Tutorial1 } from '../../components/slides/tutorial1';\n\n\nconst log = ulog('modals');\n\nconst reducer = (state, {type, payload}):AppServiceState => {\n  switch(type) {\n    case 'setState': \n      return payload;\n    case 'setDoc':\n      return {...state, ...{doc: payload}}\n    default:\n      log.error('Incorrect action, ', type, payload);\n      return state;\n      \n  }\n}\n\n\nconst AppModals: React.FC = () => {\n\n  const [state, _dispatch] = useReducer(reducer, appService.state); \n\n  const dispatch = (type:   'other'|\n                            'setDoc'|\n                            'setState', payload:any = {}) => {\n  _dispatch({type, payload});\n  }\n\n\n\n  useEffect(() => {\n    const sub = appService.state$.subscribe(state => {\n      console.log('App State Change::: ', state);\n      dispatch('setState', state);\n    });\n    return () => {\n      sub.unsubscribe();\n    }\n  }, [])\n\n\n  return (\n    <>\n      {state.showTutorial? (\n        <IonModal isOpen={state.showTutorial} onDidDismiss={() => appService.showTutorial(false)}>\n          <Tutorial1   />\n        </IonModal>\n      ) : (\n        <></>\n      )}\n    </>\n  )\n}\n\n\n\n\nexport default AppModals;","import React from 'react';\nimport { IonApp } from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\n\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\n\nimport './theme/my.css';\n\nimport { Loading } from './modules/loading/loading.component';\nimport { Routes } from './routes';\nimport { Toasts } from './modules/toast/toast.component'; \nimport AppModals from './modules/app/AppModals';\n\n\n\n\n\nconst App: React.FC = () => (\n  <IonApp>\n    <IonReactRouter>\n        <Loading /><Toasts /><AppModals />\n        <Routes />\n    </IonReactRouter>\n  </IonApp>\n);\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport { I18nextProvider } from 'react-i18next';\nimport * as serviceWorker from './serviceWorker';\n\nimport i18n from './i18n';\n\nReactDOM.render(\n  <I18nextProvider i18n={i18n}>\n     <App />\n  </I18nextProvider>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}