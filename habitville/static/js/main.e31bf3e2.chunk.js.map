{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","pages/habits/models.ts","modules/loading/loadingService.ts","modules/loading/loading.component.tsx","modules/auth/components/user.page.tsx","modules/data/models.ts","env.ts","utils.ts","pages/habits/utilsHabits.ts","modules/data/utilsData.ts","modules/parties/models.ts","pages/todo/models.ts","pages/todo/todo.new.component.tsx","pages/todo/todo.edit.inline.component.tsx","modules/data/adapters/dexie.ts","modules/toast/toastService.ts","modules/localStorage/localStorageService.ts","modules/ajax/ajax.ts","modules/auth/authService.ts","modules/data/sync.ts","modules/data/dataService.ts","modules/messages/models.ts","modules/social/models.ts","modules/gamify/utilsGamify.ts","modules/gamify/gamifyService.ts","components/animatedIcon.tsx","pages/todo/Todo.listitem.component.tsx","pages/todo/todo.service.ts","pages/todo/hooks/todos.hook.ts","modules/app/hooks/appStatus.hook.ts","components/HeaderWithProgress.tsx","pages/todo/Todos.page.tsx","modules/auth/components/intro.page.tsx","modules/parties/party.service.ts","modules/social/social.service.ts","modules/social/components/Friends.list.component.tsx","modules/messages/components/Messages.list.component.tsx","pages/Home.tsx","pages/NotFound.tsx","modules/forms/myInput.tsx","modules/forms/myForm.tsx","modules/auth/components/auth.menu.component.tsx","modules/auth/components/login.page.tsx","modules/auth/components/register.page.tsx","modules/auth/unauthenticatedRoute.tsx","pages/habits/habits.service.ts","colors.ts","pages/habits/Habit.listitem.component.tsx","pages/habits/Habit.add.component.tsx","pages/habits/Habits.page.tsx","pages/habits/hooks/habits.hook.ts","components/MenuHeaderWithProgress.tsx","pages/todo/list.inline.add.component.tsx","pages/todo/todo.menu.item.tsx","pages/todo/todo.menulist.component.tsx","modules/menu/hooks/menu.hook.tsx","components/Menu.tsx","modules/parties/components/Party.edit.component.tsx","modules/parties/components/Party.listitem.component.tsx","modules/messages/messages.service.ts","modules/parties/components/Party.invites.component.tsx","modules/parties/pages/Parties.page.tsx","modules/parties/components/Members.list.component.tsx","modules/parties/components/Challenge.listitem.component.tsx","modules/parties/components/Challenge.add.component.tsx","modules/parties/components/Challenge.list.component.tsx","modules/parties/pages/Party.view.page.tsx","routes.tsx","modules/toast/toast.component.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","habitStage","habitIntervals","habitDifficulty","loadingService","_loading","loading$","BehaviorSubject","show","this","msg","next","Loading","useState","state","setState","useEffect","subscriptions","subscribe","res","it","unsubscribe","isOpen","message","UserPage","Doc","String","fromCharCode","values","undefined","name","deleted","created","Date","now","updated","type","dirty","assign","ProjectItem","note","access","printDifficulty","hab","trivial","easy","medium","hard","extreme","Habit","stage","current","difficulty","regularityInterval","day","regularityValue","regularityEachDayGoal","progress","currentStreak","bestStreak","newRewards","ulog","level","TRACE","detail","process","REACT_APP_STAGE","SYNC_SERVER","AUTH_API_URL","console","log","env","APP_ID","ACCESS_META_KEY","TOKEN_EXPIRATION","capitalize","s","charAt","toUpperCase","slice","getNested","obj","args","reduce","saveIntoArray","item","ary","idKey","i","getIndexById","length","saveIntoDocList","filter","d","clamp","val","max","min","getInitGamifyRewards","base","gold","experience","getStreakByWeek","weeksBack","firstDayOfWeek","firstDay","moment","streak","isSame","add","subtract","getProgressValueByDate","getProgressDate","getStreakByMonth","monthsBack","date","currentDay","format","withinWeekBuffer","buffer","offset","isAfter","calculateHabitStreakByMonth","bufferSize","currentBiggestStreak","cont","currentValue","calculateHabitStreakByWeek","calculateDailyHabitStreak","getProgressDateBySubtract","value","generateUserChannelId","userid","getDefaultProject","uuid","generateProjectUUID","genrateMetaData","generateUUID","ok","shortid","generate","substring","getProjectChildId","getChannelFromProjectId","app","generateCollectionId","projectid","collection","replace","waitMS","ms","setTimeout","ChallengeStage","ChallengeDifficulty","ChallengeIntervals","canEditProject","rights","getDefaultTodoList","project","TodoList","folder","icon","secondaryType","fullname","color","_new","getDefaultTodoTag","TodoTag","animatedIcon","Todo","done","list","tags","parent","subTodos","showSubTodos","showDone","doneRewards","TodoNewComp","tag","saveFunc","projectId","title","save","a","warn","newDoc","push","className","placeholder","onKeyPress","key","onIonChange","getDefaultState","todo","tagDocs","showDeleteWarrning","text","mergeText","TodoEditInlineComponent","dataFunctions","error","hideRemoveWarrning","handleTagChange","newtags","find","t","_","concat","includes","fill","size","onClick","src","printTag","class","autoGrow","onIonBlur","match","exec","index","newState","select","close","trash","onDidDismiss","header","buttons","role","cssClass","handler","remove","DexieAdapter","scheme","db","_ready","ready$","_subscriptions","changes$","Subject","Dexie","stores","tables","forEach","columns","version","_init","open","_subscribe","sub","get","bulkGet","doc","field","operator","where","equals","toArray","docs","startsWith","notEqual","setDirty","put","bulkPut","ToastType","PartyProject","creator","members","moneyTypeSingle","moneyTypeMultiple","moneyColor","Challenge","waiting","localStorageService","localStorage","getItem","JSON","parse","str","stringify","setItem","getAjaxMessage","success","data","status","errors","getPostRequest","url","form","options","getErrorMessage","location","post","showLoading","loadingMessage","axios","hideLoading","response","AuthStatus","toastService","messages$","default","milliseconds","toast","autoClose","duration","err","showMessage","anylogger","getUser","username","email","token","token_expiery","channels","expires","isGuest","user","getGuestUser","authService","_user","_authStatus","authStatus$","username$","loadAuth","User","forceLogout","setAuthStatus","setObject","isEqual","Guest","info","getObject","updateUser","password","history","prev","printServerErrors","organizeData","channel","split","checkpoints","syncData","props","syncurl","checkpoint","chpoints","types","databaseScheme","sync","dataService","authId","_ready$","addSyncCall$","pipe","throttleTime","_syncRemote","getDoc","getBulk","queryByProperty","getProjectItems","remoteSync","oldDoc","getToken","gotNewRightsToken","renewToken","tokenres","doc2","doctype","channelid","debounce","asObservable","debounceTime","change","property","projectChildId","authid","syncRemote","dbSub","ready","Number","requestMaxSize","saveFromSync","calculateLevelExperience","exp","x","Math","floor","pow","calculateDoneTodoGold","days","diff","rew","TODO_DONE_GOLD_REWARDS","calculateDoneTodoExperience","TODO_DONE_EXPERIENCE_REWARDS","gamifyService","_userId","_state","health","maxHealth","maxExperience","items","state$","calculateFinishedTodoRewards","addGold","messageReceivedGold","addExperience","messageReceivedExperience","messageLostGold","messageLostExperience","calculateNewTodo","calculateNewHabitRewards","habit","dataSub","getReadySub","loadInitDocs","_save","sub2","subscribeDocChanges","getGamifyDocId","equal","prog","reward","round","preMessage","postMessage","initEqual","ts","red","AnimatedIcon","iconsvg","actionFunc","isStopped","isPaused","defaultOptions","loop","autoplay","render","animationData","rendererSettings","clearCanvas","scaleMode","preserveAspectRatio","actionHandler","height","width","reducer","payload","TodoListItemComp","selectedTodo","lastChild","useReducer","_dispatch","dispatch","doneHandler","handleSelectTodo","printEdit","button","lines","slot","restart","check","sort","printSmallTagFromFullname","TodoService","_projectid","doneTodos","_subscription","listName","tagName","getTags","reloadTodos","subscribeProjectTypeChanges","filterAndSaveTodos","filtered","filterDoneParentFunction","todoId","parentId","parentTodo","addSubTodoToParent","printSimpleError","saveRes","removeSubTodoFromParent","today","sun","important","star","todoService","AppStatus","HeaderWithProgress","style","right","alt","top","heart","trailWidth","percent","strokeWidth","strokeColor","leaf","TodosPage","useLocation","params","useParams","pathname","useRef","selectList","changeDoneFilter","init","useTodosCollectionFacade","dataFunc","IntroPage","initPartyState","partyService","subscribeChanges","party","partyProject","_createParty","saveNewProject","challenge","_createChallenge","saveSystemDoc","msgId","replied","accepted","newMsg","initSocialState","friends","socialService","_userid","action","showAddModal","FriendsListComponent","hideAddUser","member","inputs","addFriend","messages","MessagesListComponent","loadMsgs","subscribeChannelTypeChanges","getAllByChannel","msgs","b","printMessageIcon","messageType","mail","personAdd","printMessage","timestamp","m","unix","fromNow","printDateRelative","Home","NotFound","padding","MyInput","updateFunction","position","displayName","hasValidation","event","target","printErrors","submitButtonText","getFormOptions","settings","getValidator","MyForm","submitFunction","valid","initForm","model","Array","isArray","validateItem","validators","validateForm","updateItem","validate","findById","validator","isEmpty","isLength","isEmail","disabled","AuthMenuComponent","page","useHistory","LoginPage","submitButtongText","submit","loginAndRedirect","paddingTop","logIn","RegisterPage","register","UnauthenticatedRoute","exact","path","component","to","getInitHabitsState","selected","habits","stageFilter","HabitsService","_project","_docs","docs$","getAllByProject","filterhabits","filterFunction","HabitListItemComponent","showEditModalFunction","setDoc","printDate","active","printDayIcon","updatehabit","checkmarkCircleOutline","radioButtonOff","newProgress","progresslist","calculateHabitProgressRewards","h","week","month","calculateCurrentStreak","horizontal","vertical","edge","cog","getRegularityValues","interval","HabitAddComponent","dismissFunc","getDefaultRegularityState","regularity","handleChange","handlerRegularityValue","handleDifficultyChange","newReg","handlerRegularityIntervalChange","times","printRegularityLabel","printDifficultyLabel","showModal","modalHabit","getAction","HabitsPage","habitsService","changeStageFilter","getProject","useHabitsCollectionFacade","habitsState","addhabit","MenuHeaderWithProgress","ListAddInlineComponent","encodeURI","newList","saveList","TodoMenuItemButtonComponet","actonFunc","routerLink","routerDirection","initialState","tagsOpen","lists","openLists","showDeleteListAlert","deleteList","l","TodoMenuListComponent","subTodoList","loadInitTodoLists","todolists","side","subHeader","getMenuState","sunny","checkmark","basket","construct","appPages","home","refresh","bonfire","apps","lastComponent","withRouter","useMenuHookFacade","contentId","appPage","autoHide","PartyEditComponent","PartyListItemComponent","initMessageState","messageService","PartyInvitesListComponent","getMessages","getGlobalPartyMessages","from","printHeading","last","printNote","acceptPartyInvitation","rejectPartyInviation","printAcceptRejectButtons","userId","PartiesPage","subs","changes","editParty","saveParty","PartyMembersListComponent","self","canEditThisProject","addUser","ChallengeListItemComponent","ChallengeAddComponent","_challenge","chdiff","modalChalleng","challenges","ChallengeListComponent","modalChallenge","subscribeByPropertyChange","loadChallenges","addChallenge","ch","hideChallengeModal","saveChallenge","getInitState","loadParty","PartyViewPage","Routes","loading","dataReady","appStatus","setAppStatus","setStatusFunction","getIsAuthenticated","getUsername","guest","auth","useAppStatus","newpath","when","getRoutes","Toasts","setMessage","hideProgressBar","newestOnTop","closeOnClick","rtl","draggable","pauseOnHover","App","Boolean","window","hostname","ReactDOM","document","getElementById","navigator","serviceWorker","registration","unregister"],"mappings":"6ytCAAA,IAAIA,EAAM,CACT,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,qBAAsB,CACrB,IACA,IAED,uCAAwC,CACvC,IACA,IAED,sCAAuC,CACtC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,mCAAoC,CACnC,IACA,IAED,kCAAmC,CAClC,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BA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","file":"static/js/main.e31bf3e2.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet-ios.entry.js\": [\n\t\t328,\n\t\t37\n\t],\n\t\"./ion-action-sheet-md.entry.js\": [\n\t\t329,\n\t\t38\n\t],\n\t\"./ion-alert-ios.entry.js\": [\n\t\t330,\n\t\t21\n\t],\n\t\"./ion-alert-md.entry.js\": [\n\t\t331,\n\t\t22\n\t],\n\t\"./ion-app_8-ios.entry.js\": [\n\t\t332,\n\t\t10\n\t],\n\t\"./ion-app_8-md.entry.js\": [\n\t\t333,\n\t\t11\n\t],\n\t\"./ion-avatar_3-ios.entry.js\": [\n\t\t334,\n\t\t39\n\t],\n\t\"./ion-avatar_3-md.entry.js\": [\n\t\t335,\n\t\t40\n\t],\n\t\"./ion-back-button-ios.entry.js\": [\n\t\t336,\n\t\t41\n\t],\n\t\"./ion-back-button-md.entry.js\": [\n\t\t337,\n\t\t42\n\t],\n\t\"./ion-backdrop-ios.entry.js\": [\n\t\t338,\n\t\t79\n\t],\n\t\"./ion-backdrop-md.entry.js\": [\n\t\t339,\n\t\t80\n\t],\n\t\"./ion-button_2-ios.entry.js\": [\n\t\t340,\n\t\t43\n\t],\n\t\"./ion-button_2-md.entry.js\": [\n\t\t341,\n\t\t44\n\t],\n\t\"./ion-card_5-ios.entry.js\": [\n\t\t342,\n\t\t45\n\t],\n\t\"./ion-card_5-md.entry.js\": [\n\t\t343,\n\t\t46\n\t],\n\t\"./ion-checkbox-ios.entry.js\": [\n\t\t344,\n\t\t47\n\t],\n\t\"./ion-checkbox-md.entry.js\": [\n\t\t345,\n\t\t48\n\t],\n\t\"./ion-chip-ios.entry.js\": [\n\t\t346,\n\t\t49\n\t],\n\t\"./ion-chip-md.entry.js\": [\n\t\t347,\n\t\t50\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t348,\n\t\t81\n\t],\n\t\"./ion-datetime_3-ios.entry.js\": [\n\t\t349,\n\t\t17\n\t],\n\t\"./ion-datetime_3-md.entry.js\": [\n\t\t350,\n\t\t18\n\t],\n\t\"./ion-fab_3-ios.entry.js\": [\n\t\t351,\n\t\t51\n\t],\n\t\"./ion-fab_3-md.entry.js\": [\n\t\t352,\n\t\t52\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t353,\n\t\t82\n\t],\n\t\"./ion-infinite-scroll_2-ios.entry.js\": [\n\t\t354,\n\t\t35\n\t],\n\t\"./ion-infinite-scroll_2-md.entry.js\": [\n\t\t355,\n\t\t36\n\t],\n\t\"./ion-input-ios.entry.js\": [\n\t\t356,\n\t\t53\n\t],\n\t\"./ion-input-md.entry.js\": [\n\t\t357,\n\t\t54\n\t],\n\t\"./ion-item-option_3-ios.entry.js\": [\n\t\t358,\n\t\t55\n\t],\n\t\"./ion-item-option_3-md.entry.js\": [\n\t\t359,\n\t\t56\n\t],\n\t\"./ion-item_8-ios.entry.js\": [\n\t\t360,\n\t\t57\n\t],\n\t\"./ion-item_8-md.entry.js\": [\n\t\t361,\n\t\t58\n\t],\n\t\"./ion-loading-ios.entry.js\": [\n\t\t362,\n\t\t23\n\t],\n\t\"./ion-loading-md.entry.js\": [\n\t\t363,\n\t\t24\n\t],\n\t\"./ion-menu_3-ios.entry.js\": [\n\t\t364,\n\t\t59\n\t],\n\t\"./ion-menu_3-md.entry.js\": [\n\t\t365,\n\t\t60\n\t],\n\t\"./ion-modal-ios.entry.js\": [\n\t\t366,\n\t\t12\n\t],\n\t\"./ion-modal-md.entry.js\": [\n\t\t367,\n\t\t13\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t368,\n\t\t16\n\t],\n\t\"./ion-popover-ios.entry.js\": [\n\t\t369,\n\t\t14\n\t],\n\t\"./ion-popover-md.entry.js\": [\n\t\t370,\n\t\t15\n\t],\n\t\"./ion-progress-bar-ios.entry.js\": [\n\t\t371,\n\t\t61\n\t],\n\t\"./ion-progress-bar-md.entry.js\": [\n\t\t372,\n\t\t62\n\t],\n\t\"./ion-radio_2-ios.entry.js\": [\n\t\t373,\n\t\t63\n\t],\n\t\"./ion-radio_2-md.entry.js\": [\n\t\t374,\n\t\t64\n\t],\n\t\"./ion-range-ios.entry.js\": [\n\t\t375,\n\t\t65\n\t],\n\t\"./ion-range-md.entry.js\": [\n\t\t376,\n\t\t66\n\t],\n\t\"./ion-refresher_2-ios.entry.js\": [\n\t\t377,\n\t\t25\n\t],\n\t\"./ion-refresher_2-md.entry.js\": [\n\t\t378,\n\t\t26\n\t],\n\t\"./ion-reorder_2-ios.entry.js\": [\n\t\t379,\n\t\t33\n\t],\n\t\"./ion-reorder_2-md.entry.js\": [\n\t\t380,\n\t\t34\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t381,\n\t\t83\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t382,\n\t\t67\n\t],\n\t\"./ion-searchbar-ios.entry.js\": [\n\t\t383,\n\t\t27\n\t],\n\t\"./ion-searchbar-md.entry.js\": [\n\t\t384,\n\t\t28\n\t],\n\t\"./ion-segment_2-ios.entry.js\": [\n\t\t385,\n\t\t68\n\t],\n\t\"./ion-segment_2-md.entry.js\": [\n\t\t386,\n\t\t69\n\t],\n\t\"./ion-select_3-ios.entry.js\": [\n\t\t387,\n\t\t70\n\t],\n\t\"./ion-select_3-md.entry.js\": [\n\t\t388,\n\t\t71\n\t],\n\t\"./ion-slide_2-ios.entry.js\": [\n\t\t389,\n\t\t84\n\t],\n\t\"./ion-slide_2-md.entry.js\": [\n\t\t390,\n\t\t85\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t391,\n\t\t31\n\t],\n\t\"./ion-split-pane-ios.entry.js\": [\n\t\t392,\n\t\t86\n\t],\n\t\"./ion-split-pane-md.entry.js\": [\n\t\t393,\n\t\t87\n\t],\n\t\"./ion-tab-bar_2-ios.entry.js\": [\n\t\t394,\n\t\t72\n\t],\n\t\"./ion-tab-bar_2-md.entry.js\": [\n\t\t395,\n\t\t73\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t396,\n\t\t32\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t397,\n\t\t74\n\t],\n\t\"./ion-textarea-ios.entry.js\": [\n\t\t398,\n\t\t75\n\t],\n\t\"./ion-textarea-md.entry.js\": [\n\t\t399,\n\t\t76\n\t],\n\t\"./ion-toast-ios.entry.js\": [\n\t\t400,\n\t\t29\n\t],\n\t\"./ion-toast-md.entry.js\": [\n\t\t401,\n\t\t30\n\t],\n\t\"./ion-toggle-ios.entry.js\": [\n\t\t402,\n\t\t19\n\t],\n\t\"./ion-toggle-md.entry.js\": [\n\t\t403,\n\t\t20\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t404,\n\t\t88\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 157;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t408,\n\t\t96\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 159;\nmodule.exports = webpackAsyncContext;","\nimport { Doc } from '../../modules/data/models'\nimport { GamifyRewards } from './utilsHabits';\n\nexport const TYPE_HABBIT = 'hab';\nexport const MOMENT_DATE_FORMAT = 'YYYYMMDD';\n\nexport enum habitStage {\n  'finished',\n  'current',\n  'future',\n  'resting'\n}\n\nexport enum habitIntervals {\n  day = 'day',\n  week = 'week',\n  month = 'month'\n}\n\nexport enum habitDifficulty {\n  trivial, easy, medium, hard, extreme\n}\n\nexport const printDifficulty = (hab:habitDifficulty):string => {\n  switch(hab) {\n    case habitDifficulty.trivial:\n      return 'trivial'; // , easy peasy lemon squeezy\n    case habitDifficulty.easy:\n      return 'easy'; //Piece of Cake , Smooth Sailin'\n    case habitDifficulty.medium:\n      return 'medium'; //Let's Go\n    case habitDifficulty.hard:\n      return 'hard'; //No Pain, No Gain\n    case habitDifficulty.extreme:\n      return 'extreme'; //Death Wish\n  }\n}\n\n\nexport interface HabitProgress {\n  date:string, \n  value: number, \n  reward?: GamifyRewards,\n}\n\nexport class Habit extends Doc {\n  name: string = 'New habit';\n  note?: string;\n  type:string = TYPE_HABBIT;\n  stage: habitStage = habitStage.current;\n  difficulty:habitDifficulty = habitDifficulty.medium;\n  //regularity\n  regularityInterval:habitIntervals = habitIntervals.day;\n  regularityValue: number = 1;\n  regularityEachDayGoal?: number = 1;\n\n  progress: HabitProgress[] = [];\n  //streaks\n  currentStreak: number = 0;\n  bestStreak: number = 0;\n\n  newRewards?: GamifyRewards;\n  \n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n  }\n}\n\n\n","\nimport { BehaviorSubject } from 'rxjs';\n\n\n\nexport class LoadingService {\n  private _loading: boolean = false;\n  \n\n  public loading$ = new BehaviorSubject({show: this._loading, msg: 'Loading...'});\n\n  showLoading(msg = \"Loading...\") {\n    this._loading = true;\n    this.loading$.next({show:true, msg});\n  }\n\n  hideLoading() {\n    this._loading = false;\n    this.loading$.next({show:false, msg:''});\n  }\n\n  public get loading(): boolean {\n    return this._loading;\n  }\n\n\n  startLoadingTimer() {\n\n  }\n\n}\nexport const loadingService = new LoadingService();\n\n\n","import React, { useState, useEffect } from 'react';\nimport { IonLoading } from '@ionic/react';\nimport { Subscription } from 'rxjs';\nimport { loadingService } from './loadingService';\n\nexport const Loading: React.FC = () => {\n  const [state, setState] = useState({show:false, msg: 'Loading...'});\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      loadingService.loading$.subscribe(res =>{\n        setState({show: res.show, msg: res.msg});\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[]);\n\n  \n  //onDidDismiss={() => setShowLoading(false)}\n  return (\n      <IonLoading\n        isOpen={state.show}\n        message={state.msg}\n      />\n  );\n};","import React from 'react';\nimport { IonHeader, IonToolbar, IonPage, IonTitle, IonContent, IonLabel } from '@ionic/react';\n\n\n\nconst UserPage: React.FC = () => {\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>User Page</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonLabel>User</IonLabel>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default UserPage;\n","export const PROJECT_SERVICE = '';\nexport const PROJECT_INDEX_SERVICE = 'ch';\nexport const SYSTEM_DOC = 'sys';\n\nexport const LASTCHAR = String.fromCharCode(65535);\nexport const DIV = '.';\nexport const DOUBLE_DIV = '..';\n\nexport class Doc {\n  public id: string|undefined = undefined;\n  name: string = '';\n  public deleted?: boolean;\n  public created?: number = Date.now();\n  public updated?: number = Date.now();\n  public type: string = 'doc';\n  public dirty?: number = 0;\n\n  constructor(values: Object = {}) {\n      Object.assign(this, values);\n  }\n\n}\n\nexport class ProjectItem extends Doc {\n  public id:string;\n  public name: string = '';\n  public note?: string;\n  public access = [];\n\n  constructor(values: Object = {}) {\n    super();\n    Object.assign(this, values);\n    this.id = values['id'];\n    if(!this.id)\n      this.id = ''; \n  }\n}\n\n\n\n\n\n\n\n\n\n","import  ulog from 'ulog';\nulog.level = ulog.TRACE;\n\nexport const FIRST_DAY_OF_WEEK = 'Monday';\n\n\n\nconst dev = {\n  \n  \n}\n\nconst prod = {\n  SYNC_SERVER: 'https://auth.mlflabs.com',\n  AUTH_API_URL: 'https://auth.mlflabs.com',\n}\nconst detail = process.env.REACT_APP_STAGE === 'production' ? prod: dev;\n\nconsole.log('*********************************: ', process.env.REACT_APP_STAGE)\n\nexport const env = {...{\n  APP_ID: 'hv',\n  //myenvoy settings\n  ACCESS_META_KEY: 'access',\n  \n\n  //Auth\n  TOKEN_EXPIRATION: 300, // how many days\n  SYNC_SERVER: 'https://auth.mlflabs.com',\n  AUTH_API_URL: 'https://auth.mlflabs.com',\n  //SYNC_SERVER: 'http://localhost:3002',\n  //AUTH_API_URL: 'http://localhost:3002',\n}, ...detail}","import moment from 'moment';\n\n\nexport const capitalize = (s: string) => {\n  if (typeof s !== 'string') return ''\n  return s.charAt(0).toUpperCase() + s.slice(1)\n}\n\nexport const printDateRelative = (timestamp: number) => {\n  try {\n    const m = moment.unix(timestamp);\n\n    if(moment().diff(m, 'd') < 3){\n      return m.fromNow();\n    }\n    else {\n      return m.format('DD-MM-YYYY');\n    }\n  }\n  catch(e){\n    console.log(e);\n  }\n}\n\nexport function getNested(obj: any, ...args: string[]) {\n  return args.reduce((obj, level) => obj && obj[level], obj)\n}\n\nexport const waitMS = (ms: number) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\nexport function getAction(todo:string, data = {}){\n  return {type:todo, data:data};\n}\n\nexport function printCleanNote(text: string) {\n  const t = text.replace(/(\\r\\n|\\n|\\r)/gm,\" \");\n  if(t.length > 40)\n    return t.substring(0,37)+'...';\n  return t;\n}\n\nexport function saveIntoArray(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n          Object.assign({}, item),\n          ...ary.slice(i + 1)];\n}\n\nexport function saveIntoDocList(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  if(item['deleted']){\n    return ary.filter(d => d[idKey] !== item[idKey])\n  }\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n          Object.assign({}, item),\n          ...ary.slice(i + 1)];\n}\n\nexport function getIndexById(id: string, ary: any, idKey: string = 'id'): number {\n  for (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nexport function findById(id:any, ary: any[], idKey: string = \"id\"): any {\nfor (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return ary[i];\n    }\n  }\n  return null;\n}\n\nexport function removeFromArrayById(id: any, ary:Array<any>, idKey = 'id') {\n  return ary.filter(o => o[idKey] !== id);\n}\n\nexport function clamp(val:number, max:number, min:number = 0): number {\n  if(val > max) return max;\n  if(val < min) return min;\n  return val;\n}","import { Habit, MOMENT_DATE_FORMAT, habitIntervals } from './models';\nimport moment, { Moment, months } from 'moment';\nimport { FIRST_DAY_OF_WEEK } from '../../env';\nimport { clamp } from '../../utils';\n\n\nexport interface GamifyRewards {\n  gold:number,\n  experience: number,\n  item:any\n}\n\n\n\nexport const getInitGamifyRewards =  (base?:GamifyRewards):GamifyRewards =>  {\n  return {...{ gold: 0, experience: 0, item:undefined }, ...base};\n}\n\n\nexport const calculateCurrentStreak = (hab:Habit, bufferSize = 3): Habit => {\n  console.log('calculateCurrentStreak:::: ', hab, bufferSize);\n  if(hab.regularityInterval === habitIntervals.day){\n    const h = calculateDailyHabitStreak(hab, bufferSize)\n    return h;\n  }\n\n  if(hab.regularityInterval === habitIntervals.week){\n    return calculateHabitStreakByWeek(hab, bufferSize);\n  }\n\n  if(hab.regularityInterval === habitIntervals.month){\n    return calculateHabitStreakByMonth(hab, bufferSize);\n  }\n\n  return hab;\n}\n\n\nconst getStreakByWeek = (hab:Habit, weeksBack:number, firstDayOfWeek: string): number => {\n  const firstDay = moment().day(FIRST_DAY_OF_WEEK);\n  let currentValue = 0;\n  let streak = 0;\n  if(!firstDay.isSame(moment(), 'day')){\n    console.log('Not same day start');\n    firstDay.add(1, 'week');\n  }\n  console.log(firstDay);\n  //now we have the current first day of week, subtrack weeksBack\n  firstDay.subtract(weeksBack, 'week');\n\n  for(let i = 0; i < 7; i++) {\n    currentValue = getProgressValueByDate(getProgressDate(firstDay,i), hab);\n    if(currentValue > 0) \n      streak++;\n  }\n  return streak;\n}\n\nconst getStreakByMonth = (hab:Habit, monthsBack:number): number => {\n  const firstDay = moment().date(1);\n  \n  if(!firstDay.isSame(moment(), 'day')){\n    console.log('Not same day start');\n    firstDay.add(1, 'month');\n  }\n  console.log(firstDay);\n  let currentValue = 0;\n  let streak = 0;\n  firstDay.subtract(monthsBack, 'month');\n\n  const currentDay = moment(firstDay);\n  while(currentDay.isSame(firstDay, 'month')){\n    currentValue = getProgressValueByDate(currentDay.format(MOMENT_DATE_FORMAT), hab);\n    if(currentValue > 0) \n      streak++;\n\n    currentDay.add(1, 'day');\n  }\n  return streak;\n}\n\nconst withinWeekBuffer = (buffer: number, offset:number):boolean => {\n  if(offset === 0) return true;\n\n\n  const firstDay = moment().day(FIRST_DAY_OF_WEEK);\n  if(!firstDay.isSame(moment(), 'day')){\n    console.log('Not same day start');\n    firstDay.add(1, 'week');\n  }\n\n  //now remove offset\n  firstDay.subtract(offset, 'week');\n\n  if(firstDay.isAfter(moment().subtract(buffer,'day'))) {\n    return true;\n  }\n  \n  return false;\n}\n\n\nconst calculateHabitStreakByMonth = (hab:Habit, bufferSize:number): Habit => {\n  console.log(\"Calculate Current Streak By Month: \", hab);\n  let streak = 0;\n  let currentBiggestStreak = 0;\n  let cont = true;\n  let offset = 0;\n  let currentValue = 0;\n  while(cont) {\n    currentValue = getStreakByMonth(hab, offset);\n    console.log('Month Streak: ', currentValue);\n    console.log('--------------------Clamp:::: ', clamp(currentValue, hab.regularityValue))\n    streak += clamp(currentValue, hab.regularityValue);\n    if(streak > currentBiggestStreak) currentBiggestStreak = streak;\n\n    if(currentValue < hab.regularityValue && !withinWeekBuffer(bufferSize, offset)){\n      cont = false;\n    }\n    //cont\n    offset++;\n  } \n  let bestStreak = hab.bestStreak;\n  if(!hab.bestStreak)hab.bestStreak = 0;\n  if(currentBiggestStreak > hab.bestStreak) bestStreak = currentBiggestStreak;\n  return {...hab, currentStreak: streak, bestStreak}\n}\n\n\nconst calculateHabitStreakByWeek = (hab:Habit, bufferSize:number): Habit => {\n  console.log(\"Calculate Current Streak By Week: \", hab);\n  let streak = 0;\n  let currentBiggestStreak = 0;\n  let cont = true;\n  let offset = 0;\n  let currentValue = 0;\n  while(cont) {\n\n    currentValue = getStreakByWeek(hab, offset, FIRST_DAY_OF_WEEK);\n    \n    console.log('Week Streak: ', currentValue);\n    console.log('--------------------Clamp:::: ', clamp(currentValue, hab.regularityValue))\n    streak += clamp(currentValue, hab.regularityValue);\n    if(streak > currentBiggestStreak) currentBiggestStreak = streak;\n\n\n    if(currentValue >= hab.regularityValue){\n      \n    }\n    else {\n\n      //do we still have buffer for this time period\n\n      //streak = 0;\n      //failed on this day,see if we are in the buffer\n      \n      if(withinWeekBuffer(bufferSize, offset)){\n        console.log(\"We are within buffer, \", bufferSize, offset);\n        //still have a chance\n        \n      }\n      else {\n        console.log(\"We are past buffer, \", bufferSize, offset);\n        // did we success this time period\n\n        //out of buffer, plus failed\n        cont = false;\n      }\n    }\n      \n    //cont\n    offset++;\n  } \n  let bestStreak = hab.bestStreak;\n  if(!hab.bestStreak)hab.bestStreak = 0;\n  if(currentBiggestStreak > hab.bestStreak) bestStreak = currentBiggestStreak;\n  return {...hab, currentStreak: streak, bestStreak}\n}\n\n\n\nconst calculateDailyHabitStreak = (hab:Habit, bufferSize:number): Habit => {\n  console.log(\"Calculate Current Streak: \", hab);\n  let streak = 0;\n  let currentBiggestStreak = 0;\n  let cont = true;\n  let offset = 0;\n  let currentValue = 0;\n  while(cont) {\n    currentValue = getProgressValueByDate(getProgressDateBySubtract(offset), hab);\n    if(currentValue > 0){\n      streak++\n      if(streak > currentBiggestStreak) currentBiggestStreak = streak;\n    }\n    else {\n      cont = false;\n    }\n      \n    //cont\n    offset++;\n  } \n  let bestStreak = hab.bestStreak;\n  if(!hab.bestStreak)hab.bestStreak = 0;\n  if(currentBiggestStreak > hab.bestStreak) bestStreak = currentBiggestStreak;\n  return {...hab, currentStreak: streak, bestStreak}\n}\n\nconst getProgressValueByDate = (date: string, hab:Habit):number => {\n  if(!hab.progress) hab.progress = [];\n  for(let i = 0; i < hab.progress.length; i++){\n    if(hab.progress[i].date === date)\n    {\n      return hab.progress[i].value;\n    }\n  }\n  return 0;\n}\n\nconst getProgressDateBySubtract = (subtract:number):string => {\n  return moment().subtract(subtract, 'day').format(MOMENT_DATE_FORMAT);\n}\n\nconst getProgressDate = (date: Moment, subtract: number): string => {\n  return moment(date).subtract(subtract, 'd').format(MOMENT_DATE_FORMAT);\n}","import { PROJECT_SERVICE, DIV, PROJECT_INDEX_SERVICE, LASTCHAR, ProjectItem } from './models';\nimport shortid from 'shortid';\nimport { env } from '../../env';\n\nexport const TYPE_SETTINGS = 'set';\n\nexport function generateUserChannelId(userid): string {\n  return 'u' + env.APP_ID + userid;\n}\n\nexport function getDefaultProject(userid): ProjectItem {\n  const uuid = 'u' + env.APP_ID + userid;\n  return {\n    id: generateProjectUUID(uuid, ''),\n    name: 'default',\n    access:[],\n    type: TYPE_SETTINGS,\n    updated: 0, //Date.now(),\n    [env.ACCESS_META_KEY]: genrateMetaData(userid), \n  }\n}\n\nexport function generateUUID():string {\n  let id;\n  let ok = false;\n  while (!ok) {\n    id = shortid.generate();\n    if(id.substring(0,1)!== '_' && id.substring(0,1)!== '-')\n      ok = true;\n  }\n\n  return id;\n}\n\nexport function isThisUserProject(id:string|undefined, userid): boolean {\n  return (getChannelFromProjectId(id) === generateUserChannelId(userid));\n}\n\nexport function getProjectChildId(id:string|undefined): string {\n  if(id === undefined) throw new Error('Id can not be undefined');\n  let length = PROJECT_INDEX_SERVICE.length + DIV.length;\n  return id.substring(0, id.length-length);\n}\n\nexport function getChannelFromProjectId(id: string|undefined):string {\n  return getProjectChildId(id);\n}\n\nexport function generateProjectUUID(id = generateUUID(), app = env.APP_ID):string {\n  return app + id +  DIV + PROJECT_INDEX_SERVICE;\n}\n\nexport function generateProjectChildId(projectId: string, type: string, id = generateUUID()):string {\n  return PROJECT_SERVICE+ DIV + projectId.split(DIV)[1] + DIV + type +\n          DIV + id;\n}\n\nexport function generateCollectionId(projectid: string, collection, id = generateUUID()): string {\n  //eliminate dots from id, not allowed\n  id = id.replace('.','');\n  \n  if(projectid === undefined) throw new Error(\"Project can't be underfined\");\n  const length = PROJECT_INDEX_SERVICE.length;\n  return projectid.substring(0, projectid.length-length)+collection+ DIV +id; \n}\n\nexport const waitMS = (ms) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\n\nexport function saveIntoArray(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n  Object.assign({}, item),\n  ...ary.slice(i + 1)];\n}\n\nexport function genrateMetaData(userid:string):string[]{\n    return [ 'u'+ env.APP_ID + userid,]; \n}\n\n\n\nexport function getIndexById(id: string, ary: any, idKey: string = 'id'): number {\n  for (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return i;\n    }\n  }\n  // if we don't have a match return null\n  return -1;\n}\n\nexport const extractTypeCollectionFromDocId = (id) => {\n  return id.split(DIV)[2];\n}\n\nexport const extractChannelNameFromDocId = (id) => {\n  return id.split(DIV)[0];\n}\n\n\n//rights functions\n/*\n    Rights, each digit represents different right\n    0.  0 - Not admin 1- Admin, can change everything\n    1.  (Project item) 0 - can't see, 1 - can see, 2 - can edit\n    2.  (Project children) 0 - can't see, 1 - can see own, 2 - can see all items\n    3.  (Project children edit) 0 -can't edit, 1 can edit/make own, 2 can edit all \n*/\n\nexport const canEditProject = (rights: string): boolean => {\n  if(rights.substring(0,1) === '1') return true;\n  if(rights.substring(1,2) === '2') return true;\n  return false;\n}\n\nexport const canEditOwnedItem = (rights: string): boolean => {\n  if(rights.substring(0,1) === '1') return true;\n  if(rights.substring(3,4) === '1') return true;\n  if(rights.substring(3,4) === '2') return true;\n  return false;\n}\n\nexport const canEditOthersItem = (rights: string): boolean => {\n  if(rights.substring(0,1) === '1') return true;\n  if(rights.substring(3,4) === '2') return true;\n  return false;\n}\n\nexport const canEditItem = (rights: string, myItem:boolean): boolean => {\n  return (myItem)? canEditOwnedItem(rights) : canEditOthersItem(rights);\n}","import { Doc, ProjectItem } from \"../data/models\";\n\nexport const TYPE_PARTY = 'party';\n\nexport enum ChallengeStage {\n  'finished',\n  'current',\n  'future',\n  'waiting',\n  'resting',\n}\n\nexport enum ChallengeDifficulty {\n  trivial, easy, medium, hard, extreme\n}\n\nexport enum ChallengeIntervals {\n  day = 'day',\n  week = 'week',\n  month = 'month'\n}\n\nexport interface PartyMember {\n  id: string,\n  username: string,\n  rights: string\n}\n\n\nexport class PartyProject extends ProjectItem {\n  type: string = TYPE_PARTY\n  secondaryType: string = 'project'\n  creator: string = '';\n  dirty: number = 0;\n  members: PartyMember[]  = []\n\n  moneyTypeSingle: string = 'Ruby';\n  moneyTypeMultiple: string =  'Rubies';\n  moneyColor: string = '#ff0000'\n\n\n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n  }\n}\n\nexport class Challenge extends Doc {\n  name: string = 'New Challenge';\n  note?: string;\n  type:string = TYPE_PARTY;\n  access: string = ''\n  secondaryType: string = 'challenge'\n  stage: ChallengeStage = ChallengeStage.waiting;\n  difficulty:ChallengeDifficulty = ChallengeDifficulty.medium;\n  //regularity\n  regularityInterval:ChallengeIntervals = ChallengeIntervals.day;\n  regularityValue: number = 1;\n  regularityEachDayGoal?: number = 1;\n\n  //members\n  members: PartyMember[]  = []\n\n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n  }\n}\n","import { Doc } from '../../modules/data/models'\nimport { GamifyRewards, getInitGamifyRewards } from '../habits/utilsHabits';\nimport { getProjectChildId } from '../../modules/data/utilsData';\n\nexport const TYPE_TODO = 'todo';\nexport const TYPE_TODO_LIST = 'todolist';\nexport const TYPE_TODO_FOLDER = 'todoFolder';\nexport const TYPE_TODO_TAG = 'todoTag';\n\nexport const FOLDER_BASE_POSITION = 'base';\n\nexport const getDefaultTodoList = (name:string = 'tasks', projectid:string):TodoList => {\n  const project = getProjectChildId(projectid);\n  return new TodoList({\n    id: undefined,\n    folder: undefined,\n    type: TYPE_TODO_LIST,\n    icon: 'check',\n    secondaryType: TYPE_TODO_LIST,\n    name,\n    fullname: project + name,\n  })\n}\n\nexport class TodoList extends Doc {\n  folder: string = FOLDER_BASE_POSITION;\n  type: string = TYPE_TODO_LIST;\n  project?: string;\n  icon?:string;\n  color?:string;\n  _new?: boolean;\n  fullname:string;\n  secondaryType:'todolist'|'todoFolder'  = TYPE_TODO_LIST\n\n  constructor(values: Object = {}) {\n    super();\n    Object.assign(this, values);\n    this.fullname = values['fullname'];\n  }\n}\n\nexport const getDefaultTodoTag = (name:string = 'tasks', projectid:string, icon:string ='check'):TodoTag => {\n  const project = getProjectChildId(projectid);\n  return new TodoTag({\n    id: undefined,\n    type: TYPE_TODO_TAG,\n    icon,\n    name,\n    fullname: project + name,\n  })\n}\n\nexport class TodoTag extends Doc {\n  type: string = TYPE_TODO_TAG;\n  icon?:string;\n  animatedIcon?:any;\n  color?:string;\n  _new?: boolean;\n  fullname!: string;\n  constructor(values: Object = {}) {\n    super();\n    Object.assign(this, values);\n    //this.fullname = values['fullname'];\n  }\n}\n\nexport class Todo extends Doc {\n  note?: string;\n  type: string = TYPE_TODO;\n\n  done: boolean;\n  date: number|null;\n  list: string = 'default';\n  tags: string[];\n\n\n  _new?: boolean; // for saving new docs, temp solution\n    //sub tasks\n  parent: string | null;\n  subTodos: string[];\n  showSubTodos: boolean;\n  showDone: boolean;\n\n  newRewards: GamifyRewards;\n  doneRewards: GamifyRewards;\n  \n  constructor(values: Object = {}) {\n    super();\n    this.done = false;\n    this.date = null;\n    this.tags = [];\n    this.parent = null;\n    this.subTodos = [];\n\n    this.showSubTodos = false;\n    this.showDone = false;\n\n    this.newRewards = getInitGamifyRewards();\n    this.doneRewards = getInitGamifyRewards();\n    \n    Object.assign(this, values);\n\n  }\n}","import React, { useState } from 'react';\nimport { Todo, TYPE_TODO, TodoList, getDefaultTodoList, TodoTag } from './models';\nimport {IonInput} from '@ionic/react';\nimport { generateCollectionId } from '../../modules/data/utilsData';\nimport ulog from 'ulog'\n\n\nconst log = ulog('todo');\n\n\nconst TodoNewComp = ({list, tag,  saveFunc, projectId}:\n  {list:TodoList|undefined, tag:TodoTag|undefined, projectId: string, saveFunc: Function}) => {\n\n  const [state, setState] = useState({title:''});\n  \n  //TODOS: testing....\n  const setNewTitle = (e) => {\n    setState({title: e.detail.value});\n  }\n\n  const onKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      save();\n      setState({title: ''});\n    }\n  }\n\n\n  const save = async () => {\n      let fullname;\n      if(!list){\n        fullname = getDefaultTodoList('tasks', projectId).fullname;\n      }\n      else {\n        fullname = list.fullname;\n      }\n      \n\n      log.warn('SAVING TODO::: ', projectId, list);\n      const id = generateCollectionId(projectId, TYPE_TODO)\n      const newDoc = new Todo({\n        id, \n        name: state.title, \n        list: fullname,\n        _new: true});\n\n      if(tag){\n        log.warn('Saving a tag made manually ', tag);\n        newDoc.tags.push(tag.fullname);\n      }\n       \n      log.warn('NEW TODO::::::::::::::: ', newDoc)\n      await saveFunc(newDoc);\n  };\n\n\n  return (\n    <IonInput\n            className=\"new-todo\"\n            placeholder=\"What needs to be done?\"\n            onKeyPress={onKeyPress}\n            onIonChange={setNewTitle}\n            value={state.title}\n    />\n  )\n\n\n}\n\nexport default TodoNewComp;","import React, { useState, useEffect } from 'react';\nimport { Todo, TodoTag } from './models';\nimport { DataFunctions } from './hooks/todos.hook';\nimport _ from 'lodash';\nimport ulog from 'ulog';\nimport { IonLabel, IonTextarea, IonButton, IonIcon, IonAlert } from '@ionic/react';\nimport './todo.edit.component.css';\nimport { sunny, star, heart, trash, basket, construct, close, checkmark } from '../../../node_modules/ionicons/icons';\nimport AnimatedIcon from '../../components/animatedIcon';\n\n\nconst log = ulog('todo');\n\nconst getDefaultState = (todo:Todo, tagDocs:TodoTag[]) =>  {\n  return {\n  todo: todo,\n  tagDocs,\n  showDeleteWarrning: false,\n  text: mergeText(todo.name, todo.note)\n}}\n\nconst mergeText = (name: string|undefined, note: string|undefined): string => {\n  if(!name) name= '';\n  if(!note) \n    note = '';\n  else\n    note = '\\n'+note;\n  return name + note;\n}\n\n\n\nconst TodoEditInlineComponent = ({todo, tagDocs, dataFunctions}: \n        {todo:Todo,  tagDocs:TodoTag[], dataFunctions: DataFunctions}) => {\n  log.warn(\"Edit Todo Render::: \", todo, tagDocs, tagDocs);\n\n  const [state, setState] = useState(getDefaultState(todo, tagDocs));\n\n  useEffect(() => {\n    log.error('USE EFFECT::::: ', todo, tagDocs);\n    setState(getDefaultState(todo, tagDocs));\n  }, [todo, tagDocs])\n\n  const handleTitleChange = (e) => {\n    const text = e.detail.value;\n    console.log(text);\n    var match = /\\r|\\n/.exec(text);\n    console.log('Title Chagne: ', text, match)\n    if(match){\n      const name = text.substring(0, match.index);\n      const note = text.substring(match.index+1);\n      const newDoc = {...state.todo, ...{name: name, note: note}}\n      const newState = {...state, ...{todo: newDoc, text: text}};\n      setState(newState);\n    }\n    else {\n      const newDoc = {...state.todo, ...{name: text, note: ''}}\n      const newState = {...state, ...{todo: newDoc, text: text}};\n      setState(newState);\n    }\n  }\n\n  const handleBlur = () => {\n    console.log(\"Saving todo::: \", state);\n    dataFunctions.save(state.todo);\n  }\n\n  const showRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: true}});\n  }\n\n\n  const hideRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: false}});\n  }\n\n  const remove = () => {\n    hideRemoveWarrning();\n    console.log('REMVE ACTION STATE::::::: ', state);\n    if(state.todo.id)\n      dataFunctions.remove(state.todo.id);\n  }\n\n  const printTag = (tag: TodoTag) => {\n    log.warn('Print TAg:::: ', tag, tagDocs,  state);\n    let color;\n    if(_.includes(state.todo.tags,tag.fullname)){\n      color = 'success';\n    }\n    else {\n      color = 'light';\n    }\n    return  <IonButton \n                fill=\"clear\"\n                size=\"default\" \n                color={color} \n                key={tag.name + 'editicon'}  \n                onClick={() => handleTagChange(tag)}>\n              <IonIcon  src={\"/assets/icons/\"+tag.icon} /></IonButton>\n  }\n\n\n  const handleTagChange = (tag: TodoTag) => {\n    log.error(tag, tagDocs);\n    if(!state.todo.tags) state.todo.tags = [];\n    const res = state.todo.tags.find(t=>t===tag.fullname);\n    let newtags;\n    if(res === undefined){\n      newtags = _.concat(state.todo.tags, tag.fullname);\n    }\n    else {\n      newtags = _.filter(state.todo.tags, t=>t!==tag.fullname);\n    }\n    dataFunctions.save(Object.assign(state.todo, {tags: newtags}));\n  }\n\n\n  return (\n\n    <div className=\"\">\n        \n        \n        <div key=\"todoEditInlineIconScrollParent\" className=\"todoEditInlineIconScrollParent\">\n          { tagDocs.map(tag => printTag(tag)) }\n        </div>\n        <IonTextarea \n            placeholder=\"Enter todo title and note here\"\n            name=\"note\"\n            class=\"todoEditInlineTextArea\"\n            autoGrow={true}\n            onIonBlur={handleBlur}\n            onIonChange={handleTitleChange}\n            value={state.text}></IonTextarea>\n        \n        \n        <div>\n          <div className=\"todoButtonsLeftAlign\">\n              <IonButton size=\"small\"  fill=\"clear\" color=\"secondary\" onClick={()=>{dataFunctions.select(null)}}>\n                  <IonIcon  icon={close} /><IonLabel>Close</IonLabel>\n              </IonButton>\n          </div>\n          <div className=\"todoButtonsRightAlign\">\n              <IonButton size=\"small\"  fill=\"clear\" color=\"danger\" onClick={showRemoveWarrning}>\n                  <IonIcon  icon={trash} /><IonLabel>Delete</IonLabel>\n              </IonButton>\n          </div>\n        </div>\n        <div className=\"todoInlineEditPadding\"> </div>   \n\n\n\n\n\n\n        <IonAlert\n            isOpen={state.showDeleteWarrning}\n            onDidDismiss={() => hideRemoveWarrning}\n            header={'Warrning!!!'}\n            message={'Are you sure you want to <strong>delete</strong> this task and its sub-tasks?'}\n            buttons={[\n              {\n                text: 'Cancel',\n                role: 'cancel',\n                cssClass: 'secondary',\n                \n              },\n              {\n                text: 'Yes Im Sure',\n                handler: () => remove()\n              }\n            ]}\n          />\n    </div>\n\n  );\n\n}\n\nexport default TodoEditInlineComponent;","import Dexie from 'dexie';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { DataChangeEvent } from '../dataService';\nimport { Subscription } from 'rxjs';\nimport { env } from '../../../env';\n\nexport interface DatabaseScheme {\n  name: string,\n  version: number,\n  tables: TableScheme[],\n}\n\nexport interface TableScheme {\n  name: string,\n  columns: string,\n  sync: boolean,\n}\n\n\nexport default class DexieAdapter {\n\n  private db;\n  private _ready = false;\n  public ready$ = new BehaviorSubject(this._ready);\n  private _subscriptions:Subscription[] = [];\n\n  public changes$ = new Subject<DataChangeEvent>();\n\n  constructor(scheme: DatabaseScheme) {\n    this.db = new Dexie(env.APP_ID +  scheme.name+ '_dexie');\n    const stores = {};\n    scheme.tables.forEach(t => {\n      stores[t.name] = t.columns;\n    });\n    console.log('Dexie scheme: ', scheme, stores)\n    this.db.version(scheme.version).stores(stores);\n    this._init();\n  }\n\n  private async _init() {\n    console.log('Dexie init');\n    try {\n      await this.db.open();\n      this._ready = true;\n      this._subscribe();\n      this.ready$.next(true);\n    }\n    catch(e) {\n      console.log(e);\n    }\n  }\n\n  private async _subscribe() {\n    /*\n   this.db.on('changes', (changes) => {\n      console.log('#####################################################', changes); \n      changes.forEach(change => {\n        switch (change.type) {\n          case 1: // CREATED\n            this.changes$.next({doc: change.obj})\n            break;\n          case 2: // UPDATED\n            this.changes$.next({doc: change.obj, old: change.oldObje})\n          \n            break;\n          case 3: // DELETED\n            \n            break;\n  \n        }\n      }); \n    });\n    */\n  }\n\n  public async destroy() {\n    this._subscriptions.forEach(sub => {\n      if(sub)sub.unsubscribe();\n    })\n  }\n\n  public async getDoc(id: string, collection: string): Promise<any> {\n    console.log('Dexie getting doc::: ', id, collection);\n    //const res = await this.db[collection].where('id').equals(id).first();\n    const res = await this.db[collection].get({id});\n    console.log('=========================', res);\n    if(res) return res;\n    return null;\n  }\n\n  public async getBulk(ids: string[], collection: string): Promise<any> {\n    console.log('BULK GET: ', ids, collection);\n    const res = await this.db[collection].bulkGet(ids);\n    console.log(res);\n    return res.filter(doc => doc !== undefined)\n  }\n\n  public async queryByProperty(field: string, operator: string, \n      value: any, collection: string): Promise<any> {\n    console.log('%%%%%%%%%%%%%%%%% Dexie Query By Property::: ', \n        field, operator, value, collection);\n    switch(operator) {\n      case 'equals':\n        const docs = await this.db[collection].where(field).equals(value).toArray();\n        console.log(docs, collection, field, operator, value);\n        return docs;\n      case 'startsWith':\n        return await this.db[collection].where(field).startsWith(value).toArray();\n      case 'notEqual':\n        return await this.db[collection].where(field).notEqual(value).toArray();\n      default:\n        throw new Error('Missing proper operator, given: '+ operator);\n    }\n  }\n\n  public async getProjectItems(projectid: string, collection: string) {\n    console.log('Get Project items: ', projectid, collection);\n    const res = await this.db[collection].where('id').startsWith(projectid).toArray();\n    console.log(res);\n    return res;\n  }\n\n  public async save(doc: any, collection: string, setDirty = true){\n    console.log('---------------------------      Dexie Save: ', doc, collection);\n    if(setDirty)\n      doc.dirty = 1;\n    const res = await this.db[collection].put(doc);\n    console.log('SAVE RES: ', res);\n    if(res) {\n      this.changes$.next({doc});\n      return true\n    }\n    return false;\n  }\n\n  public async saveFromSync(docs: any[], collection: string){\n    console.log('&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&');\n    console.log('Save form Sync::: ', docs, collection);\n    const res = await this.db[collection].bulkPut(docs);\n\n    console.log('SAVE RES: ', res);\n    if(res) {\n      //this.changes$.next({doc});\n      docs.forEach(doc => {\n        this.changes$.next({doc});\n      })\n      return true\n    }\n    return false;\n  }\n\n\n}","import { Subject } from 'rxjs';\nimport { ajaxResponse } from '../ajax/ajax';\nimport { toast } from 'react-toastify';\n\nexport interface ToastMessage {\n  message: string,\n  duration: number,\n  key?: number,\n}\n\nexport enum ToastType {\n  default = \"default\", \n  info = \"info\", \n  success = \"success\", \n  warning = \"warning\", \n  error = \"error\"\n}\n\n\nexport class ToastService {\n\n  public messages$ = new Subject<ToastMessage>();\n\n  showMessage(message: string, type:ToastType = ToastType.default, milliseconds: number = 3000) {\n    toast(message, {\n      type: type,\n      autoClose: milliseconds,\n    })\n  }\n\n  printSimpleError (msg:string, duration = 2000) {\n    toast( msg, {type: ToastType.error, autoClose: duration})\n  }\n\n  //TODO: for now only prints the first error\n  printServerErrors (res:ajaxResponse) {\n    const errors = res.errors || [];\n    if(errors.length > 0){\n      errors.forEach(err => this.showMessage(err.msg, ToastType.error))\n    }\n  }\n\n\n\n}\nexport const toastService = new ToastService();\n\n\n","\n\nclass LocalStorageService {\n  \n  async getItem(id: string){\n    return localStorage.getItem(id);\n  }\n\n  async getString(id: string):Promise<string>{\n    let val:string;\n    val = localStorage.getItem(id) || '';\n    return val;\n  }\n\n  async getObject(id: string):Promise<object|null> {\n    const val = localStorage.getItem(id);\n    if(!val)return null;\n    return JSON.parse(val);\n\n  }\n\n  async setObject(id: string, val: object):Promise<boolean> {\n    try {\n      const str = JSON.stringify(val);\n      await localStorage.setItem(id, str);\n      return true;\n    }\n    catch(e){\n      console.log(e);\n      return false;\n    }\n    \n\n  }\n\n\n\n  async setString(id: string, val: string) {\n    localStorage.setItem(id, val);\n  }\n  \n}\n\nconst localStorageService = new LocalStorageService();\n\nexport default localStorageService;","import axios from 'axios';\nimport { getNested } from '../../utils';\nimport { loadingService } from '../loading/loadingService';\n\n\n\nexport interface ajaxResponse {\n  success: boolean,\n  data: any,\n  status?: number,\n  errors?: errorMessage[]\n}\n\n\nexport const getAjaxMessage = (success:boolean, data:any, \n    status:number = 0, errors: errorMessage[] = []): ajaxResponse => {\n  return {success, data, status, errors}\n}\n\nexport const getAjaxErrorMessage = (errorMessage: string, \n  location='system', status:number = 404 ) => {\n    return getAjaxMessage(false, null, status, \n      [{location, msg:errorMessage}])\n}\n\nexport interface errorMessage {\n  location: string,\n  msg: string\n}\n\nexport interface postRequest {\n  url: string,\n  type: string,\n  form: object,\n  options?: object,\n}\n\nexport interface getRequest {\n  url: string,\n  type: string,\n  form: object,\n  options?: object,\n}\n\nexport const getPostRequest = (url:string, form:object, options:object = {}, ) => {\n    return {url, type:'post', form, options};\n}\n\n\n\nexport const getErrorMessage = (msg: string, location:string = \"Server\"):errorMessage => {\n  return {msg, location};\n}\n\nexport const post = async (req: postRequest, showLoading = true, loadingMessage=\"Loading...\"):Promise<ajaxResponse> => {\n  try {\n    if(showLoading)\n      loadingService.showLoading(loadingMessage);\n    console.log(req);\n    const res = await axios.post(req.url, req.form, req.options);\n\n    loadingService.hideLoading();\n    console.log(res);\n    return getAjaxMessage(true, res.data, 200);\n  }\n  catch(err) {\n    loadingService.hideLoading();\n    //console.log(err.response);\n    const response = getNested(err, 'response');\n    if(!response || !response.status) {\n      return getAjaxMessage(false, null, 503, [getErrorMessage(\"Service is temporarly unavailable\")]);\n    }\n    else if(response.status === 422){\n      return getAjaxMessage(false, null, response.data.status, response.data.errors);\n    }\n    else if(response.status === 404) {\n      return getAjaxMessage(false, null, 404, [getErrorMessage(\"Could not connect to server\")]);\n    }\n    else {\n      return getAjaxMessage(false, null, response.status, [getErrorMessage(\"Could not connect to server\")]);\n    }\n  }\n}\n","\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport * as moment from 'moment';\nimport { isEqual } from 'lodash';\nimport anylogger from 'anylogger';\nimport localStorageService from '../localStorage/localStorageService';\nimport {env} from '../../env';\nimport  { getPostRequest, post, ajaxResponse } from '../ajax/ajax';\nimport { toastService } from '../toast/toastService';\n\n\nconst log =  anylogger('auth: authService');\n\n\n\nexport enum AuthStatus {\n  Loading, \n  Guest, //not loged in\n  User // loged in\n}\n\n\nexport const GUEST = 'Guest';\nexport const AUTH_USER_KEY = 'auth-user-key';\nexport interface AuthEvent {\n  success: boolean;\n  code: number;\n  data: any;\n}\n\nexport interface User {\n  id: string,\n  username: string;\n  email: string|null;\n  token: string|null;\n  token_expiery: number|null;\n  channels: any[];\n}\n\n\n\nexport const getUser = (values: any):User => {\n  if(values == null)\n    return {\n      id: 'guest',\n      username: GUEST,\n      email: null,\n      token: null,\n      token_expiery: null,\n      channels: []\n    }\n\n  return {\n    id: values.id || 'guest',\n    username: values.username || GUEST,\n    email: values.email||null,\n    token: values.token||null,\n    token_expiery: values.token_expiery||values.expires||null,\n    channels: values.channels|| []\n  }\n}\n\nexport const isGuest = (user:User) => {\n  return user.username === GUEST;\n}\n\nexport function getGuestUser(username:string = 'Guest'):User {\n  return getUser({ username });\n}\n\n\nexport class AuthService {\n  private _user:User = getGuestUser('null');\n  //private _authReady = false;\n  //public authReady$ = new BehaviorSubject(this._authReady);\n  //private _isAuthenticated = false;\n  //public isAuthenticated$  = new BehaviorSubject(false);\n\n  private _authStatus = AuthStatus.Loading;\n  \n  public authStatus$ = new BehaviorSubject(this._authStatus);\n  \n  public username$ = new Subject<string>();\n\n  constructor() {\n    this.loadAuth();\n  }\n\n  getIsAuthenticated():boolean { return this._authStatus === AuthStatus.User; }\n  getUsername() { return this._user.username; }\n  getEmail() { return this._user.email;}\n  getUser() { return this._user };\n\n\n  async updateUser(user: User, forceLogout = false) {\n    // log.info('Userupdate: ', user, forceLogout, this._authStatus);\n    if(!isGuest(user) || this._user.username ==='null') {\n\n      if(this._authStatus !== AuthStatus.User) {\n        this.setAuthStatus(AuthStatus.User);\n      }\n\n      if(user.username !== this._user.username){\n        this._user = user;\n        await localStorageService.setObject(AUTH_USER_KEY, user)\n        this.username$.next(user.username);\n      }\n\n      if(!isEqual(this._user, user)) {\n        this._user = user;\n        await localStorageService.setObject(AUTH_USER_KEY, user)\n      }\n      \n      return;\n    }\n\n    if(this._authStatus !== AuthStatus.Guest){\n      this.setAuthStatus(AuthStatus.Guest)\n  \n      if(forceLogout){\n        await localStorageService.setObject(AUTH_USER_KEY, getGuestUser);\n      }\n    }\n  }\n\n\n\n\n  async loadAuth() {\n    log.info('----------------- Check login');\n    try {\n      const user = getUser(await localStorageService.getObject(AUTH_USER_KEY));\n      log.info('LOADED USER', user);\n\n      if(!user.token || !user.token_expiery) {\n        return this.updateUser(getGuestUser());\n      }\n\n      log.info('LOADED USER', user);\n\n      const exp = moment.unix(user.token_expiery);\n      if(exp.isAfter(moment.now())) {\n        log.info('TOKEN VALID');\n        return this.updateUser(user);\n      }\n      else {\n        log.warn('TOKEN is old');\n        return this.updateUser(getGuestUser())\n      }\n    }\n    catch(e) {\n      log.error(e);\n      return this.updateUser(getGuestUser())\n    }\n  }\n\n\n  public async loginAndRedirect(id: string, password: string, history, location) {\n    console.log('LoginWithRedirect:: ');\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/login',\n      { id, password, app: env.APP_ID },), true,  'Login in, please wait');\n\n      console.log(\"Login RES: \", res);\n      if(res.success) {\n        this.updateUser(getUser(res.data))\n        console.log(\"LOGIN LOCATION:::: \", location, history);\n\n        let next;\n        if(location && location.state && location.state.prev){\n          next = location.state.prev.startsWith('/auth/')? '/': location.state.prev;\n        }\n\n        history.push(next || '/');\n      }\n      else {\n        console.log(res);\n        toastService.printServerErrors(res);\n      }\n  }\n\n  public async logout() {\n    \n  }\n\n  public async login(id: string, password: string):Promise<ajaxResponse> {\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/login',\n      { username: id, password: password, app: env.APP_ID }, {}), true,  'Login in, please wait');\n\n    return res;\n  }\n\n\n  public async renewToken() {\n    console.log(\"Renew Token\");\n    const res = await post(getPostRequest(env.AUTH_API_URL+'/auth/renewToken',\n                          {token: this._user.token}), false);\n    console.log(res);\n    if(res.success){\n      await this.updateUser({...this._user, ...{token: res.data.token, \n                                channels: res.data.channels,\n                                token_expiery: res.data.expires}})\n      //console.log('Token updated: ', res.data.token);\n      console.log('NEW USER:: ', this._user);\n      return true;\n    }\n    else {\n      console.log('Token updated error: ', res);\n      //is it bad token, or just no internet\n      if(res.status && res.status === 422){\n        await this.updateUser(getGuestUser());\n        return false;\n      }\n    }\n\n\n  }\n\n  public async register(username:string, email: string, password: string): Promise<boolean> {\n    console.log('Register:: ');\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/register',\n                      { username, password, email }),\n                      true,  'Registering, please wait');\n\n    console.log(\"Registering RES: \", res);\n\n    if(res.success) {\n        return true;\n    }\n    else {\n      console.log(res);\n      toastService.printServerErrors(res);\n      return false;\n    }\n  }\n\n  public async forgotPassword() {\n    //const res = await this.http.post(environment.auth_api+'/auth/forgotpassword'\n  }\n\n\n  private setAuthStatus(status:AuthStatus){\n    this._authStatus = status;\n    this.authStatus$.next(status);\n  }\n\n  public getAuthStatus():AuthStatus {\n    return this._authStatus;\n  }\n\n  public getToken():string {\n    return this._user.token || '';\n  }\n\n  public get userid(): string {\n    return this._user.id || '';\n  }\n\n\n\n}\nexport const authService = new AuthService();\n\n\n\n\n\n/*\nexport function createAuthEvent(success: boolean = true,\n  code = 1,\n  data = {}): AuthEvent {\n  return {\n    success, code, data\n  };\n}\n*/\n\n","import { post, getPostRequest } from '../ajax/ajax';\nimport { DIV } from './models';\nimport localStorageService from '../localStorage/localStorageService';\n\nexport interface SyncDataChannel {\n  name: string,\n  docs: any[],\n}\n\n\nexport const organizeData = async (data: any[]) => {\n  \n  const channels = {};\n  let channel;\n\n  data.forEach(doc => {\n    channel = doc.id.split(DIV)[0];\n    console.log(doc);\n    if(!channels[channel]) channels[channel] = [];\n    channels[channel].push({...{}, ...doc});\n\n  });\n  //now load channel checkpoints\n  const checkpoints = await localStorageService.getObject('channel_checkpoints') || {};\n  return {channels: channels, checkpoints};\n}\n\nexport const syncData = async (props:{  data:any[],\n                                        syncurl: string, \n                                        token: string, \n                                        checkpoint: number,\n                                        requestMaxSize:number}) => {\n  //TODO: check our size of docs, if its bigger than max size\n  console.log('Starting to server sync: ', props);\n  try {\n    //get checkpoint\n    const data =  await organizeData(props.data);\n    console.log('************************* ', data);\n    const res = await post(getPostRequest(props.syncurl + '/sync/sync', {\n      token: props.token,\n      checkpoint: props.checkpoint,\n      data,\n    }),false,'');\n\n    if(res) {\n      //first save channel checkpoints\n      const keys = Object.keys(res.data.checkpoints);\n      //merge the 2 checkpoints\n      const chpoints = await localStorageService.getObject('channel_checkpoints') || {};\n      await localStorageService.setObject('channel_checkpoints',{...chpoints, ...res.data.checkpoints})\n\n      return res.data.types;\n    }\n     \n    return null;\n\n  }\n  catch(e){\n    console.log(e);\n   }\n}\n\n","import { Observable, Subject, BehaviorSubject } from 'rxjs';\nimport { map, debounceTime, filter, throttleTime } from 'rxjs/operators';\nimport { getProjectChildId, generateCollectionId, \n  TYPE_SETTINGS, waitMS, getChannelFromProjectId } from './utilsData';\n\nimport { ProjectItem, DIV } from './models';\nimport _ from 'lodash';\nimport DexieAdapter, { DatabaseScheme } from './adapters/dexie';\nimport { TYPE_HABBIT } from '../../pages/habits/models';\nimport { TYPE_TODO, TYPE_TODO_LIST, TYPE_TODO_TAG } from '../../pages/todo/models';\nimport { TYPE_PARTY } from '../parties/models';\nimport { TYPE_MSG } from '../messages/models';\nimport { env } from '../../env';\nimport { authService } from '../auth/authService';\nimport localStorageService from '../localStorage/localStorageService';\nimport { syncData } from './sync';\nimport { post, getPostRequest } from '../ajax/ajax';\nimport ulog from 'ulog';\nimport { TYPE_SOCIAL } from '../social/models';\n\nconst log = ulog('dataService');\n\nexport interface DataChangeEvent {\n  doc: any,\n  old?: any,\n}\n\nconst databaseScheme: DatabaseScheme =  {\n  name: 'guest_dx',\n  version: 17,\n  tables: [\n    {\n      name: TYPE_SETTINGS,\n      columns: 'id, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_PARTY,\n      columns: 'id, dirty, party, type, secondaryType',\n      sync: true\n    },\n    {\n      name: TYPE_TODO,\n      columns: 'id, done, deleted, list, *tags, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_TODO_LIST,\n      columns: 'id, dirty, folder, secondaryType, fullname',\n      sync: true\n    },\n    {\n      name: TYPE_TODO_TAG,\n      columns: 'id, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_HABBIT,\n      columns: 'id, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_MSG,\n      columns: 'id, messageType, dirty',\n      sync: true\n    },\n    {\n      name: TYPE_SOCIAL,\n      columns: 'id, name, dirty, secondaryType',\n      sync: true\n    },\n  ]\n}\n\n\n\nclass DataService {\n  private db;\n  private authId:string = '';\n  private _ready = false;\n  public _ready$ = new BehaviorSubject(this._ready);\n  public addSyncCall$ = new Subject(); // do we need to sync with server\n\n  constructor() {\n    //subscriptions\n    this.addSyncCall$.pipe(\n      throttleTime(5000),\n    ).subscribe(() => {\n        console.log('******************** SYNCING *************************')\n        this._syncRemote();\n      })\n  }\n\n  // access\n  async getDoc(id: string|undefined,  collection: string): Promise<any> {\n    if(id === undefined){\n      log.error('Id was undefined ', id, collection);\n      throw new Error('Doc Id cannot be undefined, check logic.');\n    }\n      \n    console.log('Get Doc: ', id, collection);\n    return await this.db.getDoc(id, collection);\n  }\n\n  async getBulk(ids: string[], collection: string): Promise<any> {\n   return await this.db.getBulk(ids, collection);\n  }\n\n  /*\n    operators: equals, \n               startsWith,\n               above,\n               below,\n               notEqual\n\n  */\n  async queryByProperty(field:string, operator: 'equals'|'startsWith'|'notEqual', \n      value: any, collection: string): Promise<any> {\n    return await this.db.queryByProperty(field, operator, value, collection);\n  }\n\n\n  async getAllByProject(projectid, collection): Promise<any> {\n    return await this.db.getProjectItems(getProjectChildId(projectid) + DIV, collection);\n  }\n\n  async getAllByChannel(channel, collection): Promise<any> {\n    return await this.db.getProjectItems(channel + DIV, collection);\n  }\n\n\n  async save(doc:any, collection: string, props:{projectid?: string, \n    oldDoc?: any,remoteSync?:boolean} = {}): Promise<any> {  \n      console.log('SAVING DOC *******************', doc, props, collection);\n      if(!props) props = {remoteSync: true};\n      if(props.remoteSync === undefined) props.remoteSync = true;\n    \n      try {\n        let oldDoc = {};\n        if (doc.id && props.oldDoc == null) {\n          oldDoc = await this.getDoc(doc.id, collection);\n        }\n    \n        console.log('Checking if no changes made: ', oldDoc);\n        if (_.isEqual(oldDoc, doc)) {\n          console.log('No changes, skip saving');\n          return false; \n        }\n    \n        if(!doc.id) {\n          if(!props.projectid) throw new Error('Saving new doc requires valid props.project')\n            // @ts-ignore:  we made this check at the begining\n          doc.id = generateCollectionId(props.projectid, collection);\n          doc.created = Date.now();\n          // doc.updated = Date.now();\n        }\n        //doc.updated = Date.now();\n        doc.dirty = true;\n        //res = await this._pouch.put({ ...oldDoc, ...doc });\n\n        const res = await this.db.save(doc, collection);\n\n        console.log('******* Are we syncing it with SERVER:::: ', props, props.remoteSync);\n        if (props.remoteSync)\n          this.addSyncCall$.next();\n\n\n        console.log('Saved doc: ', res);\n        if (res.ok)\n          return res;\n        else\n          return false;\n        }\n      catch (e) {\n        console.log('DEXIE error: ', e);\n        return false;\n      }\n  }\n\n  \n\n  \n\n\n  async saveNewProject(project:ProjectItem, collection: string): Promise<any> {\n    \n    const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/addNewChannel',\n                      {token: authService.getToken(), \n                       doc: project,\n                       name: project.name}, {} ),  false) ;\n    console.log(res);\n    if(!res.success)\n      return res;\n\n    const channel = res.data.channel;\n    let gotNewRightsToken = false;\n    let tokenres;\n    while(!gotNewRightsToken){\n      tokenres = await authService.renewToken();\n      console.log('Token Res::::::: ', tokenres);\n      console.log(authService.getUser(), channel);\n\n      const user = authService.getUser();\n      if(user.channels[channel]){\n        gotNewRightsToken = true;\n      }\n      else {\n        await waitMS(2000);\n      }\n    }\n    return await this.db.save(res.data.doc, collection, false);\n  }\n\n\n\n\n  async saveSystemDoc(doc: any, project:ProjectItem, collection: string): Promise<any> {\n    \n    //set id\n    const doc2 = {}\n    if(!doc.type) \n      throw new Error('Saving system doc requires doc to have type property');\n    if(doc.secondaryType)\n      doc2['secondaryType'] = doc.secondaryType;\n\n    const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/addNewSystemDoc',\n                      {...{ token: authService.getToken(), \n                        doctype: doc.type,\n                        channelid: getChannelFromProjectId(project.id),\n                        doc: doc }, ...doc2}, {} ), false) ;\n    console.log(res);\n    if(!res.success)\n      return res;\n\n    return await this.db.save(res.data.doc, collection, false);\n  }\n\n\n\n\n  public async remove(id: string, collection: string, remoteSync:boolean = true) {\n    try {\n      const doc = await this.getDoc(id, collection);\n      if(!doc) return false;\n      log.warn('Deleting doc: ',id);\n      log.warn(doc);\n      const res =  this.db.save({...doc, ...{deleted: true}}, collection);\n      console.log(res);\n      if (remoteSync)\n        this.addSyncCall$.next();\n      return res;\n    }\n    catch(e) {\n      console.log(e);\n      return null;\n    }\n  }\n\n  public async removeProject() {\n\n    /*\n    try {\n      //load all project children and remove them\n      //TODO, on server side, if notice project deleted, make sure all server children are also deleted\n      const res = await this._pouch.allDocs({\n        include_docs: true,\n        startkey: getProjectChildId(project._id),\n        endkey: getProjectChildId(project._id) + LASTCHAR\n      });\n      const docs = res.rows.map(row => Object.assign(\n        row.doc, { _deleted: true, updated: Date.now() }));\n\n      docs.push(Object.assign(project, { _deleted: true, updated: Date.now() }));\n      const res2 = await this._pouch.bulkDocs(docs);\n\n      if (syncRemote)\n        this.addSyncCall$.next();\n\n      return res2;\n    }\n    catch (e) {\n      console.log('Remove Project Error: ', e);\n    }\n    */ return false;\n  }\n\n\n\n  // streams\n\n  subscribeChanges(debounce = 0): Observable<any> {\n    return this.db.changes$.asObservable().pipe(\n      debounceTime(debounce),\n      map((change:DataChangeEvent) => change.doc )\n    );\n  }\n  \n\n  subscribeDocChanges(id: string, debounce: number = 0): Observable<any> {\n    return this.db.changes$.asObservable().pipe(\n      debounceTime(debounce),\n      filter((change: DataChangeEvent) => change.doc.id === id),\n      map((change: DataChangeEvent) => change.doc)\n    );\n  }\n\n\n  subscribeByPropertyChange(\n    property: string,\n    value: any,\n    debounce: number = 0): Observable<any> {\n    return this.db.changes$.asObservable().pipe(\n      debounceTime(debounce),\n      \n      filter((change: DataChangeEvent) => { \n        console.log('%%%%%%%%CHANGE LOG PROPERTY%%%%%%%%%%', change)\n        // eslint-disable-next-line eqeqeq\n        console.log('TESTING::: ',change.doc[property], value )\n        return (change.doc[property] == value);\n      }),\n      map((change: DataChangeEvent) => change.doc)\n    ); \n  }\n\n  subscribeProjectTypeChanges(projectid: string|undefined,\n    type: string,\n    debounce: number = 0): Observable<any> {\n    if(projectid === undefined) \n      throw new Error('Project id, can not be undefined, can not subscribe to id') ;\n    const projectChildId = getProjectChildId(projectid);\n    return this.db.changes$.asObservable().pipe(\n      debounceTime(debounce),\n      \n      filter((change: DataChangeEvent) => { \n        console.log('%%%%%%%%CHANGE LOG%%%%%%%%%%',change, projectChildId + DIV  + type + DIV)\n        return change.doc.id.startsWith(projectChildId + DIV + type + DIV);\n      }),\n      map((change: DataChangeEvent) => change.doc)\n    ); \n  }\n\n  //project id and channel only difference is the suffic at end of proejctid\n  subscribeChannelTypeChanges(channel: string|undefined,\n    type: string,\n    debounce: number = 0): Observable<any> {\n    if(channel === undefined) \n      throw new Error('Channel can not be undefined, can not subscribe to id') ;\n    return this.db.changes$.asObservable().pipe(\n      debounceTime(debounce),\n      filter((change: DataChangeEvent) => { \n        return change.doc.id.startsWith(channel + DIV + type + DIV);\n      }),\n      map((change: DataChangeEvent) => change.doc)\n    ); \n  }\n\n  // internal\n  public get ready() {\n    return this._ready;\n  }\n\n  public getReadySub() {\n    return this._ready$;\n  }\n\n  public set ready(value: boolean) {\n    this._ready = value;\n    if(value) // only send if true, this way we can have one time listeners\n      this._ready$.next(value);\n  }\n\n\n  public async init(authid: string , syncRemote = true) {\n    console.log('Init DB')\n    const scheme = databaseScheme;\n    scheme.name = authid;\n    this.db = new DexieAdapter(scheme);\n    const dbSub = this.db.ready$.subscribe(ready => {\n      console.log('Dexie Sub: ', ready);\n      if(!ready) return;\n\n      this.ready = true;\n      if (syncRemote)\n        this.addSyncCall$.next();\n\n      dbSub.unsubscribe();\n      \n    });\n  }\n\n  private async _syncRemote() {\n    //get check point\n    console.log('DATASERVICE:::&&&&&&&&&&&&&&&&&&&&&&&&&&&&::::::::::START');\n    let ck = Number(await localStorageService.getItem('SYNC_CHECKPOINT'));\n    if(!ck) ck = 0; \n    \n    //get data\n    //go thought all the tables and get dirty docs\n    let docs: any[] = [];\n    for(let i = 0; i < databaseScheme.tables.length; i++) {\n      console.log('Loading changes from: ', databaseScheme.tables[i].name);\n      if(!databaseScheme.tables[i].sync){\n        console.log('Skipping table');\n        continue;\n      }\n      const res = await this.db.queryByProperty('dirty', 'equals', 1, databaseScheme.tables[i].name);\n      console.log(databaseScheme.tables[i].name, res);\n      docs.push(...res);\n    }\n    console.log('DOCS TO SYNC **********************', docs);\n    const res = await syncData({  data: docs, \n                                  syncurl: env.SYNC_SERVER,\n                                  token: authService.getToken(),\n                                  checkpoint: 0,\n                                  requestMaxSize: 1000});\n    //save checkpoint\n    if(res) {\n      console.log('Sync finished::: ', res);\n      const keys = Object.keys(res);\n      console.log(keys);\n      for(let i = 0; i < keys.length; i++){\n        await this.db.saveFromSync(\n          res[keys[i]].map(doc => Object.assign(doc, {dirty: 0})), \n          keys[i]);\n      }\n    }\n\n  }\n\n\n\n}\n\nexport const dataService = new DataService();\n","\n\nexport const TYPE_MSG = 'msg';\n\nexport interface Msg {\n  id:string,\n  to:string, \n  from:string, \n  type:string, \n  messageType: string,\n  message:string, \n  data: any\n  replied?: {accepted: boolean, date:number},\n  deleted?: boolean\n}","import { Doc } from \"../data/models\";\n\nexport const TYPE_SOCIAL = 'social';\n\n\n\nexport class Friend extends Doc {\n  username!: string;\n  id!: string;\n  secondaryType?: string;\n\n\n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n    if(!values['username']) throw new Error('Friend Doc username required')\n    if(!values['id']) throw new Error('Friend Doc id required')\n  }\n}\n\n\n","import { Todo } from \"../../pages/todo/models\";\nimport moment from 'moment';\nimport { TODO_DONE_GOLD_REWARDS, TODO_DONE_EXPERIENCE_REWARDS } from \"./gamifyService\";\n\n\nexport const calculateLevelExperience = (level:number): number => {\n  let exp = 0;\n    for(let x = 1; x < level; x++){\n      exp += Math.floor((x+100) * Math.pow(2,(x/7)))\n    }\n  return Math.floor(exp/4);\n}\n\nexport const HEALTH_BASE = 50;\nexport const calculateLevelHealth = (level:number): number => {\n  let exp = HEALTH_BASE;\n    for(let x = 1; x < level; x++){\n      //console.log(Math.floor((x+150) * Math.pow(2,(x/50))));\n      exp += Math.floor(5 + (x/3));\n    }\n  return exp;\n}\n\nexport const HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE = 0.2;\nexport const HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE = 0.1;\nexport const calculateDoneTodoGold = (todo:Todo): number => {\n\n  let days = 0;\n  //how many days past\n  if(todo.date)\n    days = moment(todo.date).diff(moment(),'hour');\n\n  console.log('Diff Days::: ', days)\n  \n  const rew =TODO_DONE_GOLD_REWARDS + (HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE * days);\n\n  return Math.floor(rew);\n\n\n}\n\nexport const calculateDoneTodoExperience = (todo:Todo): number => {\n\n  let days = 0;\n  //how many days past\n  if(todo.date)\n    days = moment(todo.date).diff(moment(),'hour');\n\n  console.log('Diff Days::: ', days)\n  \n  const rew =TODO_DONE_EXPERIENCE_REWARDS + \n    (HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE * days);\n\n  return Math.floor(rew);\n\n\n}\n\n\n","import { BehaviorSubject } from 'rxjs';\nimport { toast } from 'react-toastify';\nimport { Todo } from '../../pages/todo/models';\nimport { Habit, HabitProgress } from '../../pages/habits/models';\nimport { saveIntoArray, waitMS } from '../../utils';\nimport { dataService } from '../data/dataService';\nimport { calculateLevelExperience, calculateDoneTodoGold, calculateDoneTodoExperience } from './utilsGamify';\nimport { throttleTime } from '../../../node_modules/rxjs/operators';\nimport { isEqual } from 'lodash';\nimport { getInitGamifyRewards } from '../../pages/habits/utilsHabits';\nimport { generateCollectionId, genrateMetaData, TYPE_SETTINGS, getDefaultProject } from '../data/utilsData';\nimport { env } from '../../env';\nimport { authService } from '../auth/authService';\n\n\nexport const HABIT_REWARDS_GOLD_BASE = 5;\nexport const HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE = 0.2;\nexport const HABIT_REWARDS_EXPERIENCE_BASE = 3;\nexport const HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE = 0.2;\nexport const HABIT_REWARDS_NEW_GOLD = 5;\nexport const HABIT_REWARDS_NEW_EXPERIENCE = 5; \n\nexport const TODO_NEW_GOLD_REWARDS = 1;\nexport const TODO_DONE_GOLD_REWARDS = 3;\nexport const TODO_NEW_EXPERIENCE_REWARDS = 2;\nexport const TODO_DONE_EXPERIENCE_REWARDS = 5;\n\nexport const MESSAGE_DURATION = 3000;\n\nexport interface GamifyState {\n  health:number,\n  maxHealth: number,\n  experience: number,\n  maxExperience: number,\n  level: number,\n  gold: number,\n\n  items: any[],\n}\n\nexport const getInitGamifyState = () => {\n  return {\n    health: 50,\n    maxHealth: 50,\n    experience: 0,\n    maxExperience: 20,\n    level: 1,\n    gold: 0,\n\n    items:[]\n  }\n}\n\nexport class GamifyService {\n\n  private _userId = '';\n  private _subscriptions:any[] = [];\n  private _state: GamifyState = getInitGamifyState();\n  \n  public state$ = new BehaviorSubject<GamifyState>(this._state);\n  \n\n  public async init(userid: string) {\n    console.log('-------------Gamify INIT', userid);\n    this.unsubscribe();\n    this._userId = userid;\n    const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n      if(!ready) return;\n\n      const doc = await this.loadInitDocs(userid);\n      console.log('GAMIFY DOC:::: ', doc);\n\n      const sub = this.state$.pipe(throttleTime(10000)).subscribe(()=>{\n        this._save();\n      })\n  \n      const sub2 = dataService.subscribeDocChanges(this.getGamifyDocId() ,1000)\n        .subscribe(doc => {\n          console.log(\"DOC================================\", doc);\n          const equal = isEqual(this._state, doc.state);\n          console.log(\"Gamify State Equal: \", equal);\n          if(!equal)\n            this.state = doc.state;\n        });\n  \n      this._subscriptions.push(sub);\n      this._subscriptions.push(sub2);\n  \n      //load the init stae\n      if(doc)\n        this.state = doc.state;\n\n      dataSub.unsubscribe();\n    })\n  }\n\n\n\n  private unsubscribe() {\n    this._subscriptions.forEach(s=>{\n      if(s)s.unsubscribe();\n    })\n  }\n\n  public calculateFinishedTodoRewards = (todo: Todo): Todo => {\n    if(!todo.doneRewards || !todo.doneRewards.gold){\n      todo.newRewards = getInitGamifyRewards({\n        gold: calculateDoneTodoGold(todo),\n        experience: calculateDoneTodoExperience(todo),\n        item: null\n      });\n    }\n\n    if(todo.done){\n      // @ts-ignore: top, just added values\n      this.addGold(todo.newRewards.gold);\n      // @ts-ignore: \n      this.messageReceivedGold(todo.newRewards.gold)\n      // @ts-ignore: top, just added values\n      this.addExperience(todo.newRewards.experience);\n      // @ts-ignore:\n      this.messageReceivedExperience(todo.newRewards.experience)\n    }\n    else {\n      // @ts-ignore: top, just added values\n      this.addGold(todo.newRewards.gold * -1);\n      // @ts-ignore: \n      this.messageLostGold(todo.newRewards.gold)\n      // @ts-ignore: top, just added values\n      this.addExperience(todo.newRewards.experience * -1);\n      // @ts-ignore:\n      this.messageLostExperience(todo.newRewards.experience)\n    }\n\n    return {...{}, ...todo};\n  }\n\n  public calculateNewTodo = (todo: Todo): Todo => {\n    todo.newRewards = getInitGamifyRewards({\n      gold: TODO_NEW_GOLD_REWARDS,\n      experience: TODO_NEW_EXPERIENCE_REWARDS,\n      item: null,\n    });\n\n    // @ts-ignore: top, just added values\n    this.addGold(todo.newRewards.gold);\n    // @ts-ignore: \n    this.messageReceivedGold(todo.newRewards.gold)\n    // @ts-ignore: top, just added values\n    this.addExperience(todo.newRewards.experience);\n    // @ts-ignore:\n    this.messageReceivedExperience(todo.newRewards.experience)\n\n    return {...{} ,...todo};\n  }\n\n  public calculateNewHabitRewards = (habit:Habit): Habit => {\n    habit.newRewards = getInitGamifyRewards({\n      gold: HABIT_REWARDS_NEW_GOLD,\n      experience: HABIT_REWARDS_NEW_EXPERIENCE,\n      item: null,\n    });\n\n    // @ts-ignore: top, just added values\n    this.addGold(habit.newRewards.gold);\n    // @ts-ignore: \n    this.messageReceivedGold(habit.newRewards.gold)\n    // @ts-ignore: top, just added values\n    this.addExperience(habit.newRewards.experience);\n    // @ts-ignore:\n    this.messageReceivedExperience(habit.newRewards.experience)\n\n    return {...{}, ...habit};\n  }\n\n  private addGold(value:number) {\n    this.state = {...this._state, ...{gold: this._state.gold + value}};\n  }\n\n  private addExperience(value: number) {\n    let experience = this._state.experience + value;\n    \n    if(experience > this._state.maxExperience){\n      experience = (this._state.maxExperience - experience) * -1;\n      this._state = {...this._state, \n        ...{maxExperience: calculateLevelExperience(this._state.level+1),\n            level: this._state.level + 1}}\n    }\n      \n    \n    this.state = {...this._state, ...{experience}}\n  }\n\n  public calculateHabitProgressRewards(habit:Habit, progress: HabitProgress): Habit {\n    if(!habit.regularityEachDayGoal) habit.regularityEachDayGoal = 1; // default\n\n    const prog: HabitProgress = Object.assign(progress)\n\n    if(!progress.reward) {\n      // calculate rewards\n      prog.reward = getInitGamifyRewards();\n      let gold = HABIT_REWARDS_GOLD_BASE;\n      let exp = HABIT_REWARDS_EXPERIENCE_BASE;\n      for(let i = 0; i<habit.currentStreak; i++) {\n        gold += gold*HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE;\n        exp += exp*HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE;\n      }\n      prog.reward.gold = Math.round(gold);\n      prog.reward.experience = Math.round(exp);\n\n      habit.progress = saveIntoArray(prog, habit.progress, 'date');\n    }\n\n    if(prog.value >= habit.regularityEachDayGoal) {\n      \n      if(prog.reward && prog.reward.gold){\n        this.messageReceivedGold(prog.reward.gold);\n        this.addGold(prog.reward.gold);\n      }\n        \n      if(prog.reward && prog.reward.experience){\n        this.messageReceivedExperience(prog.reward.experience);\n        this.addExperience(prog.reward.experience)\n      }\n        \n    }\n    else {\n      if(prog.reward && prog.reward.gold){\n        this.messageLostGold(prog.reward.gold);\n        this.addGold(prog.reward.gold * -1);\n      }\n        \n      if(prog.reward && prog.reward.experience){\n        this.messageLostExperience(prog.reward.experience * -1);\n        this.addExperience(prog.reward.experience * -1)\n      }\n        \n    }\n\n    return habit;\n  }\n\n  private messageReceivedGold(gold: number, preMessage?:string, postMessage?:string) {\n    if(!preMessage) preMessage = '';\n    if(!postMessage) postMessage = '';\n    toast.success(preMessage+' You have received ' + gold + ' gold '+postMessage,{autoClose:MESSAGE_DURATION});\n  }\n\n  private messageLostGold(gold:number, preMessage?:string, postMessage?:string) {\n    if(!preMessage) preMessage = '';\n    if(!postMessage) postMessage = '';\n    toast.error(preMessage+' You have lost ' + gold + ' gold'+postMessage, {autoClose:MESSAGE_DURATION});\n  }\n\n  private messageReceivedExperience(exp: number, preMessage?:string, postMessage?:string) {\n    if(!preMessage) preMessage = '';\n    if(!postMessage) postMessage = '';\n    toast.success(preMessage+' You have received ' + exp + ' experience'+postMessage,{autoClose:MESSAGE_DURATION});\n  }\n\n  private messageLostExperience(exp:number, preMessage?:string, postMessage?:string) {\n    if(!preMessage) preMessage = '';\n    if(!postMessage) postMessage = '';\n    toast.error(preMessage+' You have lost ' + exp + ' experience'+postMessage, {autoClose:MESSAGE_DURATION});\n  }\n  \n  private async _save() {\n    try{\n      const doc = await dataService.getDoc(this.getGamifyDocId(), TYPE_SETTINGS);\n\n      if(!doc){\n        console.log(\"Couldn't load gamify doc: \", this.getGamifyDocId());\n        return;\n      }\n\n      console.log('========Gamify State Doc: ',this.getGamifyDocId(), doc);\n      const equal = isEqual(this._state, doc.state);\n      //make sure we are not saving the init state\n      const initEqual = isEqual(this.state, getInitGamifyState());\n\n      console.log('Saving gamify state::: ', equal, initEqual);\n      if(!equal && !initEqual && doc.userid ===  this._userId) {\n        console.log(\"Saving: \", {...doc, ...{state: this._state}})\n        dataService.save({...doc, ...{state: this._state}}, TYPE_SETTINGS);\n      }\n    }\n    catch(e) {\n      console.log(e);\n    }\n    \n  }\n\n  private getGamifyDocId(): string {\n    const defaultProject = getDefaultProject(authService.userid);\n    const id =  generateCollectionId(defaultProject.id, 'gamify', '');\n    return id.substring(0, id.length-1);\n  }\n\n  private async loadInitDocs(id: string): Promise<any> {\n    try {\n      console.log('Gamify ID: ' + this.getGamifyDocId());\n      const s = await dataService.getDoc(this.getGamifyDocId(), TYPE_SETTINGS);\n      console.log('--- gamify doc loaded: ', id, s);\n      if(s) return s;\n      console.log('Saving gamify new doc');   \n      const ts = Date.now();   \n      if(id === this._userId){  //half second pased, see if state changed\n        const res = await dataService.save({\n          id: this.getGamifyDocId(),\n          state: getInitGamifyState(),\n          type: TYPE_SETTINGS,\n          [env.ACCESS_META_KEY]: genrateMetaData(id),\n          userid: id,\n          created: ts,\n          updated: ts\n        }, TYPE_SETTINGS)\n      return res;\n      }\n    }\n    catch(e) {\n      console.log(e.red, id);\n    }\n\n    \n  }\n\n  public get state(): GamifyState {\n    return this._state;\n  }\n  public set state(value: GamifyState) {\n    this._state = value;\n    this.state$.next(value);\n  }\n\n}\nexport const gamifyService = new GamifyService();\n\n\n","import React, { useState } from 'react'\nimport Lottie from 'react-lottie';\nimport './default.css'\n\nexport const waitMS = (ms: number) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\n\nfunction AnimatedIcon({iconsvg, actionFunc}:\n    {iconsvg:any, actionFunc:Function}) {\n  const [state, setState] = useState({isStopped:true, isPaused:true})\n\n\n  const defaultOptions = {\n    loop: true,\n    autoplay: false, \n    render: 'svg',\n    animationData: iconsvg,\n    rendererSettings: {\n      clearCanvas: true,\n      scaleMode: 'noScale',\n      preserveAspectRatio: 'xMidYMid slice'\n    }\n  }; \n\n  const actionHandler = async() => {\n    setState({isStopped:false, isPaused:false});\n    \n\n    await waitMS(1000);\n    actionFunc();\n    setState({isStopped:true, isPaused:true});\n  }\n\n  return (\n    <div onClick={() => actionHandler()} className =\"animatedfunction\">\n      <Lottie  options={defaultOptions}\n          height={25}\n          width={25}\n          isStopped={state.isPaused}\n          isPaused={state.isStopped}/>\n    </div>\n  )\n}\n\nexport default AnimatedIcon;\n","import React, { useState, useEffect, useReducer } from 'react';\nimport { IonLabel, IonRow, IonCol, \n        IonIcon, IonGrid, IonButton, IonItemGroup, IonItemSliding, IonItem, IonItemOptions, IonItemOption, IonText, IonAvatar, IonThumbnail } from '@ionic/react';\nimport { Todo, TodoList, TodoTag } from './models';\nimport _ from 'lodash';\nimport { radioButtonOff, radioButtonOn, sunny, star, heart, basket, construct, arrowDownCircle, arrowForwardCircle, checkmark } from '../../../node_modules/ionicons/icons';\nimport { printCleanNote, getAction } from '../../utils';\nimport './todo.component.css'\nimport { DataFunctions } from './hooks/todos.hook';\nimport TodoEditInlineComponent from './todo.edit.inline.component';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport ulog from 'ulog'\nimport check from '../../icons/check.json';\nimport restart from '../../icons/restart.json'\nimport AnimatedIcon from '../../components/animatedIcon';\n\nconst log = ulog('todo');\n\nexport interface TodoState {\n  todo: Todo,\n}\n\n\nconst reducer = (state, {type, payload}): TodoState => {\n  switch(type) {\n    case 'updateTodo':\n      return {...state, ...{todo:payload}};\n    \n    default:\n      return state;\n  }\n}\n\n\n//Component Start\nconst TodoListItemComp = ({todo, tagDocs, selectedTodo, lastChild,  dataFunctions}:\n  {todo:Todo, tagDocs:TodoTag[], lastChild: boolean,  selectedTodo: Todo|null,  dataFunctions: DataFunctions}) => {\n  \n\n  const [state, _dispatch] = useReducer(reducer, \n    {todo: todo, })\n\n  useEffect(() => {\n    dispatch('updateTodo', todo);\n  }, [todo])\n  \n  const dispatch = (type:'updateTodo'|\n                          'any', \n                    payload:any = {}) => {\n    _dispatch({type, payload});\n  }\n  \n  console.log('STATE TODONAME: ', state.todo.name);\n  console.log(state);\n\n\n  const doneHandler = () => {\n    const newDoc = gamifyService.calculateFinishedTodoRewards(\n        {...state.todo, ...{done: !state.todo.done}});\n    dispatch('updateTodo', newDoc);\n    dataFunctions.save(newDoc);\n  }\n\n  const handleSelectTodo = () => {\n    if(selectedTodo && state.todo.id === selectedTodo.id){\n      dataFunctions.select(null);\n    }\n    else {\n      dataFunctions.select(state.todo);\n    }\n  }\n\n  \n\n  const printSmallTagFromFullname = (name:string) => {\n    log.warn(tagDocs);\n    const tag = tagDocs.find(t => t.fullname === name);\n    console.log('Print small tag: ',tag, name)\n    if(tag && tag.icon) {\n      return <IonIcon  \n                key={tag.fullname}\n                size=\"small\" \n                color='success' \n                src={\"/assets/icons/\"+tag.icon} />\n    }\n\n    return <IonIcon  \n                key={name}\n                size=\"small\" \n                color='success' \n                src={\"/assets/icons/tag.svg\"} >\n          {name}  \n          </IonIcon>\n    \n  }\n\n\n\n\n  const printTask = () => (\n    <>\n      <IonItem  button \n            color={((selectedTodo && selectedTodo.id === state.todo.id)? 'light' : '')}   \n            lines=\"full\">\n        \n            <IonAvatar onClick={() => {}} slot=\"start\">\n              {state.todo.done? (\n                <AnimatedIcon  iconsvg={restart} actionFunc={doneHandler} />\n              ) : (\n                <AnimatedIcon  iconsvg={check} actionFunc={doneHandler} />\n              )}\n              \n            </IonAvatar>\n              <IonLabel onClick={handleSelectTodo}>\n              <IonText color=\"primary\">\n                  <h2>{state.todo.name}</h2>\n              </IonText>\n              {state.todo.note? (\n                <IonText color=\"secondary\">\n                  <p>{state.todo.note}</p>\n                </IonText> \n              ) : (<></>)}\n               \n              </IonLabel>\n              {state.todo.tags.sort().map(\n                tag=>printSmallTagFromFullname(tag)\n              )}\n        </IonItem>\n        {printEdit()}\n    </>\n  )\n\n\n  const printEdit = () => {\n    if(!selectedTodo || selectedTodo.id !== state.todo.id) return;\n    return (\n      <IonGrid>\n        <IonRow>\n            <IonCol class=\"todoTitleColumn\" onClick={() => {}}  >\n              <TodoEditInlineComponent \n                          todo={state.todo}\n                          tagDocs={tagDocs}\n                          dataFunctions={dataFunctions} />\n                        \n            </IonCol>\n        </IonRow>\n      </IonGrid>\n    )\n  }\n  \n\n  return printTask();\n};\n\nexport default TodoListItemComp;\n","\nimport { Todo, TYPE_TODO, TodoList, TYPE_TODO_LIST, TodoTag, TYPE_TODO_TAG, getDefaultTodoList, getDefaultTodoTag } from './models';\nimport { BehaviorSubject, Subscription } from 'rxjs';\nimport { dataService } from '../../modules/data/dataService';\nimport { waitMS, getProjectChildId } from '../../modules/data/utilsData';\nimport _ from 'lodash';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport ulog from 'ulog';\nimport { toastService } from '../../modules/toast/toastService';\nimport sun from '../../icons/sun.json'\nimport star from '../../icons/star.json'\n\nconst log = ulog('todo');\n\n\nexport interface TodoState {\n  selectedTodo: Todo|null,\n  list: TodoList|undefined,\n  tag: TodoTag|undefined,\n  docs: Todo[],\n  tagDocs: TodoTag[],\n  doneTodos: boolean,\n}\n\n\n\nexport const getInitTodoState = (): TodoState => {\n  return {\n    selectedTodo:null,\n    list: undefined,\n    tag: undefined,\n    docs: [],\n    tagDocs: [],\n    doneTodos: false,\n  }\n}\n\n\nexport class TodoService {\n  \n  // @ts-ignore: it will be initialized in init\n  private _projectid: string;\n  private _state: TodoState = getInitTodoState();\n  public state$ = new BehaviorSubject(this._state);\n  private _subscription: Array<Subscription> = [];\n\n  public init(projectid: string, list:string|undefined, tag:string|undefined) {\n    log.warn(projectid, list, tag);\n    //first unsubscribe\n    this.unsubscribe();\n    const dataSub = dataService.getReadySub().subscribe( async (ready) => {\n      if(!ready) return;\n      \n      this._init(projectid, list, tag);\n\n      await waitMS(1000);\n      dataSub.unsubscribe();\n    });\n  }\n\n  async _init(projectid: string, listName: string|undefined, tagName: string|undefined) {\n    console.log('-------------------------------------------');\n    console.log(\"Init: \", projectid, TYPE_TODO);\n\n    if(this._projectid  === projectid && \n        this._state.list?.fullname === listName && \n        this._state.tag?.fullname === tagName) return;\n\n    let list, tag\n    if(!listName && !tagName){\n      list = getDefaultTodoList('default', projectid)     \n    }\n    if(listName)\n      list = getDefaultTodoList(listName, projectid)    \n    if(tagName)\n      tag = getDefaultTodoTag(tagName, projectid);\n\n\n\n    this._state = {...this.state, ...{\n      tag, \n      list,\n      tagDocs: this.getTags(projectid)}};\n    \n      log.warn(this._state);\n    \n    this._projectid = projectid;\n    \n    log.info(this.state);\n\n    this.reloadTodos();\n\n    const sub = dataService.subscribeProjectTypeChanges(projectid,TYPE_TODO)\n      .subscribe((doc: Todo) => {\n        log.log(\"TodoService subscription: \", doc); \n        this.reloadTodos();\n      });\n    this._subscription.push(sub);\n\n  }\n\n  async reloadTodos() {\n    log.info('RELOADING TODOS::: ', this.state)\n      let docs;\n    if(this.state.list){\n        log.info('Todo Query by List')\n        docs = await dataService.queryByProperty(\n          'list', 'equals', this.state.list.fullname, TYPE_TODO);\n    }\n     else if(this.state.tag){\n        log.info('Todo Query by Tags')\n        docs = await dataService.queryByProperty(\n          'tags', 'equals', this.state.tag.fullname, TYPE_TODO);\n    }\n\n    this.filterAndSaveTodos(docs);\n   \n  }\n\n  private filterAndSaveTodos(docs: Todo[]):Todo[] {\n    const filtered = docs.filter(doc => this.filterDoneParentFunction(doc));\n    this.state = {...this.state, ...{docs: filtered}};\n    return filtered;\n  }\n\n  private filterDoneParentFunction(doc:Todo) {\n      console.log('Filter1: ', doc.done !== this._state.doneTodos)\n      if (doc.done !== this._state.doneTodos) return false;\n      return true;\n  }\n\n\n \n  public get state(): TodoState {\n    return this._state;\n  }\n  public set state(value: TodoState) {\n    console.log('State: ', value);\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n  public async addSubTodoToParent (todoId: string, parentId: string) {\n    try {\n      const parentTodo: Todo = await dataService.getDoc(parentId, TYPE_TODO);\n      if (parentTodo) {\n        if(!parentTodo.subTodos) parentTodo.subTodos = [];\n        parentTodo.subTodos = _.concat(parentTodo.subTodos, todoId);\n        this.save(parentTodo);\n      }\n    }\n    catch(e) {\n      console.log(e);\n    }\n  }\n\n  public async removeSubTodoFromParent (todoId: string, parentId) {\n    try {\n      const parentTodo: Todo = await dataService.getDoc(parentId, TYPE_TODO);\n      if (parentTodo) {\n        if(!parentTodo.subTodos) parentTodo.subTodos = [];\n        parentTodo.subTodos = _.filter(parentTodo.subTodos, t=>t!== todoId);\n        this.save(parentTodo);\n      }\n    }\n    catch(e) {\n      console.log(e);\n    }\n  }\n\n\n  public async save(doc:Todo, parentId: string|null = null) {\n    console.log(\"------- Save: \", doc, this._projectid, TYPE_TODO);\n    //see if its new\n    if(doc._new) {\n      delete(doc._new);\n      doc.tags = [];\n      if(this.state.list)\n        doc.list = this.state.list.fullname;\n      else\n        doc.list = getProjectChildId(this._projectid)+'default'\n      if(!doc.tags){\n        doc.tags = [];\n      }\n      if(this.state.tag)\n        doc.tags.push(this.state.tag.fullname)\n     \n        \n\n      doc = gamifyService.calculateNewTodo(doc);\n    }\n    const res = await dataService.save({...{done: false}, ...doc}, TYPE_TODO, {projectid: this._projectid});\n    if(parentId && doc.id) {\n      this.addSubTodoToParent(doc.id, parentId)\n    }\n    console.log(res);\n    return res;\n\n  }\n\n  public async saveList(doc:TodoList) {\n    log.info('Save New TodoList: ', doc);\n    if(doc._new) {\n      //make sure its not a duplicate\n      const res = await dataService.getDoc(doc.id, TYPE_TODO_LIST);\n      if(res){\n        //error, its a duplicate\n        toastService.printSimpleError('List Already Exists');\n        return;\n      }\n      delete doc._new;;\n      const saveRes = await dataService.save(doc, TYPE_TODO_LIST);\n      log.info(saveRes);\n      return saveRes;\n    }\n  }\n\n  public async deleteList(list:TodoList) {\n    //get all docs that are in this list\n    log.warn(list);\n    const docs = await dataService.queryByProperty('list', 'equals', list.fullname,TYPE_TODO);\n    log.warn(docs);\n    //delete all items\n    for(let i = 0; i < docs.length; i ++){\n      dataService.remove(docs[i].id, TYPE_TODO);\n    }\n    if(list.id)\n      dataService.remove(list.id, TYPE_TODO_LIST);\n  }\n\n  public async remove(id: string) {\n    //see if this doc has parent\n    try {\n      const todo: Todo = await dataService.getDoc(id, TYPE_TODO);\n      if (todo) {\n        if(todo.parent) {\n          this.removeSubTodoFromParent(id, todo.parent);\n        }\n      }\n    }\n    catch(e) {\n      console.log(e);\n    }\n    dataService.remove(id, TYPE_TODO);\n  }\n\n  public select(doc:Todo | null) {\n    this.state = {...this._state, ...{ selectedTodo: doc} };\n  }\n\n  public changeDoneFilter(done: boolean) {\n    if(done === this._state.doneTodos) return;\n    this._state = {...this._state, ...{ doneTodos: done} };\n    this.reloadTodos();\n\n  }\n\n  public getTags(projectid):TodoTag[] {\n    const today =  {\n        type: TYPE_TODO_TAG,\n        id:'',\n        name: 'today',\n        fullname: getProjectChildId(projectid) + 'today',\n        icon: 'sun.svg',\n        animatedIcon: sun,\n      };\n    today.fullname = getProjectChildId(projectid) + 'today';\n    const important ={\n        id:'',\n        type: TYPE_TODO_TAG,\n        name: 'important',\n        fullname: getProjectChildId(projectid) + 'important',\n        icon: 'star.svg',\n        animatedIcon: star,\n      };\n    today.fullname = getProjectChildId(projectid) + 'today';\n    //console.log(today, important);\n    const tags =  [today, important];\n    console.log(tags);\n    return tags;\n  }\n\n\n  public selectList(list:TodoList) {\n    if(list === this._state.list) return;\n    this._state = {...this._state, ...{ list } };\n    this.reloadTodos();\n  }\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\n\n\nexport  const todoService = new TodoService(); ","import { useEffect, useState, useRef } from 'react';\nimport { Subscription } from 'rxjs';\nimport { Todo, TodoList, getDefaultTodoList, getDefaultTodoTag } from '../models';\nimport { TodoService, TodoState, getInitTodoState } from '../todo.service';\nimport ulog from 'ulog';\n\nconst log = ulog('todo');\n\nexport interface DataFunctions {\n  save: {(doc: Todo, parentId?: string|null):Promise<any>},\n  remove: {(id: string)},\n  select: {(doc: Todo | null)},\n  selectList: {(list: TodoList)},\n  changeDoneFilter: {(done:boolean)}\n}\n\n\n//more simpler then auth hook, just read data\nexport function useTodosCollectionFacade(\n  projectid: string| undefined, list:string|undefined, tag:string|undefined): \n  [TodoState, DataFunctions]{\n  \n  log.warn(projectid, list, tag);\n                           \n  if(!projectid) throw new Error('Projectid can not be undefined');\n  const [state, setState] = useState(getInitTodoState());\n  const todoService = useRef(new TodoService());\n          \n  const dataFunctions = {\n    save: (doc: Todo, parentId?: string|null):Promise<any> => todoService.current.save(doc, parentId),\n    remove: (id) => todoService.current.remove(id), //TODO: allow user to choose, sync or not to sync\n    select: (doc: Todo | null) => todoService.current.select(doc),\n    selectList: (list: TodoList) => todoService.current.selectList(list),\n    changeDoneFilter: (done:boolean) => todoService.current.changeDoneFilter(done),\n  }\n\n  useEffect(() => {\n    todoService.current.init(projectid, list, tag)\n    return todoService.current.unsubscribe;\n  }, [projectid, list, tag])\n\n  useEffect(() => {\n    console.log('EFFECT ====================');\n    const subscriptions: Subscription[] = [\n      todoService.current.state$.subscribe(state => {\n        console.log('TODO Hook Sub: ', state);\n        setState(state);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[projectid]);\n\n\n  return [state, dataFunctions];\n}","import { useEffect, useState } from 'react';\nimport { Subscription } from 'rxjs';\nimport { dataService } from '../../data/dataService';\nimport { GUEST, authService } from '../../auth/authService';\nimport { gamifyService } from '../../gamify/gamifyService';\nimport { partyService } from '../../parties/party.service';\n\nexport enum AppStatus {\n  loading, auth, guest\n}\n\n// username, authenticated, login, logout, renewToken\nexport function useAppStatus(): [{status:AppStatus, dataReady:boolean, username:string}] {\n\n  const [appStatus, setAppStatus] = useState({status: AppStatus.loading, dataReady: false, username: GUEST});\n\n\n  console.log('APP Router Status: ', appStatus);\n\n  useEffect(() => {\n    console.log('App Stats Effect::');\n    const subscriptions: Subscription[] = [\n      dataService.getReadySub().subscribe(ready => {\n        console.log('DataService READY', ready, dataService.ready);\n        if(ready === appStatus.dataReady) return;\n          setStatusFunction();\n      }),\n      authService.username$.subscribe(async (username) => {\n        console.log('USERNAME CHANGED: ', username);\n\n        //renew token\n        if(authService.getIsAuthenticated()){\n          authService.renewToken();\n        }\n        \n        setStatusFunction();\n        console.log('USER:::::: ', authService.getUser(), authService.getIsAuthenticated())\n        const userid = authService.getUser().id;\n        await dataService.init( userid, username !== GUEST);\n        console.log(\"Ready to start gamify service\");\n        await gamifyService.init(userid);\n        await partyService.init();\n      }),\n\n    ];\n    // usersService.loadAll();\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[]);\n\n\n  const setStatusFunction = () => {\n    const dataReady = dataService.ready;\n    const username = authService.getUsername();\n    if(dataReady === appStatus.dataReady && username === appStatus.username)\n      return;\n    console.log('STATUS ----------------', dataReady, username, appStatus);\n    \n    if(dataReady){\n      if(username === GUEST)\n        setAppStatus({ status:AppStatus.guest, username: username, dataReady: dataReady });\n      else\n        setAppStatus({ status:AppStatus.auth, username: username, dataReady: dataReady });\n    }\n    else {\n      setAppStatus({ status:AppStatus.loading, username: username, dataReady: dataReady });\n    }\n  };\n\n  return [ appStatus ];\n}","import React, { useState, useEffect } from 'react';\nimport { IonHeader, IonIcon, IonBadge } from '@ionic/react';\nimport { Line } from 'rc-progress';\nimport { gamifyService, getInitGamifyState, GamifyState } from '../modules/gamify/gamifyService';\n\n\n\nimport './header.css';\nimport 'rc-progress/assets/index.css';\nimport { heart, star, leaf, logoUsd } from 'ionicons/icons';\n\nconst HeaderWithProgress = ({title}:{title:string}) => {\n\n  const [state, setState] = useState<GamifyState>(getInitGamifyState())\n\n  const {health, maxHealth, experience, maxExperience, level, gold} = state;\n\n  useEffect(() => {\n    const sub = gamifyService.state$.subscribe(s => {\n      setState({...state, ...s});\n    })\n    return () => {\n      sub.unsubscribe();\n    };\n  }, [])\n\n\n  return (\n    <IonHeader className=\"headerWithAvatar\">\n      <div className=\"cityParent\">\n        <img src=\"/assets/pics/hills.svg\" style={{right:'25px'}} className=\"headerHills\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/hills.svg\" style={{right:'200px'}} className=\"headerHills\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/ground.svg\" className=\"headerGround\" alt=\"Ground\"/>\n        <img src=\"/assets/pics/sun.svg\" style={{right:'130px', top: '10px', width:'5%'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud2.svg\" style={{right:'240px', top: '40px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud1.svg\" style={{right:'60px', top: '40px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud2.svg\" style={{right:'140px', top: '15px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n      </div>\n      <div className=\"statsParent\" >\n        <div className=\"statsBarParent\" >\n          <IonIcon class=\"statsBarIcon\" icon={heart} style={{color: \"#C20114\"}} />\n          <Line trailWidth={0} percent={health/maxHealth * 100} \n                className=\"statsBarLine\"\n                strokeWidth={4} strokeColor=\"#C20114\" />\n          <IonBadge class=\"statsBarBadge\" \n                    color=\"danger\" >{health}/{maxHealth}</IonBadge>\n        </div>\n        <div className=\"statsBarParent\" >\n        <IonIcon class=\"statsBarIcon\" icon={leaf} style={{color: \"#157F1F\"}} />\n          <Line trailWidth={0}  percent={experience/maxExperience * 100} \n                className=\"statsBarLine\"\n                strokeWidth={4} strokeColor=\"#157F1F\" />\n          <IonBadge class=\"statsBarBadge\" \n                    color=\"success\" >{experience}/{maxExperience}</IonBadge>\n        </div>\n        <div className=\"statsBarMoneyParent\" >\n          <IonBadge class=\"statsBarMoneyBadge\" \n                    color=\"warning\" >Gold: {gold}</IonBadge>\n          <IonBadge class=\"statsBarMoneyBadge\" \n                    color=\"success\" >Level: {level}</IonBadge>\n        </div>\n      </div>\n        \n      <h1>{title}</h1>\n    </IonHeader>\n  )\n}\n\nexport default HeaderWithProgress;","import React from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonItem,\n  IonButton} from '@ionic/react';\nimport TodoNewComp from './todo.new.component';\nimport TodoListItemComp from './Todo.listitem.component';\nimport { useTodosCollectionFacade } from './hooks/todos.hook';\nimport './todos.page.css';\nimport HeaderWithProgress from '../../components/HeaderWithProgress';\nimport { useParams, useLocation } from 'react-router-dom';\nimport { capitalize } from '../../utils';\nimport { getDefaultProject } from '../../modules/data/utilsData';\nimport { authService } from '../../modules/auth/authService';\nimport ulog from 'ulog';\n\nconst log = ulog('todo');\n\n\nconst TodosPage  = () => {\n\n  const project = getDefaultProject(authService.userid);\n  const location = useLocation();\n  \n\n  let list, tag;\n  const params = useParams();\n  log.info(params, location);\n  if(location.pathname.startsWith('/todos/tag/')){\n   tag = params['tag']\n  }\n  else {\n    list = params['list']\n  }\n\n  \n  console.log('LIST::: ', list);\n  const [state, dataFunc] = useTodosCollectionFacade(project.id, list, tag)\n  const { docs, selectedTodo, tagDocs } = state;\n\n  console.log(docs);\n  // dataFunc.selectTag(tag? tag: 'all')\n\n  const printTitle = ():string => {\n    if(state.list){\n      return 'Todos: ' + capitalize(state.list.name);\n    }\n    return 'Todos';\n  }\n\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title={printTitle()} />\n      <IonContent id=\"todoContent\">\n        \n        <IonItem>  \n          <TodoNewComp \n                       list = {state.list}\n                       tag = {undefined}\n                       projectId={project.id||''} \n                       saveFunc={dataFunc.save} />\n        </IonItem>\n        <div>\n          <IonButton  color={(state.doneTodos)? 'light':'success'} \n                      class=\"todoHeaderButtons\" \n                      onClick={() => {dataFunc.changeDoneFilter(false)}}\n                      fill=\"clear\">Active</IonButton>\n          <IonButton  color={(!state.doneTodos)? 'light':'success'} \n                      class=\"todoHeaderButtons\" \n                      onClick={() => {dataFunc.changeDoneFilter(true)}}\n                      fill=\"clear\">Finished</IonButton>\n        </div>\n        <IonList>\n            {docs.map(todo => (\n              <TodoListItemComp   todo={todo} \n                                  tagDocs={tagDocs}\n                                  lastChild = {false}\n                                  selectedTodo={selectedTodo}                                 \n                                  dataFunctions={dataFunc}\n                                  key={todo.id} />\n            ))}\n        </IonList>\n        \n\n\n        {/*(selectedTodo )? (\n          <div className=\"floating-menu\">\n            <TodoEditComponent todo={selectedTodo} tags={tags} dataFunctions={dataFunc} />\n          </div>\n        ) : (\n          <></>\n        )*/}\n\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default TodosPage;\n\n","import React from 'react';\nimport { IonHeader, IonToolbar, IonPage, IonTitle, IonContent, IonLabel } from '@ionic/react';\n\n\n\nconst IntroPage: React.FC = () => {\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>Loading</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonLabel>Loading.....</IonLabel>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default IntroPage;\n","import { Subscription, BehaviorSubject } from \"rxjs\";\nimport { PartyProject, TYPE_PARTY, Challenge } from \"./models\";\nimport { getPostRequest, post } from '../ajax/ajax';\nimport { env } from \"../../env\";\nimport { AuthService, authService } from '../auth/authService';\nimport { loadingService } from \"../loading/loadingService\";\nimport { toastService, ToastType } from \"../toast/toastService\";\nimport { dataService } from \"../data/dataService\";\nimport { waitMS, getChannelFromProjectId } from '../data/utilsData';\nimport { saveIntoArray, saveIntoDocList } from '../../utils';\nimport { Msg, TYPE_MSG } from \"../messages/models\";\nimport { sunny } from 'ionicons/icons';\n\nexport interface PartyState {\n  docs: PartyProject[],\n}\n\nexport const initPartyState = {\n  docs: []\n}\n\n\n\nexport class PartyService {\n  private _subscription: Array<Subscription> = [];\n  \n  private _state: PartyState = initPartyState;\n  public state$ = new BehaviorSubject(this._state);\n  \n  async init(){\n    this.unsubscribe();\n\n\n    const sub1 = dataService.subscribeChanges().subscribe(doc => {\n      console.log(doc);\n      if(doc.type === 'party' && doc.secondaryType === 'project'){\n        console.log('Updating Party Project: ', doc);\n        const docs = saveIntoDocList(doc, this._state.docs);\n        this.state = {...this._state, ...{docs}};\n        console.log('Updating Party Project: ', doc, this._state);\n      }\n    });\n    const docs = await dataService.queryByProperty('secondaryType', 'equals', 'project', TYPE_PARTY);\n    this.state = {...this._state , ...{docs}};\n\n\n  }\n\n  /*\n    Rights, each digit represents different right\n    0.  0 - Not admin 1- Admin, can change everything\n    1.  (Project item) 0 - can't see, 1 - can see, 2 - can edit\n    2.  (Project children) 0 - can't see, 1 - can see own, 2 - can see all items\n    3.  (Project children edit) 0 -can't edit, 1 can edit/make own, 2 can edit all \n  */\n  public async addUser(id:string, party: PartyProject) {\n    try {\n      console.log('PARTY:::: ', party)\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/sendAddMemberRequest',\n                      { token: authService.getToken(), \n                        channelid: getChannelFromProjectId(party.id),\n                        id: id,\n                        rights: '0121' //see all, edit own items \n                      }), \n                      true, 'Adding member, please wait');\n      console.log(res);\n\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Member invitation sent', ToastType.success);\n\n      waitMS(3000);\n\n      dataService.addSyncCall$.next();\n    }\n    catch (e) {\n      console.log(e);\n    }\n    \n  }\n\n  public saveParty(partyProject: PartyProject){\n    if (!partyProject.id) {\n      this._createParty(partyProject);\n    }\n  }\n\n  //make new party ajax\n  private async _createParty(partyProject: PartyProject) {\n    console.log('Saving party Project::: ', partyProject);\n    loadingService.showLoading('Creating party, please wait, ' +\n                'internet connection required');\n    const res = await dataService.saveNewProject(partyProject, TYPE_PARTY);\n\n    if(!res.success){\n      return toastService.printServerErrors(res);\n    }\n        \n    loadingService.hideLoading();\n\n  }\n\n  public saveChallenge(challenge:Challenge, party:PartyProject){\n    if(!challenge.id) {\n      this._createChallenge(challenge, party);\n    }\n  }\n\n  private async _createChallenge(challenge:Challenge, partyProject: PartyProject) {\n    console.log('Saving System Doc::: ', partyProject);\n    loadingService.showLoading('Adding Challenge, please wait, ' +\n                'internet connection required');\n    const res = await dataService.saveSystemDoc(challenge,partyProject, TYPE_PARTY);\n    console.log(res);\n    if(!res.success){\n      return toastService.printServerErrors(res);\n    }\n    loadingService.hideLoading();\n  }\n\n\n  public async acceptPartyInvitation(msg:Msg){\n    //lets send a request\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/acceptChannelInvitation',\n                      { token: authService.getToken(), msgId: msg.id,}, {} ), \n                      true, 'Accept Request sent, waiting for reply.');\n      console.log(res);\n\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Pary Membership request sent. Please wait for app update.', ToastType.success);\n\n      await waitMS(2000);\n\n      dataService.addSyncCall$.next();\n\n      msg.replied = {accepted: true, date: Date.now()};\n      dataService.save(msg, TYPE_MSG);\n    }\n    catch (e) {\n      console.log(e);\n    }\n\n\n\n   \n  }\n\n  public async rejectPartyInviation(msg:Msg) {\n    const newMsg = {...msg, ...{replied:{accepted: false, date: Date.now()}}}\n    dataService.save(newMsg, TYPE_MSG);\n  }\n\n\n  public get state(): PartyState {\n    return this._state;\n  }\n  public set state(value: PartyState) {\n    console.log('State: ', value);\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\nexport const partyService = new PartyService();","import { Subscription, BehaviorSubject } from \"rxjs\";\nimport { getPostRequest, post } from '../ajax/ajax';\nimport { env } from \"../../env\";\nimport { authService } from '../auth/authService';\nimport { toastService, ToastType } from \"../toast/toastService\";\nimport { dataService } from \"../data/dataService\";\nimport { waitMS } from '../data/utilsData';\nimport { Friend } from \"./models\";\n\nexport interface SocialState {\n  friends: Friend[],\n}\n\nexport const initSocialState = {\n  friends: []\n}\n\n\n\nexport class SocialService {\n  private _subscription: Array<Subscription> = [];\n  private _userid = ''\n  private _state: SocialState = initSocialState;\n  public state$ = new BehaviorSubject(this._state);\n  \n  async init(userid){\n    if(userid === this._userid) return;\n    this._userid = userid;\n    this.unsubscribe();\n    this._init();\n  }\n\n  private async _init() {\n\n  }\n\n  public async addFriend(username?:string) {\n    try {\n      console.log('Friend:::: ', username)\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/social/sendAddFriendRequest',\n                      { token: authService.getToken(), \n                        username,\n                      }), \n                      true, 'Sending invitatin request, please wait');\n      console.log(res);\n\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Friend invitation sent', ToastType.success);\n\n      waitMS(3000);\n\n      dataService.addSyncCall$.next();\n    }\n    catch (e) {\n      console.log(e);\n    }\n    \n  }\n\n\n\n\n\n\n\n  public get state(): SocialState {\n    return this._state;\n  }\n  public set state(value: SocialState) {\n    console.log('State: ', value);\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\nexport const socialService = new SocialService();","import React, { useReducer } from 'react';\nimport { IonCard, IonCardTitle, IonCardHeader, IonCardContent, IonList, IonItem, IonAlert, IonFooter, IonButton, IonLabel } from '@ionic/react';\nimport  ulog from 'ulog';\nimport { Friend } from '../models';\nimport { socialService } from '../social.service';\nconst log = ulog('social');\n\nexport interface FriendsState {\n  showAddModal: boolean,\n  friends: Friend[],\n}\n\n\nconst reducer = (state, action): FriendsState => {\n  switch(action.type) {\n    case 'showAddMemberModal':\n      return {...state, ...{showAddModal: true}};\n    case 'hideAddMemberModal':\n      return {...state, ...{showAddModal: false}};\n\n    default:\n      log.error('Action type is not a match');\n      return state;\n  }\n}\n\nconst FriendsListComponent = () => {\n  const [state, _dispatch] = useReducer(reducer, {\n    showAddModal: false,\n    friends: [],\n  })\n\n  const dispatch = (type: 'showAddMemberModal'|\n                          'hideAddMemberModal', \n                    data:any = {}) => {\n    _dispatch({type, data});\n  }\n\n  const addFriend = () => {\n    dispatch(\"showAddMemberModal\");\n    \n  }\n\n  const hideAddUser = () => {\n    dispatch('hideAddMemberModal');\n  }\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>Friends</IonCardTitle>\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n            {state.friends.map(member => (\n              <IonItem  button \n                        key={member.id}\n                        onClick={() => {}}>\n              <IonLabel>\n                {member.username}\n              </IonLabel>\n            </IonItem>\n            ))}\n        </IonList>\n        \n      </IonCardContent>\n        <IonFooter>\n          <IonButton onClick={()=>addFriend()} fill=\"clear\">Add Friend</IonButton>\n        </IonFooter>\n      <IonAlert \n        isOpen={state.showAddModal}\n        onDidDismiss={() => hideAddUser()}\n        header=\"Friend's Username:\"\n        inputs={[\n          {\n            name: 'username',\n            type: 'text',\n            id: 'username',\n\n\n          }\n        ]}\n        buttons={[\n          {\n            text: 'Cancel',\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: () => {\n              hideAddUser();\n            }\n          },\n          {\n            text: 'Invite User',\n            handler: (data) => {\n              socialService.addFriend(data.username);\n              hideAddUser();\n            }\n          }\n        ]}\n      />\n    </IonCard>\n  )\n\n}\nexport default FriendsListComponent;","import React, { useReducer, useEffect } from 'react';\nimport { IonCard, IonCardTitle, IonCardHeader, IonCardContent, IonList, IonItem, IonLabel, IonAvatar, IonIcon, IonText } from '@ionic/react';\nimport  ulog from 'ulog';\nimport { Msg } from '../../messages/models';\nimport { dataService } from '../../data/dataService';\nimport { TYPE_MSG } from '../models';\nimport { mail, personAdd } from 'ionicons/icons';\nimport { printDateRelative } from '../../../utils';\nconst log = ulog('messages');\n\nexport interface MessagesState {\n  messages: Msg[],\n}\n\n\nconst reducer = (state, {type, payload}): MessagesState => {\n  switch(type) {\n    case 'setMessages':\n      return {...state, ...{messages: payload}};\n    \n    default:\n      log.error('Action type is not a match');\n      return state;\n  }\n}\n\nconst MessagesListComponent = ({channel}:{channel:string}) => {\n  const [state, _dispatch] = useReducer(reducer, {\n    messages: [],\n  })\n\n  useEffect(() => {\n    loadMsgs()\n    const sub = dataService.subscribeChannelTypeChanges(channel, TYPE_MSG)\n                    .subscribe(doc => {\n                        log.info(doc);\n                    });\n    return () => {\n      sub.unsubscribe();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [channel])\n\n  const dispatch = (type: 'setMessages'|\n                          '', \n                    payload:any = {}) => {\n    _dispatch({type, payload});\n  }\n\n  const loadMsgs = async () => {\n    log.info('Get all by project, type', channel, TYPE_MSG);\n    const msgs = await dataService.getAllByChannel(channel, TYPE_MSG);\n    dispatch('setMessages', msgs.sort((a,b)=>{\n      if(a.updated > b.updated) return 1;\n      return -1;\n    }))\n    log.info(msgs, channel);\n  }\n\n  const printMessageIcon = (msg) => {\n    if(msg.messageType === 'event'){\n      return <IonIcon icon={mail}  slot=\"start\" />\n    }\n    else if(msg.messageType === 'invitation') {\n      return <IonIcon icon={personAdd}  slot=\"start\" />\n    }\n  }\n\n  const printMessage = (msg) => {\n    if(msg.messageType === 'event'){\n      return <IonItem  button \n                key={msg.id}\n                onClick={() => {}}>\n        {printMessageIcon(msg)}\n        <IonLabel>\n          <h3>{msg.message}</h3>\n          <IonText color=\"secondary\">\n              <p>{printDateRelative(msg.updated)}</p>\n          </IonText>\n        </IonLabel>\n      </IonItem>\n\n\n    }\n    else if(msg.messageType === 'channelinvite') {\n      return <IonItem  button \n                key={msg.id}\n                onClick={() => {}}>\n        {printMessageIcon(msg)}\n        <IonLabel>\n          {msg.message}\n        </IonLabel>\n        <IonLabel slot=\"end\">\n          {msg.updated}\n        </IonLabel>\n      </IonItem>\n    }       \n    else if(msg.messageType === 'channelinvite') {\n      return <IonItem  button \n                key={msg.id}\n                onClick={() => {}}>\n        {printMessageIcon(msg)}\n        <IonLabel>\n          {msg.message}\n        </IonLabel>\n        <IonLabel slot=\"end\">\n          {msg.updated}\n        </IonLabel>\n      </IonItem>\n    }                 \n  }\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>Messages</IonCardTitle>\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n            {state.messages.map(msg=> printMessage(msg))}\n        </IonList>\n        \n      </IonCardContent>\n    </IonCard>\n  )\n\n}\nexport default MessagesListComponent;","import {\n  IonPage,\n  IonContent} from '@ionic/react';\nimport React, { useReducer, useEffect } from 'react';\nimport './Home.css';\nimport HeaderWithProgress from '../components/HeaderWithProgress';\nimport FriendsListComponent from '../modules/social/components/Friends.list.component';\nimport MessagesListComponent from '../modules/messages/components/Messages.list.component';\nimport ulog from 'ulog';\nimport { generateUserChannelId } from '../modules/data/utilsData';\nimport { authService } from '../modules/auth/authService';\n\nconst log = ulog('home');\n\n\nexport interface HomeState {\n  userid: string;\n}\n\nconst reducer = (state, {type, payload}:{type:string, payload:any}): HomeState => {\n  switch(type) {\n    case 'setUserid':\n      return {...state, ...{userid: payload}};\n    default:\n      log.error('Action Type is incorrect, default called', type, payload);\n      return state;\n  }\n}\n\nconst Home: React.FC = () => {\n\n  const [state, _dispatch] = useReducer(reducer, {\n    userid:''\n  })\n\n  const dispatch = (type:'setUserid', \n                    payload: any = {}) => {\n    _dispatch({type, payload});\n  }\n\n\n  useEffect(() => {\n    const sub = authService.username$.subscribe(() => {\n      log.info('Userid update, ', authService.userid);\n      dispatch('setUserid', authService.userid);\n    });\n    log.info('HOME, ', authService.userid);\n    dispatch('setUserid', authService.userid);\n    log.info('Home State', authService.userid);\n    return () => {\n      sub.unsubscribe();\n    };\n  }, [])\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title=\"HabitVille\" />\n      <IonContent >\n        <FriendsListComponent />\n        <MessagesListComponent channel={generateUserChannelId(state.userid)} />\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Home;\n\n","import {\n  IonPage,\n  IonContent,\n  IonHeader,\n  IonTitle,\n  IonToolbar} from '@ionic/react';\nimport React, {  } from 'react';\n\n\nconst NotFound: React.FC = () => {\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>habits</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent >\n        <div style={{padding:'20px'}}>\n          This page does not exist\n        </div>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default NotFound;\n\n","import React from 'react'\nimport {  IonInput, IonLabel, IonItem,\n  IonNote, IonText } from '@ionic/react';\n\n\nconst MyInput = ({data, updateFunction}) => {\n\n\n\n  //const [_data, setData] = useState<FormValueItem>(data); \n\n  /*\n  useEffect(() => {\n    props.attachToForm({name:props.name, value: props.value});\n\n    return props.detachFromForm({name:props.name, value:props.value});\n  },[props]);\n  */\n\n  //console.log(\"MY Input DATA: \", data);\n\n  const handleChange = (event) => {\n    updateFunction({...data, ...{value: event.target.value, dirty: true}});\n  };\n\n  const handleBlur = (event) => {\n    if(data.dirty === true) return;\n    updateFunction({...data, ...{value: event.target.value, dirty: true}});\n  }\n\n  const printErrors = () => {\n    if(data.dirty){\n      const errors =data.errors.map(m => (\n        <IonNote key={m} color=\"danger\">{m}</IonNote>\n      ))\n      return errors;\n    }\n  }\n\n\n  return (\n    <IonItem>\n      <IonLabel position=\"stacked\">\n        {data.displayName}\n        { data.hasValidation?(\n          <IonText color=\"danger\">*</IonText>\n        ):null}\n      </IonLabel>\n      <IonInput \n        name={data.id}\n        value={data.value}\n        type={data.type}\n        onIonBlur={handleBlur}\n        onIonChange={handleChange}></IonInput>\n        {data.messages.map(m => (\n          <IonNote key={m}>{m}</IonNote>\n        ))}\n        {printErrors()}\n    </IonItem>\n  )\n}\n\nexport default MyInput;","import React, { useEffect, useState } from 'react'\nimport MyInput from './myInput';\nimport { saveIntoArray, findById } from '../../utils';\nimport { IonButton } from '@ionic/react';\nimport validator from 'validator';\n\n\n// use to generate form, usually from outside form passed into here\n// so far we can use, ones that have stars have been tested\n// \"text\", \"password\", \"email\", \"number\", \"search\", \"tel\", and \"url\"\nexport interface FormItem { \n  id: string;\n  displayName?: string;\n  type: string;\n  messages?: string[];\n  validators?: any[];  \n  default?: any;\n}\n\nexport interface ValidatorItem {\n  type: string;\n  message?: string|null;\n  options?: any;\n}\n\n\n// use to hold form state\nexport interface FormValueItem {\n  id: string;\n  displayName: string;\n  type: string;\n  value: string;\n  messages: string[];\n  errors: string[];\n  dirty: boolean;\n  hasValidation:boolean;\n  //status: number; //0: untouched, 1: valid, 2: not valid\n}\n\nexport interface OptionsItem {\n  submitButtonText: string;\n}\n\nexport const defaultOptions:OptionsItem = {\n  submitButtonText: \"Submit\",\n}\n\nexport const getFormOptions = (settings:{}) => {\n  return {...defaultOptions, ...settings};\n}\n\nexport interface Props {\n  items: FormItem[],\n  submitFunction: Function,\n  options?: OptionsItem\n}\n\nexport interface State {\n  items: FormValueItem[],\n  valid: boolean\n}\n\nexport function getValidator(type:string, options:any = null, message:string|null = null):ValidatorItem {\n  return {type, options, message};\n}\n\n\n\nconst MyForm = (props:Props) => {\n  const submitFunction = props.submitFunction;\n  const options = props.options|| defaultOptions;\n\n  const [state, setState] = useState<State>({items:[], valid:false});\n\n  useEffect(() => {\n    initForm(props.items);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[props.items]);\n\n\n  const initForm = (items) => {\n    let model: FormValueItem[] = [];\n    // go thourgh props and generate our model from schema;\n    if(items) { //no schema, do nothing\n      items.forEach((item:FormItem) => {\n        let messages = item.messages;\n        \n        console.log(typeof(messages));\n        if(typeof(messages) === 'string'){\n          console.log('Messages is string');\n        }\n        else if(Array.isArray(messages)){\n          console.log('messages array');\n        }\n        else {\n          messages = [];\n        }\n\n        model.push(validateItem({\n            id: item.id,\n            displayName: item.displayName || item.id, \n            type: item.type,\n            value: item.default||'', \n            messages,\n            errors: [],\n            dirty:false,\n            hasValidation: (Array.isArray(item.validators) && item.validators.length>0)\n        }));\n      });\n      setState({items: model, valid: validateForm(model)});\n      //console.log(state);\n    }\n  }\n\n  //const updateItem = (id:string, displayName: string, type: string, value:any, messages:string[], hasValidation:boolean, touched:boolean) => {\n  const updateItem = (item:FormValueItem) => {\n    //console.log('Update Item, ', item);\n    const items = saveIntoArray(validateItem(item), state.items, 'id')\n    setState({\n      items: items,\n      valid: validateForm(items)\n    });\n  }\n\n\n\n  const validateItem = (item:FormValueItem): FormValueItem => {\n    const errors: string[] = validate(item.id, item.value);\n    //console.log(item)\n    return {...item, ...{errors}}\n  }\n\n  const validate = (id:string, value:any): string[] => {\n    //console.log(typeof(value));\n\n    if(typeof(value) !== 'string') return [];\n    \n    const item:FormItem = findById(id, props.items, 'id');\n    if(!item.validators)\n      item.validators = [];\n\n    const messages: string[] = [];\n    item.validators.forEach((val:ValidatorItem) => {\n      if(val.type === 'isEmpty') {\n        if(validator.isEmpty(value)){\n          messages.push(val.message || 'Value cannot be empty')\n        }\n      }\n      if(val.type === 'isLength'){\n        if(!validator.isLength(value, val.options)){\n          messages.push(val.message || 'Value length is not valid');\n        }\n      }\n      if(val.type === 'isEmail'){\n        if(!validator.isEmail(value, val.options)){\n          messages.push(val.message || 'Valid Email required');\n        }\n      }\n    });\n\n    //lastly check the whole form\n\n    //if(messages.length === 0)\n    //  validateForm();\n\n    return messages;\n  }\n\n\n  const submit = () => {\n    const form = {};\n    state.items.forEach(item => {\n      form[item.id] = { value: item.value };\n    });\n    submitFunction(form);\n    console.log(state);\n  }\n\n  const validateForm = (items = state.items) => {\n    let errors = 0;\n    items.forEach(item => {\n      errors += item.errors.length;\n    });\n\n    return errors === 0;\n  }\n  \n\n  return (\n    <div>\n        { Object.values(state.items).map((i) => (\n          <MyInput key={i.id} data={i} updateFunction={updateItem} />\n        ))}\n          <IonButton  \n            key={'submitButton'}\n            onClick={submit} \n            disabled={!state.valid}\n            color=\"primary\">{options.submitButtonText}</IonButton>\n    </div>\n  )\n\n};\n\nexport default MyForm;\n\n\n\n/*\n  const attachToForm = (component) => {\n    setInputs({...inputs, ...{[component.props.name]: component}});\n    setModel({...model, ...{[component.props.name]: component.state.value}});\n  };\n\n  const detachFromForm = (component) => {\n    const i = Object.assign({}, inputs);\n    delete i[component.props.name]\n    setInputs(i);\n\n    const m = Object.assign({}, model);\n    delete m[component.props.name];\n    setModel(m);\n  }\n\n  const updateModel = () => {\n    const m = Object.assign({}, model);\n    Object.keys(inputs).forEach((name) => {\n      m[name] = inputs[name].state.value;\n    });\n\n    setModel(m);\n  }\n\n  const submit = (event) => {\n    event.preventDefault();\n    updateModel();\n    console.log(model);\n  }\n\n  const getElement = (type) => {\n    if(type === 'string'){\n      return (\n        <div>type</div>\n      )\n    }\n  }\n*/","import React, { useState, useEffect } from 'react';\nimport { IonButton } from '@ionic/react';\nimport './auth.css';\nimport { useLocation, useHistory } from 'react-router-dom';\n\n\n\n\n\nconst AuthMenuComponent = ({page}: {page:string}) => {\n  const location = useLocation();\n  const history = useHistory();\n  \n  const push = (url:string) => {\n    console.log(location.pathname);\n    if(location.pathname && url !== location.pathname){\n      history.push(url);\n    }\n\n  }\n  \n  \n  return (\n    <div className=\"authMenuParent\" >\n      <IonButton  onClick={() => push('/auth/login')}\n                  size=\"small\"  \n                  color={(page==='login')? 'success':'light'}\n                  fill=\"clear\">\n          Login\n      </IonButton>\n      <IonButton   onClick={() => push('/auth/register')}\n                  size=\"small\"  \n                  color={(page==='register')? 'success':'light'}\n                  fill=\"clear\">\n          Register\n      </IonButton>\n\n    </div>\n  );\n}\n\nexport default AuthMenuComponent;","import React from 'react';\nimport {\n  IonIcon,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonPage\n} from \"@ionic/react\";\nimport { logIn} from 'ionicons/icons';\nimport MyForm, { getValidator, FormItem, getFormOptions } from '../../forms/myForm';\nimport { authService } from '../authService';\nimport { useLocation, useHistory } from 'react-router';\nimport AuthMenuComponent from './auth.menu.component';\nimport './auth.css';\n\nconst LoginPage  = () => {\n\n  console.log(\"LOGIN PAGE\");\n  const location = useLocation();\n  const history = useHistory();\n  console.log(\"LOCATION++++++++++++:::: \", location)\n\n  const options = getFormOptions({\n    submitButtongText: \"Login\"\n  });\n  \n  const form: FormItem[] = [\n    {\n      id: 'id',\n      displayName: 'ID (Username or Email): ',\n      type: 'string',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'ID needs to be between 3 to 50 characters')\n  \n      ],\n    },\n    {\n      id: 'password',\n      displayName: \"Password: \",\n      type: 'password',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'ID needs to be between 3 to 50 characters')\n      ]\n    },\n    \n  ]\n  \n  const submit = async (form) => {\n    console.log(form);\n    authService.loginAndRedirect(\n        form['id'].value, \n        form['password'].value,\n        history,\n        location);\n  }\n\n\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Login</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <div style={{paddingTop:'50px'}} className=\"ion-text-center\">\n          <IonIcon icon={logIn} color=\"primary\" className=\"iconFormCenter\" />\n        </div>\n        <AuthMenuComponent page=\"login\" />\n        <div style={{padding:'20px'}}>\n          <MyForm  items={form} options={options} submitFunction={submit} /> \n        </div>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default LoginPage;\n","import React, {  } from 'react';\n\nimport {\n  IonIcon,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonPage\n} from \"@ionic/react\";\nimport { logIn} from 'ionicons/icons';\nimport MyForm, { getValidator, FormItem, getFormOptions } from '../../forms/myForm';\nimport { authService } from '../authService';\nimport { useLocation, useHistory } from 'react-router';\nimport AuthMenuComponent from './auth.menu.component';\nimport './auth.css';\n\nconst RegisterPage  = () => {\n\n  console.log(\"REGISTER PAGE\");\n  const location = useLocation();\n  const history = useHistory();\n  console.log(\"LOCATION++++++++++++:::: \", location)\n\n  const options = getFormOptions({\n    submitButtongText: \"Login\"\n  });\n  \n  const form: FormItem[] = [\n    {\n      id: 'username',\n      displayName: 'Username: ',\n      type: 'string',\n      validators: [\n        getValidator('isLength', {min:3, max:20}, 'Username needs to be between 3 to 20 characters')\n  \n      ],\n    },\n    {\n      id: 'email',\n      displayName: 'Email: ',\n      type: 'string',\n      validators: [\n        getValidator('isEmail',{}, 'Email is not valid')\n  \n      ],\n    },\n    {\n      id: 'password',\n      displayName: \"Password: \",\n      type: 'password',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'Password needs to be between 3 to 50 characters')\n      ]\n    },\n    \n  ]\n  \n  const submit = async (form) => {\n    console.log(form);\n    const res = await authService.register(\n                        form['username'].value, \n                        form['email'].value,\n                        form['password'].value);\n    if(res){\n      authService.loginAndRedirect(\n                        form['username'].value, \n                        form['password'].value,\n                        history,\n                        location)\n    }\n  }\n\n\n\n\n\n\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Register</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <div style={{paddingTop:'50px'}} className=\"ion-text-center\">\n          <IonIcon  color=\"primary\"\n                    icon={logIn} \n                    className=\"iconFormCenter\" />\n        </div>\n        <AuthMenuComponent page=\"register\" />\n        <div style={{padding:'20px'}}>\n          <MyForm  items={form} options={options} submitFunction={submit} /> \n        </div>\n\n        \n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default RegisterPage;\n","import React, { FunctionComponent } from \"react\";\nimport { Route, Redirect, useLocation } from \"react-router-dom\";\nimport LoginPage from './components/login.page';\nimport RegisterPage from './components/register.page';\n\n\nconst UnauthenticatedRoute = ({ exact, path }: \n  { component: FunctionComponent<{}>, exact: boolean, path: string }) => {\n\n  \n  const location = useLocation();\n  // const history = useHistory();\n  // const params = useParams();\n  // const path = location.pathname;\n  \n  // console.log(\"Location:::: \", location);\n  // console.log('HISTORY:::: ', history);\n  // console.log('PARAMS:::: ', params);\n\n\n  const getRoute = () => {\n    if(location.pathname === '/auth/register'){\n      return <Route path={path} \n                    component={RegisterPage} \n                    exact={exact} />;\n    }\n    else if(location.pathname === '/auth/login'){\n      return <Route\n                path='/auth/login'\n                render={() => <LoginPage />}\n              />\n    }\n    else {\n      return <Redirect to={{\n              pathname: \"/auth/login\",\n              state: {prev: location.pathname}\n            }}/>;\n    }\n  }\n  \n\n  return (\n    getRoute()\n  );\n}\n\n\n\n\n\n/*\n\n\n\n\nconst  PrivateRoute = ({ component: Component, ...rest }) => {\n\n  const [authenticated] = useUserFacade();\n  //const location = useLocation();\n\n  //console.log(location);\n\n\n  return (\n    <Route\n      {...rest}\n      render={props =>\n        authenticated ? (\n          <Component {...props} />\n        ) : (\n          <Redirect\n            to={{ pathname: \"/auth/login\"}}\n          />\n        )\n      }\n    />\n  );\n}\n*/\nexport default UnauthenticatedRoute;","\nimport { Habit, habitStage, TYPE_HABBIT } from './models';\nimport { BehaviorSubject, Subscription } from 'rxjs';\nimport { dataService } from '../../modules/data/dataService';\nimport { saveIntoArray, waitMS, isThisUserProject } from '../../modules/data/utilsData';\nimport { ProjectItem } from '../../modules/data/models';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport _ from 'lodash';\nimport { authService } from '../../modules/auth/authService';\n\nexport interface habitsState {\n  selected: Habit | null,\n  habits: Habit[],\n  stageFilter: habitStage\n}\n\nexport const getInitHabitsState = (): habitsState => {\n  return {\n    selected: null,\n    habits: [],\n    stageFilter: habitStage.current\n  }\n}\n\nexport class HabitsService {\n\n  // @ts-ignore:  we force init later on in init function\n  private _project: ProjectItem;\n  public getProject():ProjectItem {return this._project}\n  private _state: habitsState = getInitHabitsState();\n\n  public state$ = new BehaviorSubject(this._state);\n\n  private _docs: Habit[] = [];\n\n  public docs$ = new BehaviorSubject(this._docs);\n\n  private _subscription: Array<Subscription> = [];\n\n  public init(project: ProjectItem) {\n    const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n      if (!ready) return;\n      const equals = _.isEqual(project, this._project);\n      if (equals) return;\n\n      await this._init(project);\n\n      dataSub.unsubscribe();\n    });\n\n  }\n\n  async _init(project: ProjectItem) {\n    console.log(\"################################# Init: \", project, TYPE_HABBIT);\n    if (this._project && this._project.id === project.id) return;\n    console.log('Saving....', this._project, project);\n    this._project = project;\n    this._docs = await dataService.getAllByProject(project.id, TYPE_HABBIT);\n    console.log(\"Init Docs: \", this._docs);\n    this.filterhabits();\n\n    //manage changes\n\n    const sub = dataService.subscribeProjectTypeChanges(project.id, TYPE_HABBIT)\n      .subscribe(doc => {\n        console.log(\"habit Service Subscription: \", doc);\n        if (doc.deleted)\n          this._docs = this._docs.filter(d => d.id !== doc.id);\n        else {\n          console.log('Updating doc: ', doc);\n          this._docs = saveIntoArray(doc, this._docs);\n        }\n        this.filterhabits();\n        //TODO: need to optimize this, maybe start using the view query, see bottom of file\n      });\n    this._subscription.push(sub);\n  }\n\n\n\n  private filterhabits() {\n    console.log(\"Filterhabits\", this._docs);\n    const filtered = this._docs.filter(doc => this.filterFunction(doc));\n    this.state = { ...this._state, ...{ habits: filtered } };\n    console.log(\"Filtered State: \", this._state);\n  }\n\n  private filterFunction(doc: Habit) {\n    return (doc.stage === this._state.stageFilter)\n  }\n\n\n\n  public get state(): habitsState {\n    return this._state;\n  }\n  public set state(value: habitsState) {\n    this._state = value;\n    this.state$.next(this._state);\n}\n\n  public get docs(): Habit[] {\n    return this._docs;\n  }\n  public set docs(value: Habit[]) {\n    this._docs = value;\n    this.docs$.next(this._docs);\n  }\n\n\n\n  public save(doc: Habit) {\n    console.log(\"Save: \", doc, this._project, TYPE_HABBIT);\n\n    //check if its new, no id, its noew\n    if (!doc.id) {\n      if(isThisUserProject(this._project.id, authService.getUser().id)){\n        console.log('Savingl new personal challenge');\n        doc = Object.assign(gamifyService.calculateNewHabitRewards(doc));\n        return dataService.save({ ...{ done: false }, ...doc }, TYPE_HABBIT, { projectid: this._project.id });\n      }\n      else {\n        console.log('Saving party challenge')\n      }\n    }\n    else\n      dataService.save({ ...{ done: false }, ...doc }, TYPE_HABBIT, { projectid: this._project.id });\n  }\n\n  public remove(id: string) {\n    dataService.remove(id, TYPE_HABBIT);\n  }\n\n  public select(doc: Habit) {\n    this.state = { ...this._state, ...{ selected: doc } };\n  }\n\n  public changeStageFilter(stage: habitStage) {\n    if (stage === this._state.stageFilter) return;\n    this._state = { ...this._state, ...{ stageFilter: stage } };\n    this.filterhabits();\n\n  }\n\n\n  public unsubscribe() {\n    if (!this) return;\n    this._subscription.forEach(sub => {\n      if (sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n","export const COLOR_PRIMARY = 'primary';\nexport const COLOR_SECONDARY = 'secondary';\nexport const COLOR_TERTIARY = 'tertiary';\nexport const COLOR_SUCCESS = 'success';\nexport const COLOR_WARNING = 'warning';\nexport const COLOR_DANGER = 'danger';\nexport const COLOR_LIGHT = 'light';\nexport const COLOR_MEDIUM = 'medium';\nexport const COLOR_DARK = 'dark';","import React, { useState, useEffect } from 'react';\nimport { IonItem, IonCard, IonCardHeader, IonCardTitle, IonIcon, IonFab, IonFabButton, IonCardContent, IonGrid, IonRow, IonCol, IonNote, IonBadge, IonLabel } from '@ionic/react';\nimport { COLOR_LIGHT, COLOR_DARK, COLOR_SUCCESS, COLOR_DANGER } from '../../colors';\nimport { radioButtonOff, checkmarkCircleOutline, cog } from '../../../node_modules/ionicons/icons';\nimport moment from 'moment';\nimport { Habit, MOMENT_DATE_FORMAT, HabitProgress } from './models';\nimport { habitDataFunctions } from './hooks/habits.hook';\nimport './Habit.listitem.component.css';\nimport { saveIntoArray, getIndexById } from '../../modules/data/utilsData';\nimport { calculateCurrentStreak } from './utilsHabits';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\n\n\n\nconst HabitListItemComponent = ({habit, dataFunctions, showEditModalFunction}:\n  {habit:Habit, dataFunctions: habitDataFunctions, showEditModalFunction:{(habit: Habit)}}) => {\n\n  const [doc, setDoc] = useState(habit);\n\n  useEffect(() => {\n    setDoc(habit);\n  }, [habit])\n\n\n  const printDate = (index:number, active = false) => {\n    const day =  moment().subtract(index, 'day');\n    if(active)\n    {\n      return (\n        <IonLabel\n          color=\"primary\"\n        >\n        {day.format('DD')} <br /> {day.format('dd')}\n        </IonLabel>)\n    }\n    return (\n      <>\n      {day.format('DD')} <br /> {day.format('dd')}\n      </>)\n  }\n\n  const printGoal = () => {\n    if(doc.regularityInterval === 'day'){\n      return (\n        <IonItem>\n              <IonNote>\n                Remember, you promised that you will repeat \n                this habit <strong>every day</strong>.\n              </IonNote>\n        </IonItem>\n      )\n    }\n    \n    return (\n      <IonItem>\n        <IonNote>\n          Remember you promised that you will repeat this habit \n          <strong> {doc.regularityValue} times {doc.regularityInterval}</strong>\n        </IonNote>\n      </IonItem>\n    )\n  }\n\n\n\n\n  const printDayIcon = (index: number, active=false) => {\n    const day = moment().subtract(index, 'day');\n    let progress = doc.progress.find(obj => day.format(MOMENT_DATE_FORMAT) === obj.date);\n    if(!progress)\n      progress = {date: day.format(MOMENT_DATE_FORMAT), value: 0};\n\n    \n    if(active){\n      //TODO: find a way to caluclate if buffer can be used for the ones not done\n      // @ts-ignore: undefined, but we are forsing assignment just before this\n      return (<IonIcon  onClick={() => updatehabit(index, progress)}\n                      size=\"large\" \n                      key={index}\n                      color={ progress.value > 0? COLOR_SUCCESS:  COLOR_DARK} \n                      icon={progress.value > 0? checkmarkCircleOutline : radioButtonOff} />)\n    }\n    // @ts-ignore: undefined, but we are forsing assignment just before this\n    return (<IonIcon  \n    size=\"large\" \n    key={index}\n    color={ progress.value > 0? COLOR_SUCCESS:  COLOR_DANGER} \n    icon={progress.value > 0? checkmarkCircleOutline : radioButtonOff} />)\n\n    \n  }\n\n  const updatehabit = (index: number, progress:{date:string, value:number}) => {\n    console.log(' %%%%%%%%%%%%%%%%%%%%%%%%%%  Update Progress::: ', index, progress);\n    let newProgress: HabitProgress = {date: progress.date, value: (progress.value === 0)? 1: 0 }\n\n    const i = getIndexById(newProgress.date, doc.progress, 'date')\n    if(i !== -1) {\n      newProgress = {...doc.progress[i], ...newProgress }\n    }\n    const progresslist = saveIntoArray(newProgress, doc.progress, 'date');\n    const newDoc = gamifyService.calculateHabitProgressRewards(\n                    calculateCurrentStreak({...doc, ...{progress: progresslist}}), newProgress);\n    console.log('NEW PROGRESSSSSSS:::::::::::::::::::::::;', newDoc);\n    dataFunctions.save(newDoc);\n\n  }\n\n  const print = () => {\n    return (\n        <IonCard>\n          <IonCardHeader>\n            {/*<IonCardSubtitle>Card Subtitle</IonCardSubtitle>*/}\n            <IonCardTitle>{doc.name}</IonCardTitle>\n            <IonBadge class=\"habitBadge\" color=\"success\">{doc.currentStreak}</IonBadge>\n            <IonBadge class=\"habitBadge\" color=\"tertiary\">{doc.bestStreak}</IonBadge>\n          </IonCardHeader>\n          <IonItem>\n            <IonGrid>\n              <IonRow class=\"datecell\">\n                <IonCol>{printDate(6)}</IonCol>\n                <IonCol>{printDate(5)}</IonCol>\n                <IonCol>{printDate(4)}</IonCol>\n                <IonCol>{printDate(3)}</IonCol>\n                <IonCol>{printDate(2)}</IonCol>\n                <IonCol>{printDate(1)}</IonCol>\n                <IonCol>{printDate(0, true)}</IonCol>\n              </IonRow>\n              <IonRow class=\"datecell\">\n                <IonCol>{printDayIcon(6)}</IonCol>\n                <IonCol>{printDayIcon(5)}</IonCol>\n                <IonCol>{printDayIcon(4)}</IonCol>\n                <IonCol>{printDayIcon(3)}</IonCol>\n                <IonCol>{printDayIcon(2)}</IonCol>\n                <IonCol>{printDayIcon(1)}</IonCol>\n                <IonCol>{printDayIcon(0, true)}</IonCol>\n              </IonRow>\n            </IonGrid>\n          </IonItem>\n          <IonCardContent>\n            {printGoal()}\n          </IonCardContent>\n          <IonFab horizontal=\"end\" vertical=\"bottom\" edge>\n            <IonFabButton size=\"small\" color={COLOR_LIGHT} onClick={() => showEditModalFunction(doc)}>\n              <IonIcon size=\"large\" icon={cog} />\n            </IonFabButton>\n          </IonFab>\n        </IonCard>\n    );\n  }\n  \n  return print();\n};\n\nexport default HabitListItemComponent;\n\n","import React, { useState } from 'react';\nimport { IonItem, IonLabel, IonIcon, IonInput, IonTextarea, IonButton, IonHeader, IonTitle, IonToolbar, IonContent, IonFooter, IonButtons, IonSelect, IonSelectOption, IonRange, IonFab, IonFabButton, IonAlert, IonSegment, IonSegmentButton } from '@ionic/react';\nimport { arrowBack, trash } from '../../../node_modules/ionicons/icons';\nimport { Habit, habitIntervals, habitDifficulty, printDifficulty } from './models';\nimport { capitalize } from '../../utils';\nimport { COLOR_DANGER } from '../../colors';\n\n\n\ninterface habitState {\n  regularity: {\n    interval: habitIntervals,\n    min: number,\n    max: number,\n  }\n  doc: Habit,\n  showDeleteWarrning: boolean\n}\n\nconst getRegularityValues = (interval: habitIntervals) => {\n  switch (interval) {\n    case habitIntervals.day:\n      return {interval: interval, min:1, max: 1}\n    case habitIntervals.week:\n      return {interval: interval, min:1, max: 6}\n    case habitIntervals.month:\n      return {interval: interval, min:1, max: 25}\n  }\n}\n\nconst HabitAddComponent = ({habit, dismissFunc}:\n  {habit:Habit, dismissFunc: {(habit:Habit|null, action: 'save'|'remove'|'none')}}) => {\n  console.log('Add habits Form:::::: ', habit);\n  const getDefaultRegularityState: habitState = {\n    regularity: getRegularityValues(habit.regularityInterval),\n    doc: new Habit(),\n    showDeleteWarrning: false\n  }\n\n\n  const [state, setState] = useState<habitState>({...getDefaultRegularityState, ...{doc: habit}});\n\n\n\n  console.log(state);\n  const handleChange = (e) => {\n    const newDoc = {...state.doc, ...{[e.target.name]:e.detail.value}}\n    const newState = {...state, ...{doc: newDoc}};\n    setState(newState);\n  }\n\n  const handlerRegularityValue = (e) => {\n    console.log(e);\n    const newDoc = {...state.doc, ...{regularityValue: e.detail.value}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  const handlerRegularityIntervalChange = (value) => {\n    value = value || 'day';\n    const newDoc = {...state.doc, ...{regularityInterval: value, regularityValue: 1}};\n    const newReg = {...state.regularity, ...getRegularityValues(value)};\n    setState({...state, ...{doc:newDoc, regularity: newReg}});\n    console.log(state);\n  }\n\n  const printRegularityLabel = () => {\n\n    const times = (state.doc.regularityValue > 1)? ' times a ': ' time a ';\n    if(state.doc.regularityInterval === 'day'){\n      return 'I will repeat this habit every day.'\n    }\n    \n    return 'I will repeat this habit ' +state.doc.regularityValue + times + state.doc.regularityInterval\n  }\n\n  const handleDifficultyChange = (e) => {\n    const newDoc = {...state.doc, ...{difficulty: e.detail.value}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  const printDifficultyLabel = (hab: habitDifficulty): string => {\n    switch(hab) {\n      case habitDifficulty.trivial:\n        return 'Easy peasy lemon squeezy';\n      case habitDifficulty.easy:\n        return 'Piece of Cake';\n      case habitDifficulty.medium:\n        return \"Let's Rock\";\n      case habitDifficulty.hard:\n        return 'No Pain, No Gain';\n      case habitDifficulty.extreme:\n        return 'Death Wish';\n    }\n  }\n\n  const showRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: true}});\n  }\n\n  const hideRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: false}});\n  }\n\n  const removehabit = () => {\n    hideRemoveWarrning();\n    console.log('REMVE ACTION STATE::::::: ', state);\n    dismissFunc(state.doc, 'remove');\n  }\n\n\n\n  const print = () => {\n      return (\n      <>\n        <IonHeader>\n          <IonToolbar>\n            {/*\n            <IonButtons slot=\"start\">\n              <IonButton> <IonIcon size=\"large\" icon={arrowBack} /></IonButton>\n            </IonButtons>\n            */}\n            <IonTitle>Add Habit</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonItem>\n              <IonLabel position=\"floating\">Name</IonLabel>\n              <IonInput \n                  name=\"name\"\n                  placeholder=\"Read book, Go running ...\" \n                  onIonChange={handleChange}\n                  value={state.doc.name} />\n          </IonItem>\n          <IonItem>\n              <IonLabel position=\"floating\">Note</IonLabel>\n              <IonTextarea \n                  placeholder=\"Enter more information here, motivate yourself...\"\n                  name=\"note\"\n                  onIonChange={handleChange}\n                  value={state.doc.note}></IonTextarea>\n          </IonItem>\n          <IonItem>\n            <IonSegment value={state.doc.regularityInterval}\n                        onIonChange={(e) => handlerRegularityIntervalChange(e.detail.value)}>\n              <IonSegmentButton value=\"day\">\n                <IonLabel>Daily</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"week\">\n                <IonLabel>Weekly</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"month\">\n                <IonLabel>Monthly</IonLabel>\n              </IonSegmentButton>\n            </IonSegment>\n          </IonItem>\n\n          {(state.doc.regularityInterval !== 'day')? (\n            <>\n              <IonRange \n                    min={state.regularity.min}\n                    max={state.regularity.max}\n                    debounce={100}\n                    value={state.doc.regularityValue}\n                    onIonChange={handlerRegularityValue}\n                    color=\"secondary\" >\n                <IonLabel slot=\"start\">{state.regularity.min}</IonLabel>\n                <IonLabel slot=\"end\">{state.regularity.max}</IonLabel>\n              </IonRange>\n            </>\n          ) : (\n          <></> )}\n          <IonItem>\n            <IonLabel>{printRegularityLabel()}</IonLabel>\n          </IonItem>\n\n          <IonRange min={0} \n                    max={4} \n                    debounce={100}\n                    value={state.doc.difficulty}\n                    onIonChange={handleDifficultyChange}\n                    color=\"secondary\">\n              <IonLabel slot=\"start\">{capitalize(printDifficulty(habitDifficulty.trivial))}</IonLabel>\n              <IonLabel slot=\"end\">{capitalize(printDifficulty(habitDifficulty.extreme))}</IonLabel>\n          </IonRange>\n\n          <IonItem>\n            <IonLabel>{printDifficultyLabel(state.doc.difficulty)}</IonLabel>\n          </IonItem>\n        </IonContent> \n\n        <IonFooter>\n          <IonToolbar>\n            <IonTitle>\n              <IonButton onClick={() => dismissFunc(state.doc, 'save')}>Save</IonButton>\n              <IonButton onClick={() => dismissFunc(null, 'none')}>Cancel</IonButton>\n            </IonTitle>\n          </IonToolbar>\n        </IonFooter>\n        <IonFab horizontal=\"end\" vertical=\"bottom\" >\n          <IonFabButton size=\"small\" color={COLOR_DANGER} onClick={() => showRemoveWarrning()}>\n            <IonIcon size=\"large\" icon={trash} />\n          </IonFabButton>\n        </IonFab>\n        <IonAlert\n          isOpen={state.showDeleteWarrning}\n          onDidDismiss={() => hideRemoveWarrning}\n          header={'Warrning!!!'}\n          message={'Are you sure you want to <strong>delete</strong> this habit?'}\n          buttons={[\n            {\n              text: 'Cancel',\n              role: 'cancel',\n              cssClass: 'secondary',\n              \n            },\n            {\n              text: 'Yes Im Sure',\n              handler: () => removehabit()\n            }\n          ]}\n        />\n      </>\n      );\n  }\n  \n  console.log(\"Ready to return form\");\n  return print();\n};\n\nexport default HabitAddComponent;\n","import React, { useReducer } from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonFabButton,\n  IonFab,\n  IonIcon,\n  IonModal} from '@ionic/react';\n\nimport { add } from '../../../node_modules/ionicons/icons';\nimport { useHabitsCollectionFacade } from './hooks/habits.hook';\nimport { Habit } from './models';\nimport HabitListItemComponent from './Habit.listitem.component';\nimport HabitAddComponent from './Habit.add.component';\nimport HeaderWithProgress from '../../components/HeaderWithProgress';\nimport { authService } from '../../modules/auth/authService';\nimport { getDefaultProject } from '../../modules/data/utilsData';\n\n\nexport interface habitPageState {\n  showModal: boolean,\n  modalHabit: Habit|null,\n}\n\nconst reducer = (state, action): habitPageState => {\n  switch(action.type) {\n    case 'showModal':\n      return {...state, ...{showModal: action.data.showModal, modalHabit: action.data.habit} }\n    case 'hideModal':\n      return state;\n    default:\n      return state;\n  }\n}\n\nexport function getAction(todo:'showModal', data = {}){\n  return {type:todo, data:data};\n}\n\n\nconst HabitsPage: React.FC = () => {\n  console.log(getDefaultProject(authService.userid));\n  const [habitsState, dataFunc] = useHabitsCollectionFacade(getDefaultProject(authService.userid));\n  const [state, dispatch] = useReducer(reducer, {\n    showModal:false,\n    modalHabit: null,\n  })\n\n  console.log('STATE::: ', state);\n  const { habits } = habitsState;\n\n  const addhabit = (habit:Habit = new Habit()) => {\n    console.log('Add habit:  ', habit);\n    dispatch(getAction('showModal', {showModal: true, habit}));\n  }\n\n  const hidehabitModal = () => {\n    dispatch(getAction('showModal', {showModal: false, habit: null}));\n  }\n\n  const habitDismissFunc = (habit: Habit|null, action:'save'|'remove'|'none') => {\n    console.log('habit: ', habit)\n    dispatch(getAction('showModal', {showModal: false, habit: null}));\n    if(action === 'save' && habit != null){\n      dataFunc.save(habit);\n    }\n    else if(action === 'remove' && habit != null && habit.id){\n      dataFunc.remove(habit.id);\n    }\n  }\n\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title=\"Habits\" />\n      <IonContent>\n        \n      <IonList>\n        {habits.map(habit => (\n              <HabitListItemComponent\n                        habit={habit} \n                        dataFunctions={dataFunc}\n                        key={habit.id} \n                        showEditModalFunction={addhabit}\n              />\n        ))}\n      </IonList>\n      {state.showModal? (\n        <IonModal isOpen={state.showModal} onDidDismiss={() => hidehabitModal()}>\n        <HabitAddComponent habit={state.modalHabit||new Habit()} \n                            dismissFunc = {habitDismissFunc}  />\n        </IonModal>\n      ) : (\n        <></>\n      )}\n      \n\n      <IonFab vertical=\"top\" horizontal=\"end\" slot=\"fixed\" edge>\n        <IonFabButton onClick={()=> addhabit()}>\n          <IonIcon icon={add} />\n        </IonFabButton>\n      </IonFab>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default HabitsPage;\n\n","import { useEffect, useState, useRef } from 'react';\nimport { Subscription } from 'rxjs';\nimport { ProjectItem } from '../../../modules/data/models';\nimport { Habit, habitStage } from '../models';\nimport { habitsState, getInitHabitsState,  HabitsService } from '../habits.service';\nimport _ from 'lodash';\n\nexport interface habitDataFunctions {\n  save: {(doc: Habit)},\n  remove: {(id: string)},\n  select: {(doc: Habit)},\n  changeStageFilter: {(stage: habitStage)}\n}\n\n\n//more simpler then auth hook, just read data\nexport function useHabitsCollectionFacade(project: ProjectItem): \n                                        [habitsState, habitDataFunctions]{\n\n  const [state, setState] = useState(getInitHabitsState());\n\n  const habitsService = useRef(new HabitsService());\n  \n          \n  const dataFunctions = {\n    save: (doc: Habit) => {\n      console.log('@@@@@@@@@@@@@@@@@@@@@ Habit Hook Save: ', habitsService.current, doc)\n      habitsService.current.save(doc)\n    },\n    remove: (id) => habitsService.current.remove(id), //TODO: allow user to choose, sync or not to sync\n    select: (doc: Habit) => habitsService.current.select(doc),\n    changeStageFilter: (stage: habitStage) => habitsService.current.changeStageFilter(stage),\n  }\n\n  useEffect(() => {\n    console.log('habitS HOOK - UseEffect NEW SERVICE------------------------------');\n    if(_.isEqual(habitsService.current.getProject(), project)) \n        return;\n    habitsService.current.init(project)\n\n    return habitsService.current.unsubscribe;\n  }, [project])\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      habitsService.current.state$.subscribe(state => {\n        console.log('habits Hook Sub: ', state);\n        setState(state);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[project]);\n\n\n  return [state, dataFunctions];\n}","import React, {  } from 'react';\nimport { IonHeader } from '@ionic/react';\n\n\n\n\nconst MenuHeaderWithProgress = () => {\n\n  \n  return (\n    <IonHeader className=\"menuHeaderWithAvatar\">\n      \n      <h1>Menu</h1>\n    </IonHeader>\n  )\n}\n\nexport default MenuHeaderWithProgress;","import React, { useState } from 'react';\nimport { IonInput } from '@ionic/react';\nimport { ProjectItem } from '../../modules/data/models';\nimport { generateCollectionId, getProjectChildId } from '../../modules/data/utilsData';\nimport { TYPE_TODO_LIST, TodoList } from './models';\nimport ulog from 'ulog';\nimport { todoService } from './todo.service';\n\nconst log = ulog('todo');\n\n\nconst ListAddInlineComponent = ({projectid}:{projectid: string}) => {\n\n  const [state, setState] = useState({name:''});\n\n  const setNewTitle = (e) => {\n    setState({name: e.detail.value});\n  }\n  \n  const onKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      save();\n      setState({name: ''});\n    }\n  }\n\n  const save = async () => {\n    const id = generateCollectionId(projectid, TYPE_TODO_LIST, encodeURI(state.name));\n    const newList = new TodoList({\n      id,\n      name: state.name,\n      secondaryType: TYPE_TODO_LIST,\n      //folder??\n      project: getProjectChildId(projectid),\n    })\n    newList._new = true;\n\n    log.info('NEW TODO LIST::::::::::::::: ', newList)\n    const res = await todoService.saveList(newList);\n    log.info(res);\n  };\n\n  return (\n    <IonInput\n      className=\"new-todo\"\n      placeholder=\"Add new List?\"\n      onKeyPress={onKeyPress}\n      onIonChange={setNewTitle}\n      value={state.name}\n    />\n  )\n}\n\nexport default ListAddInlineComponent;","import React, { useState } from 'react'\nimport { IonItem } from '@ionic/react'\nimport Lottie from 'react-lottie';\nimport sun from '../../icons/sun.json';\nimport './todo.menu.css';\n\nexport const waitMS = (ms: number) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\nconst TodoMenuItemButtonComponet = ({name, color, actonFunc}:\n  {name: string, color:string, actonFunc:Function}) => {\n  \n  const [state, setState] = useState({isStopped:true, isPaused:true})\n  \n  \n  const defaultOptions = {\n    loop: true,\n    autoplay: true, \n    animationData: sun,\n    rendererSettings: {\n      clearCanvas: true,\n      scaleMode: 'noScale',\n      preserveAspectRatio: 'xMidYMid slice'\n    }\n  }; \n  \n  const actionHandler = async() => {\n    setState({isStopped:false, isPaused:false});\n    actonFunc();\n\n    await waitMS(1000);\n    setState({isStopped:true, isPaused:true});\n  }\n  \n  \n  \n  return (\n    <IonItem  button \n        onClick={() => actionHandler()}\n        color={color}  \n        routerLink={encodeURI('/todos/tag/today')} \n        routerDirection=\"none\"\n        lines=\"none\">\n    <div className =\"lottieicon\">\n      <Lottie  options={defaultOptions}\n          height={25}\n          width={25}\n          isStopped={state.isPaused}\n          isPaused={state.isStopped}/>\n    </div>\n    {name} \n</IonItem>\n  )\n}\n\nexport default TodoMenuItemButtonComponet","import React, { useReducer, useEffect } from 'react';\nimport ListAddInlineComponent from './list.inline.add.component';\nimport ulog from 'ulog';\nimport { TodoTag, TodoList, TYPE_TODO_LIST } from './models';\nimport { dataService } from '../../modules/data/dataService';\nimport { saveIntoArray } from '../../modules/data/utilsData';\nimport { authService } from '../../modules/auth/authService';\nimport { IonList, IonItem, IonLabel, IonItemDivider, IonItemGroup, IonItemSliding, IonItemOptions, IonItemOption, IonAlert, IonIcon } from '@ionic/react';\nimport { useLocation } from 'react-router';\nimport { todoService } from './todo.service';\nimport TodoMenuItemButtonComponet from './todo.menu.item';\n\nconst log = ulog('todo');\n\nconst initialState:{\n  tags:TodoTag[],\n  tagsOpen: boolean\n  lists:TodoList[],\n  openLists: string[],\n  showDeleteListAlert: boolean,\n  deleteList: TodoList,\n} = {\n  tags:[],\n  tagsOpen: false,\n  lists:[],\n  openLists:[],\n  showDeleteListAlert: false,\n  deleteList: new TodoList(),\n}\n\nconst reducer =  (state = initialState, { type, payload }:{type:string, payload:any}) => {\n  switch (type) {\n\n    case 'hideDeleteAlert':\n      return { ...state, ...{ showDeleteListAlert: false} }\n\n    case 'showDeleteAlert': \n    return { ...state, ...{ showDeleteListAlert: true, deleteList: payload } }\n\n    case 'setTodoList': \n      if(payload.deleted)\n      return { ...state, ...{lists: state.lists.filter(l => l.id !== payload.id)} };\n      else\n        return { ...state, ...{lists: saveIntoArray(payload, state.lists)} };\n\n    case 'setTodoLists':\n      //find todos page\n      return { ...state, ...{ lists: payload } };\n\n\n    default:\n      log.error('REDUCER GOT UNHANDLED TYPE ', type, payload);\n      return state\n  }\n}\n\n\nconst TodoMenuListComponent = ({projectid}: {projectid:string}) => {\n  const location = useLocation();\n  const path = location.pathname;\n  log.warn(path);\n  const [state, _dispatch] = useReducer(reducer, initialState)\n\n  const dispatch = (type: 'setTodoLists'|\n                          'hideDeleteAlert'|\n                          'showDeleteAlert'|\n                          'setTodoList', payload = {}) => {\n    _dispatch({type, payload});\n  }\n\n\n  useEffect(() => {\n    const subTodoList = dataService.subscribeProjectTypeChanges(\n      projectid, TYPE_TODO_LIST ).subscribe(change => {\n        log.info('Menu Change: ', change);\n        dispatch('setTodoList', change);\n      })\n    loadInitTodoLists(projectid);\n    return () => {\n      subTodoList.unsubscribe();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [authService.userid])\n\n  const loadInitTodoLists = async (projectid:string) => {\n    const todolists = await dataService.getAllByProject(projectid,TYPE_TODO_LIST);\n    log.info(todolists);\n    dispatch('setTodoLists', todolists);\n  }\n\n  const deleteList = () => {\n      todoService.deleteList(state.deleteList)\n  }\n\n\n  const tagButtonClickHandler = (tag) => {\n    console.log(tag);\n  }\n\n  return (\n    <IonList>\n      {/*}\n       <IonItem  button \n                color={(path ==='/todos/tag/today'? 'light' : '')}  \n                routerLink={encodeURI('/todos/tag/today')} \n                routerDirection=\"none\"\n                lines=\"none\">\n       \n              <IonIcon\n                size=\"large\"\n                src=\"assets/icons/sun.svg\"></IonIcon>\n            Today\n          </IonItem>\n      */}\n      <IonItemGroup key=\"listsGroup\">\n          <TodoMenuItemButtonComponet \n            name=\"Today\"\n            color={(path ==='/todos/tag/today'? 'light' : '')}  \n            actonFunc = {() => tagButtonClickHandler('today')}\n          /> \n            \n             \n        {state.lists.map( list => (\n          <IonItemSliding key={list.name+'list'}>\n            <IonItem  button \n                      color={(path ==='/todos/'+list.name? 'light' : '')}  \n                      routerLink={encodeURI('/todos/'+list.name)} \n                      routerDirection=\"none\"\n                      lines=\"none\">\n              <IonLabel>{list.name}</IonLabel>\n            </IonItem>\n            <IonItemOptions side=\"end\">\n              <IonItemOption  color=\"danger\" \n                              onClick={() => dispatch('showDeleteAlert',list)}>\n                Delete</IonItemOption>\n            </IonItemOptions>\n          </IonItemSliding>\n        ))}\n      </IonItemGroup>\n      <IonItemDivider>\n      </IonItemDivider>\n      <ListAddInlineComponent key=\"addNewItem\" projectid={projectid} />\n\n      <IonAlert \n        isOpen={state.showDeleteListAlert}\n        onDidDismiss={() => dispatch('hideDeleteAlert')}\n        header={\"Are you sure you want to delete '\" + state.deleteList.name + \"' list?\"}\n        subHeader={'All tasks in this list will be deleted'}\n        buttons={[\n          {\n            text: 'Cancel',\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: () => dispatch('hideDeleteAlert')\n          },\n          {\n            text: 'Delete List',\n            handler: () => deleteList()\n          }\n        ]}\n      />\n    </IonList>\n  )\n\n\n\n}\n\nexport default TodoMenuListComponent;","import React, { useReducer, useEffect } from 'react';\nimport { home, apps, sunny, star, heart, basket, construct, bonfire, checkmark, refresh } from 'ionicons/icons';\nimport { getDefaultProject } from '../../data/utilsData';\nimport { authService } from '../../auth/authService';\nimport ulog from 'ulog';\nimport TodoMenuListComponent from '../../../pages/todo/todo.menulist.component';\n\nconst log = ulog('menu');\n\nexport interface AppPage {\n  url: string;\n  icon: any;\n  title: string;\n  lastComponent?: any;\n}\n\n\nexport interface MenuFunctions {\n\n}\n\nexport interface MenuState {\n  projectid: string,\n  appPages: AppPage[];\n}\n\nexport const todoTags: AppPage[] = [\n  {\n    title: 'Today',\n    url: '/todos/today',\n    icon: sunny,\n  },\n  {\n    title: 'Important',\n    url: '/todos/important',\n    icon: star,\n  },\n  {\n    title: 'Important',\n    url: '/todos/tasksmain33mmm',\n    icon: checkmark,\n  },\n  {\n    title: 'Whish List',\n    url: '/todos/whish',\n    icon: heart,\n  },\n  {\n    title: 'Buy',\n    url: '/todos/buy',\n    icon: basket,\n  },\n  {\n    title: 'Projects',\n    url: '/todos/projects',\n    icon: construct,\n  },\n]\n\nexport const getMenuState = (projectid: string): MenuState => {\n  return {\n    projectid,\n    appPages: [\n      {\n        title: 'Home',\n        url: '/home',\n        icon: home,\n      },\n      {\n        title: 'Habits',\n        url: '/habits',\n        icon: refresh,\n      },\n      {\n        title: 'Parties',\n        url: '/parties',\n        icon: bonfire,\n      },\n      {\n        title: 'Todos',\n        url: '/todos',\n        icon: apps,\n        lastComponent: <TodoMenuListComponent projectid={projectid}  />\n      }\n    ]\n  }\n};\n\n\nconst reducer = (state, { type, payload }:{type:string, payload:any}):MenuState => {\n  switch (type) {\n  case 'authChange':\n    return getMenuState(getDefaultProject(authService.userid).id);\n  default:\n    log.error('REDUCER GOT UNHANDLED TYPE ', type, payload);\n    return state\n  }\n}\n\n\n\n//more simpler then auth hook, just read data\nexport function useMenuHookFacade(): [MenuState, MenuFunctions] {\n  const project = getDefaultProject(authService.userid);\n  const [state, _dispatch] = useReducer(reducer, getMenuState(project.id))\n\n  useEffect(() => {\n    const sub = authService.username$.subscribe(name => {\n      _dispatch({type: 'authChange', payload: authService.userid});\n    })\n   \n    return () => {sub.unsubscribe()};\n  }, [])\n          \n  const menuFunctions: MenuFunctions = {\n  }\n\n  \n\n\n  return [state, menuFunctions];\n}","import {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonMenu,\n  IonMenuToggle,\n  IonGrid,\n  IonCol,\n  IonRow\n} from '@ionic/react';\nimport React from 'react';\nimport { withRouter, useLocation } from 'react-router-dom';\nimport MenuHeaderWithProgress from './MenuHeaderWithProgress';\nimport { useMenuHookFacade } from '../modules/menu/hooks/menu.hook';\nimport './menu.css';\nimport ulog from 'ulog'\n\nconst log = ulog('menu')\n\nconst Menu = () => {\n\n  const [state,] = useMenuHookFacade();\n  const location = useLocation();\n  const path = location.pathname;\n  log.warn(path);\n  return (\n    <IonMenu key=\"ionmenu_left\" contentId=\"main\" type=\"overlay\">\n      <MenuHeaderWithProgress />\n      <IonContent key=\"menu_left\" >\n        <IonGrid>\n        {state.appPages.map((appPage, index) => {\n          return (\n            <>\n              <IonRow key={appPage.title.replace(' ', '')+appPage.url + index}>\n                <IonCol class=\"leftMenuCol\">\n                <IonMenuToggle  autoHide={false}>\n                  <IonItem\n                        color={(path === appPage.url? 'light' : '')}   \n                        routerLink={appPage.url} routerDirection=\"none\">\n                    <IonIcon slot=\"start\" icon={appPage.icon} />\n                    <IonLabel>{appPage.title}</IonLabel>\n                  </IonItem>\n                </IonMenuToggle>\n                </IonCol>\n              </IonRow>\n              {appPage.lastComponent? (\n                appPage.lastComponent\n              ) : (<></>)}\n            </>\n        )})}\n        </IonGrid>\n      </IonContent>\n    </IonMenu>\n)};\n\nexport default withRouter(Menu);\n","import React, { useState } from 'react';\nimport { PartyProject } from '../models';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonItem, \n  IonInput, IonLabel, IonTextarea, IonFooter, IonButton } from '@ionic/react';\n\n\n\n\n\nconst PartyEditComponent = ({party, dismissFunc}:\n    {party: PartyProject| null, dismissFunc:{(party: PartyProject|null, action: 'save'| 'remove' | 'none')}}) => {\n\n  const [state, setState] = useState({party: party||new PartyProject()})\n\n\n  const handleChange = (e) => {\n    const newDoc = {...state.party, ...{[e.target.name]:e.detail.value}}\n    const newState = {...state, ...{party: newDoc}};\n    setState(newState);\n  }\n\n\n  return (\n    <>\n      <IonHeader>\n            <IonToolbar>\n              <IonTitle>Add/Edit Party</IonTitle>\n            </IonToolbar>\n      </IonHeader>\n      <IonContent>\n          <IonItem>\n                <IonLabel position=\"floating\">Name</IonLabel>\n                <IonInput \n                    name=\"name\"\n                    placeholder=\"Your Cool Party Name\" \n                    onIonChange={handleChange}\n                    value={state.party.name} />\n            </IonItem>\n            <IonItem>\n                <IonLabel position=\"floating\">Note</IonLabel>\n                <IonTextarea \n                    placeholder=\"More details for your party members\"\n                    name=\"note\"\n                    onIonChange={handleChange}\n                    value={state.party.note}></IonTextarea>\n            </IonItem>\n            <IonFooter>\n              <IonToolbar>\n                <IonTitle>\n                  <IonButton onClick={() => dismissFunc(state.party, 'save')}>Save</IonButton>\n                  <IonButton onClick={() => dismissFunc(null, 'none')}>Cancel</IonButton>\n                </IonTitle>\n              </IonToolbar>\n            </IonFooter>\n      </IonContent>\n    </>\n  );\n}\n\nexport default PartyEditComponent;","import React, { useState, useEffect, useReducer } from 'react';\nimport { PartyProject } from '../models';\nimport { IonCard, IonCardHeader, IonCardTitle, IonCardSubtitle, IonBadge } from '@ionic/react';\nimport { useHistory } from '../../../../node_modules/@types/react-router';\n\n\nconst PartyListItemComponent = ({partyProject, history,  showEditModalFunction}:\n          {partyProject:PartyProject, history, showEditModalFunction:{(party: PartyProject)}}) => {\n\n  const [state, setState] = useState({party: partyProject})\n\n  useEffect(() => {\n    setState({...state, ...{party:partyProject}});\n  }, [partyProject])\n\n  return(\n    <IonCard>\n      <IonCardHeader onClick={() => history.push('/parties/'+ encodeURI(state.party.id||''))}>\n        <IonCardTitle>{state.party.name} \n              <IonBadge>{state.party.members.length}</IonBadge></IonCardTitle>\n        <IonCardSubtitle>{state.party.note}</IonCardSubtitle>\n      </IonCardHeader>\n    </IonCard>\n  )\n\n\n} \n\nexport default PartyListItemComponent;\n\n\n","import { Subscription, BehaviorSubject, Subject } from \"rxjs\";\nimport { dataService } from \"../data/dataService\";\nimport { TYPE_MSG } from \"./models\";\n\nexport interface Message {\n  from: string,\n  message: string, \n  type: string,\n}\n\nexport interface MessagesState {\n  docs: Message[],\n}\n\nexport const initMessageState = {\n  docs: []\n}\n\n\n\nexport class MessageService {\n  private _subscription: Array<Subscription> = [];\n  \n  private _state: MessagesState = initMessageState;\n  public state$ = new BehaviorSubject(this._state);\n  public messages$ = new Subject<Message>()\n  \n  async init(){\n    this.unsubscribe();\n    \n    const sub = dataService.subscribeChanges().subscribe(doc => {\n      console.log(doc);\n    });\n\n    this._subscription.push(sub);\n\n  }\n\n\n  public async getGlobalPartyMessages() {\n    const msgs = await dataService.queryByProperty('messageType', 'equals', 'messageType', TYPE_MSG );\n\n    console.log(msgs);\n    return msgs;\n  }\n \n\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\nexport const messageService = new MessageService();","import React, { useEffect, useReducer } from 'react';\nimport { IonList, IonLabel, IonItem, IonAvatar, IonButton } from '@ionic/react';\nimport { Msg } from '../../messages/models';\nimport { dataService } from '../../data/dataService';\nimport { waitMS } from '../../data/utilsData';\nimport { messageService } from '../../messages/messages.service';\nimport { capitalize, saveIntoDocList } from '../../../utils';\nimport { partyService } from '../party.service';\n\n\nconst reducer = (state, action) => {\n  switch(action.type) {\n    case 'addmsgs':\n      return {...state, ...{msgs: action.data} }\n    case 'addmsg':\n    return {...state, ...{msgs: saveIntoDocList(action.data, state.msgs)} };\n    default:\n      return state;\n  }\n}\n\n\nconst PartyInvitesListComponent = () => {\n\n  const [state, dispatch] = useReducer(reducer, {msgs: []})\n\n  console.log(state);\n\n  useEffect(() => {\n    const sub = dataService.subscribeChanges().subscribe(doc => {\n      if(doc.messageType !== 'party') return;\n      console.log(doc);\n      console.log(state);\n      dispatch({type: 'addmsg', data: doc});\n    });\n    getMessages();\n    return () => {\n      if(sub)sub.unsubscribe();\n    };\n  }, [])\n\n\n  const getMessages = async () => {\n    waitMS(2000);\n    const msgs = await messageService.getGlobalPartyMessages();\n    console.log(msgs);\n    dispatch({type: 'addmsgs', data:[...state.msgs, ...msgs]});\n  }\n\n  const printHeading = (msg:Msg):string => {\n    return capitalize(msg.from);\n  }\n\n  const printNote = (msg:Msg):string => {\n    if(msg.data){\n      if(msg.data.type === 'invite'){\n        let last = '';\n        if(msg.replied && msg.replied.accepted === false){\n          last = ' Rejected';\n        }\n        else if(msg.replied && msg.replied.accepted === true) {\n          last = ' Accepted';\n        }\n        return 'Come join our party: ' + msg.data.name + last;\n      }\n\n      if(msg.data.type === 'inviteaccepted') {\n        return 'Invitation to join \"'+ msg.data.name +'\" has been accepted'\n      }\n    }\n    return msg.message;\n  }\n\n  const printAcceptRejectButtons = (msg:Msg) => {\n    if(msg.data && msg.data.type === 'invite' && msg.replied === undefined){\n      return (\n        <div slot=\"end\">\n          <IonButton onClick={() => partyService.acceptPartyInvitation(msg)} >\n            Accept</IonButton>\n          <IonButton onClick={() => partyService.rejectPartyInviation(msg)}> \n            Reject</IonButton>\n        </div>\n      )\n    }\n  }\n\n  return(\n    <IonList>\n      {state.msgs.map(msg => (\n        <IonItem key={msg.id}> \n          <IonItem>\n            <IonAvatar slot=\"start\">\n              <img  />\n            </IonAvatar>\n            <IonLabel>\n              <h3>{printHeading(msg)}</h3>\n              <p>{printNote(msg)}</p>\n            </IonLabel>\n            {printAcceptRejectButtons(msg)}\n            \n          </IonItem>\n        </IonItem>\n      ))}\n    </IonList>\n  )\n\n\n} \n\nexport default PartyInvitesListComponent;","import React, { useState, useEffect, useReducer } from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonCard,\n  IonCardHeader,\n  IonCardTitle,\n  IonCardSubtitle,\n  IonCardContent,\n  IonLabel,\n  IonButton,\n  IonModal,\n  IonItem} from '@ionic/react';\nimport HeaderWithProgress from '../../../components/HeaderWithProgress';\nimport { authService } from '../../auth/authService';\nimport { PartyProject } from '../models';\nimport PartyEditComponent from '../components/Party.edit.component';\nimport { partyService } from '../party.service';\nimport PartyListItemComponent from '../components/Party.listitem.component';\nimport { useHistory } from 'react-router-dom';\nimport PartyInvitesListComponent from '../components/Party.invites.component';\n\nexport interface PartiesState {\n  userId: string,\n  showModal: boolean,\n  party: PartyProject|null\n  docs: PartyProject[],\n}\nconst reducer = (state, action:{type:string, data:any}): PartiesState => {\n  console.log(action, state);\n  switch(action.type) {\n    case 'dismissEdit':\n      return {...state, ...{showModal: false, party: null}}\n    case 'edit':\n      return {...state, ...{showModal: true, party: action.data}}\n    case 'docs':\n      return {...state, ...{docs:action.data}};\n    case 'userid': \n      return {...state, ...{userId: action.data}};\n    default:\n      console.log('ERROR, INCORRECT ACTION TYPE ', action);\n      return state;\n  }\n}\n\n\n\nconst PartiesPage = () => {\n  const history = useHistory();\n  const [state, _dispatch] = useReducer(reducer, {\n    userId: '',\n    showModal: false,\n    party: new PartyProject(),\n    docs: [],\n  })\n\n  const dispatch = (type: 'userid'|\n                          'dismissEdit'|\n                          'edit'|\n                          'docs', data:any = null) => {\n      _dispatch({type, data});                      \n  }\n\n  console.log('Parties Page:: ', state);\n\n  useEffect(() => {\n    const subs = [\n      authService.username$.subscribe(username => {\n        dispatch('userid', authService.userid);\n      }),\n\n      partyService.state$.subscribe(changes => {\n        dispatch('docs', changes.docs);\n      }),\n\n    ]\n    return () => {\n      subs.forEach(sub => {\n        if(sub) sub.unsubscribe();\n      });\n    };\n    // eslint-disable-next-line\n  }, [])\n\n  const editParty = (party:PartyProject = new PartyProject()) => {\n    console.log('Add party:  ', party);\n    dispatch('edit', party);\n  }\n\n\n  const modalDismissFunc = (party: PartyProject|null, action:'save'|'remove'|'none') => {\n    console.log('PARTY: ', party)\n    dispatch('dismissEdit')\n    if(action === 'save' && party != null){\n      partyService.saveParty(party)\n    }\n    else if(action === 'remove' && party != null && party.id){\n      //dataFunc.remove(habit._id);\n    }\n  }\n\n  const hideModal = () => {\n    dispatch('dismissEdit');\n  }\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title=\"Parties\" />\n      <IonContent>\n        {state.showModal? (\n          <IonModal isOpen={state.showModal} onDidDismiss={() => hideModal()}>\n            <PartyEditComponent party={state.party} \n                                dismissFunc = {modalDismissFunc}  />\n          </IonModal>\n        ) : (\n          <></>\n        )}\n        <IonCard>\n          <IonCardHeader>\n            <IonCardTitle>\n              Here you can join friends to conquer those tasks together.\n            </IonCardTitle>\n            <IonCardSubtitle>\n              \n            </IonCardSubtitle>\n          </IonCardHeader>\n          <IonCardContent>\n            <IonLabel>\n              Create your party to go on quests and challenge your friends.\n            </IonLabel>\n            <IonButton onClick={() =>editParty()} >Create Party</IonButton>\n            <br></br><br></br><br></br>\n            <IonLabel>\n              Join your friends party, give them your code: <strong>{state.userId}</strong>\n            </IonLabel>\n            \n          </IonCardContent>\n        </IonCard>\n      <IonList>\n        {state.docs.map(party => (\n          <PartyListItemComponent partyProject={party} \n                                  history={history}\n                                  key={party.id}\n                                  showEditModalFunction={editParty} />\n        ))}  \n      </IonList>\n      <PartyInvitesListComponent />\n      <IonItem>\n        <IonLabel>To join a party, you can give part leader your id: {state.userId} </IonLabel>\n      </IonItem>\n      \n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default PartiesPage;\n\n","import React, { useReducer } from 'react';\nimport { PartyProject, PartyMember } from '../models';\nimport { IonCard, IonCardTitle, IonCardHeader, IonCardContent, IonList, IonItem, IonAlert, IonFooter, IonButton, IonLabel } from '@ionic/react';\nimport { partyService } from '../party.service';\nimport  ulog from 'ulog';\nimport { authService } from '../../auth/authService';\nimport { canEditProject } from '../../data/utilsData';\nconst log = ulog('memberlist');\n\nexport interface MembersState {\n  showAddModal: boolean,\n  members: PartyMember[],\n}\n\n\nconst reducer = (state, action): MembersState => {\n  switch(action.type) {\n    case 'showAddMemberModal':\n      return {...state, ...{showAddModal: true}};\n    case 'hideAddMemberModal':\n      return {...state, ...{showAddModal: false}};\n\n    default:\n      log.error('Action type is not a match');\n      return state;\n  }\n}\n\nconst PartyMembersListComponent = ({project}:{project:PartyProject}) => {\n  const [state, _dispatch] = useReducer(reducer, {\n    showAddModal: false,\n    members: [],\n  })\n\n  const dispatch = (type: 'showAddMemberModal'|\n                          'hideAddMemberModal', \n                    data:any = {}) => {\n    _dispatch({type, data});\n  }\n\n  const addMember = () => {\n    dispatch(\"showAddMemberModal\");\n    \n  }\n\n  const hideAddUser = () => {\n    dispatch('hideAddMemberModal');\n  }\n\n  const canEditThisProject = () => {\n    const self = project.members.find(m => m.id === authService.userid);\n    if(!self) return false;\n    return canEditProject(self.rights);\n  }\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>Members</IonCardTitle>\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n            {project.members.map(member => (\n              <IonItem  button \n                        key={member.id}\n                        onClick={() => {}}>\n              <IonLabel>\n                {member.username}\n              </IonLabel>\n            </IonItem>\n            ))}\n        </IonList>\n        \n      </IonCardContent>\n      {canEditThisProject()? (\n        <IonFooter>\n          <IonButton onClick={()=>addMember()} fill=\"clear\">Add Member</IonButton>\n        </IonFooter>\n      ) : ( <></>)}\n      <IonAlert \n        isOpen={state.showAddModal}\n        onDidDismiss={() => hideAddUser()}\n        header=\"Friend ID:\"\n        subHeader={'Found at bottom of parties page.'}\n        inputs={[\n          {\n            name: 'userid',\n            type: 'text',\n            id: 'adduserid',\n\n\n          }\n        ]}\n        buttons={[\n          {\n            text: 'Cancel',\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: () => {\n              hideAddUser();\n            }\n          },\n          {\n            text: 'Invite User',\n            handler: (data) => {\n              partyService.addUser(data.userid, project);\n              hideAddUser();\n            }\n          }\n        ]}\n      />\n    </IonCard>\n  )\n\n}\nexport default PartyMembersListComponent;","import React, { useEffect, useReducer } from 'react';\nimport { IonItem, IonCard, IonCardHeader, IonCardTitle, IonCardContent, IonNote, IonBadge, IonFooter, IonButton } from '@ionic/react';\nimport { Challenge, ChallengeStage } from '../models';\nimport { ProjectItem } from '../../data/models';\n\nexport interface ChallengeState {\n  challenge: Challenge,\n}\n\nconst reducer = (state, action): ChallengeState => {\n  switch(action.type) {\n    case 'challenge':\n      return {...state, ...{challenge:action.data}}\n\n    default:\n      console.log('ERROR WENT TO DEFAULTS:: ', action);\n      return state;\n  }\n}\n\n\nconst ChallengeListItemComponent = ({challenge}:\n  {challenge:Challenge, showEditModalFunction:{(challenge: Challenge)}}) => {\n\n  const [state, _dispatch] = useReducer(reducer, {\n    challenge,\n  })\n\n  const dispatch = (type:'challenge', data:any) => {\n    _dispatch({type, data});\n  }\n\n  useEffect(() => {\n    dispatch('challenge', challenge);\n  }, [challenge])\n\n\n  const printAcceptChallenge = () => {\n    //which state, and if already joined\n    if(challenge.stage !== ChallengeStage.waiting) return;\n    //const self = challenge.mem \n  }\n  const acceptChallenge = () => {\n\n  }\n\n  const printAddProgress = () => {\n    return (\n      <IonButton onClick={()=>acceptChallenge()} fill=\"clear\">Accept Challenge</IonButton>\n    )\n  }\n  const addProgress = () => {\n\n  }\n\n\n  const printGoal = () => {\n    if(state.challenge.regularityInterval === 'day'){\n      return (\n        <IonItem>\n              <IonNote>\n                Remember, you promised that you will repeat \n                this habit <strong>every day</strong>.\n              </IonNote>\n        </IonItem>\n      )\n    }\n    \n    return (\n      <IonItem>\n        <IonNote>\n          Remember you promised that you will repeat this habit \n          <strong> {state.challenge.regularityValue} times {state.challenge.regularityInterval}</strong>\n        </IonNote>\n      </IonItem>\n    )\n  }\n\n\n\n  const print = () => {\n    return (\n        <IonCard>\n          <IonCardHeader>\n            {/*<IonCardSubtitle>Card Subtitle</IonCardSubtitle>*/}\n            <IonCardTitle>{state.challenge.name}</IonCardTitle>\n          </IonCardHeader>\n          <IonCardContent>\n            {printGoal()}\n          </IonCardContent>\n          <IonFooter>\n            {printAcceptChallenge()}\n            {printAddProgress()}\n            \n          </IonFooter>\n         {/* \n          <IonFab horizontal=\"end\" vertical=\"bottom\" edge>\n            <IonFabButton size=\"small\" color={COLOR_LIGHT} onClick={() => showEditModalFunction(doc)}>\n              <IonIcon size=\"large\" icon={cog} />\n            </IonFabButton>\n          </IonFab>\n        */}\n        </IonCard>\n    );\n  }\n  \n  return print();\n};\n\nexport default ChallengeListItemComponent;\n\n","import React, { useState } from 'react';\nimport { IonItem, IonLabel, IonIcon, IonInput, IonTextarea, IonButton, \n  IonHeader, IonTitle, IonToolbar, IonContent, IonFooter, \n  IonRange, IonFab, \n  IonFabButton, IonAlert, IonSegment, IonSegmentButton } from '@ionic/react';\nimport { ChallengeIntervals, Challenge, ChallengeDifficulty } from '../models';\nimport { capitalize } from '../../../utils';\nimport { COLOR_DANGER } from '../../../colors';\nimport { trash } from 'ionicons/icons';\n\n\n\ninterface challengeState {\n  regularity: {\n    interval: ChallengeIntervals,\n    min: number,\n    max: number,\n  }\n  doc: Challenge,\n  showDeleteWarrning: boolean\n}\n\nconst getRegularityValues = (interval: ChallengeIntervals) => {\n  switch (interval) {\n    case ChallengeIntervals.day:\n      return {interval: interval, min:1, max: 1}\n    case ChallengeIntervals.week:\n      return {interval: interval, min:1, max: 6}\n    case ChallengeIntervals.month:\n      return {interval: interval, min:1, max: 25}\n  }\n}\n\nconst ChallengeAddComponent = ({challenge, dismissFunc}:\n  {challenge:Challenge|null, dismissFunc: {(challenge:Challenge|null, action: 'save'|'remove'|'none')}}) => {\n  console.log('Add Challenge Form:::::: ', challenge);\n  const _challenge = challenge|| new Challenge();\n  const getDefaultRegularityState: challengeState = {\n    regularity: getRegularityValues(_challenge.regularityInterval),\n    doc: _challenge,\n    showDeleteWarrning: false\n  }\n  const [state, setState] = useState<challengeState>({...getDefaultRegularityState, ...{doc: _challenge}});\n\n\n\n  console.log(state);\n  const handleChange = (e) => {\n    const newDoc = {...state.doc, ...{[e.target.name]:e.detail.value}}\n    const newState = {...state, ...{doc: newDoc}};\n    setState(newState);\n  }\n\n  const handlerRegularityValue = (e) => {\n    console.log(e);\n    const newDoc = {...state.doc, ...{regularityValue: e.detail.value}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  const handlerRegularityIntervalChange = (value) => {\n    value = value || 'day';\n    const newDoc = {...state.doc, ...{regularityInterval: value, regularityValue: 1}};\n    const newReg = {...state.regularity, ...getRegularityValues(value)};\n    setState({...state, ...{doc:newDoc, regularity: newReg}});\n    console.log(state);\n  }\n\n  const printRegularityLabel = () => {\n\n    const times = (state.doc.regularityValue > 1)? ' times a ': ' time a ';\n    if(state.doc.regularityInterval === 'day'){\n      return 'I will repeat this task every day.'\n    }\n    \n    return 'I will repeat this task ' + state.doc.regularityValue + times + state.doc.regularityInterval\n  }\n\n  const handleDifficultyChange = (e) => {\n    const newDoc = {...state.doc, ...{difficulty: e.detail.value}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  const printDifficultyLabel = (chdiff: ChallengeDifficulty): string => {\n    switch(chdiff) {\n      case ChallengeDifficulty.trivial:\n        return 'Easy peasy lemon squeezy';\n      case ChallengeDifficulty.easy:\n        return 'Piece of Cake';\n      case ChallengeDifficulty.medium:\n        return \"Let's Rock\";\n      case ChallengeDifficulty.hard:\n        return 'No Pain, No Gain';\n      case ChallengeDifficulty.extreme:\n        return 'Death Wish';\n    }\n  }\n\n  const showRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: true}});\n  }\n\n  const hideRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: false}});\n  }\n\n  const removehabit = () => {\n    hideRemoveWarrning();\n    console.log('REMVE ACTION STATE::::::: ', state);\n    dismissFunc(state.doc, 'remove');\n  }\n\n\n\n  const print = () => {\n      return (\n      <>\n        <IonHeader>\n          <IonToolbar>\n            {/*\n            <IonButtons slot=\"start\">\n              <IonButton> <IonIcon size=\"large\" icon={arrowBack} /></IonButton>\n            </IonButtons>\n            */}\n            <IonTitle>Add Challenge</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonItem>\n              <IonLabel position=\"floating\">Name</IonLabel>\n              <IonInput \n                  name=\"name\"\n                  placeholder=\"Read book, Go running ...\" \n                  onIonChange={handleChange}\n                  value={state.doc.name} />\n          </IonItem>\n          <IonItem>\n              <IonLabel position=\"floating\">Note</IonLabel>\n              <IonTextarea \n                  placeholder=\"Enter more information here, motivate yourself...\"\n                  name=\"note\"\n                  onIonChange={handleChange}\n                  value={state.doc.note}></IonTextarea>\n          </IonItem>\n          <IonItem>\n            <IonSegment value={state.doc.regularityInterval}\n                        onIonChange={(e) => handlerRegularityIntervalChange(e.detail.value)}>\n              <IonSegmentButton value=\"day\">\n                <IonLabel>Daily</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"week\">\n                <IonLabel>Weekly</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"month\">\n                <IonLabel>Monthly</IonLabel>\n              </IonSegmentButton>\n            </IonSegment>\n          </IonItem>\n\n          {(state.doc.regularityInterval !== 'day')? (\n            <>\n              <IonRange \n                    min={state.regularity.min}\n                    max={state.regularity.max}\n                    debounce={100}\n                    value={state.doc.regularityValue}\n                    onIonChange={handlerRegularityValue}\n                    color=\"secondary\" >\n                <IonLabel slot=\"start\">{state.regularity.min}</IonLabel>\n                <IonLabel slot=\"end\">{state.regularity.max}</IonLabel>\n              </IonRange>\n            </>\n          ) : (\n          <></> )}\n          <IonItem>\n            <IonLabel>{printRegularityLabel()}</IonLabel>\n          </IonItem>\n\n          <IonRange min={0} \n                    max={4} \n                    debounce={100}\n                    value={state.doc.difficulty}\n                    onIonChange={handleDifficultyChange}\n                    color=\"secondary\">\n              <IonLabel slot=\"start\">{capitalize(printDifficultyLabel(ChallengeDifficulty.trivial))}</IonLabel>\n              <IonLabel slot=\"end\">{capitalize(printDifficultyLabel(ChallengeDifficulty.extreme))}</IonLabel>\n          </IonRange>\n\n          <IonItem>\n            <IonLabel>{printDifficultyLabel(state.doc.difficulty)}</IonLabel>\n          </IonItem>\n        </IonContent> \n\n        <IonFooter>\n          <IonToolbar>\n            <IonTitle>\n              <IonButton onClick={() => dismissFunc(state.doc, 'save')}>Save</IonButton>\n              <IonButton onClick={() => dismissFunc(null, 'none')}>Cancel</IonButton>\n            </IonTitle>\n          </IonToolbar>\n        </IonFooter>\n        <IonFab horizontal=\"end\" vertical=\"bottom\" >\n          <IonFabButton size=\"small\" color={COLOR_DANGER} onClick={() => showRemoveWarrning()}>\n            <IonIcon size=\"large\" icon={trash} />\n          </IonFabButton>\n        </IonFab>\n        <IonAlert\n          isOpen={state.showDeleteWarrning}\n          onDidDismiss={() => hideRemoveWarrning}\n          header={'Warrning!!!'}\n          message={'Are you sure you want to <strong>delete</strong> this habit?'}\n          buttons={[\n            {\n              text: 'Cancel',\n              role: 'cancel',\n              cssClass: 'secondary',\n              \n            },\n            {\n              text: 'Yes Im Sure',\n              handler: () => removehabit()\n            }\n          ]}\n        />\n      </>\n      );\n  }\n  \n  console.log(\"Ready to return form\");\n  return print();\n};\n\nexport default ChallengeAddComponent;\n","import React, { useReducer, useEffect } from 'react';\nimport { IonList, IonModal, IonCard, \n  IonCardContent, IonCardHeader, IonCardTitle, \n  IonFab, IonFabButton, IonIcon, IonButton, IonFooter } from '@ionic/react';\nimport { Challenge, PartyProject, TYPE_PARTY } from '../models';\nimport ChallengeListItemComponent from './Challenge.listitem.component';\nimport ChallengeAddComponent from './Challenge.add.component';\nimport { add } from 'ionicons/icons';\nimport { dataService } from '../../data/dataService';\nimport { partyService } from '../party.service';\nimport { getProjectChildId, canEditProject } from '../../data/utilsData';\nimport { saveIntoArray } from '../../../utils';\nimport  ulog from 'ulog';\nimport { authService } from '../../auth/authService';\n\n//ulog.level = 7;\nconst log = ulog('challengelist');\n\n\nexport interface ChallengeListState {\n  showModal: boolean,\n  modalChallenge: Challenge|null,\n  challenges: Challenge[],\n}\n\nconst reducer = (state, action): ChallengeListState => {\n  switch(action.type) {\n    case 'addChallengeModal': \n      return {...state, ...{showModal: true, modalChalleng: action.data}}\n    case 'hideChallengeModal':\n      return {...state, ...{showModal: false, modalChalleng: null}}\n    case 'loadChallenges': \n      return {...state, ...{challenges: action.data}}\n    case 'challengeChange':\n      return {...state, ...{challenges:saveIntoArray(action.data,state.challenges)}};\n    default:\n      return state;\n  }\n}\n\n\n\n\nconst ChallengeListComponent = ({project}:{project: PartyProject}) => {\n  const [state, _dispatch] = useReducer(reducer, {\n    showModal: false,\n    modalChallenge: null,\n    challenges: [],\n  });\n\n  useEffect(() => {\n    //hvCSL13RdC.ch party\n    console.log('CHALLENGE LIST COMP::::::: ', project.id, TYPE_PARTY);\n    const sub = dataService.subscribeByPropertyChange('secondaryType', 'challenge')\n      .subscribe(change => {\n        if(change.id.startsWith(getProjectChildId(project.id)))\n          dispatch('challengeChange', change);\n\n    });\n    if(project.id)\n      loadChallenges(project.id);\n\n    return () => {\n      sub.unsubscribe();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [project.id])\n\n  const loadChallenges = async (id: string) => {\n    const res = await dataService.queryByProperty(\n        'secondaryType', 'equals', 'challenge', TYPE_PARTY);\n    const challenges = res.filter(doc => doc.id.startsWith(getProjectChildId(id)));\n    dispatch('loadChallenges', challenges);\n  };\n\n  const dispatch = (type: 'addChallengeModal'|\n                          'loadChallenges'|\n                          'challengeChange'|\n                          'hideChallengeModal', data:any) => {\n    _dispatch({type, data});\n  }\n  \n  const addChallenge = (ch:Challenge = new Challenge()) => {\n    console.log('Add challenge:  ', ch);\n    dispatch('addChallengeModal', ch);\n  }\n\n  const hideChallengeModal = () => {\n    dispatch('hideChallengeModal', null);\n  }\n\n  const challengeDismissFunc = (challenge: Challenge|null, action:'save'|'remove'|'none') => {\n    console.log('Challenge: ', challenge)\n    hideChallengeModal();\n    if(action === 'save' && challenge != null){\n      partyService.saveChallenge(challenge, project);\n    }\n    else if(action === 'remove' && challenge != null && challenge.id){\n      //dataFunc.remove(habit.id);\n    }\n  }\n\n\n  const canEditThisProject = () => {\n    const self = project.members.find(m => m.id === authService.userid);\n    if(!self) return false;\n    return canEditProject(self.rights);\n  }\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>Challenges</IonCardTitle>\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n          {state.challenges.map(challenge => (\n                <ChallengeListItemComponent\n                          challenge={challenge} \n                          key={challenge.id} \n                          showEditModalFunction={addChallenge}/>\n          ))}\n        </IonList>\n        {state.showModal? (\n          <IonModal isOpen={state.showModal} onDidDismiss={() => hideChallengeModal()}>\n          <ChallengeAddComponent challenge={state.modalChallenge} \n                              dismissFunc = {challengeDismissFunc}  />\n          </IonModal>\n        ) : (\n          <></>\n        )}\n      </IonCardContent>\n      <IonFooter>\n        {canEditThisProject()? (\n          <IonButton    onClick={() => addChallenge()}\n            fill=\"clear\">Add New Challenge</IonButton>\n        ) : ( <></>)}\n      </IonFooter>\n    </IonCard>\n  )\n}\n\n\n\nexport default ChallengeListComponent;","import React, { useState, useEffect, useReducer, useRef } from 'react';\nimport { IonPage, IonContent, IonButton, IonModal } from '@ionic/react';\nimport HeaderWithProgress from '../../../components/HeaderWithProgress';\nimport { PartyProject, TYPE_PARTY } from '../models';\nimport { useParams, useHistory } from 'react-router-dom';\nimport { dataService } from '../../data/dataService';\nimport { HabitsService } from '../../../pages/habits/habits.service';\nimport HabitListComponent from '../../../pages/habits/Habit.list.component';\nimport { waitMS } from '../../../utils';\nimport PartyMembersListComponent from '../components/Members.list.component';\nimport { first } from '../../../../node_modules/rxjs/operators';\nimport ChallengeListComponent from '../components/Challenge.list.component';\n\n\n\ninterface State {\n  party:PartyProject,\n}\n\nconst getInitState = {\n    party: new PartyProject(),\n}\n\n\nconst loadParty = async (id:string, state, setState, history) => {\n  console.log('Loading party');\n  const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n    if(!ready) return;\n    console.log('==============================Load party, ', id);\n    const party = await dataService.getDoc(id, TYPE_PARTY);\n    console.log(party)\n    if(!party){\n      dataSub.unsubscribe();\n      console.log('************************************* couldn load party', id);\n      history.push('/parties');\n      return\n    }\n    setState({...state, ...{party}})\n    dataSub.unsubscribe();\n  })\n  \n}\n\n//*********** Page Start *************/\nconst PartyViewPage = () => {\n  console.log('PARTY PAGE');\n  const {id} = useParams();\n  const history = useHistory();\n  const [state, setState] = useState<State>(getInitState)\n  const habitsService = useRef(new HabitsService());\n\n  //if(!id) return history.push('/parties');\n  console.log('--------------------------------EFFECT: ', id);\n  useEffect(() => {\n    if(id)\n      loadParty(id, state, setState, history)\n    else {\n      console.log('=================================================== no id')\n      history.push('/parties');\n    }\n  }, [id])\n  \n\n\n\n\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title={\"Party: \" + state.party.name} />\n      <IonContent>\n        \n      {state.party.id? (\n        <>\n          <PartyMembersListComponent  project={state.party} />\n          <ChallengeListComponent project={state.party} />\n        </>\n      ):(<></>)}\n\n      </IonContent>\n    </IonPage>\n  )\n}\n\nexport default PartyViewPage;","import React, {  } from 'react';\nimport { Redirect, Route, useHistory, useLocation } from 'react-router-dom';\nimport UserPage from './modules/auth/components/user.page';\nimport TodosPage from './pages/todo/Todos.page';\nimport IntroPage from './modules/auth/components/intro.page';\nimport { useAppStatus, AppStatus } from './modules/app/hooks/appStatus.hook';\nimport Home from './pages/Home';\nimport NotFound from './pages/NotFound';\nimport UnauthenticatedRoute from './modules/auth/unauthenticatedRoute';\nimport HabitsPage from './pages/habits/Habits.page';\nimport { home, timer, apps } from '../node_modules/ionicons/icons';\nimport { IonSplitPane, IonRouterOutlet } from '../node_modules/@ionic/react';\nimport Menu from './components/Menu';\nimport PartiesPage from './modules/parties/pages/Parties.page';\nimport PartyViewPage from './modules/parties/pages/Party.view.page';\n\nexport const Routes = () => {\n  const [appStatus] = useAppStatus();\n  const history = useHistory();\n  const location = useLocation();\n\n  console.log('APP RERENDER::::::::::::::::::::::::::::::::::::::', appStatus, location, history);\n  \n\n  \n  if(appStatus.status === AppStatus.auth && location.pathname.startsWith('/auth/')){\n    if(location.state){\n      const newpath = location.state['prev'] || '/';\n      history.push(newpath);\n    }\n    \n  }\n\n  const getRoutes = () => {\n    switch(appStatus.status){\n      case AppStatus.auth:\n        return (\n          <IonSplitPane when=\"sm\" contentId=\"main\">\n            <Menu key=\"menu\"/>\n            <IonRouterOutlet id=\"main\">\n                <Route path=\"/home\" component={Home} exact={true} />           \n                <Route exact path=\"/auth/user\" component={UserPage} />\n                <Route path=\"/todos\" component={TodosPage} exact={true} />\n                <Route path=\"/todos/:list\" component={TodosPage} exact={true} />\n                <Route path=\"/todos/tag/:tag\" component={TodosPage} exact={true} />\n                <Route path=\"/habits\" component={HabitsPage} exact={true} />\n                <Route path=\"/parties\" component={PartiesPage} exact={true} />\n                <Route path=\"/parties/:id\" component={PartyViewPage} exact={true} />\n                <Route path=\"/\" render={() => <Redirect to=\"/home\" />} exact={true} />\n                <Route path=\"/404\" component={NotFound} />\n                <Redirect to=\"/404\" />\n            </IonRouterOutlet>\n        </IonSplitPane>\n        )\n      case AppStatus.guest:\n          return (\n            <IonRouterOutlet>\n              <UnauthenticatedRoute exact path=\"*\" component={Home} />\n            </IonRouterOutlet>\n          );\n      default:\n          return (\n            <IonRouterOutlet>\n              <Route exact path=\"*\"  component={IntroPage} />\n            </IonRouterOutlet>\n          );\n      \n\n    }\n  }\n\n  return getRoutes();\n}","import React, { useState, useEffect } from 'react';\nimport { IonToast } from '@ionic/react';\nimport { Subscription } from 'rxjs';\nimport { toastService, ToastMessage } from './toastService';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nexport const Toasts: React.FC = () => {\n  const [message, setMessage] = useState<ToastMessage | null>(null);\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      toastService.messages$.subscribe((m: ToastMessage) =>{\n        setMessage(m);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[message]);\n\n  console.log('PRINTING TOAST: ', message);\n\n  /*\n  const print = () => {\n    if(message)\n      return <IonToast\n                isOpen={message != null}\n                message={message.message}\n                duration={message.duration}\n                onDidDismiss={() => setMessage(null)}\n              />\n  } \n*/\n\n  return (\n    <div className='toastDiv' >\n      <ToastContainer\n          position=\"top-right\"\n          autoClose={5000}\n          hideProgressBar\n          newestOnTop={false}\n          closeOnClick\n          rtl={false}\n          draggable\n          pauseOnHover\n          />\n    </div>\n  );\n};","import React from 'react';\nimport { IonApp } from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\n\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\n\nimport './theme/my.css';\n\nimport { Loading } from './modules/loading/loading.component';\nimport { Routes } from './routes';\nimport { Toasts } from './modules/toast/toast.component';\n\n\n\nconst App: React.FC = () => (\n  <IonApp>\n    <IonReactRouter>\n      <Loading /><Toasts />\n      <Routes />\n    </IonReactRouter>\n  </IonApp>\n);\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}