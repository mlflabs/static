(this.webpackJsonphabitville=this.webpackJsonphabitville||[]).push([[7],{103:function(e,t,n){e.exports=n(224)},109:function(e,t,n){var a={"./ion-action-sheet-ios.entry.js":[228,37],"./ion-action-sheet-md.entry.js":[229,38],"./ion-alert-ios.entry.js":[230,21],"./ion-alert-md.entry.js":[231,22],"./ion-app_8-ios.entry.js":[232,10],"./ion-app_8-md.entry.js":[233,11],"./ion-avatar_3-ios.entry.js":[234,39],"./ion-avatar_3-md.entry.js":[235,40],"./ion-back-button-ios.entry.js":[236,41],"./ion-back-button-md.entry.js":[237,42],"./ion-backdrop-ios.entry.js":[238,79],"./ion-backdrop-md.entry.js":[239,80],"./ion-button_2-ios.entry.js":[240,43],"./ion-button_2-md.entry.js":[241,44],"./ion-card_5-ios.entry.js":[242,45],"./ion-card_5-md.entry.js":[243,46],"./ion-checkbox-ios.entry.js":[244,47],"./ion-checkbox-md.entry.js":[245,48],"./ion-chip-ios.entry.js":[246,49],"./ion-chip-md.entry.js":[247,50],"./ion-col_3.entry.js":[248,81],"./ion-datetime_3-ios.entry.js":[249,17],"./ion-datetime_3-md.entry.js":[250,18],"./ion-fab_3-ios.entry.js":[251,51],"./ion-fab_3-md.entry.js":[252,52],"./ion-img.entry.js":[253,82],"./ion-infinite-scroll_2-ios.entry.js":[254,35],"./ion-infinite-scroll_2-md.entry.js":[255,36],"./ion-input-ios.entry.js":[256,53],"./ion-input-md.entry.js":[257,54],"./ion-item-option_3-ios.entry.js":[258,55],"./ion-item-option_3-md.entry.js":[259,56],"./ion-item_8-ios.entry.js":[260,57],"./ion-item_8-md.entry.js":[261,58],"./ion-loading-ios.entry.js":[262,23],"./ion-loading-md.entry.js":[263,24],"./ion-menu_3-ios.entry.js":[264,59],"./ion-menu_3-md.entry.js":[265,60],"./ion-modal-ios.entry.js":[266,12],"./ion-modal-md.entry.js":[267,13],"./ion-nav_2.entry.js":[268,16],"./ion-popover-ios.entry.js":[269,14],"./ion-popover-md.entry.js":[270,15],"./ion-progress-bar-ios.entry.js":[271,61],"./ion-progress-bar-md.entry.js":[272,62],"./ion-radio_2-ios.entry.js":[273,63],"./ion-radio_2-md.entry.js":[274,64],"./ion-range-ios.entry.js":[275,65],"./ion-range-md.entry.js":[276,66],"./ion-refresher_2-ios.entry.js":[277,25],"./ion-refresher_2-md.entry.js":[278,26],"./ion-reorder_2-ios.entry.js":[279,33],"./ion-reorder_2-md.entry.js":[280,34],"./ion-ripple-effect.entry.js":[281,83],"./ion-route_4.entry.js":[282,67],"./ion-searchbar-ios.entry.js":[283,27],"./ion-searchbar-md.entry.js":[284,28],"./ion-segment_2-ios.entry.js":[285,68],"./ion-segment_2-md.entry.js":[286,69],"./ion-select_3-ios.entry.js":[287,70],"./ion-select_3-md.entry.js":[288,71],"./ion-slide_2-ios.entry.js":[289,84],"./ion-slide_2-md.entry.js":[290,85],"./ion-spinner.entry.js":[291,31],"./ion-split-pane-ios.entry.js":[292,86],"./ion-split-pane-md.entry.js":[293,87],"./ion-tab-bar_2-ios.entry.js":[294,72],"./ion-tab-bar_2-md.entry.js":[295,73],"./ion-tab_2.entry.js":[296,32],"./ion-text.entry.js":[297,74],"./ion-textarea-ios.entry.js":[298,75],"./ion-textarea-md.entry.js":[299,76],"./ion-toast-ios.entry.js":[300,29],"./ion-toast-md.entry.js":[301,30],"./ion-toggle-ios.entry.js":[302,19],"./ion-toggle-md.entry.js":[303,20],"./ion-virtual-scroll.entry.js":[304,88]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=109,e.exports=r},111:function(e,t,n){var a={"./ion-icon.entry.js":[308,96]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=111,e.exports=r},126:function(e,t,n){},127:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){},154:function(e,t,n){},155:function(e,t,n){},157:function(e,t,n){},221:function(e,t,n){},222:function(e,t,n){},224:function(e,t,n){"use strict";n.r(t);var a,r,o,s=n(0),c=n.n(s),i=n(36),u=n.n(i),l=n(1),d=n(93),h=(n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(125),n(126),n(127),n(10)),f=n(9),m=n(11),p=n(312),b=new(function(){function e(){Object(f.a)(this,e),this._loading=!1,this.loading$=new p.a({show:this._loading,msg:"Loading..."})}return Object(m.a)(e,[{key:"showLoading",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";this._loading=!0,this.loading$.next({show:!0,msg:e})}},{key:"hideLoading",value:function(){this._loading=!1,this.loading$.next({show:!1,msg:""})}},{key:"startLoadingTimer",value:function(){}},{key:"loading",get:function(){return this._loading}}]),e}()),g=function(){var e=Object(s.useState)({show:!1,msg:"Loading..."}),t=Object(h.a)(e,2),n=t[0],a=t[1];return Object(s.useEffect)((function(){var e=[b.loading$.subscribe((function(e){a({show:e.show,msg:e.msg})}))];return function(){e.map((function(e){return e.unsubscribe()}))}}),[]),c.a.createElement(l.y,{isOpen:n.show,message:n.msg})},v=n(22),y=function(){return c.a.createElement(l.D,null,c.a.createElement(l.r,null,c.a.createElement(l.N,null,c.a.createElement(l.M,null,"User Page"))),c.a.createElement(l.m,null,c.a.createElement(l.v,null,"User")))},E=n(2),j=n.n(E),k=n(5),w=n(15),x=n(14),O=n(13),S=n(16),_=(String.fromCharCode(65535),function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(f.a)(this,e),this.id=void 0,this.deleted=void 0,this.created=Date.now(),this.updated=Date.now(),this.type="doc",this.dirty=0,Object.assign(this,t)}),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(f.a)(this,t),(e=Object(w.a)(this,Object(x.a)(t).call(this))).name="",e.note=void 0,e.access=[],Object.assign(Object(O.a)(e),n),e}return Object(S.a)(t,e),t}(_),C=n(4);!function(e){e[e.finished=0]="finished",e[e.current=1]="current",e[e.future=2]="future",e[e.resting=3]="resting"}(a||(a={})),function(e){e.day="day",e.week="week",e.month="month"}(r||(r={})),function(e){e[e.trivial=0]="trivial",e[e.easy=1]="easy",e[e.medium=2]="medium",e[e.hard=3]="hard",e[e.extreme=4]="extreme"}(o||(o={}));var I=function(e){switch(e){case o.trivial:return"trivial";case o.easy:return"easy";case o.medium:return"medium";case o.hard:return"hard";case o.extreme:return"extreme"}},D=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(f.a)(this,t),(e=Object(w.a)(this,Object(x.a)(t).call(this))).name="New habit",e.note=void 0,e.type="hab",e.stage=a.current,e.difficulty=o.medium,e.regularityInterval=r.day,e.regularityValue=1,e.regularityEachDayGoal=1,e.progress=[],e.currentStreak=0,e.bestStreak=0,e.newRewards=void 0,Object.assign(Object(O.a)(e),n),e}return Object(S.a)(t,e),t}(_),P=n(20),R=n.n(P),A="production"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_STAGE?{SYNC_SERVER:"https://auth.mlflabs.com",AUTH_API_URL:"https://auth.mlflabs.com"}:{},N=Object(C.a)({},{APP_ID:"hv",ACCESS_META_KEY:"access",TOKEN_EXPIRATION:300,SYNC_SERVER:"http://localhost:3002",AUTH_API_URL:"http://localhost:3002"},{},A),F=n(28),M=function(e){return"string"!==typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)};function L(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return n.reduce((function(e,t){return e&&e[t]}),e)}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:e,data:t}}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=H(e[n],t,n);return-1===a&&(a=t.length),[].concat(Object(F.a)(t.slice(0,a)),[Object.assign({},e)],Object(F.a)(t.slice(a+1)))}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id";if(e.deleted)return t.filter((function(t){return t[n]!==e[n]}));var a=H(e[n],t,n);return-1===a&&(a=t.length),[].concat(Object(F.a)(t.slice(0,a)),[Object.assign({},e)],Object(F.a)(t.slice(a+1)))}function H(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=0;a<t.length;a++)if(e===t[a][n])return a;return-1}function $(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e>t?t:e<n?n:e}var W=function(e){return Object(C.a)({},{gold:0,experience:0,item:void 0},{},e)},q=function(e,t,n){var a=R()().day("Monday"),r=0;a.isSame(R()(),"day")||(console.log("Not same day start"),a.add(1,"week")),console.log(a),a.subtract(t,"week");for(var o=0;o<7;o++)Q(Z(a,o),e)>0&&r++;return r},Y=function(e,t){var n=R()().date(1);n.isSame(R()(),"day")||(console.log("Not same day start"),n.add(1,"month")),console.log(n);var a=0;n.subtract(t,"month");for(var r=R()(n);r.isSame(n,"month");)Q(r.format("YYYYMMDD"),e)>0&&a++,r.add(1,"day");return a},z=function(e,t){if(0===t)return!0;var n=R()().day("Monday");return n.isSame(R()(),"day")||(console.log("Not same day start"),n.add(1,"week")),n.subtract(t,"week"),!!n.isAfter(R()().subtract(e,"day"))},V=function(e,t){console.log("Calculate Current Streak By Month: ",e);for(var n=0,a=0,r=!0,o=0,s=0;r;)s=Y(e,o),console.log("Month Streak: ",s),console.log("--------------------Clamp:::: ",$(s,e.regularityValue)),(n+=$(s,e.regularityValue))>a&&(a=n),s<e.regularityValue&&!z(t,o)&&(r=!1),o++;var c=e.bestStreak;return e.bestStreak||(e.bestStreak=0),a>e.bestStreak&&(c=a),Object(C.a)({},e,{currentStreak:n,bestStreak:c})},K=function(e,t){console.log("Calculate Current Streak By Week: ",e);for(var n=0,a=0,r=!0,o=0,s=0;r;)s=q(e,o),console.log("Week Streak: ",s),console.log("--------------------Clamp:::: ",$(s,e.regularityValue)),(n+=$(s,e.regularityValue))>a&&(a=n),s>=e.regularityValue||(z(t,o)?console.log("We are within buffer, ",t,o):(console.log("We are past buffer, ",t,o),r=!1)),o++;var c=e.bestStreak;return e.bestStreak||(e.bestStreak=0),a>e.bestStreak&&(c=a),Object(C.a)({},e,{currentStreak:n,bestStreak:c})},J=function(e,t){console.log("Calculate Current Streak: ",e);for(var n=0,a=0,r=!0,o=0;r;)Q(X(o),e)>0?++n>a&&(a=n):r=!1,o++;var s=e.bestStreak;return e.bestStreak||(e.bestStreak=0),a>e.bestStreak&&(s=a),Object(C.a)({},e,{currentStreak:n,bestStreak:s})},Q=function(e,t){t.progress||(t.progress=[]);for(var n=0;n<t.progress.length;n++)if(t.progress[n].date===e)return t.progress[n].value;return 0},X=function(e){return R()().subtract(e,"day").format("YYYYMMDD")},Z=function(e,t){return R()(e).subtract(t,"d").format("YYYYMMDD")},ee=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(f.a)(this,t),(e=Object(w.a)(this,Object(x.a)(t).call(this))).name=void 0,e.note=void 0,e.type="todo",e.done=void 0,e.date=void 0,e.tags=void 0,e._new=void 0,e.parent=void 0,e.subTodos=void 0,e.showSubTodos=void 0,e.showDone=void 0,e.newRewards=void 0,e.doneRewards=void 0,e.done=!1,e.date=null,e.tags=[],e.parent=null,e.subTodos=[],e.showSubTodos=!1,e.showDone=!1,e.newRewards=W(),e.doneRewards=W(),Object.assign(Object(O.a)(e),n),e}return Object(S.a)(t,e),t}(_),te=n(18),ne=n(96),ae=n.n(ne);function re(e){var t="u"+N.APP_ID+e;return Object(te.a)({id:ie(t,""),name:"default",access:[],type:"set",updated:0},N.ACCESS_META_KEY,he(e))}function oe(){for(var e,t=!1;!t;)"_"!==(e=ae.a.generate()).substring(0,1)&&"-"!==e.substring(0,1)&&(t=!0);return e}function se(e){if(void 0===e)throw new Error("Id can not be undefined");var t="ch".length+".".length;return e.substring(0,e.length-t)}function ce(e){return se(e)}function ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N.APP_ID;return t+e+".ch"}function ue(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:oe();if(void 0===e)throw new Error("Project can't be underfined");var a="ch".length;return e.substring(0,e.length-a)+t+"."+n}var le=function(e){return new Promise((function(t){setTimeout(t,e)}))};function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=fe(e[n],t,n);return-1===a&&(a=t.length),[].concat(Object(F.a)(t.slice(0,a)),[Object.assign({},e)],Object(F.a)(t.slice(a+1)))}function he(e){return["u"+N.APP_ID+e]}function fe(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=0;a<t.length;a++)if(e===t[a][n])return a;return-1}var me,pe=function(e){var t=e.parentId,n=void 0===t?void 0:t,a=e.saveFunc,r=e.projectId,o=Object(s.useState)({title:""}),i=Object(h.a)(o,2),u=i[0],d=i[1],f=function(){var e=Object(k.a)(j.a.mark((function e(){var t,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ue(r,"todo"),o=new ee({id:t,name:u.title,parent:n,_new:!0}),console.log("NEW TODO::::::::::::::: ",o),e.next=5,a(o,n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(l.t,{className:"new-todo",placeholder:"What needs to be done?",onKeyPress:function(e){"Enter"===e.key&&(f(),d({title:""}))},onIonChange:function(e){d({title:e.detail.value})},value:u.title})},be=n(17),ge=n.n(be),ve=n(8),ye=(n(136),n(137),function(e){return{todo:e,showDeleteWarrning:!1,text:Ee(e.name,e.note)}}),Ee=function(e,t){return e||(e=""),e+(t=t?"\n"+t:"")},je=function(e){var t=e.todo,n=e.tags,a=e.dataFunctions;console.log("Edit Todo Render::: ",t);var r=Object(s.useState)(ye(t)),o=Object(h.a)(r,2),i=o[0],u=o[1];Object(s.useEffect)((function(){u(ye(t))}),[t]);var d=function(){u(Object(C.a)({},i,{},{showDeleteWarrning:!1}))},f=function(e){i.todo.tags||(i.todo.tags=[]);var t,n=ge.a.find(i.todo.tags,(function(t){return t===e}));t=ge.a.isUndefined(n)?ge.a.concat(i.todo.tags,e):ge.a.filter(i.todo.tags,(function(t){return t!==e})),a.save(Object.assign(i.todo,{tags:t}))};return c.a.createElement("div",{className:""},c.a.createElement("div",{className:"todoEditInlineIconScrollParent"},n.map((function(e){return function(e){var t=ge.a.includes(i.todo.tags,e)?"success":"light";return"today"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return f(e)}},c.a.createElement(l.s,{icon:ve.F})):"important"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return f(e)}},c.a.createElement(l.s,{icon:ve.E})):"tasks"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return f(e)}},c.a.createElement(l.s,{icon:ve.i})):"wish"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return f(e)}},c.a.createElement(l.s,{icon:ve.r})):"buy"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return f(e)}},c.a.createElement(l.s,{icon:ve.f})):"projects"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return f(e)}},c.a.createElement(l.s,{icon:ve.q})):void 0}(e)}))),c.a.createElement(l.L,{placeholder:"Enter todo title and note here",name:"note",class:"todoEditInlineTextArea",autoGrow:!0,onIonBlur:function(){console.log("Saving todo::: ",i),a.save(i.todo)},onIonChange:function(e){var t=e.detail.value;console.log(t);var n=/\r|\n/.exec(t);if(console.log("Title Chagne: ",t,n),n){var a=t.substring(0,n.index),r=t.substring(n.index+1),o=Object(C.a)({},i.todo,{},{name:a,note:r}),s=Object(C.a)({},i,{},{todo:o,text:t});u(s)}else{var c=Object(C.a)({},i.todo,{},{name:t,note:""}),l=Object(C.a)({},i,{},{todo:c,text:t});u(l)}},value:i.text}),c.a.createElement("div",null,c.a.createElement("div",{className:"todoButtonsLeftAlign"},c.a.createElement(l.f,{size:"small",fill:"clear",color:"secondary",onClick:function(){a.select(null)}},c.a.createElement(l.s,{icon:ve.m}),c.a.createElement(l.v,null,"Close"))),c.a.createElement("div",{className:"todoButtonsRightAlign"},c.a.createElement(l.f,{size:"small",fill:"clear",color:"danger",onClick:function(){u(Object(C.a)({},i,{},{showDeleteWarrning:!0}))}},c.a.createElement(l.s,{icon:ve.G}),c.a.createElement(l.v,null,"Delete")))),c.a.createElement("div",{className:"todoInlineEditPadding"}," "),c.a.createElement(l.b,{isOpen:i.showDeleteWarrning,onDidDismiss:function(){return d},header:"Warrning!!!",message:"Are you sure you want to <strong>delete</strong> this task and its sub-tasks?",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary"},{text:"Yes Im Sure",handler:function(){return d(),console.log("REMVE ACTION STATE::::::: ",i),void(i.todo.id&&a.remove(i.todo.id))}}]}))},ke=n(38),we=n(101),xe=n(316),Oe=n(313),Se=n(314),_e=n(315),Te=n(97),Ce=function(){function e(t){Object(f.a)(this,e),this.db=void 0,this._ready=!1,this.ready$=new p.a(this._ready),this._subscriptions=[],this.changes$=new we.a,this.db=new Te.a(N.APP_ID+t.name+"_dexie");var n={};t.tables.forEach((function(e){n[e.name]=e.columns})),console.log("Dexie scheme: ",t,n),this.db.version(t.version).stores(n),this._init()}return Object(m.a)(e,[{key:"_init",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Dexie init"),e.prev=1,e.next=4,this.db.open();case 4:this._ready=!0,this._subscribe(),this.ready$.next(!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._subscriptions.forEach((function(e){e&&e.unsubscribe()}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDoc",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Dexie getting doc::: ",t,n),e.next=3,this.db[n].get({id:t});case 3:if(a=e.sent,console.log("=========================",a),!a){e.next=7;break}return e.abrupt("return",a);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getBulk",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("BULK GET: ",t,n),e.next=3,this.db[n].bulkGet(t);case 3:return a=e.sent,console.log(a),e.abrupt("return",a.filter((function(e){return void 0!==e})));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"queryByProperty",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n,a,r){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("%%%%%%%%%%%%%%%%% Dexie Query By Property::: ",t,n,a,r),e.t0=n,e.next="equals"===e.t0?4:"startsWith"===e.t0?7:"notEqual"===e.t0?10:13;break;case 4:return e.next=6,this.db[r].where(t).equals(a).toArray();case 6:return e.abrupt("return",e.sent);case 7:return e.next=9,this.db[r].where(t).startsWith(a).toArray();case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,this.db[r].where(t).notEqual(a).toArray();case 12:return e.abrupt("return",e.sent);case 13:throw new Error("Missing proper operator, given: "+n);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"getProjectItems",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Get Project items: ",t,n),e.next=3,this.db[n].where("id").startsWith(t).toArray();case 3:return a=e.sent,console.log(a),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a,r,o=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(o.length>2&&void 0!==o[2])||o[2],console.log("---------------------------      Dexie Save: ",t,n),a&&(t.dirty=1),e.next=5,this.db[n].put(t);case 5:if(r=e.sent,console.log("SAVE RES: ",r),!r){e.next=10;break}return this.changes$.next({doc:t}),e.abrupt("return",!0);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveFromSync",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a,r=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&"),console.log("Save form Sync::: ",t,n),e.next=4,this.db[n].bulkPut(t);case 4:if(a=e.sent,console.log("SAVE RES: ",a),!a){e.next=9;break}return t.forEach((function(e){r.changes$.next({doc:e})})),e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),Ie=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(f.a)(this,t),(e=Object(w.a)(this,Object(x.a)(t).call(this))).type="party",e.creator="",e.dirty=0,e.members=[],Object.assign(Object(O.a)(e),n),e}return Object(S.a)(t,e),t}(T),De=n(98),Pe=n.n(De),Re=new(function(){function e(){Object(f.a)(this,e)}return Object(m.a)(e,[{key:"getItem",value:function(){var e=Object(k.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",localStorage.getItem(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getString",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem(t)||"",e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getObject",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem(t)){e.next=3;break}return e.abrupt("return",null);case 3:return e.abrupt("return",JSON.parse(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setObject",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=JSON.stringify(n),e.next=4,localStorage.setItem(t,a);case 4:return e.abrupt("return",!0);case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setString",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem(t,n);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()),Ae=n(99),Ne=n.n(Ae),Fe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return{success:e,data:t,status:n,errors:a}},Me=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{url:e,type:"post",form:t,options:n}},Le=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Server";return{msg:e,location:t}},Ge=function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a,r,o,s=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(s.length>1&&void 0!==s[1])||s[1],a=s.length>2&&void 0!==s[2]?s[2]:"Loading...",e.prev=2,n&&b.showLoading(a),console.log(t),e.next=7,Ne.a.post(t.url,t.form,t.options);case 7:return r=e.sent,b.hideLoading(),console.log(r),e.abrupt("return",Fe(!0,r.data,200));case 13:if(e.prev=13,e.t0=e.catch(2),b.hideLoading(),(o=L(e.t0,"response"))&&o.status){e.next=21;break}return e.abrupt("return",Fe(!1,null,503,[Le("Service is temporarly unavailable")]));case 21:if(422!==o.status){e.next=25;break}return e.abrupt("return",Fe(!1,null,o.data.status,o.data.errors));case 25:if(404!==o.status){e.next=29;break}return e.abrupt("return",Fe(!1,null,404,[Le("Could not connect to server")]));case 29:return e.abrupt("return",Fe(!1,null,o.status,[Le("Could not connect to server")]));case 30:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}();!function(e){e.default="default",e.info="info",e.success="success",e.warning="warning",e.error="error"}(me||(me={}));var Ue,Be=new(function(){function e(){Object(f.a)(this,e),this.messages$=new we.a}return Object(m.a)(e,[{key:"showMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:me.default,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;Object(ke.b)(e,{type:t,autoClose:n})}},{key:"printServerErrors",value:function(e){var t=this,n=e.errors||[];n.length>0&&n.forEach((function(e){return t.showMessage(e.msg,me.error)}))}}]),e}()),He=Pe()("auth: authService");!function(e){e[e.Loading=0]="Loading",e[e.Guest=1]="Guest",e[e.User=2]="User"}(Ue||(Ue={}));var $e=function(e){return null==e?{id:"guest",username:"Guest",email:null,token:null,token_expiery:null,channels:[]}:{id:e.id||"guest",username:e.username||"Guest",email:e.email||null,token:e.token||null,token_expiery:e.token_expiery||e.expires||null,channels:e.channels||[]}},We=function(e){return"Guest"===e.username};function qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Guest";return $e({username:e})}var Ye=new(function(){function e(){Object(f.a)(this,e),this._user=qe("null"),this._authStatus=Ue.Loading,this.authStatus$=new p.a(this._authStatus),this.username$=new we.a,this.loadAuth()}return Object(m.a)(e,[{key:"getIsAuthenticated",value:function(){return this._authStatus===Ue.User}},{key:"getUsername",value:function(){return this._user.username}},{key:"getEmail",value:function(){return this._user.email}},{key:"getUser",value:function(){return this._user}},{key:"updateUser",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],We(t)&&"null"!==this._user.username){e.next=13;break}if(this._authStatus!==Ue.User&&this.setAuthStatus(Ue.User),t.username===this._user.username){e.next=8;break}return this._user=t,e.next=7,Re.setObject("auth-user-key",t);case 7:this.username$.next(t.username);case 8:if(Object(be.isEqual)(this._user,t)){e.next=12;break}return this._user=t,e.next=12,Re.setObject("auth-user-key",t);case 12:return e.abrupt("return");case 13:if(this._authStatus===Ue.Guest){e.next=18;break}if(this.setAuthStatus(Ue.Guest),!n){e.next=18;break}return e.next=18,Re.setObject("auth-user-key",qe);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadAuth",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return He.info("----------------- Check login"),e.prev=1,e.t0=$e,e.next=5,Re.getObject("auth-user-key");case 5:if(e.t1=e.sent,t=(0,e.t0)(e.t1),He.info("LOADED USER",t),t.token&&t.token_expiery){e.next=10;break}return e.abrupt("return",this.updateUser(qe()));case 10:if(He.info("LOADED USER",t),!P.unix(t.token_expiery).isAfter(P.now())){e.next=17;break}return He.info("TOKEN VALID"),e.abrupt("return",this.updateUser(t));case 17:return He.warn("TOKEN is old"),e.abrupt("return",this.updateUser(qe()));case 19:e.next=25;break;case 21:return e.prev=21,e.t2=e.catch(1),He.error(e.t2),e.abrupt("return",this.updateUser(qe()));case 25:case"end":return e.stop()}}),e,this,[[1,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"loginAndRedirect",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n,a,r){var o,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("LoginWithRedirect:: "),e.next=3,Ge(Me(N.AUTH_API_URL+"/auth/login",{id:t,password:n,app:N.APP_ID}),!0,"Login in, please wait");case 3:o=e.sent,console.log("Login RES: ",o),o.success?(this.updateUser($e(o.data)),console.log("LOGIN LOCATION:::: ",r,a),r&&r.state&&r.state.prev&&(s=r.state.prev.startsWith("/auth/")?"/":r.state.prev),a.push(s||"/")):(console.log(o),Be.printServerErrors(o));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge(Me(N.AUTH_API_URL+"/auth/login",{username:t,password:n,app:N.APP_ID},{}),!0,"Login in, please wait");case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renewToken",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Renew Token"),e.next=3,Ge(Me(N.AUTH_API_URL+"/auth/renewToken",{token:this._user.token}),!1);case 3:if(t=e.sent,console.log(t),!t.success){e.next=12;break}return e.next=8,this.updateUser(Object(C.a)({},this._user,{},{token:t.data.token,channels:t.data.channels,token_expiery:t.data.expires}));case 8:return console.log("NEW USER:: ",this._user),e.abrupt("return",!0);case 12:if(console.log("Token updated error: ",t),!t.status||422!==t.status){e.next=17;break}return e.next=16,this.updateUser(qe());case 16:return e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n,a){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Register:: "),e.next=3,Ge(Me(N.AUTH_API_URL+"/auth/register",{username:t,password:a,email:n}),!0,"Registering, please wait");case 3:if(r=e.sent,console.log("Registering RES: ",r),!r.success){e.next=9;break}return e.abrupt("return",!0);case 9:return console.log(r),Be.printServerErrors(r),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"forgotPassword",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setAuthStatus",value:function(e){this._authStatus=e,this.authStatus$.next(e)}},{key:"getAuthStatus",value:function(){return this._authStatus}},{key:"getToken",value:function(){return this._user.token||""}},{key:"userid",get:function(){return this._user.id||""}}]),e}()),ze=function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},t.forEach((function(e){a=e.id.split(".")[0],console.log(e),n[a]||(n[a]=[]),n[a].push(Object(C.a)({},{},{},e))})),e.next=4,Re.getObject("channel_checkpoints");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:return r=e.t0,e.abrupt("return",{channels:n,checkpoints:r});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Starting to server sync: ",t),e.prev=1,e.next=4,ze(t.data);case 4:return n=e.sent,console.log("************************* ",n),e.next=8,Ge(Me(t.syncurl+"/sync/sync",{token:t.token,checkpoint:t.checkpoint,data:n}));case 8:if(!(a=e.sent)){e.next=20;break}return Object.keys(a.data.checkpoints),e.next=13,Re.getObject("channel_checkpoints");case 13:if(e.t0=e.sent,e.t0){e.next=16;break}e.t0={};case 16:return r=e.t0,e.next=19,Re.setObject("channel_checkpoints",Object(C.a)({},r,{},a.data.checkpoints));case 19:return e.abrupt("return",a.data.types);case 20:return e.abrupt("return",null);case 23:e.prev=23,e.t1=e.catch(1),console.log(e.t1);case 26:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(t){return e.apply(this,arguments)}}(),Ke={name:"guest_dx",version:4,tables:[{name:"set",columns:"id, dirty"},{name:"party",columns:"id, dirty, party, type"},{name:"todo",columns:"id, done, deleted, parent, *tags, dirty"},{name:"hab",columns:"id, dirty"},{name:"msg",columns:"id, messageType, parent, dirty"}]},Je=new(function(){function e(){var t=this;Object(f.a)(this,e),this.db=void 0,this.authId="",this._ready=!1,this._ready$=new p.a(this._ready),this.addSyncCall$=new we.a,this.addSyncCall$.pipe(Object(xe.a)(5e3)).subscribe((function(){t._syncRemote()}))}return Object(m.a)(e,[{key:"getDoc",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Get Doc: ",t,n),e.next=3,this.db.getDoc(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getBulk",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.getBulk(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"queryByProperty",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n,a,r){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.queryByProperty(t,n,a,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"getAllByProject",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.getProjectItems(se(t)+".",n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a,r,o,s=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=s.length>2&&void 0!==s[2]?s[2]:{})||(a={remoteSync:!0}),e.prev=2,r={},!t.id||null!=a.oldDoc){e.next=8;break}return e.next=7,this.getDoc(t.id,n);case 7:r=e.sent;case 8:if(console.log("Checking if no changes made: ",r),!ge.a.isEqual(r,t)){e.next=12;break}return console.log("No changes, skip saving"),e.abrupt("return",!1);case 12:if(t.id){e.next=17;break}if(a.project){e.next=15;break}throw new Error("Saving new doc requires valid props.project");case 15:t.id=ue(a.project.id,n),t.created=Date.now();case 17:return t.dirty=!0,e.next=20,this.db.save(t,n);case 20:if(o=e.sent,a.remoteSync&&this.addSyncCall$.next(),console.log("Saved doc: ",o),!o.ok){e.next=27;break}return e.abrupt("return",o);case 27:return e.abrupt("return",!1);case 28:e.next=34;break;case 30:return e.prev=30,e.t0=e.catch(2),console.log("Save Pouch Error: ",e.t0),e.abrupt("return",!1);case 34:case"end":return e.stop()}}),e,this,[[2,30]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveNewProject",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a,r,o,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge(Me(N.AUTH_API_URL+"/channels/addNewChannel",{token:Ye.getToken(),doc:t,name:t.name},{}),!1);case 2:if(a=e.sent,console.log(a),a.success){e.next=6;break}return e.abrupt("return",a);case 6:r=a.data.channel,o=!1;case 8:if(o){e.next=23;break}return e.next=11,Ye.renewToken();case 11:if(s=e.sent,console.log("Token Res::::::: ",s),console.log(Ye.getUser(),r),!Ye.getUser().channels[r]){e.next=19;break}o=!0,e.next=21;break;case 19:return e.next=21,le(2e3);case 21:e.next=8;break;case 23:return e.next=25,this.db.save(a.data.doc,n,!1);case 25:return e.abrupt("return",e.sent);case 26:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a,r,o,s=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(s.length>2&&void 0!==s[2])||s[2],e.prev=1,r=this.getDoc(t,n)){e.next=5;break}return e.abrupt("return",!1);case 5:return o=this.db.save(Object(C.a)({},r,{},{deleted:!0})),console.log(o),a&&this.addSyncCall$.next(),e.abrupt("return",o);case 11:return e.prev=11,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"removeProject",value:function(){var e=Object(k.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"subscribeChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.db.changes$.asObservable().pipe(Object(Oe.a)(e),Object(Se.a)((function(e){return e.doc})))}},{key:"subscribeDocChanges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.db.changes$.asObservable().pipe(Object(Oe.a)(t),Object(_e.a)((function(t){return t.doc.id===e})),Object(Se.a)((function(e){return e.doc})))}},{key:"subscribeProjectCollectionChanges",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(void 0===e)throw new Error("Project id, can not be undefined, can not subscribe to id");var a=se(e);return this.db.changes$.asObservable().pipe(Object(Oe.a)(n),Object(_e.a)((function(e){return console.log("%%%%%%%%%%%%%%%%%%%%%",e,a+"."+t+"."),e.doc.id.startsWith(a+"."+t+".")})),Object(Se.a)((function(e){return e.doc})))}},{key:"getReadySub",value:function(){return this._ready$}},{key:"init",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a,r,o=this,s=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!(s.length>1&&void 0!==s[1])||s[1],console.log("Init DB"),(a=Ke).name=t,this.db=new Ce(a),r=this.db.ready$.subscribe((function(e){console.log("Dexie Sub: ",e),e&&(o.ready=!0,n&&o.addSyncCall$.next(),r.unsubscribe())}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_syncRemote",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t,n,a,r,o,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("DATASERVICE:::&&&&&&&&&&&&&&&&&&&&&&&&&&&&::::::::::START"),e.t0=Number,e.next=4,Re.getItem("SYNC_CHECKPOINT");case 4:e.t1=e.sent,(0,e.t0)(e.t1)||0,t=[],n=0;case 9:if(!(n<Ke.tables.length)){e.next=19;break}return console.log("Loading changes from: ",Ke.tables[n].name),e.next=13,this.db.queryByProperty("dirty","equals",1,Ke.tables[n].name);case 13:a=e.sent,console.log(Ke.tables[n].name,a),t.push.apply(t,Object(F.a)(a));case 16:n++,e.next=9;break;case 19:return console.log("DOCS TO SYNC **********************",t),e.next=22,Ve({data:t,syncurl:N.SYNC_SERVER,token:Ye.getToken(),checkpoint:0,requestMaxSize:1e3});case 22:if(!(r=e.sent)){e.next=34;break}console.log("Sync finished::: ",r),o=Object.keys(r),console.log(o),s=0;case 28:if(!(s<o.length)){e.next=34;break}return e.next=31,this.db.saveFromSync(r[o[s]].map((function(e){return Object.assign(e,{dirty:0})})),o[s]);case 31:s++,e.next=28;break;case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ready",get:function(){return this._ready},set:function(e){this._ready=e,e&&this._ready$.next(e)}}]),e}()),Qe=function(e){for(var t=0,n=1;n<e;n++)t+=Math.floor((n+100)*Math.pow(2,n/7));return Math.floor(t/4)},Xe=function(e){var t=0;e.date&&(t=R()(e.date).diff(R()(),"hour")),console.log("Diff Days::: ",t);var n=et+.2*t;return Math.floor(n)},Ze=function(e){var t=0;e.date&&(t=R()(e.date).diff(R()(),"hour")),console.log("Diff Days::: ",t);var n=tt+.1*t;return Math.floor(n)},et=3,tt=5,nt=new(function(){function e(){var t=this;Object(f.a)(this,e),this._userId="",this._subscriptions=[],this._state={health:50,maxHealth:50,experience:0,maxExperience:20,level:1,gold:0,items:[]},this.state$=new p.a(this._state),this.calculateFinishedTodoRewards=function(e){return e.doneRewards&&e.doneRewards.gold||(e.newRewards=W({gold:Xe(e),experience:Ze(e),item:null})),e.done?(t.addGold(e.newRewards.gold),t.messageReceivedGold(e.newRewards.gold),t.addExperience(e.newRewards.experience),t.messageReceivedExperience(e.newRewards.experience)):(t.addGold(-1*e.newRewards.gold),t.messageLostGold(e.newRewards.gold),t.addExperience(-1*e.newRewards.experience),t.messageLostExperience(e.newRewards.experience)),Object(C.a)({},{},{},e)},this.calculateNewTodo=function(e){return e.newRewards=W({gold:1,experience:2,item:null}),t.addGold(e.newRewards.gold),t.messageReceivedGold(e.newRewards.gold),t.addExperience(e.newRewards.experience),t.messageReceivedExperience(e.newRewards.experience),Object(C.a)({},{},{},e)},this.calculateNewHabitRewards=function(e){return e.newRewards=W({gold:5,experience:5,item:null}),t.addGold(e.newRewards.gold),t.messageReceivedGold(e.newRewards.gold),t.addExperience(e.newRewards.experience),t.messageReceivedExperience(e.newRewards.experience),Object(C.a)({},{},{},e)}}return Object(m.a)(e,[{key:"init",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("-------------Gamify INIT",t),this.unsubscribe(),this._userId=t,n=Je.getReadySub().subscribe(function(){var e=Object(k.a)(j.a.mark((function e(r){var o,s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,a.loadInitDocs(t);case 4:o=e.sent,console.log("GAMIFY DOC:::: ",o),s=a.state$.pipe(Object(xe.a)(1e4)).subscribe((function(){a._save()})),c=Je.subscribeDocChanges(a.getGamifyDocId(),1e3).subscribe((function(e){console.log("DOC================================",e);var t=Object(be.isEqual)(a._state,e.state);console.log("Gamify State Equal: ",t),t||(a.state=e.state)})),a._subscriptions.push(s),a._subscriptions.push(c),o&&(a.state=o.state),n.unsubscribe();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unsubscribe",value:function(){this._subscriptions.forEach((function(e){e&&e.unsubscribe()}))}},{key:"addGold",value:function(e){this.state=Object(C.a)({},this._state,{},{gold:this._state.gold+e})}},{key:"addExperience",value:function(e){var t=this._state.experience+e;t>this._state.maxExperience&&(t=-1*(this._state.maxExperience-t),this._state=Object(C.a)({},this._state,{},{maxExperience:Qe(this._state.level+1),level:this._state.level+1})),this.state=Object(C.a)({},this._state,{},{experience:t})}},{key:"calculateHabitProgressRewards",value:function(e,t){e.regularityEachDayGoal||(e.regularityEachDayGoal=1);var n=Object.assign(t);if(!t.reward){n.reward=W();for(var a=5,r=3,o=0;o<e.currentStreak;o++)a+=.2*a,r+=.2*r;n.reward.gold=Math.round(a),n.reward.experience=Math.round(r),e.progress=U(n,e.progress,"date")}return n.value>=e.regularityEachDayGoal?(n.reward&&n.reward.gold&&(this.messageReceivedGold(n.reward.gold),this.addGold(n.reward.gold)),n.reward&&n.reward.experience&&(this.messageReceivedExperience(n.reward.experience),this.addExperience(n.reward.experience))):(n.reward&&n.reward.gold&&(this.messageLostGold(n.reward.gold),this.addGold(-1*n.reward.gold)),n.reward&&n.reward.experience&&(this.messageLostExperience(-1*n.reward.experience),this.addExperience(-1*n.reward.experience))),e}},{key:"messageReceivedGold",value:function(e,t,n){t||(t=""),n||(n=""),ke.b.success(t+" You have received "+e+" gold "+n,{autoClose:3e3})}},{key:"messageLostGold",value:function(e,t,n){t||(t=""),n||(n=""),ke.b.error(t+" You have lost "+e+" gold"+n,{autoClose:3e3})}},{key:"messageReceivedExperience",value:function(e,t,n){t||(t=""),n||(n=""),ke.b.success(t+" You have received "+e+" experience"+n,{autoClose:3e3})}},{key:"messageLostExperience",value:function(e,t,n){t||(t=""),n||(n=""),ke.b.error(t+" You have lost "+e+" experience"+n,{autoClose:3e3})}},{key:"_save",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t,n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Je.getDoc(this.getGamifyDocId(),"set");case 3:if(t=e.sent){e.next=7;break}return console.log("Couldn't load gamify doc: ",this.getGamifyDocId()),e.abrupt("return");case 7:console.log("========Gamify State Doc: ",this.getGamifyDocId(),t),n=Object(be.isEqual)(this._state,t.state),a=Object(be.isEqual)(this.state,{health:50,maxHealth:50,experience:0,maxExperience:20,level:1,gold:0,items:[]}),console.log("Saving gamify state::: ",n,a),n||a||t.userid!==this._userId||(console.log("Saving: ",Object(C.a)({},t,{},{state:this._state})),Je.save(Object(C.a)({},t,{},{state:this._state}),"set")),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"getGamifyDocId",value:function(){var e=ue(re(Ye.userid).id,"gamify","");return e.substring(0,e.length-1)}},{key:"loadInitDocs",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a,r,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Gamify ID: "+this.getGamifyDocId()),e.next=4,Je.getDoc(this.getGamifyDocId(),"set");case 4:if(n=e.sent,console.log("--- gamify doc loaded: ",t,n),!n){e.next=8;break}return e.abrupt("return",n);case 8:if(console.log("Saving gamify new doc"),a=Date.now(),t!==this._userId){e.next=15;break}return e.next=13,Je.save((r={id:this.getGamifyDocId(),state:{health:50,maxHealth:50,experience:0,maxExperience:20,level:1,gold:0,items:[]},type:"set"},Object(te.a)(r,N.ACCESS_META_KEY,he(t)),Object(te.a)(r,"userid",t),Object(te.a)(r,"created",a),Object(te.a)(r,"updated",a),r),"set");case 13:return o=e.sent,e.abrupt("return",o);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.log(e.t0.red,t);case 20:case"end":return e.stop()}}),e,this,[[0,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"state",get:function(){return this._state},set:function(e){this._state=e,this.state$.next(e)}}]),e}()),at=function(e,t){switch(t.type){case"fullupdate":return rt(t.data),e;case"updateTodo":return Object(C.a)({},e,{},{todo:t.data});case"subtodos":return console.log("Action DATA: ",t),Object(C.a)({},e,{},{todo:t.data.todo,subTodos:t.data.subTodos});default:return e}},rt=function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a,r,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.todo,a=t.dispatch,r=t.dataFunctions,console.log("Loading Sub Todos Function: ",n.subTodos,n.showSubTodos,n),!(n.subTodos&&n.showSubTodos&&n.subTodos.length>0)){e.next=8;break}return e.next=5,r.loadSubTodos(n.subTodos);case 5:o=e.sent,console.log("Loading subtodos ------------: ",o),a(G("subtodos",{todo:n,subTodos:o}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ot=function e(t){var n=t.todo,a=t.tags,r=t.projectId,o=t.selectedTodo,i=t.lastChild,u=t.dataFunctions,d=Object(s.useReducer)(at,{todo:n,subTodos:[],newSubTitle:"",subSelect:null}),f=Object(h.a)(d,2),m=f[0],p=f[1],b=Object(s.useState)(!1),g=Object(h.a)(b,2);g[0],g[1];console.log("STATE TODONAME: ",m.todo.name),console.log(m),Object(s.useEffect)((function(){console.log("UseEffect TODOS-------- "+n.name,n),p(G("fullupdate",{todo:n,dispatch:p,dataFunctions:u}))}),[n,u]);var v=function(){var e=nt.calculateFinishedTodoRewards(Object(C.a)({},m.todo,{},{done:!m.todo.done}));p(G("updateTodo",e)),u.save(e)},y=function(e){if(m.todo.showDone!==e){var t=Object(C.a)({},m.todo,{},{showDone:e});p(G("updateTodo",t)),u.save(t)}},E=function(){var e=Object(C.a)({},m.todo,{},{showSubTodos:!m.todo.showSubTodos});p(G("updateTodo",e)),u.save(e)},j=function(e){o&&e.id===o.id?u.select(null):u.select(e)};m.todo.subTodos&&m.todo.subTodos.length>0&&(console.log("*****************************************"),console.log(m.todo.name,m.todo.subTodos));var k=function(e){m.todo.tags||(m.todo.tags=[]);var t,n=ge.a.find(m.todo.tags,(function(t){return t===e}));t=ge.a.isUndefined(n)?ge.a.concat(m.todo.tags,e):ge.a.filter(m.todo.tags,(function(t){return t!==e})),u.save(Object.assign(m.todo,{tags:t}))},w=function(){if(console.log("Print subtodos:: ",m.todo.showSubTodos),!m.todo.showSubTodos)return c.a.createElement(c.a.Fragment,null);return c.a.createElement(c.a.Fragment,null,c.a.createElement(l.G,null,c.a.createElement(l.l,null,c.a.createElement("div",{className:"todoEditInlineIconScrollParent"},a.map((function(e){return function(e){var t=ge.a.includes(m.todo.tags,e)?"primary":"light";return"today"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return k(e)}},c.a.createElement(l.s,{icon:ve.F})):"important"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return k(e)}},c.a.createElement(l.s,{icon:ve.E})):"tasks"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return k(e)}},c.a.createElement(l.s,{icon:ve.i})):"wish"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return k(e)}},c.a.createElement(l.s,{icon:ve.r})):"buy"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return k(e)}},c.a.createElement(l.s,{icon:ve.f})):"projects"===e?c.a.createElement(l.f,{class:"todoEditInlineIconScrollChild",size:"small",key:e,fill:"clear",color:t,onClick:function(){return k(e)}},c.a.createElement(l.s,{icon:ve.q})):void 0}(e)}))))),c.a.createElement(l.G,{class:"todoRow"},c.a.createElement(l.l,{size:"auto"},c.a.createElement("div",{className:"bufferColumnParent"},c.a.createElement("div",{className:"bufferColumn"}))),c.a.createElement(l.l,null,c.a.createElement("div",null,m.todo.showDone?c.a.createElement(l.f,{color:"success",class:"todoHeaderButtons",onClick:function(){return y(!1)},fill:"clear"},"Switch to Active"):c.a.createElement(l.f,{color:"success",class:"todoHeaderButtons",onClick:function(){return y(!0)},fill:"clear"},"Switch to Done"),o&&o.id===m.todo.id?c.a.createElement(l.f,{color:"success",class:"todoHeaderButtons",onClick:function(){return j(m.todo)},fill:"clear"},"Hide Edit"):c.a.createElement(l.f,{color:"success",class:"todoHeaderButtons",onClick:function(){return j(m.todo)},fill:"clear"},"Edit")),m.subTodos.filter((function(e){return e.showDone||(e.showDone=!1),e.done===m.todo.showDone})).map((function(t){return c.a.createElement(e,{todo:t,tags:a,selectedTodo:o,projectId:r,dataFunctions:u,lastChild:(n=m.subTodos,s=t,console.log("amILast"),0===n.length||n[n.length-1].id===s.id),key:t.id+"sub"});var n,s})))),c.a.createElement(l.G,null,c.a.createElement(l.l,{size:"auto"},c.a.createElement("div",{className:"bufferColumnParent"},c.a.createElement("div",{className:"bufferAddTaskColumn"}))),c.a.createElement(l.l,null,c.a.createElement(pe,{parentId:m.todo.id,projectId:r,saveFunc:u.save}))))};return c.a.createElement(l.q,null,c.a.createElement(l.G,{class:m.todo.showSubTodos&&!i?"":"todoRowBorder"},c.a.createElement(l.l,{size:"auto"},m.todo.done?c.a.createElement(l.s,{color:"dark",style:{fontSize:"32px",verticalAlign:"text-top"},icon:ve.y,onClick:v}):c.a.createElement(l.s,{color:"dark",style:{fontSize:"32px",verticalAlign:"text-top"},icon:ve.x,onClick:v})),c.a.createElement(l.l,{class:"todoTitleColumn",onClick:function(){return E()}},c.a.createElement(l.v,{class:"todoTitle"},m.todo.name),m.todo.note?c.a.createElement("div",{className:"todoNote"},function(e){var t=e.replace(/(\r\n|\n|\r)/gm," ");return t.length>40?t.substring(0,37)+"...":t}(m.todo.note)):c.a.createElement(c.a.Fragment,null),m.todo.tags&&m.todo.tags.length>0?c.a.createElement("div",{className:"todoListItemIcons"},m.todo.tags.map((function(e){return function(e){return"today"===e?c.a.createElement(l.s,{icon:ve.F,key:e,color:"sunny"}):"important"===e?c.a.createElement(l.s,{icon:ve.E,key:e,color:"warning"}):"wish"===e?c.a.createElement(l.s,{icon:ve.r,key:e,color:"danger"}):"buy"===e?c.a.createElement(l.s,{icon:ve.f,key:e,color:"tertiary"}):"projects"===e?c.a.createElement(l.s,{icon:ve.q,key:e,color:"medium"}):"tasks"===e?c.a.createElement(l.s,{icon:ve.i,key:e,color:"medium"}):void 0}(e)}))):c.a.createElement(c.a.Fragment,null)),c.a.createElement(l.l,{size:"auto"},m.todo.showSubTodos?c.a.createElement(l.s,{color:"primary",style:{fontSize:"32px",paddingRight:"10px"},onClick:function(){return E()},icon:ve.d}):c.a.createElement(l.s,{color:"primary",style:{fontSize:"32px",paddingRight:"10px"},onClick:function(){return E()},icon:ve.e}))),o&&o.id===m.todo.id?c.a.createElement(l.G,null,c.a.createElement(l.l,null,c.a.createElement(je,{todo:m.todo,tags:a,dataFunctions:u}))):c.a.createElement(c.a.Fragment,null),w())},st=function(){function e(){Object(f.a)(this,e),this._project=void 0,this._state={selectedTodo:null,selectedTag:"all",docs:[],tags:["today","tasks","important","wish","buy","projects","all"],doneTodos:!1,showSubTodos:!1},this.state$=new p.a(this._state),this._subscription=[]}return Object(m.a)(e,[{key:"init",value:function(e,t){var n=this;this.unsubscribe();var a=Je.getReadySub().subscribe(function(){var r=Object(k.a)(j.a.mark((function r(o){return j.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o){r.next=2;break}return r.abrupt("return");case 2:return n._init(e,t),r.next=5,le(1e3);case 5:a.unsubscribe();case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}},{key:"_init",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a,r,o=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("-------------------------------------------"),console.log("Init: ",t,"todo"),!this._project||this._project.id!==t.id||this._state.selectedTag!==n){e.next=4;break}return e.abrupt("return");case 4:return a="today"===n||"important"===n,this._state=Object(C.a)({},this.state,{},{selectedTag:n,showSubTodos:a}),e.next=8,le(500);case 8:console.log("Loadng new project::: "),this._project=t,this.reloadTodos(),r=Je.subscribeProjectCollectionChanges(t.id,"todo").subscribe((function(e){console.log("TodoService subscription: ",e),o.reloadTodos()})),this._subscription.push(r);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"reloadBaseParent",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading base parent"),e.next=3,this.getBaseParent(t);case 3:if(n=e.sent,console.log("Base Parent::: ",n),n){e.next=7;break}return e.abrupt("return",this.reloadTodos());case 7:n.deleted?this.filterAndSaveTodos(this.state.docs.filter((function(e){return e.id!==t.id}))):this.filterAndSaveTodos(de(n,this.state.docs));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBaseParent",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.parent){e.next=13;break}return e.next=3,Je.getDoc(t.parent,"todo");case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:if(!n.parent){e.next=10;break}return e.abrupt("return",this.getBaseParent(n));case 10:return e.abrupt("return",n);case 11:e.next=14;break;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadTodos",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("State: ",this.state),e.next=3,Je.queryByProperty("tags","equals",this.state.selectedTag,"todo");case 3:t=e.sent,console.log("DOCS::: ",t),this.filterAndSaveTodos(t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"filterAndSaveTodos",value:function(e){var t=this,n=e.filter((function(e){return t.filterDoneParentFunction(e)}));return this.state=Object(C.a)({},this.state,{},{docs:n}),n}},{key:"filterDoneParentFunction",value:function(e){return console.log("Filter1: ",e.done!==this._state.doneTodos),e.done===this._state.doneTodos&&!(e.parent&&!this.state.showSubTodos)}},{key:"addSubTodoToParent",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Je.getDoc(n,"todo");case 3:(a=e.sent)&&(a.subTodos||(a.subTodos=[]),a.subTodos=ge.a.concat(a.subTodos,t),this.save(a)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"removeSubTodoFromParent",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Je.getDoc(n,"todo");case 3:(a=e.sent)&&(a.subTodos||(a.subTodos=[]),a.subTodos=ge.a.filter(a.subTodos,(function(e){return e!==t})),this.save(a)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a,r=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:null,console.log("------- Save: ",t,this._project,"todo"),t._new&&(delete t._new,t.tags=[],"all"!==this.state.selectedTag?t.tags.push(this.state.selectedTag):t.tags.push("tasks"),t=nt.calculateNewTodo(t)),e.next=5,Je.save(Object(C.a)({},{done:!1},{},t),"todo",{project:this._project});case 5:return a=e.sent,n&&t.id&&this.addSubTodoToParent(t.id,n),console.log(a),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Je.getDoc(t,"todo");case 3:(n=e.sent)&&n.parent&&this.removeSubTodoFromParent(t,n.parent),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:Je.remove(t,"todo");case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"select",value:function(e){this.state=Object(C.a)({},this._state,{},{selectedTodo:e})}},{key:"changeDoneFilter",value:function(e){e!==this._state.doneTodos&&(this._state=Object(C.a)({},this._state,{},{doneTodos:e}),this.reloadTodos())}},{key:"changeShowSubtodosFilter",value:function(e){e!==this._state.showSubTodos&&(this._state=Object(C.a)({},this._state,{},{showSubTodos:e}),this.reloadTodos())}},{key:"selectTag",value:function(e){e!==this._state.selectedTag&&(this._state=Object(C.a)({},this._state,{},{selectedTag:e}),this.reloadTodos())}},{key:"loadTodoList",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.getBulk(t,"todo");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"unsubscribe",value:function(){this&&this._subscription.forEach((function(e){e&&e.unsubscribe()}))}},{key:"state",get:function(){return this._state},set:function(e){console.log("State: ",e),this._state=e,this.state$.next(this._state)}}]),e}();new st;n(154);var ct,it=n(64),ut=(n(155),n(156),function(e){var t=e.title,n=Object(s.useState)({health:50,maxHealth:50,experience:0,maxExperience:20,level:1,gold:0,items:[]}),a=Object(h.a)(n,2),r=a[0],o=a[1],i=r.health,u=r.maxHealth,d=r.experience,f=r.maxExperience,m=r.level,p=r.gold;return Object(s.useEffect)((function(){var e=nt.state$.subscribe((function(e){o(Object(C.a)({},r,{},e))}));return function(){e.unsubscribe()}}),[]),c.a.createElement(l.r,{className:"headerWithAvatar"},c.a.createElement("div",{className:"cityParent"},c.a.createElement("img",{src:"/assets/pics/hills.svg",style:{right:"25px"},className:"headerHills",alt:"Hills"}),c.a.createElement("img",{src:"/assets/pics/hills.svg",style:{right:"200px"},className:"headerHills",alt:"Hills"}),c.a.createElement("img",{src:"/assets/pics/ground.svg",className:"headerGround",alt:"Ground"}),c.a.createElement("img",{src:"/assets/pics/sun.svg",style:{right:"130px",top:"10px",width:"5%"},className:"headerSkyDetail",alt:"Hills"}),c.a.createElement("img",{src:"/assets/pics/cloud2.svg",style:{right:"240px",top:"40px"},className:"headerSkyDetail",alt:"Hills"}),c.a.createElement("img",{src:"/assets/pics/cloud1.svg",style:{right:"60px",top:"40px"},className:"headerSkyDetail",alt:"Hills"}),c.a.createElement("img",{src:"/assets/pics/cloud2.svg",style:{right:"140px",top:"15px"},className:"headerSkyDetail",alt:"Hills"})),c.a.createElement("div",{className:"statsParent"},c.a.createElement("div",{className:"statsBarParent"},c.a.createElement(l.s,{class:"statsBarIcon",icon:ve.r,style:{color:"#C20114"}}),c.a.createElement(it.a,{trailWidth:0,percent:i/u*100,className:"statsBarLine",strokeWidth:4,strokeColor:"#C20114"}),c.a.createElement(l.e,{class:"statsBarBadge",color:"danger"},i,"/",u)),c.a.createElement("div",{className:"statsBarParent"},c.a.createElement(l.s,{class:"statsBarIcon",icon:ve.t,style:{color:"#157F1F"}}),c.a.createElement(it.a,{trailWidth:0,percent:d/f*100,className:"statsBarLine",strokeWidth:4,strokeColor:"#157F1F"}),c.a.createElement(l.e,{class:"statsBarBadge",color:"success"},d,"/",f)),c.a.createElement("div",{className:"statsBarMoneyParent"},c.a.createElement(l.e,{class:"statsBarMoneyBadge",color:"warning"},"Gold: ",p),c.a.createElement(l.e,{class:"statsBarMoneyBadge",color:"success"},"Level: ",m))),c.a.createElement("h1",null,t))}),lt=function(){var e=re(Ye.userid),t=Object(v.i)().tag,n=t||"tasks";console.log("TAG::: ",n);var a=function(e,t){var n=Object(s.useState)({selectedTodo:null,selectedTag:"all",docs:[],tags:["today","tasks","important","wish","buy","projects","all"],doneTodos:!1,showSubTodos:!1}),a=Object(h.a)(n,2),r=a[0],o=a[1],c=Object(s.useRef)(new st);c.current.selectTag(t);var i={save:function(e,t){return c.current.save(e,t)},remove:function(e){return c.current.remove(e)},select:function(e){return c.current.select(e)},selectTag:function(e){return c.current.selectTag(e)},loadSubTodos:function(e){return c.current.loadTodoList(e)},changeDoneFilter:function(e){return c.current.changeDoneFilter(e)},changeShowSubTodosFilter:function(e){return c.current.changeShowSubtodosFilter(e)}};return Object(s.useEffect)((function(){return console.log("TODOS HOOK - UseEffect NEW SERVICE------------------------------"),c.current.init(e,t),c.current.unsubscribe}),[e.id]),Object(s.useEffect)((function(){var e=[c.current.state$.subscribe((function(e){console.log("TODO Hook Sub: ",e),o(e)}))];return function(){e.map((function(e){return e.unsubscribe()}))}}),[e.id]),[r,i]}(e,n),r=Object(h.a)(a,2),o=r[0],i=r[1],u=o.docs,d=o.selectedTodo,f=o.tags;console.log(u);return c.a.createElement(l.D,null,c.a.createElement(ut,{title:t?"Todos: "+M(t):"Todos"}),c.a.createElement(l.m,{id:"todoContent"},c.a.createElement(l.u,null,c.a.createElement(pe,{parentId:void 0,projectId:e.id||"",saveFunc:i.save})),c.a.createElement("div",null,c.a.createElement(l.f,{color:o.doneTodos?"light":"success",class:"todoHeaderButtons",onClick:function(){i.changeDoneFilter(!1)},fill:"clear"},"Active"),c.a.createElement(l.f,{color:o.doneTodos?"success":"light",class:"todoHeaderButtons",onClick:function(){i.changeDoneFilter(!0)},fill:"clear"},"Finished"),c.a.createElement(l.f,{color:o.showSubTodos?"tertiary":"light",class:"todoHeaderButtons",onClick:function(){i.changeShowSubTodosFilter(!0)},fill:"clear"},"Show Children"),c.a.createElement(l.f,{color:o.showSubTodos?"light":"tertiary",class:"todoHeaderButtons",onClick:function(){i.changeShowSubTodosFilter(!1)},fill:"clear"},"Only Parents")),c.a.createElement(l.x,null,u.map((function(t){return c.a.createElement(ot,{todo:t,tags:f,lastChild:!1,selectedTodo:d,projectId:e.id,dataFunctions:i,key:t.id})})))))},dt=function(){return c.a.createElement(l.D,null,c.a.createElement(l.r,null,c.a.createElement(l.N,null,c.a.createElement(l.M,null,"Loading"))),c.a.createElement(l.m,null,c.a.createElement(l.v,null,"Loading.....")))},ht={docs:[]},ft=new(function(){function e(){Object(f.a)(this,e),this._subscription=[],this._state=ht,this.state$=new p.a(this._state)}return Object(m.a)(e,[{key:"init",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t,n=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.unsubscribe(),Je.subscribeChanges().subscribe((function(e){if(console.log(e),"party"===e.type){var t=B(e,n._state.docs);n.state=Object(C.a)({},n._state,{},{docs:t})}})),e.next=4,Je.queryByProperty("type","equals","party","party");case 4:t=e.sent,this.state=Object(C.a)({},this._state,{},{docs:t});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addUser",value:function(){var e=Object(k.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("PARTY:::: ",n),e.next=4,Ge(Me(N.AUTH_API_URL+"/channels/sendAddMemberRequest",{token:Ye.getToken(),channelid:ce(n.id),id:t,rights:"0121"}),!0,"Adding member, please wait");case 4:if(a=e.sent,console.log(a),a.success){e.next=8;break}return e.abrupt("return",Be.printServerErrors(a));case 8:Be.showMessage("Member invitation sent",me.success),le(3e3),Je.addSyncCall$.next(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"save",value:function(e){e.id||this._createParty(e)}},{key:"_createParty",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Saving party Project::: ",t),b.showLoading("Creating party, please wait, internet connection required"),e.next=4,Je.saveNewProject(t,"party");case 4:if((n=e.sent).success){e.next=7;break}return e.abrupt("return",Be.printServerErrors(n));case 7:b.hideLoading();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"acceptPartyInvitation",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ge(Me(N.AUTH_API_URL+"/channels/acceptChannelInvitation",{token:Ye.getToken(),msgId:t.id},{}),!0,"Accept Request sent, waiting for reply.");case 3:if(n=e.sent,console.log(n),n.success){e.next=7;break}return e.abrupt("return",Be.printServerErrors(n));case 7:return Be.showMessage("Pary Membership request sent. Please wait for app update.",me.success),e.next=10,le(2e3);case 10:Je.addSyncCall$.next(),t.replied={accepted:!0,date:Date.now()},Je.save(t,"msg"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"rejectPartyInviation",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(C.a)({},t,{},{replied:{accepted:!1,date:Date.now()}}),Je.save(n,"msg");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"unsubscribe",value:function(){this&&this._subscription.forEach((function(e){e&&e.unsubscribe()}))}},{key:"state",get:function(){return this._state},set:function(e){console.log("State: ",e),this._state=e,this.state$.next(this._state)}}]),e}());!function(e){e[e.loading=0]="loading",e[e.auth=1]="auth",e[e.guest=2]="guest"}(ct||(ct={}));n(157);var mt=function(){return c.a.createElement(l.D,null,c.a.createElement(ut,{title:"HabitVille"}),c.a.createElement(l.m,null,"Future home of HabitVille"))},pt=function(){return c.a.createElement(l.D,null,c.a.createElement(l.r,null,c.a.createElement(l.N,null,c.a.createElement(l.M,null,"habits"))),c.a.createElement(l.m,null,c.a.createElement("div",{style:{padding:"20px"}},"This page does not exist")))},bt=function(e){var t=e.data,n=e.updateFunction;return c.a.createElement(l.u,null,c.a.createElement(l.v,{position:"stacked"},t.displayName,t.hasValidation?c.a.createElement(l.K,{color:"danger"},"*"):null),c.a.createElement(l.t,{name:t.id,value:t.value,type:t.type,onIonBlur:function(e){!0!==t.dirty&&n(Object(C.a)({},t,{},{value:e.target.value,dirty:!0}))},onIonChange:function(e){n(Object(C.a)({},t,{},{value:e.target.value,dirty:!0}))}}),t.messages.map((function(e){return c.a.createElement(l.C,{key:e},e)})),function(){if(t.dirty)return t.errors.map((function(e){return c.a.createElement(l.C,{key:e,color:"danger"},e)}))}())},gt=n(55),vt=n.n(gt),yt={submitButtonText:"Submit"},Et=function(e){return Object(C.a)({},yt,{},e)};function jt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:e,options:t,message:n}}var kt=function(e){var t=e.submitFunction,n=e.options||yt,a=Object(s.useState)({items:[],valid:!1}),r=Object(h.a)(a,2),o=r[0],i=r[1];Object(s.useEffect)((function(){u(e.items)}),[e.items]);var u=function(e){var t=[];e&&(e.forEach((function(e){var n=e.messages;console.log(typeof n),"string"===typeof n?console.log("Messages is string"):Array.isArray(n)?console.log("messages array"):n=[],t.push(f({id:e.id,displayName:e.displayName||e.id,type:e.type,value:e.default||"",messages:n,errors:[],dirty:!1,hasValidation:Array.isArray(e.validators)&&e.validators.length>0}))})),i({items:t,valid:p(t)}))},d=function(e){var t=U(f(e),o.items,"id");i({items:t,valid:p(t)})},f=function(e){var t=m(e.id,e.value);return Object(C.a)({},e,{},{errors:t})},m=function(t,n){if("string"!==typeof n)return[];var a=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=0;a<t.length;a++)if(e===t[a][n])return t[a];return null}(t,e.items,"id");a.validators||(a.validators=[]);var r=[];return a.validators.forEach((function(e){"isEmpty"===e.type&&vt.a.isEmpty(n)&&r.push(e.message||"Value cannot be empty"),"isLength"===e.type&&(vt.a.isLength(n,e.options)||r.push(e.message||"Value length is not valid")),"isEmail"===e.type&&(vt.a.isEmail(n,e.options)||r.push(e.message||"Valid Email required"))})),r},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.items,t=0;return e.forEach((function(e){t+=e.errors.length})),0===t};return c.a.createElement("div",null,Object.values(o.items).map((function(e){return c.a.createElement(bt,{key:e.id,data:e,updateFunction:d})})),c.a.createElement(l.f,{key:"submitButton",onClick:function(){var e={};o.items.forEach((function(t){e[t.id]={value:t.value}})),t(e),console.log(o)},disabled:!o.valid,color:"primary"},n.submitButtonText))},wt=(n(61),function(e){var t=e.page,n=Object(v.h)(),a=Object(v.g)(),r=function(e){console.log(n.pathname),n.pathname&&e!==n.pathname&&a.push(e)};return c.a.createElement("div",{className:"authMenuParent"},c.a.createElement(l.f,{onClick:function(){return r("/auth/login")},size:"small",color:"login"===t?"success":"light",fill:"clear"},"Login"),c.a.createElement(l.f,{onClick:function(){return r("/auth/register")},size:"small",color:"register"===t?"success":"light",fill:"clear"},"Register"))}),xt=function(){console.log("LOGIN PAGE");var e=Object(v.h)(),t=Object(v.g)();console.log("LOCATION++++++++++++:::: ",e);var n=Et({submitButtongText:"Login"}),a=[{id:"id",displayName:"ID (Username or Email): ",type:"string",validators:[jt("isLength",{min:3,max:50},"ID needs to be between 3 to 50 characters")]},{id:"password",displayName:"Password: ",type:"password",validators:[jt("isLength",{min:3,max:50},"ID needs to be between 3 to 50 characters")]}],r=function(){var n=Object(k.a)(j.a.mark((function n(a){return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log(a),Ye.loginAndRedirect(a.id.value,a.password.value,t,e);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return c.a.createElement(l.D,null,c.a.createElement(l.r,null,c.a.createElement(l.N,{color:"primary"},c.a.createElement(l.M,null,"Login"))),c.a.createElement(l.m,null,c.a.createElement("div",{style:{paddingTop:"50px"},className:"ion-text-center"},c.a.createElement(l.s,{icon:ve.u,color:"primary",className:"iconFormCenter"})),c.a.createElement(wt,{page:"login"}),c.a.createElement("div",{style:{padding:"20px"}},c.a.createElement(kt,{items:a,options:n,submitFunction:r}))))},Ot=function(){console.log("REGISTER PAGE");var e=Object(v.h)(),t=Object(v.g)();console.log("LOCATION++++++++++++:::: ",e);var n=Et({submitButtongText:"Login"}),a=[{id:"username",displayName:"Username: ",type:"string",validators:[jt("isLength",{min:3,max:20},"Username needs to be between 3 to 20 characters")]},{id:"email",displayName:"Email: ",type:"string",validators:[jt("isEmail",{},"Email is not valid")]},{id:"password",displayName:"Password: ",type:"password",validators:[jt("isLength",{min:3,max:50},"Password needs to be between 3 to 50 characters")]}],r=function(){var n=Object(k.a)(j.a.mark((function n(a){return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(a),n.next=3,Ye.register(a.username.value,a.email.value,a.password.value);case 3:n.sent&&Ye.loginAndRedirect(a.username.value,a.password.value,t,e);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return c.a.createElement(l.D,null,c.a.createElement(l.r,null,c.a.createElement(l.N,{color:"primary"},c.a.createElement(l.M,null,"Register"))),c.a.createElement(l.m,null,c.a.createElement("div",{style:{paddingTop:"50px"},className:"ion-text-center"},c.a.createElement(l.s,{color:"primary",icon:ve.u,className:"iconFormCenter"})),c.a.createElement(wt,{page:"register"}),c.a.createElement("div",{style:{padding:"20px"}},c.a.createElement(kt,{items:a,options:n,submitFunction:r}))))},St=function(e){var t=e.exact,n=e.path,a=Object(v.h)();return"/auth/register"===a.pathname?c.a.createElement(v.c,{path:n,component:Ot,exact:t}):"/auth/login"===a.pathname?c.a.createElement(v.c,{path:"/auth/login",render:function(){return c.a.createElement(xt,null)}}):c.a.createElement(v.b,{to:{pathname:"/auth/login",state:{prev:a.pathname}}})},_t=function(){return{selected:null,habits:[],stageFilter:a.current}},Tt=function(){function e(){Object(f.a)(this,e),this._project=void 0,this._state=_t(),this.state$=new p.a(this._state),this._docs=[],this.docs$=new p.a(this._docs),this._subscription=[]}return Object(m.a)(e,[{key:"getProject",value:function(){return this._project}},{key:"init",value:function(e){var t=this,n=Je.getReadySub().subscribe(function(){var a=Object(k.a)(j.a.mark((function a(r){return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r){a.next=2;break}return a.abrupt("return");case 2:if(!ge.a.isEqual(e,t._project)){a.next=5;break}return a.abrupt("return");case 5:return a.next=7,t._init(e);case 7:n.unsubscribe();case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}},{key:"_init",value:function(){var e=Object(k.a)(j.a.mark((function e(t){var n,a=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("################################# Init: ",t,"hab"),!this._project||this._project.id!==t.id){e.next=3;break}return e.abrupt("return");case 3:return console.log("Saving....",this._project,t),this._project=t,e.next=7,Je.getAllByProject(t.id,"hab");case 7:this._docs=e.sent,console.log("Init Docs: ",this._docs),this.filterhabits(),n=Je.subscribeProjectCollectionChanges(t.id,"hab").subscribe((function(e){console.log("habit Service Subscription: ",e),e.deleted?a._docs=a._docs.filter((function(t){return t.id!==e.id})):(console.log("Updating doc: ",e),a._docs=de(e,a._docs)),a.filterhabits()})),this._subscription.push(n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"filterhabits",value:function(){var e=this;console.log("Filterhabits",this._docs);var t=this._docs.filter((function(t){return e.filterFunction(t)}));this.state=Object(C.a)({},this._state,{},{habits:t}),console.log("Filtered State: ",this._state)}},{key:"filterFunction",value:function(e){return e.stage===this._state.stageFilter}},{key:"save",value:function(e){console.log("Save: ",e,this._project,"hab"),e.id||(e=Object.assign(nt.calculateNewHabitRewards(e))),Je.save(Object(C.a)({},{done:!1},{},e),"hab",{project:this._project})}},{key:"remove",value:function(e){Je.remove(e,"hab")}},{key:"select",value:function(e){this.state=Object(C.a)({},this._state,{},{selected:e})}},{key:"changeStageFilter",value:function(e){e!==this._state.stageFilter&&(this._state=Object(C.a)({},this._state,{},{stageFilter:e}),this.filterhabits())}},{key:"unsubscribe",value:function(){this&&this._subscription.forEach((function(e){e&&e.unsubscribe()}))}},{key:"state",get:function(){return this._state},set:function(e){this._state=e,this.state$.next(this._state)}},{key:"docs",get:function(){return this._docs},set:function(e){this._docs=e,this.docs$.next(this._docs)}}]),e}();function Ct(e){var t=Object(s.useState)(_t()),n=Object(h.a)(t,2),a=n[0],r=n[1],o=Object(s.useRef)(new Tt),c={save:function(e){console.log("@@@@@@@@@@@@@@@@@@@@@ Habit Hook Save: ",o.current,e),o.current.save(e)},remove:function(e){return o.current.remove(e)},select:function(e){return o.current.select(e)},changeStageFilter:function(e){return o.current.changeStageFilter(e)}};return Object(s.useEffect)((function(){if(console.log("habitS HOOK - UseEffect NEW SERVICE------------------------------"),!ge.a.isEqual(o.current.getProject(),e))return o.current.init(e),o.current.unsubscribe}),[e]),Object(s.useEffect)((function(){var e=[o.current.state$.subscribe((function(e){console.log("habits Hook Sub: ",e),r(e)}))];return function(){e.map((function(e){return e.unsubscribe()}))}}),[e]),[a,c]}n(221);var It=function(e){var t=e.habit,n=e.dataFunctions,a=e.showEditModalFunction,o=Object(s.useState)(t),i=Object(h.a)(o,2),u=i[0],d=i[1];Object(s.useEffect)((function(){d(t)}),[t]);var f=function(e){var t=R()().subtract(e,"day");return c.a.createElement(c.a.Fragment,null,t.format("DD")," ",c.a.createElement("br",null)," ",t.format("dd"))},m=function(e){var t=R()().subtract(e,"day"),n=u.progress.find((function(e){return t.format("YYYYMMDD")===e.date}));return n||(n={date:t.format("YYYYMMDD"),value:0}),c.a.createElement(l.s,{onClick:function(){return p(e,n)},size:"large",key:e,color:n.value>0?"success":"dark",icon:n.value>0?ve.j:ve.x})},p=function(e,t){console.log(" %%%%%%%%%%%%%%%%%%%%%%%%%%  Update Progress::: ",e,t);var a={date:t.date,value:0===t.value?1:0},o=fe(a.date,u.progress,"date");-1!==o&&(a=Object(C.a)({},u.progress[o],{},a));var s=de(a,u.progress,"date"),c=nt.calculateHabitProgressRewards(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(console.log("calculateCurrentStreak:::: ",e,t),e.regularityInterval===r.day){var n=J(e,t);return n}return e.regularityInterval===r.week?K(e,t):e.regularityInterval===r.month?V(e,t):e}(Object(C.a)({},u,{},{progress:s})),a);console.log("NEW PROGRESSSSSSS:::::::::::::::::::::::;",c),n.save(c)};return c.a.createElement(l.g,null,c.a.createElement(l.i,null,c.a.createElement(l.k,null,u.name),c.a.createElement(l.e,{class:"habitBadge",color:"success"},u.currentStreak),c.a.createElement(l.e,{class:"habitBadge",color:"tertiary"},u.bestStreak)),c.a.createElement(l.u,null,c.a.createElement(l.q,null,c.a.createElement(l.G,{class:"datecell"},c.a.createElement(l.l,null,f(6)),c.a.createElement(l.l,null,f(5)),c.a.createElement(l.l,null,f(4)),c.a.createElement(l.l,null,f(3)),c.a.createElement(l.l,null,f(2)),c.a.createElement(l.l,null,f(1)),c.a.createElement(l.l,null,f(0))),c.a.createElement(l.G,{class:"datecell"},c.a.createElement(l.l,null,m(6)),c.a.createElement(l.l,null,m(5)),c.a.createElement(l.l,null,m(4)),c.a.createElement(l.l,null,m(3)),c.a.createElement(l.l,null,m(2)),c.a.createElement(l.l,null,m(1)),c.a.createElement(l.l,null,m(0))))),c.a.createElement(l.h,null,"day"===u.regularityInterval?c.a.createElement(l.u,null,c.a.createElement(l.C,null,"Remember, you promised that you will repeat this habit ",c.a.createElement("strong",null,"every day"),".")):c.a.createElement(l.u,null,c.a.createElement(l.C,null,"Remember you promised that you will repeat this habit",c.a.createElement("strong",null," ",u.regularityValue," times ",u.regularityInterval)))),c.a.createElement(l.n,{horizontal:"end",vertical:"bottom",edge:!0},c.a.createElement(l.o,{size:"small",color:"light",onClick:function(){return a(u)}},c.a.createElement(l.s,{size:"large",icon:ve.p}))))},Dt=function(e){switch(e){case r.day:return{interval:e,min:1,max:1};case r.week:return{interval:e,min:1,max:6};case r.month:return{interval:e,min:1,max:25}}},Pt=function(e){var t=e.habit,n=e.dismissFunc;console.log("Add habits Form:::::: ",t);var a={regularity:Dt(t.regularityInterval),doc:new D,showDeleteWarrning:!1},r=Object(s.useState)(Object(C.a)({},a,{},{doc:t})),i=Object(h.a)(r,2),u=i[0],d=i[1];console.log(u);var f=function(e){var t=Object(C.a)({},u.doc,{},Object(te.a)({},e.target.name,e.detail.value)),n=Object(C.a)({},u,{},{doc:t});d(n)},m=function(e){console.log(e);var t=Object(C.a)({},u.doc,{},{regularityValue:e.detail.value});d(Object(C.a)({},u,{},{doc:t}))},p=function(e){var t=Object(C.a)({},u.doc,{},{difficulty:e.detail.value});d(Object(C.a)({},u,{},{doc:t}))},b=function(){d(Object(C.a)({},u,{},{showDeleteWarrning:!1}))};return console.log("Ready to return form"),c.a.createElement(c.a.Fragment,null,c.a.createElement(l.r,null,c.a.createElement(l.N,null,c.a.createElement(l.M,null,"Add Habit"))),c.a.createElement(l.m,null,c.a.createElement(l.u,null,c.a.createElement(l.v,{position:"floating"},"Name"),c.a.createElement(l.t,{name:"name",placeholder:"Read book, Go running ...",onIonChange:f,value:u.doc.name})),c.a.createElement(l.u,null,c.a.createElement(l.v,{position:"floating"},"Note"),c.a.createElement(l.L,{placeholder:"Enter more information here, motivate yourself...",name:"note",onIonChange:f,value:u.doc.note})),c.a.createElement(l.u,null,c.a.createElement(l.H,{value:u.doc.regularityInterval,onIonChange:function(e){return function(e){e=e||"day";var t=Object(C.a)({},u.doc,{},{regularityInterval:e,regularityValue:1}),n=Object(C.a)({},u.regularity,{},Dt(e));d(Object(C.a)({},u,{},{doc:t,regularity:n})),console.log(u)}(e.detail.value)}},c.a.createElement(l.I,{value:"day"},c.a.createElement(l.v,null,"Daily")),c.a.createElement(l.I,{value:"week"},c.a.createElement(l.v,null,"Weekly")),c.a.createElement(l.I,{value:"month"},c.a.createElement(l.v,null,"Monthly")))),"day"!==u.doc.regularityInterval?c.a.createElement(c.a.Fragment,null,c.a.createElement(l.E,{min:u.regularity.min,max:u.regularity.max,debounce:100,value:u.doc.regularityValue,onIonChange:m,color:"secondary"},c.a.createElement(l.v,{slot:"start"},u.regularity.min),c.a.createElement(l.v,{slot:"end"},u.regularity.max))):c.a.createElement(c.a.Fragment,null),c.a.createElement(l.u,null,c.a.createElement(l.v,null,function(){var e=u.doc.regularityValue>1?" times a ":" time a ";return"day"===u.doc.regularityInterval?"I will repeat this habit every day.":"I will repeat this habit "+u.doc.regularityValue+e+u.doc.regularityInterval}())),c.a.createElement(l.E,{min:0,max:4,debounce:100,value:u.doc.difficulty,onIonChange:p,color:"secondary"},c.a.createElement(l.v,{slot:"start"},M(I(o.trivial))),c.a.createElement(l.v,{slot:"end"},M(I(o.extreme)))),c.a.createElement(l.u,null,c.a.createElement(l.v,null,function(e){switch(e){case o.trivial:return"Easy peasy lemon squeezy";case o.easy:return"Piece of Cake";case o.medium:return"Let's Rock";case o.hard:return"No Pain, No Gain";case o.extreme:return"Death Wish"}}(u.doc.difficulty)))),c.a.createElement(l.p,null,c.a.createElement(l.N,null,c.a.createElement(l.M,null,c.a.createElement(l.f,{onClick:function(){return n(u.doc,"save")}},"Save"),c.a.createElement(l.f,{onClick:function(){return n(null,"none")}},"Cancel")))),c.a.createElement(l.n,{horizontal:"end",vertical:"bottom"},c.a.createElement(l.o,{size:"small",color:"danger",onClick:function(){d(Object(C.a)({},u,{},{showDeleteWarrning:!0}))}},c.a.createElement(l.s,{size:"large",icon:ve.G}))),c.a.createElement(l.b,{isOpen:u.showDeleteWarrning,onDidDismiss:function(){return b},header:"Warrning!!!",message:"Are you sure you want to <strong>delete</strong> this habit?",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary"},{text:"Yes Im Sure",handler:function(){return b(),console.log("REMVE ACTION STATE::::::: ",u),void n(u.doc,"remove")}}]}))},Rt=function(e,t){switch(t.type){case"showModal":return Object(C.a)({},e,{},{showModal:t.data.showModal,modalHabit:t.data.habit});case"hideModal":default:return e}};function At(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:e,data:t}}var Nt=function(){console.log(re(Ye.userid));var e=Ct(re(Ye.userid)),t=Object(h.a)(e,2),n=t[0],a=t[1],r=Object(s.useReducer)(Rt,{showModal:!1,modalHabit:null}),o=Object(h.a)(r,2),i=o[0],u=o[1];console.log("STATE::: ",i);var d=n.habits,f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new D;console.log("Add habit:  ",e),u(At("showModal",{showModal:!0,habit:e}))};return c.a.createElement(l.D,null,c.a.createElement(ut,{title:"Habits"}),c.a.createElement(l.m,null,c.a.createElement(l.x,null,d.map((function(e){return c.a.createElement(It,{habit:e,dataFunctions:a,key:e.id,showEditModalFunction:f})}))),i.showModal?c.a.createElement(l.B,{isOpen:i.showModal,onDidDismiss:function(){u(At("showModal",{showModal:!1,habit:null}))}},c.a.createElement(Pt,{habit:i.modalHabit||new D,dismissFunc:function(e,t){console.log("habit: ",e),u(At("showModal",{showModal:!1,habit:null})),"save"===t&&null!=e?a.save(e):"remove"===t&&null!=e&&e.id&&a.remove(e.id)}})):c.a.createElement(c.a.Fragment,null),c.a.createElement(l.n,{vertical:"top",horizontal:"end",slot:"fixed",edge:!0},c.a.createElement(l.o,{onClick:function(){return f()}},c.a.createElement(l.s,{icon:ve.a})))))},Ft=function(){return c.a.createElement(l.r,{className:"menuHeaderWithAvatar"},c.a.createElement("h1",null,"Menu"))},Mt=[{title:"Today",url:"/todos/today",icon:ve.F,subPages:[]},{title:"Important",url:"/todos/important",icon:ve.E,subPages:[]},{title:"Important",url:"/todos/tasksmain33mmm",icon:ve.i,subPages:[]},{title:"Whish List",url:"/todos/whish",icon:ve.r,subPages:[]},{title:"Buy",url:"/todos/buy",icon:ve.f,subPages:[]},{title:"Projects",url:"/todos/projects",icon:ve.q,subPages:[]}],Lt={appPages:[{title:"Home",url:"/home",icon:ve.s,subPages:[]},{title:"Habits",url:"/habits",icon:ve.z,subPages:[]},{title:"Parties",url:"/parties",icon:ve.g,subPages:[]},{title:"Todos",url:"/todos",icon:ve.b,subPages:Mt}]};n(222);var Gt=Object(v.j)((function(){var e=function(){var e=Object(s.useState)(Lt),t=Object(h.a)(e,2),n=t[0];return t[1],[n,{}]}(),t=Object(h.a)(e,1)[0],n=Object(v.h)().pathname;return c.a.createElement(l.z,{key:"ionmenu_left",contentId:"main",type:"overlay"},c.a.createElement(Ft,null),c.a.createElement(l.m,{key:"menu_left"},c.a.createElement(l.q,null,t.appPages.map((function(e,t){return c.a.createElement(c.a.Fragment,null,c.a.createElement(l.G,{key:e.title.replace(" ","")+e.url},c.a.createElement(l.l,{class:"leftMenuCol"},c.a.createElement(l.A,{autoHide:!1},c.a.createElement(l.u,{color:n.startsWith(e.url)?"light":"",routerLink:e.url,routerDirection:"none"},c.a.createElement(l.s,{slot:"start",icon:e.icon}),c.a.createElement(l.v,null,e.title))))),e.subPages.length>0?c.a.createElement(c.a.Fragment,null,e.subPages.map((function(t,a){return c.a.createElement(l.G,{key:e.title.replace(" ","")+e.url+"_"+t.url},c.a.createElement(l.l,{class:"leftSubMenuCol"},c.a.createElement(l.A,{autoHide:!1},c.a.createElement(l.f,{fill:"clear",color:n.startsWith(t.url)?"success":"",class:"menuButton",routerLink:t.url,routerDirection:"none"},c.a.createElement(l.s,{slot:"start",icon:t.icon}),c.a.createElement(l.v,null,t.title)))))}))):c.a.createElement("div",{key:e.title+"_empty"}))})))))})),Ut=function(e){var t=e.party,n=e.dismissFunc,a=Object(s.useState)({party:t}),r=Object(h.a)(a,2),o=r[0],i=r[1],u=function(e){var t=Object(C.a)({},o.party,{},Object(te.a)({},e.target.name,e.detail.value)),n=Object(C.a)({},o,{},{party:t});i(n)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(l.r,null,c.a.createElement(l.N,null,c.a.createElement(l.M,null,"Add/Edit Party"))),c.a.createElement(l.m,null,c.a.createElement(l.u,null,c.a.createElement(l.v,{position:"floating"},"Name"),c.a.createElement(l.t,{name:"name",placeholder:"Your Cool Party Name",onIonChange:u,value:o.party.name})),c.a.createElement(l.u,null,c.a.createElement(l.v,{position:"floating"},"Note"),c.a.createElement(l.L,{placeholder:"More details for your party members",name:"note",onIonChange:u,value:o.party.note})),c.a.createElement(l.p,null,c.a.createElement(l.N,null,c.a.createElement(l.M,null,c.a.createElement(l.f,{onClick:function(){return n(o.party,"save")}},"Save"),c.a.createElement(l.f,{onClick:function(){return n(null,"none")}},"Cancel"))))))},Bt=function(e){var t=e.partyProject,n=e.history,a=(e.showEditModalFunction,Object(s.useState)({party:t})),r=Object(h.a)(a,2),o=r[0],i=r[1];return Object(s.useEffect)((function(){i(Object(C.a)({},o,{},{party:t}))}),[t]),c.a.createElement(l.g,null,c.a.createElement(l.i,{onClick:function(){return n.push("/parties/"+encodeURI(o.party.id||""))}},c.a.createElement(l.k,null,o.party.name,c.a.createElement(l.e,null,o.party.members.length)),c.a.createElement(l.j,null,o.party.note)))},Ht={docs:[]},$t=new(function(){function e(){Object(f.a)(this,e),this._subscription=[],this._state=Ht,this.state$=new p.a(this._state),this.messages$=new we.a}return Object(m.a)(e,[{key:"init",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.unsubscribe(),t=Je.subscribeChanges().subscribe((function(e){console.log(e)})),this._subscription.push(t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getGlobalPartyMessages",value:function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.queryByProperty("messageType","equals","messageType","msg");case 2:return t=e.sent,console.log(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"unsubscribe",value:function(){this&&this._subscription.forEach((function(e){e&&e.unsubscribe()}))}}]),e}()),Wt=function(e,t){switch(t.type){case"addmsgs":return Object(C.a)({},e,{},{msgs:t.data});case"addmsg":return Object(C.a)({},e,{},{msgs:B(t.data,e.msgs)});default:return e}},qt=function(){var e=Object(s.useReducer)(Wt,{msgs:[]}),t=Object(h.a)(e,2),n=t[0],a=t[1];console.log(n),Object(s.useEffect)((function(){var e=Je.subscribeChanges().subscribe((function(e){"party"===e.messageType&&(console.log(e),console.log(n),a({type:"addmsg",data:e}))}));return r(),function(){e&&e.unsubscribe()}}),[]);var r=function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return le(2e3),e.next=3,$t.getGlobalPartyMessages();case 3:t=e.sent,console.log(t),a({type:"addmsgs",data:[].concat(Object(F.a)(n.msgs),Object(F.a)(t))});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(l.x,null,n.msgs.map((function(e){return c.a.createElement(l.u,{key:e.id},c.a.createElement(l.u,null,c.a.createElement(l.d,{slot:"start"},c.a.createElement("img",null)),c.a.createElement(l.v,null,c.a.createElement("h3",null,function(e){return M(e.from)}(e)),c.a.createElement("p",null,function(e){if(e.data){if("invite"===e.data.type){var t="";return e.replied&&!1===e.replied.accepted?t=" Rejected":e.replied&&!0===e.replied.accepted&&(t=" Accepted"),"Come join our party: "+e.data.name+t}if("inviteaccepted"===e.data.type)return'Invitation to join "'+e.data.name+'" has been accepted'}return e.message}(e))),function(e){if(e.data&&"invite"===e.data.type&&void 0===e.replied)return c.a.createElement("div",{slot:"end"},c.a.createElement(l.f,{onClick:function(){return ft.acceptPartyInvitation(e)}},"Accept"),c.a.createElement(l.f,{onClick:function(){return ft.rejectPartyInviation(e)}},"Reject"))}(e)))})))},Yt=function(){var e=Object(v.g)(),t=Object(s.useState)({userId:"",showModal:!1,party:new Ie,partyList:[]}),n=Object(h.a)(t,2),a=n[0],r=n[1];console.log("Parties Page:: ",a),Object(s.useEffect)((function(){var e=[Ye.username$.subscribe((function(e){r(Object(C.a)({},a,{},{userId:Ye.userid}))})),ft.state$.subscribe((function(e){r(Object(C.a)({},a,{},{partyList:e.docs,userId:Ye.userid}))}))];return function(){e.forEach((function(e){e&&e.unsubscribe()}))}}),[]);var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie;console.log("Add party:  ",e),r(Object(C.a)({},a,{},{showModal:!0,party:e}))};return c.a.createElement(l.D,null,c.a.createElement(ut,{title:"Parties"}),c.a.createElement(l.m,null,a.showModal?c.a.createElement(l.B,{isOpen:a.showModal,onDidDismiss:function(){r(Object(C.a)({},a,{},{showModal:!1,party:new Ie}))}},c.a.createElement(Ut,{party:a.party,dismissFunc:function(e,t){console.log("PARTY: ",e),r(Object(C.a)({},a,{},{showModal:!1,party:new Ie})),"save"===t&&null!=e?ft.save(e):"remove"===t&&null!=e&&e.id}})):c.a.createElement(c.a.Fragment,null),c.a.createElement(l.g,null,c.a.createElement(l.i,null,c.a.createElement(l.k,null,"Here you can join friends to conquer those tasks together."),c.a.createElement(l.j,null)),c.a.createElement(l.h,null,c.a.createElement(l.v,null,"Create your party to go on quests and challenge your friends."),c.a.createElement(l.f,{onClick:function(){return o()}},"Create Party"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(l.v,null,"Join your friends party, give them your code: ",c.a.createElement("strong",null,a.userId)))),c.a.createElement(l.x,null,a.partyList.map((function(t){return c.a.createElement(Bt,{partyProject:t,history:e,key:t.id,showEditModalFunction:o})}))),c.a.createElement(qt,null),c.a.createElement(l.u,null,c.a.createElement(l.v,null,"To join a party, you can give part leader your id: ",a.userId," "))))},zt=function(e){var t=Ct(e.project),n=Object(h.a)(t,2),a=n[0],r=n[1],o=Object(s.useState)({showModal:!1,modalhabit:new D}),i=Object(h.a)(o,2),u=i[0],d=i[1],f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new D;console.log("Add habit:  ",e),d({showModal:!0,modalhabit:e})};return c.a.createElement(l.g,null,c.a.createElement(l.i,null,c.a.createElement(l.k,null,"Habits")),c.a.createElement(l.h,null,c.a.createElement(l.x,null,a.habits.map((function(e){return c.a.createElement(It,{habit:e,dataFunctions:r,key:e.id,showEditModalFunction:f})}))),u.showModal?c.a.createElement(l.B,{isOpen:u.showModal,onDidDismiss:function(){d({showModal:!1,modalhabit:new D})}},c.a.createElement(Pt,{habit:u.modalhabit,dismissFunc:function(e,t){console.log("habit: ",e),d({showModal:!1,modalhabit:new D}),"save"===t&&null!=e?r.save(e):"remove"===t&&null!=e&&e.id&&r.remove(e.id)}})):c.a.createElement(c.a.Fragment,null)),c.a.createElement(l.n,{vertical:"top",horizontal:"end",slot:"fixed"},c.a.createElement(l.o,{onClick:function(){return f()},size:"small"},c.a.createElement(l.s,{icon:ve.a}))))},Vt=function(e){var t=e.project,n=Object(s.useState)({showAddModal:!1}),a=Object(h.a)(n,2),r=a[0],o=a[1],i=function(){o(Object(C.a)({},r,{},{showAddModal:!1}))};return c.a.createElement(l.g,null,c.a.createElement(l.i,null,c.a.createElement(l.k,null,"Members"),r.showAddModal?c.a.createElement(l.u,null):c.a.createElement(c.a.Fragment,null)),c.a.createElement(l.h,null,c.a.createElement(l.x,null)),c.a.createElement(l.p,null,c.a.createElement(l.f,{onClick:function(){o(Object(C.a)({},r,{},{showAddModal:!0}))},fill:"clear"},"Add Member")),c.a.createElement(l.b,{isOpen:r.showAddModal,onDidDismiss:function(){return i()},header:"Friend ID:",subHeader:"Found at bottom of parties page.",inputs:[{name:"userid",type:"text",id:"adduserid"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){i()}},{text:"Invite User",handler:function(e){ft.addUser(e.userid,t),i()}}]}))},Kt={party:new Ie},Jt=function(){var e=Object(k.a)(j.a.mark((function e(t,n,a,r){var o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Loading party"),o=Je.getReadySub().subscribe(function(){var e=Object(k.a)(j.a.mark((function e(s){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return console.log("==============================Load party, ",t),e.next=5,Je.getDoc(t,"party");case 5:if(c=e.sent,console.log(c),c){e.next=12;break}return o.unsubscribe(),console.log("************************************* couldn load party",t),r.push("/parties"),e.abrupt("return");case 12:a(Object(C.a)({},n,{},{party:c})),o.unsubscribe();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),Qt=function(){console.log("PARTY PAGE");var e=Object(v.i)().id,t=Object(v.g)(),n=Object(s.useState)(Kt),a=Object(h.a)(n,2),r=a[0],o=a[1];Object(s.useRef)(new Tt);return console.log("--------------------------------EFFECT: ",e),Object(s.useEffect)((function(){e?Jt(e,r,o,t):(console.log("=================================================== no id"),t.push("/parties"))}),[e]),c.a.createElement(l.D,null,c.a.createElement(ut,{title:"Party: "+r.party.name}),c.a.createElement(l.m,null,r.party.id?c.a.createElement(c.a.Fragment,null,c.a.createElement(Vt,{project:r.party}),c.a.createElement(zt,{project:r.party})):c.a.createElement(c.a.Fragment,null)))},Xt=function(){var e=function(){var e=Object(s.useState)({status:ct.loading,dataReady:!1,username:"Guest"}),t=Object(h.a)(e,2),n=t[0],a=t[1];console.log("APP Router Status: ",n),Object(s.useEffect)((function(){console.log("App Stats Effect::");var e=[Je.getReadySub().subscribe((function(e){console.log("DataService READY",e,Je.ready),e!==n.dataReady&&r()})),Ye.username$.subscribe(function(){var e=Object(k.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("USERNAME CHANGED: ",t),Ye.getIsAuthenticated()&&Ye.renewToken(),r(),console.log("USER:::::: ",Ye.getUser(),Ye.getIsAuthenticated()),n=Ye.getUser().id,e.next=7,Je.init(n,"Guest"!==t);case 7:return console.log("Ready to start gamify service"),e.next=10,nt.init(n);case 10:return e.next=12,ft.init();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())];return function(){e.map((function(e){return e.unsubscribe()}))}}),[]);var r=function(){var e=Je.ready,t=Ye.getUsername();e===n.dataReady&&t===n.username||(console.log("STATUS ----------------",e,t,n),a(e?"Guest"===t?{status:ct.guest,username:t,dataReady:e}:{status:ct.auth,username:t,dataReady:e}:{status:ct.loading,username:t,dataReady:e}))};return[n.status]}(),t=Object(h.a)(e,1)[0],n=Object(v.g)(),a=Object(v.h)();if(console.log("APP RERENDER::::::::::::::::::::::::::::::::::::::",t,a,n),t===ct.auth&&a.pathname.startsWith("/auth/")&&a.state){var r=a.state.prev||"/";n.push(r)}return function(){switch(t){case ct.auth:return c.a.createElement(l.J,{when:"sm",contentId:"main"},c.a.createElement(Gt,{key:"menu"}),c.a.createElement(l.F,{id:"main"},c.a.createElement(v.c,{path:"/home",component:mt,exact:!0}),c.a.createElement(v.c,{exact:!0,path:"/auth/user",component:y}),c.a.createElement(v.c,{path:"/todos",component:lt,exact:!0}),c.a.createElement(v.c,{path:"/todos/:tag",component:lt,exact:!0}),c.a.createElement(v.c,{path:"/habits",component:Nt,exact:!0}),c.a.createElement(v.c,{path:"/parties",component:Yt,exact:!0}),c.a.createElement(v.c,{path:"/parties/:id",component:Qt,exact:!0}),c.a.createElement(v.c,{path:"/",render:function(){return c.a.createElement(v.b,{to:"/home"})},exact:!0}),c.a.createElement(v.c,{path:"/404",component:pt}),c.a.createElement(v.b,{to:"/404"})));case ct.guest:return c.a.createElement(l.F,null,c.a.createElement(St,{exact:!0,path:"*",component:mt}));default:return c.a.createElement(l.F,null,c.a.createElement(v.c,{exact:!0,path:"*",component:dt}))}}()},Zt=(n(223),function(){var e=Object(s.useState)(null),t=Object(h.a)(e,2),n=t[0],a=t[1];return Object(s.useEffect)((function(){var e=[Be.messages$.subscribe((function(e){a(e)}))];return function(){e.map((function(e){return e.unsubscribe()}))}}),[n]),console.log("PRINTING TOAST: ",n),c.a.createElement("div",{className:"toastDiv"},c.a.createElement(ke.a,{position:"top-right",autoClose:5e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0}))}),en=function(){return c.a.createElement(l.c,null,c.a.createElement(d.a,null,c.a.createElement(g,null),c.a.createElement(Zt,null),c.a.createElement(Xt,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(c.a.createElement(en,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},61:function(e,t,n){}},[[103,8,9]]]);
//# sourceMappingURL=main.47a88f57.chunk.js.map