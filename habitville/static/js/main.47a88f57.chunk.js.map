{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ include: //.entry/.js$/ exclude: //.system/.entry/.js$/ groupOptions: {} namespace object","pages/habits/models.ts","modules/loading/loadingService.ts","modules/loading/loading.component.tsx","modules/auth/components/user.page.tsx","modules/data/models.ts","env.ts","utils.ts","pages/habits/utilsHabits.ts","pages/todo/models.ts","modules/data/utilsData.ts","modules/toast/toastService.ts","pages/todo/todo.new.component.tsx","pages/todo/todo.edit.inline.component.tsx","modules/data/adapters/dexie.ts","modules/parties/models.ts","modules/localStorage/localStorageService.ts","modules/ajax/ajax.ts","modules/auth/authService.ts","modules/data/sync.ts","modules/data/dataService.ts","modules/messages/models.ts","modules/gamify/utilsGamify.ts","modules/gamify/gamifyService.ts","pages/todo/Todo.listitem.component.tsx","pages/todo/todo.service.ts","modules/app/hooks/appStatus.hook.ts","components/HeaderWithProgress.tsx","pages/todo/Todos.page.tsx","pages/todo/hooks/todos.hook.ts","modules/auth/components/intro.page.tsx","modules/parties/party.service.ts","pages/Home.tsx","pages/NotFound.tsx","modules/forms/myInput.tsx","modules/forms/myForm.tsx","modules/auth/components/auth.menu.component.tsx","modules/auth/components/login.page.tsx","modules/auth/components/register.page.tsx","modules/auth/unauthenticatedRoute.tsx","pages/habits/habits.service.ts","pages/habits/hooks/habits.hook.ts","colors.ts","pages/habits/Habit.listitem.component.tsx","pages/habits/Habit.add.component.tsx","pages/habits/Habits.page.tsx","components/MenuHeaderWithProgress.tsx","modules/menu/hooks/menu.hook.ts","components/Menu.tsx","modules/parties/components/Party.edit.component.tsx","modules/parties/components/Party.listitem.component.tsx","modules/messages/messages.service.ts","modules/parties/components/Party.invites.component.tsx","modules/parties/pages/Parties.page.tsx","pages/habits/Habit.list.component.tsx","modules/parties/components/Members.list.component.tsx","modules/parties/pages/Party.view.page.tsx","routes.tsx","modules/toast/toast.component.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","habitStage","habitIntervals","habitDifficulty","loadingService","_loading","loading$","BehaviorSubject","show","this","msg","next","Loading","useState","state","setState","useEffect","subscriptions","subscribe","res","it","unsubscribe","isOpen","message","UserPage","Doc","String","fromCharCode","values","undefined","deleted","created","Date","now","updated","type","dirty","assign","ProjectItem","name","note","access","printDifficulty","hab","trivial","easy","medium","hard","extreme","Habit","stage","current","difficulty","regularityInterval","day","regularityValue","regularityEachDayGoal","progress","currentStreak","bestStreak","newRewards","detail","process","REACT_APP_STAGE","SYNC_SERVER","AUTH_API_URL","env","APP_ID","ACCESS_META_KEY","TOKEN_EXPIRATION","capitalize","s","charAt","toUpperCase","slice","getNested","obj","args","reduce","level","getAction","todo","data","saveIntoArray","item","ary","idKey","i","getIndexById","length","saveIntoDocList","filter","d","clamp","val","max","min","getInitGamifyRewards","base","gold","experience","getStreakByWeek","weeksBack","firstDayOfWeek","firstDay","moment","streak","isSame","console","log","add","subtract","getProgressValueByDate","getProgressDate","getStreakByMonth","monthsBack","date","currentDay","format","withinWeekBuffer","buffer","offset","isAfter","calculateHabitStreakByMonth","bufferSize","currentBiggestStreak","cont","currentValue","calculateHabitStreakByWeek","calculateDailyHabitStreak","getProgressDateBySubtract","value","Todo","done","tags","_new","parent","subTodos","showSubTodos","showDone","doneRewards","getDefaultProject","userid","uuid","generateProjectUUID","genrateMetaData","generateUUID","ok","shortid","generate","substring","getProjectChildId","getChannelFromProjectId","app","generateCollectionId","projectid","collection","waitMS","ms","setTimeout","ToastType","TodoNewComp","parentId","saveFunc","projectId","title","save","a","newDoc","className","placeholder","onKeyPress","key","onIonChange","getDefaultState","showDeleteWarrning","text","mergeText","TodoEditInlineComponent","dataFunctions","hideRemoveWarrning","handleTagChange","tag","newtags","_","find","t","isUndefined","concat","color","includes","class","size","fill","onClick","icon","sunny","star","checkmark","heart","basket","construct","printTag","autoGrow","onIonBlur","match","exec","index","newState","select","close","trash","onDidDismiss","header","buttons","role","cssClass","handler","remove","DexieAdapter","scheme","db","_ready","ready$","_subscriptions","changes$","Subject","Dexie","stores","tables","forEach","columns","version","_init","open","_subscribe","sub","get","bulkGet","doc","field","operator","where","equals","toArray","startsWith","notEqual","setDirty","put","docs","bulkPut","PartyProject","creator","members","localStorageService","localStorage","getItem","JSON","parse","str","stringify","setItem","getAjaxMessage","success","status","errors","getPostRequest","url","form","options","getErrorMessage","location","post","showLoading","loadingMessage","axios","hideLoading","response","AuthStatus","toastService","messages$","default","milliseconds","toast","autoClose","err","showMessage","error","anylogger","getUser","username","email","token","token_expiery","channels","expires","isGuest","user","getGuestUser","authService","_user","_authStatus","authStatus$","username$","loadAuth","User","forceLogout","setAuthStatus","setObject","isEqual","Guest","info","getObject","updateUser","warn","password","history","prev","push","printServerErrors","organizeData","channel","split","checkpoints","syncData","props","syncurl","checkpoint","chpoints","types","databaseScheme","dataService","authId","_ready$","addSyncCall$","pipe","throttleTime","_syncRemote","getDoc","getBulk","queryByProperty","getProjectItems","remoteSync","oldDoc","project","getToken","gotNewRightsToken","renewToken","tokenres","debounce","asObservable","debounceTime","change","projectChildId","authid","syncRemote","dbSub","ready","Number","requestMaxSize","saveFromSync","calculateLevelExperience","exp","x","Math","floor","pow","calculateDoneTodoGold","days","diff","rew","TODO_DONE_GOLD_REWARDS","calculateDoneTodoExperience","TODO_DONE_EXPERIENCE_REWARDS","gamifyService","_userId","_state","health","maxHealth","maxExperience","items","state$","calculateFinishedTodoRewards","addGold","messageReceivedGold","addExperience","messageReceivedExperience","messageLostGold","messageLostExperience","calculateNewTodo","calculateNewHabitRewards","habit","dataSub","getReadySub","loadInitDocs","_save","sub2","subscribeDocChanges","getGamifyDocId","equal","prog","reward","round","preMessage","postMessage","initEqual","ts","red","reducer","action","loadSubtodos","dispatch","loadSubTodos","todos","TodoListItemComp","selectedTodo","lastChild","useReducer","newSubTitle","subSelect","doneHandler","filterHandler","showSubTodosHandler","handleSelectTodo","printSubtodos","printTagEdit","list","me","style","fontSize","verticalAlign","radioButtonOn","radioButtonOff","replace","printCleanNote","paddingRight","arrowDownCircle","arrowForwardCircle","TodoService","_project","selectedTag","doneTodos","_subscription","showChildren","reloadTodos","subscribeProjectCollectionChanges","getBaseParent","baseParent","filterAndSaveTodos","filtered","filterDoneParentFunction","todoId","parentTodo","addSubTodoToParent","removeSubTodoFromParent","AppStatus","HeaderWithProgress","src","right","alt","top","width","trailWidth","percent","strokeWidth","strokeColor","leaf","TodosPage","useParams","todoService","useRef","selectTag","loadTodoList","changeDoneFilter","changeShowSubTodosFilter","changeShowSubtodosFilter","init","useTodosCollectionFacade","dataFunc","IntroPage","initPartyState","partyService","subscribeChanges","party","channelid","rights","partyProject","_createParty","saveNewProject","msgId","replied","accepted","newMsg","Home","NotFound","padding","MyInput","updateFunction","position","displayName","hasValidation","event","target","messages","m","printErrors","defaultOptions","submitButtonText","getFormOptions","settings","getValidator","MyForm","submitFunction","valid","initForm","model","Array","isArray","validateItem","validators","validateForm","updateItem","validate","findById","validator","isEmpty","isLength","isEmail","disabled","AuthMenuComponent","page","useLocation","useHistory","pathname","LoginPage","submitButtongText","submit","loginAndRedirect","paddingTop","logIn","RegisterPage","register","UnauthenticatedRoute","exact","path","component","render","to","getInitHabitsState","selected","habits","stageFilter","HabitsService","_docs","docs$","getAllByProject","filterhabits","filterFunction","useHabitsCollectionFacade","habitsService","changeStageFilter","getProject","HabitListItemComponent","showEditModalFunction","setDoc","printDate","printDayIcon","updatehabit","checkmarkCircleOutline","newProgress","progresslist","calculateHabitProgressRewards","h","week","month","calculateCurrentStreak","horizontal","vertical","edge","cog","getRegularityValues","interval","HabitAddComponent","dismissFunc","getDefaultRegularityState","regularity","handleChange","handlerRegularityValue","handleDifficultyChange","newReg","handlerRegularityIntervalChange","slot","times","printRegularityLabel","printDifficultyLabel","showModal","modalHabit","HabitsPage","habitsState","addhabit","MenuHeaderWithProgress","todoTags","subPages","getInitMenuState","appPages","home","refresh","bonfire","apps","withRouter","useMenuHookFacade","contentId","appPage","autoHide","routerLink","routerDirection","subPage","index2","PartyEditComponent","PartyListItemComponent","encodeURI","initMessageState","messageService","msgs","PartyInvitesListComponent","messageType","getMessages","getGlobalPartyMessages","from","printHeading","last","printNote","acceptPartyInvitation","rejectPartyInviation","printAcceptRejectButtons","PartiesPage","userId","partyList","subs","changes","editParty","HabitListComponent","modalhabit","modalState","setModalState","PartyMembersListComponent","showAddModal","hideAddUser","subHeader","inputs","addUser","getInitState","loadParty","PartyViewPage","Routes","loading","dataReady","appStatus","setAppStatus","setStatusFunction","getIsAuthenticated","getUsername","guest","auth","useAppStatus","newpath","when","getRoutes","Toasts","setMessage","hideProgressBar","newestOnTop","closeOnClick","rtl","draggable","pauseOnHover","App","Boolean","window","hostname","ReactDOM","document","getElementById","navigator","serviceWorker","registration","unregister"],"mappings":"mIAAA,IAAIA,EAAM,CACT,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,8BAA+B,CAC9B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,qBAAsB,CACrB,IACA,IAED,uCAAwC,CACvC,IACA,IAED,sCAAuC,CACtC,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,mCAAoC,CACnC,IACA,IAED,kCAAmC,CAClC,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,kCAAmC,CAClC,IACA,IAED,iCAAkC,CACjC,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,iCAAkC,CACjC,IACA,IAED,gCAAiC,CAChC,IACA,IAED,+BAAg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","file":"static/js/main.47a88f57.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet-ios.entry.js\": [\n\t\t228,\n\t\t37\n\t],\n\t\"./ion-action-sheet-md.entry.js\": [\n\t\t229,\n\t\t38\n\t],\n\t\"./ion-alert-ios.entry.js\": [\n\t\t230,\n\t\t21\n\t],\n\t\"./ion-alert-md.entry.js\": [\n\t\t231,\n\t\t22\n\t],\n\t\"./ion-app_8-ios.entry.js\": [\n\t\t232,\n\t\t10\n\t],\n\t\"./ion-app_8-md.entry.js\": [\n\t\t233,\n\t\t11\n\t],\n\t\"./ion-avatar_3-ios.entry.js\": [\n\t\t234,\n\t\t39\n\t],\n\t\"./ion-avatar_3-md.entry.js\": [\n\t\t235,\n\t\t40\n\t],\n\t\"./ion-back-button-ios.entry.js\": [\n\t\t236,\n\t\t41\n\t],\n\t\"./ion-back-button-md.entry.js\": [\n\t\t237,\n\t\t42\n\t],\n\t\"./ion-backdrop-ios.entry.js\": [\n\t\t238,\n\t\t79\n\t],\n\t\"./ion-backdrop-md.entry.js\": [\n\t\t239,\n\t\t80\n\t],\n\t\"./ion-button_2-ios.entry.js\": [\n\t\t240,\n\t\t43\n\t],\n\t\"./ion-button_2-md.entry.js\": [\n\t\t241,\n\t\t44\n\t],\n\t\"./ion-card_5-ios.entry.js\": [\n\t\t242,\n\t\t45\n\t],\n\t\"./ion-card_5-md.entry.js\": [\n\t\t243,\n\t\t46\n\t],\n\t\"./ion-checkbox-ios.entry.js\": [\n\t\t244,\n\t\t47\n\t],\n\t\"./ion-checkbox-md.entry.js\": [\n\t\t245,\n\t\t48\n\t],\n\t\"./ion-chip-ios.entry.js\": [\n\t\t246,\n\t\t49\n\t],\n\t\"./ion-chip-md.entry.js\": [\n\t\t247,\n\t\t50\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t248,\n\t\t81\n\t],\n\t\"./ion-datetime_3-ios.entry.js\": [\n\t\t249,\n\t\t17\n\t],\n\t\"./ion-datetime_3-md.entry.js\": [\n\t\t250,\n\t\t18\n\t],\n\t\"./ion-fab_3-ios.entry.js\": [\n\t\t251,\n\t\t51\n\t],\n\t\"./ion-fab_3-md.entry.js\": [\n\t\t252,\n\t\t52\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t253,\n\t\t82\n\t],\n\t\"./ion-infinite-scroll_2-ios.entry.js\": [\n\t\t254,\n\t\t35\n\t],\n\t\"./ion-infinite-scroll_2-md.entry.js\": [\n\t\t255,\n\t\t36\n\t],\n\t\"./ion-input-ios.entry.js\": [\n\t\t256,\n\t\t53\n\t],\n\t\"./ion-input-md.entry.js\": [\n\t\t257,\n\t\t54\n\t],\n\t\"./ion-item-option_3-ios.entry.js\": [\n\t\t258,\n\t\t55\n\t],\n\t\"./ion-item-option_3-md.entry.js\": [\n\t\t259,\n\t\t56\n\t],\n\t\"./ion-item_8-ios.entry.js\": [\n\t\t260,\n\t\t57\n\t],\n\t\"./ion-item_8-md.entry.js\": [\n\t\t261,\n\t\t58\n\t],\n\t\"./ion-loading-ios.entry.js\": [\n\t\t262,\n\t\t23\n\t],\n\t\"./ion-loading-md.entry.js\": [\n\t\t263,\n\t\t24\n\t],\n\t\"./ion-menu_3-ios.entry.js\": [\n\t\t264,\n\t\t59\n\t],\n\t\"./ion-menu_3-md.entry.js\": [\n\t\t265,\n\t\t60\n\t],\n\t\"./ion-modal-ios.entry.js\": [\n\t\t266,\n\t\t12\n\t],\n\t\"./ion-modal-md.entry.js\": [\n\t\t267,\n\t\t13\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t268,\n\t\t16\n\t],\n\t\"./ion-popover-ios.entry.js\": [\n\t\t269,\n\t\t14\n\t],\n\t\"./ion-popover-md.entry.js\": [\n\t\t270,\n\t\t15\n\t],\n\t\"./ion-progress-bar-ios.entry.js\": [\n\t\t271,\n\t\t61\n\t],\n\t\"./ion-progress-bar-md.entry.js\": [\n\t\t272,\n\t\t62\n\t],\n\t\"./ion-radio_2-ios.entry.js\": [\n\t\t273,\n\t\t63\n\t],\n\t\"./ion-radio_2-md.entry.js\": [\n\t\t274,\n\t\t64\n\t],\n\t\"./ion-range-ios.entry.js\": [\n\t\t275,\n\t\t65\n\t],\n\t\"./ion-range-md.entry.js\": [\n\t\t276,\n\t\t66\n\t],\n\t\"./ion-refresher_2-ios.entry.js\": [\n\t\t277,\n\t\t25\n\t],\n\t\"./ion-refresher_2-md.entry.js\": [\n\t\t278,\n\t\t26\n\t],\n\t\"./ion-reorder_2-ios.entry.js\": [\n\t\t279,\n\t\t33\n\t],\n\t\"./ion-reorder_2-md.entry.js\": [\n\t\t280,\n\t\t34\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t281,\n\t\t83\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t282,\n\t\t67\n\t],\n\t\"./ion-searchbar-ios.entry.js\": [\n\t\t283,\n\t\t27\n\t],\n\t\"./ion-searchbar-md.entry.js\": [\n\t\t284,\n\t\t28\n\t],\n\t\"./ion-segment_2-ios.entry.js\": [\n\t\t285,\n\t\t68\n\t],\n\t\"./ion-segment_2-md.entry.js\": [\n\t\t286,\n\t\t69\n\t],\n\t\"./ion-select_3-ios.entry.js\": [\n\t\t287,\n\t\t70\n\t],\n\t\"./ion-select_3-md.entry.js\": [\n\t\t288,\n\t\t71\n\t],\n\t\"./ion-slide_2-ios.entry.js\": [\n\t\t289,\n\t\t84\n\t],\n\t\"./ion-slide_2-md.entry.js\": [\n\t\t290,\n\t\t85\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t291,\n\t\t31\n\t],\n\t\"./ion-split-pane-ios.entry.js\": [\n\t\t292,\n\t\t86\n\t],\n\t\"./ion-split-pane-md.entry.js\": [\n\t\t293,\n\t\t87\n\t],\n\t\"./ion-tab-bar_2-ios.entry.js\": [\n\t\t294,\n\t\t72\n\t],\n\t\"./ion-tab-bar_2-md.entry.js\": [\n\t\t295,\n\t\t73\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t296,\n\t\t32\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t297,\n\t\t74\n\t],\n\t\"./ion-textarea-ios.entry.js\": [\n\t\t298,\n\t\t75\n\t],\n\t\"./ion-textarea-md.entry.js\": [\n\t\t299,\n\t\t76\n\t],\n\t\"./ion-toast-ios.entry.js\": [\n\t\t300,\n\t\t29\n\t],\n\t\"./ion-toast-md.entry.js\": [\n\t\t301,\n\t\t30\n\t],\n\t\"./ion-toggle-ios.entry.js\": [\n\t\t302,\n\t\t19\n\t],\n\t\"./ion-toggle-md.entry.js\": [\n\t\t303,\n\t\t20\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t304,\n\t\t88\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 109;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t308,\n\t\t96\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 111;\nmodule.exports = webpackAsyncContext;","\nimport { Doc } from '../../modules/data/models'\nimport { GamifyRewards } from './utilsHabits';\n\nexport const TYPE_HABBIT = 'hab';\nexport const MOMENT_DATE_FORMAT = 'YYYYMMDD';\n\nexport enum habitStage {\n  'finished',\n  'current',\n  'future',\n  'resting'\n}\n\nexport enum habitIntervals {\n  day = 'day',\n  week = 'week',\n  month = 'month'\n}\n\nexport enum habitDifficulty {\n  trivial, easy, medium, hard, extreme\n}\n\nexport const printDifficulty = (hab:habitDifficulty):string => {\n  switch(hab) {\n    case habitDifficulty.trivial:\n      return 'trivial'; // , easy peasy lemon squeezy\n    case habitDifficulty.easy:\n      return 'easy'; //Piece of Cake , Smooth Sailin'\n    case habitDifficulty.medium:\n      return 'medium'; //Let's Go\n    case habitDifficulty.hard:\n      return 'hard'; //No Pain, No Gain\n    case habitDifficulty.extreme:\n      return 'extreme'; //Death Wish\n  }\n}\n\n\nexport interface HabitProgress {\n  date:string, \n  value: number, \n  reward?: GamifyRewards,\n}\n\nexport class Habit extends Doc {\n  name: string = 'New habit';\n  note?: string;\n  type:string = TYPE_HABBIT;\n  stage: habitStage = habitStage.current;\n  difficulty:habitDifficulty = habitDifficulty.medium;\n  //regularity\n  regularityInterval:habitIntervals = habitIntervals.day;\n  regularityValue: number = 1;\n  regularityEachDayGoal?: number = 1;\n\n  progress: HabitProgress[] = [];\n  //streaks\n  currentStreak: number = 0;\n  bestStreak: number = 0;\n\n  newRewards?: GamifyRewards;\n  \n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n  }\n\n}\n","\nimport { BehaviorSubject } from 'rxjs';\n\n\n\nexport class LoadingService {\n  private _loading: boolean = false;\n  \n\n  public loading$ = new BehaviorSubject({show: this._loading, msg: 'Loading...'});\n\n  showLoading(msg = \"Loading...\") {\n    this._loading = true;\n    this.loading$.next({show:true, msg});\n  }\n\n  hideLoading() {\n    this._loading = false;\n    this.loading$.next({show:false, msg:''});\n  }\n\n  public get loading(): boolean {\n    return this._loading;\n  }\n\n\n  startLoadingTimer() {\n\n  }\n\n}\nexport const loadingService = new LoadingService();\n\n\n","import React, { useState, useEffect } from 'react';\nimport { IonLoading } from '@ionic/react';\nimport { Subscription } from 'rxjs';\nimport { loadingService } from './loadingService';\n\nexport const Loading: React.FC = () => {\n  const [state, setState] = useState({show:false, msg: 'Loading...'});\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      loadingService.loading$.subscribe(res =>{\n        setState({show: res.show, msg: res.msg});\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[]);\n\n  \n  //onDidDismiss={() => setShowLoading(false)}\n  return (\n      <IonLoading\n        isOpen={state.show}\n        message={state.msg}\n      />\n  );\n};","import React from 'react';\nimport { IonHeader, IonToolbar, IonPage, IonTitle, IonContent, IonLabel } from '@ionic/react';\n\n\n\nconst UserPage: React.FC = () => {\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>User Page</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonLabel>User</IonLabel>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default UserPage;\n","export const PROJECT_SERVICE = '';\nexport const PROJECT_INDEX_SERVICE = 'ch';\n\nexport const LASTCHAR = String.fromCharCode(65535);\nexport const DIV = '.';\nexport const DOUBLE_DIV = '..';\n\nexport class Doc {\n  public id: string|undefined = undefined;\n  public deleted?: boolean;\n  public created?: number = Date.now();\n  public updated?: number = Date.now();\n  public type: string = 'doc';\n  public dirty?: number = 0;\n\n  constructor(values: Object = {}) {\n      Object.assign(this, values);\n  }\n\n}\n\nexport class ProjectItem extends Doc {\n  public name: string = '';\n  public note?: string;\n  public access = [];\n\n  constructor(values: Object = {}) {\n    super();\n    Object.assign(this, values);\n}\n}\n\n\n\n\n\n\n\n\n\n","\nexport const FIRST_DAY_OF_WEEK = 'Monday';\n\nconst dev = {\n  \n  \n}\n\nconst prod = {\n  SYNC_SERVER: 'https://auth.mlflabs.com',\n  AUTH_API_URL: 'https://auth.mlflabs.com',\n}\nconst detail = process.env.REACT_APP_STAGE === 'production' ? prod: dev;\n\nexport const env = {...{\n  APP_ID: 'hv',\n  //myenvoy settings\n  ACCESS_META_KEY: 'access',\n  \n\n  //Auth\n  TOKEN_EXPIRATION: 300, // how many days\n  //SYNC_SERVER: 'https://auth.mlflabs.com',\n  //AUTH_API_URL: 'https://auth.mlflabs.com',\n  SYNC_SERVER: 'http://localhost:3002',\n  AUTH_API_URL: 'http://localhost:3002',\n}, ...detail}","\nexport const capitalize = (s: string) => {\n  if (typeof s !== 'string') return ''\n  return s.charAt(0).toUpperCase() + s.slice(1)\n}\n\nexport function getNested(obj: any, ...args: string[]) {\n  return args.reduce((obj, level) => obj && obj[level], obj)\n}\n\nexport const waitMS = (ms: number) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\nexport function getAction(todo:string, data = {}){\n  return {type:todo, data:data};\n}\n\nexport function printCleanNote(text: string) {\n  const t = text.replace(/(\\r\\n|\\n|\\r)/gm,\" \");\n  if(t.length > 40)\n    return t.substring(0,37)+'...';\n  return t;\n}\n\nexport function saveIntoArray(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n          Object.assign({}, item),\n          ...ary.slice(i + 1)];\n}\n\nexport function saveIntoDocList(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  if(item['deleted']){\n    return ary.filter(d => d[idKey] !== item[idKey])\n  }\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n          Object.assign({}, item),\n          ...ary.slice(i + 1)];\n}\n\nexport function getIndexById(id: string, ary: any, idKey: string = 'id'): number {\n  for (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nexport function findById(id:any, ary: any[], idKey: string = \"id\"): any {\nfor (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return ary[i];\n    }\n  }\n  return null;\n}\n\nexport function removeFromArrayById(id: any, ary:Array<any>, idKey = 'id') {\n  return ary.filter(o => o[idKey] !== id);\n}\n\nexport function clamp(val:number, max:number, min:number = 0): number {\n  if(val > max) return max;\n  if(val < min) return min;\n  return val;\n}","import { Habit, MOMENT_DATE_FORMAT, habitIntervals } from './models';\nimport moment, { Moment, months } from 'moment';\nimport { FIRST_DAY_OF_WEEK } from '../../env';\nimport { clamp } from '../../utils';\n\n\nexport interface GamifyRewards {\n  gold:number,\n  experience: number,\n  item:any\n}\n\n\n\nexport const getInitGamifyRewards =  (base?:GamifyRewards):GamifyRewards =>  {\n  return {...{ gold: 0, experience: 0, item:undefined }, ...base};\n}\n\n\nexport const calculateCurrentStreak = (hab:Habit, bufferSize = 3): Habit => {\n  console.log('calculateCurrentStreak:::: ', hab, bufferSize);\n  if(hab.regularityInterval === habitIntervals.day){\n    const h = calculateDailyHabitStreak(hab, bufferSize)\n    return h;\n  }\n\n  if(hab.regularityInterval === habitIntervals.week){\n    return calculateHabitStreakByWeek(hab, bufferSize);\n  }\n\n  if(hab.regularityInterval === habitIntervals.month){\n    return calculateHabitStreakByMonth(hab, bufferSize);\n  }\n\n  return hab;\n}\n\n\nconst getStreakByWeek = (hab:Habit, weeksBack:number, firstDayOfWeek: string): number => {\n  const firstDay = moment().day(FIRST_DAY_OF_WEEK);\n  let currentValue = 0;\n  let streak = 0;\n  if(!firstDay.isSame(moment(), 'day')){\n    console.log('Not same day start');\n    firstDay.add(1, 'week');\n  }\n  console.log(firstDay);\n  //now we have the current first day of week, subtrack weeksBack\n  firstDay.subtract(weeksBack, 'week');\n\n  for(let i = 0; i < 7; i++) {\n    currentValue = getProgressValueByDate(getProgressDate(firstDay,i), hab);\n    if(currentValue > 0) \n      streak++;\n  }\n  return streak;\n}\n\nconst getStreakByMonth = (hab:Habit, monthsBack:number): number => {\n  const firstDay = moment().date(1);\n  \n  if(!firstDay.isSame(moment(), 'day')){\n    console.log('Not same day start');\n    firstDay.add(1, 'month');\n  }\n  console.log(firstDay);\n  let currentValue = 0;\n  let streak = 0;\n  firstDay.subtract(monthsBack, 'month');\n\n  const currentDay = moment(firstDay);\n  while(currentDay.isSame(firstDay, 'month')){\n    currentValue = getProgressValueByDate(currentDay.format(MOMENT_DATE_FORMAT), hab);\n    if(currentValue > 0) \n      streak++;\n\n    currentDay.add(1, 'day');\n  }\n  return streak;\n}\n\nconst withinWeekBuffer = (buffer: number, offset:number):boolean => {\n  if(offset === 0) return true;\n\n\n  const firstDay = moment().day(FIRST_DAY_OF_WEEK);\n  if(!firstDay.isSame(moment(), 'day')){\n    console.log('Not same day start');\n    firstDay.add(1, 'week');\n  }\n\n  //now remove offset\n  firstDay.subtract(offset, 'week');\n\n  if(firstDay.isAfter(moment().subtract(buffer,'day'))) {\n    return true;\n  }\n  \n  return false;\n}\n\n\nconst calculateHabitStreakByMonth = (hab:Habit, bufferSize:number): Habit => {\n  console.log(\"Calculate Current Streak By Month: \", hab);\n  let streak = 0;\n  let currentBiggestStreak = 0;\n  let cont = true;\n  let offset = 0;\n  let currentValue = 0;\n  while(cont) {\n    currentValue = getStreakByMonth(hab, offset);\n    console.log('Month Streak: ', currentValue);\n    console.log('--------------------Clamp:::: ', clamp(currentValue, hab.regularityValue))\n    streak += clamp(currentValue, hab.regularityValue);\n    if(streak > currentBiggestStreak) currentBiggestStreak = streak;\n\n    if(currentValue < hab.regularityValue && !withinWeekBuffer(bufferSize, offset)){\n      cont = false;\n    }\n    //cont\n    offset++;\n  } \n  let bestStreak = hab.bestStreak;\n  if(!hab.bestStreak)hab.bestStreak = 0;\n  if(currentBiggestStreak > hab.bestStreak) bestStreak = currentBiggestStreak;\n  return {...hab, currentStreak: streak, bestStreak}\n}\n\n\nconst calculateHabitStreakByWeek = (hab:Habit, bufferSize:number): Habit => {\n  console.log(\"Calculate Current Streak By Week: \", hab);\n  let streak = 0;\n  let currentBiggestStreak = 0;\n  let cont = true;\n  let offset = 0;\n  let currentValue = 0;\n  while(cont) {\n\n    currentValue = getStreakByWeek(hab, offset, FIRST_DAY_OF_WEEK);\n    \n    console.log('Week Streak: ', currentValue);\n    console.log('--------------------Clamp:::: ', clamp(currentValue, hab.regularityValue))\n    streak += clamp(currentValue, hab.regularityValue);\n    if(streak > currentBiggestStreak) currentBiggestStreak = streak;\n\n\n    if(currentValue >= hab.regularityValue){\n      \n    }\n    else {\n\n      //do we still have buffer for this time period\n\n      //streak = 0;\n      //failed on this day,see if we are in the buffer\n      \n      if(withinWeekBuffer(bufferSize, offset)){\n        console.log(\"We are within buffer, \", bufferSize, offset);\n        //still have a chance\n        \n      }\n      else {\n        console.log(\"We are past buffer, \", bufferSize, offset);\n        // did we success this time period\n\n        //out of buffer, plus failed\n        cont = false;\n      }\n    }\n      \n    //cont\n    offset++;\n  } \n  let bestStreak = hab.bestStreak;\n  if(!hab.bestStreak)hab.bestStreak = 0;\n  if(currentBiggestStreak > hab.bestStreak) bestStreak = currentBiggestStreak;\n  return {...hab, currentStreak: streak, bestStreak}\n}\n\n\n\nconst calculateDailyHabitStreak = (hab:Habit, bufferSize:number): Habit => {\n  console.log(\"Calculate Current Streak: \", hab);\n  let streak = 0;\n  let currentBiggestStreak = 0;\n  let cont = true;\n  let offset = 0;\n  let currentValue = 0;\n  while(cont) {\n    currentValue = getProgressValueByDate(getProgressDateBySubtract(offset), hab);\n    if(currentValue > 0){\n      streak++\n      if(streak > currentBiggestStreak) currentBiggestStreak = streak;\n    }\n    else {\n      cont = false;\n    }\n      \n    //cont\n    offset++;\n  } \n  let bestStreak = hab.bestStreak;\n  if(!hab.bestStreak)hab.bestStreak = 0;\n  if(currentBiggestStreak > hab.bestStreak) bestStreak = currentBiggestStreak;\n  return {...hab, currentStreak: streak, bestStreak}\n}\n\nconst getProgressValueByDate = (date: string, hab:Habit):number => {\n  if(!hab.progress) hab.progress = [];\n  for(let i = 0; i < hab.progress.length; i++){\n    if(hab.progress[i].date === date)\n    {\n      return hab.progress[i].value;\n    }\n  }\n  return 0;\n}\n\nconst getProgressDateBySubtract = (subtract:number):string => {\n  return moment().subtract(subtract, 'day').format(MOMENT_DATE_FORMAT);\n}\n\nconst getProgressDate = (date: Moment, subtract: number): string => {\n  return moment(date).subtract(subtract, 'd').format(MOMENT_DATE_FORMAT);\n}","import { Doc } from '../../modules/data/models'\nimport { GamifyRewards, getInitGamifyRewards } from '../habits/utilsHabits';\n\nexport const TYPE_TODO = 'todo';\n\nexport class Todo extends Doc {\n  name?: string;\n  note?: string;\n  type: string = TYPE_TODO;\n\n  done: boolean;\n  date: number|null;\n  tags: string[];\n\n\n  _new?: boolean; // for saving new docs, temp solution\n    //sub tasks\n  parent: string | null;\n  subTodos: string[];\n  showSubTodos: boolean;\n  showDone: boolean;\n\n  newRewards: GamifyRewards;\n  doneRewards: GamifyRewards;\n  \n  constructor(values: Object = {}) {\n    super();\n    this.done = false;\n    this.date = null;\n    this.tags = [];\n    this.parent = null;\n    this.subTodos = [];\n\n    this.showSubTodos = false;\n    this.showDone = false;\n\n    this.newRewards = getInitGamifyRewards();\n    this.doneRewards = getInitGamifyRewards();\n    \n    Object.assign(this, values);\n\n  }\n}","import { PROJECT_SERVICE, DIV, PROJECT_INDEX_SERVICE, LASTCHAR, ProjectItem } from './models';\nimport shortid from 'shortid';\nimport { env } from '../../env';\n\nexport const TYPE_SETTINGS = 'set';\n\nexport function getDefaultProject(userid): ProjectItem {\n  const uuid = 'u' + env.APP_ID + userid;\n  return {\n    id: generateProjectUUID(uuid, ''),\n    name: 'default',\n    access:[],\n    type: TYPE_SETTINGS,\n    updated: 0, //Date.now(),\n    [env.ACCESS_META_KEY]: genrateMetaData(userid), \n  }\n}\n\nexport function generateUUID():string {\n  let id;\n  let ok = false;\n  while (!ok) {\n    id = shortid.generate();\n    if(id.substring(0,1)!== '_' && id.substring(0,1)!== '-')\n      ok = true;\n  }\n\n  return id;\n}\n\nexport function getProjectChildId(id:string|undefined): string {\n  if(id === undefined) throw new Error('Id can not be undefined');\n  let length = PROJECT_INDEX_SERVICE.length + DIV.length;\n  return id.substring(0, id.length-length);\n}\n\nexport function getChannelFromProjectId(id: string|undefined):string {\n  return getProjectChildId(id);\n}\n\nexport function generateProjectUUID(id = generateUUID(), app = env.APP_ID):string {\n  return app + id +  DIV + PROJECT_INDEX_SERVICE;\n}\n\nexport function generateProjectChildId(projectId: string, type: string, id = generateUUID()):string {\n  return PROJECT_SERVICE+ DIV + projectId.split(DIV)[1] + DIV + type +\n          DIV + id;\n}\n\nexport function generateCollectionId(projectid: string|undefined, collection, id = generateUUID()): string {\n  if(projectid === undefined) throw new Error(\"Project can't be underfined\");\n  const length = PROJECT_INDEX_SERVICE.length;\n  return projectid.substring(0, projectid.length-length)+collection+ DIV +id; \n}\n\nexport const waitMS = (ms) => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\n\nexport function saveIntoArray(item: Object, ary: Array<any> = [], idKey: string = 'id'): Array<any> {\n  let i = getIndexById(item[idKey], ary, idKey);\n  if (i === -1) {\n    i = ary.length;\n  }\n  return [...ary.slice(0, i),\n  Object.assign({}, item),\n  ...ary.slice(i + 1)];\n}\n\nexport function genrateMetaData(userid:string):string[]{\n    return [ 'u'+ env.APP_ID + userid,]; \n}\n\n\n\nexport function getIndexById(id: string, ary: any, idKey: string = 'id'): number {\n  for (let i = 0; i < ary.length; i++) {\n    if (id === ary[i][idKey]) {\n      return i;\n    }\n  }\n  // if we don't have a match return null\n  return -1;\n}\n\nexport const extractTypeCollectionFromDocId = (id) => {\n  return id.split(DIV)[2];\n}","import { Subject } from 'rxjs';\nimport { ajaxResponse } from '../ajax/ajax';\nimport { toast } from 'react-toastify';\n\nexport interface ToastMessage {\n  message: string,\n  duration: number,\n  key?: number,\n}\n\nexport enum ToastType {\n  default = \"default\", \n  info = \"info\", \n  success = \"success\", \n  warning = \"warning\", \n  error = \"error\"\n}\n\n\nexport class ToastService {\n\n  public messages$ = new Subject<ToastMessage>();\n\n  showMessage(message: string, type:ToastType = ToastType.default, milliseconds: number = 3000) {\n    toast(message, {\n      type: type,\n      autoClose: milliseconds,\n    })\n  }\n\n  //TODO: for now only prints the first error\n  printServerErrors (res:ajaxResponse) {\n    const errors = res.errors || [];\n    if(errors.length > 0){\n      errors.forEach(err => this.showMessage(err.msg, ToastType.error))\n    }\n  }\n\n\n\n}\nexport const toastService = new ToastService();\n\n\n","import React, { useState } from 'react';\nimport { Todo, TYPE_TODO } from './models';\nimport {IonInput} from '@ionic/react';\nimport { generateCollectionId } from '../../modules/data/utilsData';\n\nconst TodoNewComp = ({parentId = undefined, saveFunc, projectId}:\n  {parentId: string|undefined, projectId: string|undefined, saveFunc: Function}) => {\n\n  const [state, setState] = useState({title:''});\n\n  //TODOS: testing....\n  const setNewTitle = (e) => {\n    setState({title: e.detail.value});\n  }\n\n  const onKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      save();\n      setState({title: ''});\n    }\n  }\n\n\n  const save = async () => {\n      const id = generateCollectionId(projectId, TYPE_TODO)\n      const newDoc = new Todo({id, name: state.title, parent: parentId, _new: true});\n      console.log('NEW TODO::::::::::::::: ', newDoc)\n      await saveFunc(newDoc, parentId);\n  };\n\n\n  return (\n    <IonInput\n            className=\"new-todo\"\n            placeholder=\"What needs to be done?\"\n            onKeyPress={onKeyPress}\n            onIonChange={setNewTitle}\n            value={state.title}\n    />\n  )\n\n\n}\n\nexport default TodoNewComp;","import React, { useState, useEffect } from 'react';\nimport { Todo } from './models';\nimport { DataFunctions } from './hooks/todos.hook';\nimport _ from 'lodash';\nimport { IonLabel, IonTextarea, IonButton, IonIcon, IonAlert } from '@ionic/react';\nimport './todo.edit.component.css';\nimport { sunny, star, heart, trash, basket, construct, close, checkmark } from '../../../node_modules/ionicons/icons';\n\nconst getDefaultState = (todo:Todo) =>  {\n  return {\n  todo: todo,\n  showDeleteWarrning: false,\n  text: mergeText(todo.name, todo.note)\n}}\n\nconst mergeText = (name: string|undefined, note: string|undefined): string => {\n  if(!name) name= '';\n  if(!note) \n    note = '';\n  else\n    note = '\\n'+note;\n  return name + note;\n}\n\n\n\nconst TodoEditInlineComponent = ({todo, tags, dataFunctions}: \n        {todo:Todo,  tags:string[], dataFunctions: DataFunctions}) => {\n  console.log(\"Edit Todo Render::: \", todo);\n\n  const [state, setState] = useState(getDefaultState(todo));\n\n  useEffect(() => {\n    setState(getDefaultState(todo));\n  }, [todo])\n\n  const handleTitleChange = (e) => {\n    const text = e.detail.value;\n    console.log(text);\n    var match = /\\r|\\n/.exec(text);\n    console.log('Title Chagne: ', text, match)\n    if(match){\n      const name = text.substring(0, match.index);\n      const note = text.substring(match.index+1);\n      const newDoc = {...state.todo, ...{name: name, note: note}}\n      const newState = {...state, ...{todo: newDoc, text: text}};\n      setState(newState);\n    }\n    else {\n      const newDoc = {...state.todo, ...{name: text, note: ''}}\n      const newState = {...state, ...{todo: newDoc, text: text}};\n      setState(newState);\n    }\n  }\n\n  const handleBlur = () => {\n    console.log(\"Saving todo::: \", state);\n    dataFunctions.save(state.todo);\n  }\n\n  const showRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: true}});\n  }\n\n\n  const hideRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: false}});\n  }\n\n  const remove = () => {\n    hideRemoveWarrning();\n    console.log('REMVE ACTION STATE::::::: ', state);\n    if(state.todo.id)\n      dataFunctions.remove(state.todo.id);\n  }\n\n  const printTag = (tag: string) => {\n    const color = (_.includes(state.todo.tags,tag))? 'success': 'light';\n    if(tag === 'today')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n                  <IonIcon  icon={sunny} />\n              </IonButton>);\n    if(tag === 'important')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n                  <IonIcon  icon={star} />\n              </IonButton>); \n    if(tag === 'tasks')\n    return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n                <IonIcon  icon={checkmark} />\n            </IonButton>);\n    if(tag === 'wish')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n                <IonIcon  icon={heart} />\n            </IonButton>); \n    if(tag === 'buy')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n              <IonIcon  icon={basket} />\n          </IonButton>);\n    if(tag === 'projects')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n              <IonIcon  icon={construct} />\n          </IonButton>);\n  }\n\n\n  const handleTagChange = (tag: string) => {\n    if(!state.todo.tags) state.todo.tags = [];\n\n    const res = _.find(state.todo.tags, t=>t===tag);\n    let newtags;\n    if(_.isUndefined(res)){\n      newtags = _.concat(state.todo.tags, tag);\n    }\n    else {\n      newtags = _.filter(state.todo.tags, t=>t!==tag);\n    }\n    dataFunctions.save(Object.assign(state.todo, {tags: newtags}));\n  }\n\n\n  return (\n\n    <div className=\"\">\n        \n        \n        <div className=\"todoEditInlineIconScrollParent\">\n          { tags.map(tag => printTag(tag)) }\n        </div>\n        <IonTextarea \n            placeholder=\"Enter todo title and note here\"\n            name=\"note\"\n            class=\"todoEditInlineTextArea\"\n            autoGrow={true}\n            onIonBlur={handleBlur}\n            onIonChange={handleTitleChange}\n            value={state.text}></IonTextarea>\n        \n        \n        <div>\n          <div className=\"todoButtonsLeftAlign\">\n              <IonButton size=\"small\"  fill=\"clear\" color=\"secondary\" onClick={()=>{dataFunctions.select(null)}}>\n                  <IonIcon  icon={close} /><IonLabel>Close</IonLabel>\n              </IonButton>\n          </div>\n          <div className=\"todoButtonsRightAlign\">\n              <IonButton size=\"small\"  fill=\"clear\" color=\"danger\" onClick={showRemoveWarrning}>\n                  <IonIcon  icon={trash} /><IonLabel>Delete</IonLabel>\n              </IonButton>\n          </div>\n        </div>\n        <div className=\"todoInlineEditPadding\"> </div>   \n\n\n\n\n\n\n        <IonAlert\n            isOpen={state.showDeleteWarrning}\n            onDidDismiss={() => hideRemoveWarrning}\n            header={'Warrning!!!'}\n            message={'Are you sure you want to <strong>delete</strong> this task and its sub-tasks?'}\n            buttons={[\n              {\n                text: 'Cancel',\n                role: 'cancel',\n                cssClass: 'secondary',\n                \n              },\n              {\n                text: 'Yes Im Sure',\n                handler: () => remove()\n              }\n            ]}\n          />\n    </div>\n\n  );\n\n}\n\nexport default TodoEditInlineComponent;","import Dexie from 'dexie';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { DataChangeEvent } from '../dataService';\nimport { Subscription } from 'rxjs';\nimport { env } from '../../../env';\n\nexport interface DatabaseScheme {\n  name: string,\n  version: number,\n  tables: TableScheme[],\n}\n\nexport interface TableScheme {\n  name: string,\n  columns: string,\n}\n\n\nexport default class DexieAdapter {\n\n  private db;\n  private _ready = false;\n  public ready$ = new BehaviorSubject(this._ready);\n  private _subscriptions:Subscription[] = [];\n\n  public changes$ = new Subject<DataChangeEvent>();\n\n  constructor(scheme: DatabaseScheme) {\n    this.db = new Dexie(env.APP_ID +  scheme.name+ '_dexie');\n    const stores = {};\n    scheme.tables.forEach(t => {\n      stores[t.name] = t.columns;\n    });\n    console.log('Dexie scheme: ', scheme, stores)\n    this.db.version(scheme.version).stores(stores);\n    this._init();\n  }\n\n  private async _init() {\n    console.log('Dexie init');\n    try {\n      await this.db.open();\n      this._ready = true;\n      this._subscribe();\n      this.ready$.next(true);\n    }\n    catch(e) {\n      console.log(e);\n    }\n  }\n\n  private async _subscribe() {\n    /*\n   this.db.on('changes', (changes) => {\n      console.log('#####################################################', changes); \n      changes.forEach(change => {\n        switch (change.type) {\n          case 1: // CREATED\n            this.changes$.next({doc: change.obj})\n            break;\n          case 2: // UPDATED\n            this.changes$.next({doc: change.obj, old: change.oldObje})\n          \n            break;\n          case 3: // DELETED\n            \n            break;\n  \n        }\n      }); \n    });\n    */\n  }\n\n  public async destroy() {\n    this._subscriptions.forEach(sub => {\n      if(sub)sub.unsubscribe();\n    })\n  }\n\n  public async getDoc(id: string, collection: string): Promise<any> {\n    console.log('Dexie getting doc::: ', id, collection);\n    //const res = await this.db[collection].where('id').equals(id).first();\n    const res = await this.db[collection].get({id});\n    console.log('=========================', res);\n    if(res) return res;\n    return null;\n  }\n\n  public async getBulk(ids: string[], collection: string): Promise<any> {\n    console.log('BULK GET: ', ids, collection);\n    const res = await this.db[collection].bulkGet(ids);\n    console.log(res);\n    return res.filter(doc => doc !== undefined)\n  }\n\n  public async queryByProperty(field: string, operator: string, \n      value: any, collection: string): Promise<any> {\n    console.log('%%%%%%%%%%%%%%%%% Dexie Query By Property::: ', \n        field, operator, value, collection);\n    switch(operator) {\n      case 'equals':\n        return await this.db[collection].where(field).equals(value).toArray();\n      case 'startsWith':\n        return await this.db[collection].where(field).startsWith(value).toArray();\n      case 'notEqual':\n        return await this.db[collection].where(field).notEqual(value).toArray();\n      default:\n        throw new Error('Missing proper operator, given: '+ operator);\n    }\n  }\n\n  public async getProjectItems(projectid: string, collection: string) {\n    console.log('Get Project items: ', projectid, collection);\n    const res = await this.db[collection].where('id').startsWith(projectid).toArray();\n    console.log(res);\n    return res;\n  }\n\n  public async save(doc: any, collection: string, setDirty = true){\n    console.log('---------------------------      Dexie Save: ', doc, collection);\n    if(setDirty)\n      doc.dirty = 1;\n    const res = await this.db[collection].put(doc);\n    console.log('SAVE RES: ', res);\n    if(res) {\n      this.changes$.next({doc});\n      return true\n    }\n    return false;\n  }\n\n  public async saveFromSync(docs: any[], collection: string){\n    console.log('&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&');\n    console.log('Save form Sync::: ', docs, collection);\n    const res = await this.db[collection].bulkPut(docs);\n\n    console.log('SAVE RES: ', res);\n    if(res) {\n      //this.changes$.next({doc});\n      docs.forEach(doc => {\n        this.changes$.next({doc});\n      })\n      return true\n    }\n    return false;\n  }\n\n\n}","import { Doc, ProjectItem } from \"../data/models\";\nexport const TYPE_PARTY = 'party';\n\n\nexport interface PartyMember {\n  id: string,\n  username: string,\n  rights: string\n}\n\n\nexport class PartyProject extends ProjectItem {\n  type: string = TYPE_PARTY\n  creator: string = '';\n  dirty: number = 0;\n  members: PartyMember[]  = []\n\n  constructor(values: Object = {}) {\n    super()\n    Object.assign(this, values);\n  }\n}\n","\n\nclass LocalStorageService {\n  \n  async getItem(id: string){\n    return localStorage.getItem(id);\n  }\n\n  async getString(id: string):Promise<string>{\n    let val:string;\n    val = localStorage.getItem(id) || '';\n    return val;\n  }\n\n  async getObject(id: string):Promise<object|null> {\n    const val = localStorage.getItem(id);\n    if(!val)return null;\n    return JSON.parse(val);\n\n  }\n\n  async setObject(id: string, val: object):Promise<boolean> {\n    try {\n      const str = JSON.stringify(val);\n      await localStorage.setItem(id, str);\n      return true;\n    }\n    catch(e){\n      console.log(e);\n      return false;\n    }\n    \n\n  }\n\n\n\n  async setString(id: string, val: string) {\n    localStorage.setItem(id, val);\n  }\n  \n}\n\nconst localStorageService = new LocalStorageService();\n\nexport default localStorageService;","import axios from 'axios';\nimport { getNested } from '../../utils';\nimport { loadingService } from '../loading/loadingService';\n\n\n\nexport interface ajaxResponse {\n  success: boolean,\n  data: any,\n  status?: number,\n  errors?: errorMessage[]\n}\n\n\nexport const getAjaxMessage = (success:boolean, data:any, \n    status:number = 0, errors: errorMessage[] = []): ajaxResponse => {\n  return {success, data, status, errors}\n}\n\nexport const getAjaxErrorMessage = (errorMessage: string, \n  location='system', status:number = 404 ) => {\n    return getAjaxMessage(false, null, status, \n      [{location, msg:errorMessage}])\n}\n\nexport interface errorMessage {\n  location: string,\n  msg: string\n}\n\nexport interface postRequest {\n  url: string,\n  type: string,\n  form: object,\n  options?: object,\n}\n\nexport interface getRequest {\n  url: string,\n  type: string,\n  form: object,\n  options?: object,\n}\n\nexport const getPostRequest = (url:string, form:object, options:object = {}, ) => {\n    return {url, type:'post', form, options};\n}\n\n\n\nexport const getErrorMessage = (msg: string, location:string = \"Server\"):errorMessage => {\n  return {msg, location};\n}\n\nexport const post = async (req: postRequest, showLoading = true, loadingMessage=\"Loading...\"):Promise<ajaxResponse> => {\n  try {\n    if(showLoading)\n      loadingService.showLoading(loadingMessage);\n    console.log(req);\n    const res = await axios.post(req.url, req.form, req.options);\n\n    loadingService.hideLoading();\n    console.log(res);\n    return getAjaxMessage(true, res.data, 200);\n  }\n  catch(err) {\n    loadingService.hideLoading();\n    //console.log(err.response);\n    const response = getNested(err, 'response');\n    if(!response || !response.status) {\n      return getAjaxMessage(false, null, 503, [getErrorMessage(\"Service is temporarly unavailable\")]);\n    }\n    else if(response.status === 422){\n      return getAjaxMessage(false, null, response.data.status, response.data.errors);\n    }\n    else if(response.status === 404) {\n      return getAjaxMessage(false, null, 404, [getErrorMessage(\"Could not connect to server\")]);\n    }\n    else {\n      return getAjaxMessage(false, null, response.status, [getErrorMessage(\"Could not connect to server\")]);\n    }\n  }\n}\n","\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport * as moment from 'moment';\nimport { isEqual } from 'lodash';\nimport anylogger from 'anylogger';\nimport localStorageService from '../localStorage/localStorageService';\nimport {env} from '../../env';\nimport  { getPostRequest, post, ajaxResponse } from '../ajax/ajax';\nimport { toastService } from '../toast/toastService';\n\n\nconst log =  anylogger('auth: authService');\n\n\n\nexport enum AuthStatus {\n  Loading, \n  Guest, //not loged in\n  User // loged in\n}\n\n\nexport const GUEST = 'Guest';\nexport const AUTH_USER_KEY = 'auth-user-key';\nexport interface AuthEvent {\n  success: boolean;\n  code: number;\n  data: any;\n}\n\nexport interface User {\n  id: string,\n  username: string;\n  email: string|null;\n  token: string|null;\n  token_expiery: number|null;\n  channels: any[];\n}\n\n\n\nexport const getUser = (values: any):User => {\n  if(values == null)\n    return {\n      id: 'guest',\n      username: GUEST,\n      email: null,\n      token: null,\n      token_expiery: null,\n      channels: []\n    }\n\n  return {\n    id: values.id || 'guest',\n    username: values.username || GUEST,\n    email: values.email||null,\n    token: values.token||null,\n    token_expiery: values.token_expiery||values.expires||null,\n    channels: values.channels|| []\n  }\n}\n\nexport const isGuest = (user:User) => {\n  return user.username === GUEST;\n}\n\nexport function getGuestUser(username:string = 'Guest'):User {\n  return getUser({ username });\n}\n\n\nexport class AuthService {\n  private _user:User = getGuestUser('null');\n  //private _authReady = false;\n  //public authReady$ = new BehaviorSubject(this._authReady);\n  //private _isAuthenticated = false;\n  //public isAuthenticated$  = new BehaviorSubject(false);\n\n  private _authStatus = AuthStatus.Loading;\n  \n  public authStatus$ = new BehaviorSubject(this._authStatus);\n  \n  public username$ = new Subject<string>();\n\n  constructor() {\n    this.loadAuth();\n  }\n\n  getIsAuthenticated():boolean { return this._authStatus === AuthStatus.User; }\n  getUsername() { return this._user.username; }\n  getEmail() { return this._user.email;}\n  getUser() { return this._user };\n\n\n  async updateUser(user: User, forceLogout = false) {\n    // log.info('Userupdate: ', user, forceLogout, this._authStatus);\n    if(!isGuest(user) || this._user.username ==='null') {\n\n      if(this._authStatus !== AuthStatus.User) {\n        this.setAuthStatus(AuthStatus.User);\n      }\n\n      if(user.username !== this._user.username){\n        this._user = user;\n        await localStorageService.setObject(AUTH_USER_KEY, user)\n        this.username$.next(user.username);\n      }\n\n      if(!isEqual(this._user, user)) {\n        this._user = user;\n        await localStorageService.setObject(AUTH_USER_KEY, user)\n      }\n      \n      return;\n    }\n\n    if(this._authStatus !== AuthStatus.Guest){\n      this.setAuthStatus(AuthStatus.Guest)\n  \n      if(forceLogout){\n        await localStorageService.setObject(AUTH_USER_KEY, getGuestUser);\n      }\n    }\n  }\n\n\n\n\n  async loadAuth() {\n    log.info('----------------- Check login');\n    try {\n      const user = getUser(await localStorageService.getObject(AUTH_USER_KEY));\n      log.info('LOADED USER', user);\n\n      if(!user.token || !user.token_expiery) {\n        return this.updateUser(getGuestUser());\n      }\n\n      log.info('LOADED USER', user);\n\n      const exp = moment.unix(user.token_expiery);\n      if(exp.isAfter(moment.now())) {\n        log.info('TOKEN VALID');\n        return this.updateUser(user);\n      }\n      else {\n        log.warn('TOKEN is old');\n        return this.updateUser(getGuestUser())\n      }\n    }\n    catch(e) {\n      log.error(e);\n      return this.updateUser(getGuestUser())\n    }\n  }\n\n\n  public async loginAndRedirect(id: string, password: string, history, location) {\n    console.log('LoginWithRedirect:: ');\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/login',\n      { id, password, app: env.APP_ID },), true,  'Login in, please wait');\n\n      console.log(\"Login RES: \", res);\n      if(res.success) {\n        this.updateUser(getUser(res.data))\n        console.log(\"LOGIN LOCATION:::: \", location, history);\n\n        let next;\n        if(location && location.state && location.state.prev){\n          next = location.state.prev.startsWith('/auth/')? '/': location.state.prev;\n        }\n\n        history.push(next || '/');\n      }\n      else {\n        console.log(res);\n        toastService.printServerErrors(res);\n      }\n  }\n\n  public async logout() {\n    \n  }\n\n  public async login(id: string, password: string):Promise<ajaxResponse> {\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/login',\n      { username: id, password: password, app: env.APP_ID }, {}), true,  'Login in, please wait');\n\n    return res;\n  }\n\n\n  public async renewToken() {\n    console.log(\"Renew Token\");\n    const res = await post(getPostRequest(env.AUTH_API_URL+'/auth/renewToken',\n                          {token: this._user.token}), false);\n    console.log(res);\n    if(res.success){\n      await this.updateUser({...this._user, ...{token: res.data.token, \n                                channels: res.data.channels,\n                                token_expiery: res.data.expires}})\n      //console.log('Token updated: ', res.data.token);\n      console.log('NEW USER:: ', this._user);\n      return true;\n    }\n    else {\n      console.log('Token updated error: ', res);\n      //is it bad token, or just no internet\n      if(res.status && res.status === 422){\n        await this.updateUser(getGuestUser());\n        return false;\n      }\n    }\n\n\n  }\n\n  public async register(username:string, email: string, password: string): Promise<boolean> {\n    console.log('Register:: ');\n    const res = await post( getPostRequest(env.AUTH_API_URL+'/auth/register',\n                      { username, password, email }),\n                      true,  'Registering, please wait');\n\n    console.log(\"Registering RES: \", res);\n\n    if(res.success) {\n        return true;\n    }\n    else {\n      console.log(res);\n      toastService.printServerErrors(res);\n      return false;\n    }\n  }\n\n  public async forgotPassword() {\n    //const res = await this.http.post(environment.auth_api+'/auth/forgotpassword'\n  }\n\n\n  private setAuthStatus(status:AuthStatus){\n    this._authStatus = status;\n    this.authStatus$.next(status);\n  }\n\n  public getAuthStatus():AuthStatus {\n    return this._authStatus;\n  }\n\n  public getToken():string {\n    return this._user.token || '';\n  }\n\n  public get userid(): string {\n    return this._user.id || '';\n  }\n\n\n\n}\nexport const authService = new AuthService();\n\n\n\n\n\n/*\nexport function createAuthEvent(success: boolean = true,\n  code = 1,\n  data = {}): AuthEvent {\n  return {\n    success, code, data\n  };\n}\n*/\n\n","import { post, getPostRequest } from '../ajax/ajax';\nimport { DIV } from './models';\nimport localStorageService from '../localStorage/localStorageService';\n\nexport interface SyncDataChannel {\n  name: string,\n  docs: any[],\n}\n\n\nexport const organizeData = async (data: any[]) => {\n  \n  const channels = {};\n  let channel;\n\n  data.forEach(doc => {\n    channel = doc.id.split(DIV)[0];\n    console.log(doc);\n    if(!channels[channel]) channels[channel] = [];\n    channels[channel].push({...{}, ...doc});\n\n  });\n  //now load channel checkpoints\n  const checkpoints = await localStorageService.getObject('channel_checkpoints') || {};\n  return {channels: channels, checkpoints};\n}\n\nexport const syncData = async (props:{  data:any[],\n                                        syncurl: string, \n                                        token: string, \n                                        checkpoint: number,\n                                        requestMaxSize:number}) => {\n  //TODO: check our size of docs, if its bigger than max size\n  console.log('Starting to server sync: ', props);\n  try {\n    //get checkpoint\n    const data =  await organizeData(props.data);\n    console.log('************************* ', data);\n    const res = await post(getPostRequest(props.syncurl + '/sync/sync', {\n      token: props.token,\n      checkpoint: props.checkpoint,\n      data,\n    }));\n\n    if(res) {\n      //first save channel checkpoints\n      const keys = Object.keys(res.data.checkpoints);\n      //merge the 2 checkpoints\n      const chpoints = await localStorageService.getObject('channel_checkpoints') || {};\n      await localStorageService.setObject('channel_checkpoints',{...chpoints, ...res.data.checkpoints})\n\n      return res.data.types;\n    }\n     \n    return null;\n\n  }\n  catch(e){\n    console.log(e);\n   }\n}\n\n","import { Observable, Subject, BehaviorSubject } from 'rxjs';\nimport { map, debounceTime, filter, throttleTime } from 'rxjs/operators';\nimport {  getProjectChildId,  generateCollectionId, TYPE_SETTINGS, waitMS } from './utilsData';\n\nimport { ProjectItem, DIV } from './models';\nimport _ from 'lodash';\nimport DexieAdapter, { DatabaseScheme } from './adapters/dexie';\nimport { TYPE_HABBIT } from '../../pages/habits/models';\nimport { TYPE_TODO } from '../../pages/todo/models';\nimport { TYPE_PARTY } from '../parties/models';\nimport { TYPE_MSG } from '../messages/models';\nimport { env } from '../../env';\nimport { authService } from '../auth/authService';\nimport localStorageService from '../localStorage/localStorageService';\nimport { syncData } from './sync';\nimport { loadingService } from '../loading/loadingService';\nimport { post, getPostRequest, getAjaxErrorMessage } from '../ajax/ajax';\n\nexport interface DataChangeEvent {\n  doc: any,\n  old?: any\n}\n\nconst databaseScheme: DatabaseScheme =  {\n  name: 'guest_dx',\n  version: 4,\n  tables: [\n    {\n      name: TYPE_SETTINGS,\n      columns: 'id, dirty'\n    },\n    {\n      name: TYPE_PARTY,\n      columns: 'id, dirty, party, type'\n    },\n    {\n      name: TYPE_TODO,\n      columns: 'id, done, deleted, parent, *tags, dirty'\n    },\n    {\n      name: TYPE_HABBIT,\n      columns: 'id, dirty'\n    },\n    {\n      name: TYPE_MSG,\n      columns: 'id, messageType, parent, dirty'\n    },\n  ]\n}\n\n\n\nclass DataService {\n  private db;\n  private authId:string = '';\n  private _ready = false;\n  public _ready$ = new BehaviorSubject(this._ready);\n  public addSyncCall$ = new Subject(); // do we need to sync with server\n\n  constructor() {\n    //subscriptions\n    this.addSyncCall$.pipe(\n      throttleTime(5000),\n    ).subscribe(() => {\n        this._syncRemote();\n      })\n  }\n\n  // access\n  async getDoc(id: string,  collection: string): Promise<any> {\n    console.log('Get Doc: ', id, collection);\n    return await this.db.getDoc(id, collection);\n  }\n\n  async getBulk(ids: string[], collection: string): Promise<any> {\n   return await this.db.getBulk(ids, collection);\n  }\n\n  /*\n    operators: equals, \n               startsWith,\n               above,\n               below,\n               notEqual\n\n  */\n  async queryByProperty(field:string, operator: 'equals'|'startsWith'|'notEqual', \n      value: any, collection: string): Promise<any> {\n    return await this.db.queryByProperty(field, operator, value, collection);\n  }\n\n\n  async getAllByProject(projectid, collection): Promise<any> {\n    return await this.db.getProjectItems(getProjectChildId(projectid) + DIV, collection);\n  }\n\n\n  async save(doc:any, collection: string, props:{project?: ProjectItem, \n    oldDoc?: any,remoteSync?:boolean} = {}): Promise<any> {  \n    \n      if(!props) props = {remoteSync: true};\n    \n      try {\n        let oldDoc = {};\n        if (doc.id && props.oldDoc == null) {\n          oldDoc = await this.getDoc(doc.id, collection);\n        }\n    \n        console.log('Checking if no changes made: ', oldDoc);\n        if (_.isEqual(oldDoc, doc)) {\n          console.log('No changes, skip saving');\n          return false; \n        }\n    \n        if(!doc.id) {\n          if(!props.project) throw new Error('Saving new doc requires valid props.project')\n            // @ts-ignore:  we made this check at the begining\n          doc.id = generateCollectionId(props.project.id, collection);\n          doc.created = Date.now();\n          // doc.updated = Date.now();\n        }\n        //doc.updated = Date.now();\n        doc.dirty = true;\n        //res = await this._pouch.put({ ...oldDoc, ...doc });\n\n        const res = await this.db.save(doc, collection);\n\n        if (props.remoteSync)\n          this.addSyncCall$.next();\n\n\n        console.log('Saved doc: ', res);\n        if (res.ok)\n          return res;\n        else\n          return false;\n        }\n      catch (e) {\n        console.log('Save Pouch Error: ', e);\n        return false;\n      }\n  }\n\n  \n\n  \n\n\n  async saveNewProject(project:ProjectItem, collection: string): Promise<any> {\n    \n    const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/addNewChannel',\n                      {token: authService.getToken(), \n                       doc: project,\n                       name: project.name}, {} ),  false) ;\n    console.log(res);\n    if(!res.success)\n      return res;\n\n    const channel = res.data.channel;\n    let gotNewRightsToken = false;\n    let tokenres;\n    while(!gotNewRightsToken){\n      tokenres = await authService.renewToken();\n      console.log('Token Res::::::: ', tokenres);\n      console.log(authService.getUser(), channel);\n\n      const user = authService.getUser();\n      if(user.channels[channel]){\n        gotNewRightsToken = true;\n      }\n      else {\n        await waitMS(2000);\n      }\n    }\n    return await this.db.save(res.data.doc, collection, false);\n  }\n\n\n\n  public async remove(id: string, collection: string, remoteSync:boolean = true) {\n    try {\n      const doc = this.getDoc(id, collection);\n      if(!doc) return false;\n      const res =  this.db.save({...doc, ...{deleted: true}});\n      console.log(res);\n      if (remoteSync)\n        this.addSyncCall$.next();\n\n\n      return res;\n    }\n    catch(e) {\n      console.log(e);\n      return null;\n    }\n  }\n\n  public async removeProject() {\n\n    /*\n    try {\n      //load all project children and remove them\n      //TODO, on server side, if notice project deleted, make sure all server children are also deleted\n      const res = await this._pouch.allDocs({\n        include_docs: true,\n        startkey: getProjectChildId(project._id),\n        endkey: getProjectChildId(project._id) + LASTCHAR\n      });\n      const docs = res.rows.map(row => Object.assign(\n        row.doc, { _deleted: true, updated: Date.now() }));\n\n      docs.push(Object.assign(project, { _deleted: true, updated: Date.now() }));\n      const res2 = await this._pouch.bulkDocs(docs);\n\n      if (syncRemote)\n        this.addSyncCall$.next();\n\n      return res2;\n    }\n    catch (e) {\n      console.log('Remove Project Error: ', e);\n    }\n    */ return false;\n  }\n\n\n\n  // streams\n\n  subscribeChanges(debounce = 0): Observable<any> {\n    return this.db.changes$.asObservable().pipe(\n      debounceTime(debounce),\n      map((change:DataChangeEvent) => change.doc )\n    );\n  }\n  \n\n  subscribeDocChanges(id: string, debounce: number = 0): Observable<any> {\n    return this.db.changes$.asObservable().pipe(\n      debounceTime(debounce),\n      filter((change: DataChangeEvent) => change.doc.id === id),\n      map((change: DataChangeEvent) => change.doc)\n    );\n  }\n\n\n\n  subscribeProjectCollectionChanges(projectid: string|undefined,\n    type: string,\n    debounce: number = 0): Observable<any> {\n    if(projectid === undefined) \n      throw new Error('Project id, can not be undefined, can not subscribe to id') ;\n    const projectChildId = getProjectChildId(projectid);\n    return this.db.changes$.asObservable().pipe(\n      debounceTime(debounce),\n      \n      filter((change: DataChangeEvent) => { \n        console.log('%%%%%%%%%%%%%%%%%%%%%',change, projectChildId + DIV  + type + DIV)\n        return change.doc.id.startsWith(projectChildId + DIV + type + DIV);\n      }),\n      map((change: DataChangeEvent) => change.doc)\n    ); \n  }\n\n\n\n  // internal\n  public get ready() {\n    return this._ready;\n  }\n\n  public getReadySub() {\n    return this._ready$;\n  }\n\n  public set ready(value: boolean) {\n    this._ready = value;\n    if(value) // only send if true, this way we can have one time listeners\n      this._ready$.next(value);\n  }\n\n\n  public async init(authid: string , syncRemote = true) {\n    console.log('Init DB')\n    const scheme = databaseScheme;\n    scheme.name = authid;\n    this.db = new DexieAdapter(scheme);\n    const dbSub = this.db.ready$.subscribe(ready => {\n      console.log('Dexie Sub: ', ready);\n      if(!ready) return;\n\n      this.ready = true;\n      if (syncRemote)\n        this.addSyncCall$.next();\n\n      dbSub.unsubscribe();\n      \n    });\n  }\n\n  private async _syncRemote() {\n    //get check point\n    console.log('DATASERVICE:::&&&&&&&&&&&&&&&&&&&&&&&&&&&&::::::::::START');\n    let ck = Number(await localStorageService.getItem('SYNC_CHECKPOINT'));\n    if(!ck) ck = 0; \n    \n    //get data\n    //go thought all the tables and get dirty docs\n    let docs: any[] = [];\n    for(let i = 0; i < databaseScheme.tables.length; i++) {\n      console.log('Loading changes from: ', databaseScheme.tables[i].name);\n      const res = await this.db.queryByProperty('dirty', 'equals', 1, databaseScheme.tables[i].name);\n      console.log(databaseScheme.tables[i].name, res);\n      docs.push(...res);\n    }\n    console.log('DOCS TO SYNC **********************', docs);\n    const res = await syncData({  data: docs, \n                                  syncurl: env.SYNC_SERVER,\n                                  token: authService.getToken(),\n                                  checkpoint: 0,\n                                  requestMaxSize: 1000});\n    //save checkpoint\n    if(res) {\n      console.log('Sync finished::: ', res);\n      const keys = Object.keys(res);\n      console.log(keys);\n      for(let i = 0; i < keys.length; i++){\n        await this.db.saveFromSync(\n          res[keys[i]].map(doc => Object.assign(doc, {dirty: 0})), \n          keys[i]);\n      }\n    }\n\n  }\n\n\n\n}\n\nexport const dataService = new DataService();\n","\n\nexport const TYPE_MSG = 'msg';\n\nexport interface Msg {\n  id:string,\n  to:string, \n  from:string, \n  type:string, \n  message:string, \n  data: any\n  replied?: {accepted: boolean, date:number},\n  deleted?: boolean\n}","import { Todo } from \"../../pages/todo/models\";\nimport moment from 'moment';\nimport { TODO_DONE_GOLD_REWARDS, TODO_DONE_EXPERIENCE_REWARDS } from \"./gamifyService\";\n\n\nexport const calculateLevelExperience = (level:number): number => {\n  let exp = 0;\n    for(let x = 1; x < level; x++){\n      exp += Math.floor((x+100) * Math.pow(2,(x/7)))\n    }\n  return Math.floor(exp/4);\n}\n\nexport const HEALTH_BASE = 50;\nexport const calculateLevelHealth = (level:number): number => {\n  let exp = HEALTH_BASE;\n    for(let x = 1; x < level; x++){\n      //console.log(Math.floor((x+150) * Math.pow(2,(x/50))));\n      exp += Math.floor(5 + (x/3));\n    }\n  return exp;\n}\n\nexport const HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE = 0.2;\nexport const HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE = 0.1;\nexport const calculateDoneTodoGold = (todo:Todo): number => {\n\n  let days = 0;\n  //how many days past\n  if(todo.date)\n    days = moment(todo.date).diff(moment(),'hour');\n\n  console.log('Diff Days::: ', days)\n  \n  const rew =TODO_DONE_GOLD_REWARDS + (HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE * days);\n\n  return Math.floor(rew);\n\n\n}\n\nexport const calculateDoneTodoExperience = (todo:Todo): number => {\n\n  let days = 0;\n  //how many days past\n  if(todo.date)\n    days = moment(todo.date).diff(moment(),'hour');\n\n  console.log('Diff Days::: ', days)\n  \n  const rew =TODO_DONE_EXPERIENCE_REWARDS + \n    (HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE * days);\n\n  return Math.floor(rew);\n\n\n}\n\n\n","import { BehaviorSubject } from 'rxjs';\nimport { toast } from 'react-toastify';\nimport { Todo } from '../../pages/todo/models';\nimport { Habit, HabitProgress } from '../../pages/habits/models';\nimport { saveIntoArray, waitMS } from '../../utils';\nimport { dataService } from '../data/dataService';\nimport { calculateLevelExperience, calculateDoneTodoGold, calculateDoneTodoExperience } from './utilsGamify';\nimport { throttleTime } from '../../../node_modules/rxjs/operators';\nimport { isEqual } from 'lodash';\nimport { getInitGamifyRewards } from '../../pages/habits/utilsHabits';\nimport { generateCollectionId, genrateMetaData, TYPE_SETTINGS, getDefaultProject } from '../data/utilsData';\nimport { env } from '../../env';\nimport { authService } from '../auth/authService';\n\n\nexport const HABIT_REWARDS_GOLD_BASE = 5;\nexport const HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE = 0.2;\nexport const HABIT_REWARDS_EXPERIENCE_BASE = 3;\nexport const HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE = 0.2;\nexport const HABIT_REWARDS_NEW_GOLD = 5;\nexport const HABIT_REWARDS_NEW_EXPERIENCE = 5; \n\nexport const TODO_NEW_GOLD_REWARDS = 1;\nexport const TODO_DONE_GOLD_REWARDS = 3;\nexport const TODO_NEW_EXPERIENCE_REWARDS = 2;\nexport const TODO_DONE_EXPERIENCE_REWARDS = 5;\n\nexport const MESSAGE_DURATION = 3000;\n\nexport interface GamifyState {\n  health:number,\n  maxHealth: number,\n  experience: number,\n  maxExperience: number,\n  level: number,\n  gold: number,\n\n  items: any[],\n}\n\nexport const getInitGamifyState = () => {\n  return {\n    health: 50,\n    maxHealth: 50,\n    experience: 0,\n    maxExperience: 20,\n    level: 1,\n    gold: 0,\n\n    items:[]\n  }\n}\n\nexport class GamifyService {\n\n  private _userId = '';\n  private _subscriptions:any[] = [];\n  private _state: GamifyState = getInitGamifyState();\n  \n  public state$ = new BehaviorSubject<GamifyState>(this._state);\n  \n\n  public async init(userid: string) {\n    console.log('-------------Gamify INIT', userid);\n    this.unsubscribe();\n    this._userId = userid;\n    const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n      if(!ready) return;\n\n      const doc = await this.loadInitDocs(userid);\n      console.log('GAMIFY DOC:::: ', doc);\n\n      const sub = this.state$.pipe(throttleTime(10000)).subscribe(()=>{\n        this._save();\n      })\n  \n      const sub2 = dataService.subscribeDocChanges(this.getGamifyDocId() ,1000)\n        .subscribe(doc => {\n          console.log(\"DOC================================\", doc);\n          const equal = isEqual(this._state, doc.state);\n          console.log(\"Gamify State Equal: \", equal);\n          if(!equal)\n            this.state = doc.state;\n        });\n  \n      this._subscriptions.push(sub);\n      this._subscriptions.push(sub2);\n  \n      //load the init stae\n      if(doc)\n        this.state = doc.state;\n\n      dataSub.unsubscribe();\n    })\n  }\n\n\n\n  private unsubscribe() {\n    this._subscriptions.forEach(s=>{\n      if(s)s.unsubscribe();\n    })\n  }\n\n  public calculateFinishedTodoRewards = (todo: Todo): Todo => {\n    if(!todo.doneRewards || !todo.doneRewards.gold){\n      todo.newRewards = getInitGamifyRewards({\n        gold: calculateDoneTodoGold(todo),\n        experience: calculateDoneTodoExperience(todo),\n        item: null\n      });\n    }\n\n    if(todo.done){\n      // @ts-ignore: top, just added values\n      this.addGold(todo.newRewards.gold);\n      // @ts-ignore: \n      this.messageReceivedGold(todo.newRewards.gold)\n      // @ts-ignore: top, just added values\n      this.addExperience(todo.newRewards.experience);\n      // @ts-ignore:\n      this.messageReceivedExperience(todo.newRewards.experience)\n    }\n    else {\n      // @ts-ignore: top, just added values\n      this.addGold(todo.newRewards.gold * -1);\n      // @ts-ignore: \n      this.messageLostGold(todo.newRewards.gold)\n      // @ts-ignore: top, just added values\n      this.addExperience(todo.newRewards.experience * -1);\n      // @ts-ignore:\n      this.messageLostExperience(todo.newRewards.experience)\n    }\n\n    return {...{}, ...todo};\n  }\n\n  public calculateNewTodo = (todo: Todo): Todo => {\n    todo.newRewards = getInitGamifyRewards({\n      gold: TODO_NEW_GOLD_REWARDS,\n      experience: TODO_NEW_EXPERIENCE_REWARDS,\n      item: null,\n    });\n\n    // @ts-ignore: top, just added values\n    this.addGold(todo.newRewards.gold);\n    // @ts-ignore: \n    this.messageReceivedGold(todo.newRewards.gold)\n    // @ts-ignore: top, just added values\n    this.addExperience(todo.newRewards.experience);\n    // @ts-ignore:\n    this.messageReceivedExperience(todo.newRewards.experience)\n\n    return {...{} ,...todo};\n  }\n\n  public calculateNewHabitRewards = (habit:Habit): Habit => {\n    habit.newRewards = getInitGamifyRewards({\n      gold: HABIT_REWARDS_NEW_GOLD,\n      experience: HABIT_REWARDS_NEW_EXPERIENCE,\n      item: null,\n    });\n\n    // @ts-ignore: top, just added values\n    this.addGold(habit.newRewards.gold);\n    // @ts-ignore: \n    this.messageReceivedGold(habit.newRewards.gold)\n    // @ts-ignore: top, just added values\n    this.addExperience(habit.newRewards.experience);\n    // @ts-ignore:\n    this.messageReceivedExperience(habit.newRewards.experience)\n\n    return {...{}, ...habit};\n  }\n\n  private addGold(value:number) {\n    this.state = {...this._state, ...{gold: this._state.gold + value}};\n  }\n\n  private addExperience(value: number) {\n    let experience = this._state.experience + value;\n    \n    if(experience > this._state.maxExperience){\n      experience = (this._state.maxExperience - experience) * -1;\n      this._state = {...this._state, \n        ...{maxExperience: calculateLevelExperience(this._state.level+1),\n            level: this._state.level + 1}}\n    }\n      \n    \n    this.state = {...this._state, ...{experience}}\n  }\n\n  public calculateHabitProgressRewards(habit:Habit, progress: HabitProgress): Habit {\n    if(!habit.regularityEachDayGoal) habit.regularityEachDayGoal = 1; // default\n\n    const prog: HabitProgress = Object.assign(progress)\n\n    if(!progress.reward) {\n      // calculate rewards\n      prog.reward = getInitGamifyRewards();\n      let gold = HABIT_REWARDS_GOLD_BASE;\n      let exp = HABIT_REWARDS_EXPERIENCE_BASE;\n      for(let i = 0; i<habit.currentStreak; i++) {\n        gold += gold*HABIT_REWARDS_GOLD_PERCENTAGE_INCREASE;\n        exp += exp*HABIT_REWARDS_EXPERIENCE_PERCENTAGE_INCREASE;\n      }\n      prog.reward.gold = Math.round(gold);\n      prog.reward.experience = Math.round(exp);\n\n      habit.progress = saveIntoArray(prog, habit.progress, 'date');\n    }\n\n    if(prog.value >= habit.regularityEachDayGoal) {\n      \n      if(prog.reward && prog.reward.gold){\n        this.messageReceivedGold(prog.reward.gold);\n        this.addGold(prog.reward.gold);\n      }\n        \n      if(prog.reward && prog.reward.experience){\n        this.messageReceivedExperience(prog.reward.experience);\n        this.addExperience(prog.reward.experience)\n      }\n        \n    }\n    else {\n      if(prog.reward && prog.reward.gold){\n        this.messageLostGold(prog.reward.gold);\n        this.addGold(prog.reward.gold * -1);\n      }\n        \n      if(prog.reward && prog.reward.experience){\n        this.messageLostExperience(prog.reward.experience * -1);\n        this.addExperience(prog.reward.experience * -1)\n      }\n        \n    }\n\n    return habit;\n  }\n\n  private messageReceivedGold(gold: number, preMessage?:string, postMessage?:string) {\n    if(!preMessage) preMessage = '';\n    if(!postMessage) postMessage = '';\n    toast.success(preMessage+' You have received ' + gold + ' gold '+postMessage,{autoClose:MESSAGE_DURATION});\n  }\n\n  private messageLostGold(gold:number, preMessage?:string, postMessage?:string) {\n    if(!preMessage) preMessage = '';\n    if(!postMessage) postMessage = '';\n    toast.error(preMessage+' You have lost ' + gold + ' gold'+postMessage, {autoClose:MESSAGE_DURATION});\n  }\n\n  private messageReceivedExperience(exp: number, preMessage?:string, postMessage?:string) {\n    if(!preMessage) preMessage = '';\n    if(!postMessage) postMessage = '';\n    toast.success(preMessage+' You have received ' + exp + ' experience'+postMessage,{autoClose:MESSAGE_DURATION});\n  }\n\n  private messageLostExperience(exp:number, preMessage?:string, postMessage?:string) {\n    if(!preMessage) preMessage = '';\n    if(!postMessage) postMessage = '';\n    toast.error(preMessage+' You have lost ' + exp + ' experience'+postMessage, {autoClose:MESSAGE_DURATION});\n  }\n  \n  private async _save() {\n    try{\n      const doc = await dataService.getDoc(this.getGamifyDocId(), TYPE_SETTINGS);\n\n      if(!doc){\n        console.log(\"Couldn't load gamify doc: \", this.getGamifyDocId());\n        return;\n      }\n\n      console.log('========Gamify State Doc: ',this.getGamifyDocId(), doc);\n      const equal = isEqual(this._state, doc.state);\n      //make sure we are not saving the init state\n      const initEqual = isEqual(this.state, getInitGamifyState());\n\n      console.log('Saving gamify state::: ', equal, initEqual);\n      if(!equal && !initEqual && doc.userid ===  this._userId) {\n        console.log(\"Saving: \", {...doc, ...{state: this._state}})\n        dataService.save({...doc, ...{state: this._state}}, TYPE_SETTINGS);\n      }\n    }\n    catch(e) {\n      console.log(e);\n    }\n    \n  }\n\n  private getGamifyDocId(): string {\n    const defaultProject = getDefaultProject(authService.userid);\n    const id =  generateCollectionId(defaultProject.id, 'gamify', '');\n    return id.substring(0, id.length-1);\n  }\n\n  private async loadInitDocs(id: string): Promise<any> {\n    try {\n      console.log('Gamify ID: ' + this.getGamifyDocId());\n      const s = await dataService.getDoc(this.getGamifyDocId(), TYPE_SETTINGS);\n      console.log('--- gamify doc loaded: ', id, s);\n      if(s) return s;\n      console.log('Saving gamify new doc');   \n      const ts = Date.now();   \n      if(id === this._userId){  //half second pased, see if state changed\n        const res = await dataService.save({\n          id: this.getGamifyDocId(),\n          state: getInitGamifyState(),\n          type: TYPE_SETTINGS,\n          [env.ACCESS_META_KEY]: genrateMetaData(id),\n          userid: id,\n          created: ts,\n          updated: ts\n        }, TYPE_SETTINGS)\n      return res;\n      }\n    }\n    catch(e) {\n      console.log(e.red, id);\n    }\n\n    \n  }\n\n  public get state(): GamifyState {\n    return this._state;\n  }\n  public set state(value: GamifyState) {\n    this._state = value;\n    this.state$.next(value);\n  }\n\n}\nexport const gamifyService = new GamifyService();\n\n\n","import React, { useState, useEffect, useReducer } from 'react';\nimport { IonLabel, IonRow, IonCol, \n        IonIcon, IonGrid, IonButton } from '@ionic/react';\nimport { Todo } from './models';\nimport _ from 'lodash';\nimport { radioButtonOff, radioButtonOn, sunny, star, heart, basket, construct, arrowDownCircle, arrowForwardCircle, checkmark } from '../../../node_modules/ionicons/icons';\nimport { printCleanNote, getAction } from '../../utils';\nimport './todo.component.css'\nimport { DataFunctions } from './hooks/todos.hook';\nimport TodoNewComp from './todo.new.component';\nimport TodoEditInlineComponent from './todo.edit.inline.component';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\n\nexport interface TodoState {\n  todo: Todo,\n  newSubTitle: string,\n  subSelect: Todo|null\n  subTodos: Todo[]\n}\n\n\nconst reducer = (state, action): TodoState => {\n  switch(action.type) {\n    case 'fullupdate':\n      loadSubtodos(action.data)\n      return state; //next action will make a full load\n    case 'updateTodo':\n      return {...state, ...{todo:action.data}};\n    case 'subtodos':\n      console.log('Action DATA: ', action);\n      return {...state, ...{todo: action.data.todo, subTodos: action.data.subTodos}}\n    default:\n      return state;\n  }\n}\n\nconst loadSubtodos = async (data:{todo:Todo, dispatch, dataFunctions: DataFunctions}) => {\n  const {todo, dispatch, dataFunctions} = data;\n  console.log('Loading Sub Todos Function: ', todo.subTodos, todo.showSubTodos, todo);\n  if(todo.subTodos && todo.showSubTodos && todo.subTodos.length > 0){\n    const todos = await dataFunctions.loadSubTodos(todo.subTodos);\n    console.log(\"Loading subtodos ------------: \", todos);\n    dispatch(getAction('subtodos', {todo: todo, subTodos:todos}))\n  }\n}\n\n\n//Component Start\nconst TodoListItemComp = ({todo, tags, projectId, selectedTodo, lastChild,  dataFunctions}:\n  {todo:Todo, tags:string[], projectId: string|undefined, lastChild: boolean,  selectedTodo: Todo|null,  dataFunctions: DataFunctions}) => {\n  \n\n  const [state, dispatch] = useReducer(reducer, \n    {todo: todo, subTodos: [], newSubTitle: '', subSelect:null})\n  \n  const [showSubAddSubtask, setShowSubAddSubtask] = useState(false)\n\n  console.log('STATE TODONAME: ', state.todo.name);\n  console.log(state);\n\n  useEffect(() => {\n    console.log(\"UseEffect TODOS-------- \"+ todo.name, todo);\n    //load our subtodos\n    dispatch(getAction('fullupdate', {todo: todo, dispatch, dataFunctions}));\n  }, [todo, dataFunctions])\n\n\n\n\n  const doneHandler = () => {\n    const newDoc = gamifyService.calculateFinishedTodoRewards(\n        {...state.todo, ...{done: !state.todo.done}});\n    dispatch(getAction('updateTodo', newDoc));\n    dataFunctions.save(newDoc);\n  }\n\n  const filterHandler = (showDone: boolean) => {\n    if(state.todo.showDone === showDone)return;\n    const newDoc = {...state.todo, ...{showDone: showDone}};\n    dispatch(getAction('updateTodo', newDoc));\n    dataFunctions.save(newDoc);\n  }\n\n  const showSubTodosHandler = () => {\n    const newDoc = {...state.todo, ...{showSubTodos: !state.todo.showSubTodos}};\n    dispatch(getAction('updateTodo', newDoc));\n    dataFunctions.save(newDoc);\n  }\n\n  const handleSelectTodo = (todo:Todo) => {\n    if(selectedTodo && todo.id === selectedTodo.id){\n      dataFunctions.select(null);\n    }\n    else {\n      dataFunctions.select(todo);\n    }\n  }\n\n  if(state.todo.subTodos && state.todo.subTodos.length > 0){\n    console.log('*****************************************')\n    console.log(state.todo.name, state.todo.subTodos);\n\n  }\n\n  const printTag = (tag: string) => {\n    if(tag === 'today')\n      return (<IonIcon  icon={sunny} key={tag} color=\"sunny\" />);\n    if(tag === 'important')\n      return (<IonIcon  icon={star} key={tag} color=\"warning\" />); \n    if(tag === 'wish')\n      return (<IonIcon  icon={heart} key={tag} color=\"danger\" />); \n    if(tag === 'buy')\n      return (<IonIcon  icon={basket} key={tag} color=\"tertiary\" />);\n    if(tag === 'projects')\n      return (<IonIcon  icon={construct} key={tag} color=\"medium\" />);\n    if(tag === 'tasks')\n      return (<IonIcon  icon={checkmark} key={tag} color=\"medium\" />);\n  }\n\n  const printTagEdit = (tag: string) => {\n    const color = (_.includes(state.todo.tags,tag))? 'primary': 'light';\n    if(tag === 'today')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} \n                  fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n                  <IonIcon  icon={sunny} />\n              </IonButton>);\n    if(tag === 'important')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n                  <IonIcon  icon={star} />\n              </IonButton>); \n    if(tag === 'tasks')\n    return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n                <IonIcon  icon={checkmark} />\n            </IonButton>);\n    if(tag === 'wish')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n                <IonIcon  icon={heart} />\n            </IonButton>); \n    if(tag === 'buy')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n              <IonIcon  icon={basket} />\n          </IonButton>);\n    if(tag === 'projects')\n      return (<IonButton class=\"todoEditInlineIconScrollChild\" size=\"small\" key={tag} fill=\"clear\" color={color} onClick={() => handleTagChange(tag)}>\n              <IonIcon  icon={construct} />\n          </IonButton>);\n  }\n\n\n  const handleTagChange = (tag: string) => {\n    if(!state.todo.tags) state.todo.tags = [];\n\n    const res = _.find(state.todo.tags, t=>t===tag);\n    let newtags;\n    if(_.isUndefined(res)){\n      newtags = _.concat(state.todo.tags, tag);\n    }\n    else {\n      newtags = _.filter(state.todo.tags, t=>t!==tag);\n    }\n    dataFunctions.save(Object.assign(state.todo, {tags: newtags}));\n  }\n\n  \n  const printSubtodos = () => {\n    console.log(\"Print subtodos:: \", state.todo.showSubTodos);\n    if(!state.todo.showSubTodos) return <></>;\n\n  const amILast = (list: Todo[], me: Todo): boolean => {\n    console.log('amILast');\n    if(list.length === 0) return true;\n\n    if(list[list.length-1].id === me.id) return true;\n\n    return false;\n  }\n\n    return (\n      <>\n      <IonRow>\n        <IonCol>\n          <div className=\"todoEditInlineIconScrollParent\">\n            { tags.map(tag => printTagEdit(tag)) }\n          </div>\n        </IonCol>\n      </IonRow>\n      <IonRow class=\"todoRow\">\n        <IonCol  size=\"auto\">\n          <div className=\"bufferColumnParent\" >\n            <div className=\"bufferColumn\" />\n          </div>\n        </IonCol>\n        <IonCol>\n          <div>\n            {(state.todo.showDone)? (\n              <IonButton  color={'success'}\n                class=\"todoHeaderButtons\" \n                onClick={() => filterHandler(false)}\n                fill=\"clear\">Switch to Active</IonButton>\n            ) : (\n              <IonButton  color={'success'}\n                class=\"todoHeaderButtons\" \n                onClick={() => filterHandler(true)}\n                fill=\"clear\">Switch to Done</IonButton>\n            )}\n            {(selectedTodo && selectedTodo.id === state.todo.id)? (\n              <IonButton  color={'success'}\n                class=\"todoHeaderButtons\" \n                onClick={() => handleSelectTodo(state.todo)}\n                fill=\"clear\">Hide Edit</IonButton>\n            ) : (\n              <IonButton  color={'success'}\n                class=\"todoHeaderButtons\" \n                onClick={() => handleSelectTodo(state.todo)}\n                fill=\"clear\">Edit</IonButton>\n            )}\n            {/*\n            {(!showSubAddSubtask)? (\n              <IonButton  color={'primary'}\n                class=\"todoHeaderButtons\" \n                onClick={() => setShowSubAddSubtask(!showSubAddSubtask)}\n                fill=\"clear\">Show Add Subtask</IonButton>\n            ) : (\n              <IonButton  color={'success'}\n                class=\"todoHeaderButtons\" \n                onClick={() => setShowSubAddSubtask(!showSubAddSubtask)}\n                fill=\"clear\">Hide Add SubTasks</IonButton>\n            )}\n            */}\n          </div>\n          {state.subTodos.filter(todo => {\n            if(!todo.showDone) todo.showDone = false;\n            return todo.done === state.todo.showDone\n            })\n            .map(todo => (\n              <TodoListItemComp todo={todo} \n                  tags={tags}\n                  selectedTodo={selectedTodo}\n                  projectId={projectId}\n                  dataFunctions={dataFunctions}\n                  lastChild={amILast(state.subTodos, todo)}\n                  key={todo.id + \"sub\"} />\n          ))}\n        </IonCol>\n      </IonRow>\n      <IonRow>\n        <IonCol size=\"auto\">\n          <div className=\"bufferColumnParent\" >\n            <div className=\"bufferAddTaskColumn\" />\n          </div></IonCol>\n        <IonCol>\n            <TodoNewComp  parentId={state.todo.id} \n              projectId={projectId} \n              saveFunc={dataFunctions.save} />\n        </IonCol>\n      </IonRow>\n    </>\n    )\n  }\n\n  const printTask = () => {\n      return (\n          <IonGrid>\n            <IonRow class={(state.todo.showSubTodos && !lastChild)? '': 'todoRowBorder'}>\n              <IonCol size=\"auto\">\n                  {state.todo.done? (\n                      <IonIcon  color=\"dark\"  \n                                style={{fontSize:'32px', verticalAlign: 'text-top'}}\n                                icon={radioButtonOn} onClick={doneHandler} />\n                  ) : (\n                      <IonIcon  color=\"dark\"\n                                style={{fontSize:'32px', verticalAlign: 'text-top'}}\n                                icon={radioButtonOff} onClick={doneHandler} />\n                  )}\n              </IonCol>\n              <IonCol class=\"todoTitleColumn\" onClick={() => showSubTodosHandler()}  >\n                        <IonLabel  class=\"todoTitle\" >\n                          {state.todo.name}\n                          {/*\n                          {(state.todo.subTodos && state.subTodos.length > 0)? (\n                            <IonBadge class=\"todoBadgeSubtodos\" color=\"secondary\">\n                                {state.subTodos.length}\n                            </IonBadge>\n                          ) : (<></>)}\n                        */}\n                        </IonLabel>\n                        {state.todo.note? (\n                          <div className=\"todoNote\">\n                            {printCleanNote(state.todo.note)}\n                          </div>\n              \n                        ) : (\n                            <></>\n                        )}\n                        {(state.todo.tags && state.todo.tags.length > 0)? (\n                          <div className=\"todoListItemIcons\">\n                            { state.todo.tags.map(tag => printTag(tag)) }\n                          </div>\n                        ) : ( <></> )}\n                        \n              </IonCol>\n              <IonCol size=\"auto\" >\n                  \n                  {state.todo.showSubTodos? (\n                    <IonIcon  color=\"primary\"\n                              style={{fontSize:'32px', paddingRight:\"10px\"}}\n                              onClick={() => showSubTodosHandler()}\n                              icon={arrowDownCircle} />\n\n                  ) : (\n                    <IonIcon  color=\"primary\"\n                              style={{fontSize:'32px', paddingRight:\"10px\"}}\n                              onClick={() => showSubTodosHandler()}\n                              icon={arrowForwardCircle} />\n                  )}\n                 \n              </IonCol>\n              \n            </IonRow>\n            {(selectedTodo && selectedTodo.id === state.todo.id)? (\n              <IonRow>\n                <IonCol>\n                  <TodoEditInlineComponent \n                          todo={state.todo}\n                          tags={tags}\n                          dataFunctions={dataFunctions} />\n                </IonCol>        \n              </IonRow>\n            ) : ( <></> )}\n            {printSubtodos()}\n          </IonGrid>\n      )\n  }\n\n  return printTask();\n};\n\nexport default TodoListItemComp;\n","\nimport { Todo, TYPE_TODO } from './models';\nimport { BehaviorSubject, Subscription } from 'rxjs';\nimport { dataService } from '../../modules/data/dataService';\nimport { saveIntoArray, waitMS } from '../../modules/data/utilsData';\nimport { ProjectItem } from '../../modules/data/models';\nimport _ from 'lodash';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\n\nexport interface TodoState {\n  selectedTodo: Todo|null,\n  selectedTag: string,\n  docs: Todo[],\n  tags: string[],\n  doneTodos: boolean,\n  showSubTodos: boolean,\n}\n\nexport const getInitTodoState = (): TodoState => {\n  return {\n    selectedTodo:null,\n    selectedTag: 'all',\n    docs: [],\n    tags: ['today', 'tasks', 'important', 'wish', 'buy', 'projects', 'all'],\n    doneTodos: false,\n\n    showSubTodos: false,\n  }\n}\n\n\nexport class TodoService {\n  \n  // @ts-ignore: it will be initialized in init\n  private _project: ProjectItem;\n\n  private _state: TodoState = getInitTodoState();\n  \n  public state$ = new BehaviorSubject(this._state);\n\n  // private _docs: Todo[] = [];\n  \n  // public docs$ = new BehaviorSubject(this._docs);\n\n  private _subscription: Array<Subscription> = [];\n\n\n\n  public init(project: ProjectItem, tag: string) {\n    //first unsubscribe\n    this.unsubscribe();\n    const dataSub = dataService.getReadySub().subscribe( async (ready) => {\n      if(!ready) return;\n      \n      this._init(project, tag);\n\n      await waitMS(1000);\n      dataSub.unsubscribe();\n    });\n  }\n\n  async _init(project: ProjectItem, tag: string) {\n    console.log('-------------------------------------------');\n    console.log(\"Init: \", project, TYPE_TODO);\n    if(this._project && this._project.id === project.id && \n      this._state.selectedTag === tag) return;\n\n    const showChildren = (tag === 'today' || tag === 'important')? true : false;\n\n    this._state = {...this.state, ...{ selectedTag: tag, showSubTodos: showChildren}};\n\n    await waitMS(500);\n    console.log('Loadng new project::: ');\n    this._project = project;\n\n    // console.log(\"Init Docs: \", this._docs);\n    //this.filterTodos();\n    this.reloadTodos();\n    //todoMiddleware.init();\n\n    //manage changes\n\n    const sub = dataService.subscribeProjectCollectionChanges(project.id,TYPE_TODO)\n      .subscribe((doc: Todo) => {\n        console.log(\"TodoService subscription: \", doc); \n        this.reloadTodos();\n        //testing just reload the whole thing\n        //this.reloadBaseParent(doc);\n      });\n    this._subscription.push(sub);\n\n  }\n\n  private async reloadBaseParent(todo:Todo){\n    console.log(\"Loading base parent\");\n    const baseParent = await this.getBaseParent(todo);\n    console.log(\"Base Parent::: \", baseParent);\n    if(!baseParent) return this.reloadTodos();\n\n    if(baseParent.deleted){\n      this.filterAndSaveTodos(this.state.docs.filter(d => d.id !== todo.id));\n    }\n    else {\n      this.filterAndSaveTodos(saveIntoArray(baseParent, this.state.docs));\n    }\n    \n  }\n\n  private async getBaseParent(todo:Todo){\n    if(todo.parent){\n      const parent = await dataService.getDoc(todo.parent, TYPE_TODO);\n      if(!parent) {\n        return null;\n      }\n\n      if(parent.parent){\n        return this.getBaseParent(parent);\n      }\n      else {\n        return parent;\n      }\n    }\n    else {\n      return todo;\n    }\n  }\n\n  private async reloadTodos() {\n    console.log('State: ', this.state);\n    const docs = await dataService.queryByProperty('tags', 'equals', \n      this.state.selectedTag, TYPE_TODO);\n    console.log('DOCS::: ', docs);\n    this.filterAndSaveTodos(docs);\n  }\n\n  private filterAndSaveTodos(docs: Todo[]):Todo[] {\n    const filtered = docs.filter(doc => this.filterDoneParentFunction(doc));\n    this.state = {...this.state, ...{docs: filtered}};\n    return filtered;\n  }\n\n  private filterDoneParentFunction(doc:Todo) {\n      console.log('Filter1: ', doc.done !== this._state.doneTodos)\n      if (doc.done !== this._state.doneTodos) return false;\n      if (doc.parent && !this.state.showSubTodos) return false;\n      return true;\n  }\n\n\n \n  public get state(): TodoState {\n    return this._state;\n  }\n  public set state(value: TodoState) {\n    console.log('State: ', value);\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n  public async addSubTodoToParent (todoId: string, parentId: string) {\n    try {\n      const parentTodo: Todo = await dataService.getDoc(parentId, TYPE_TODO);\n      if (parentTodo) {\n        if(!parentTodo.subTodos) parentTodo.subTodos = [];\n        parentTodo.subTodos = _.concat(parentTodo.subTodos, todoId);\n        this.save(parentTodo);\n      }\n    }\n    catch(e) {\n      console.log(e);\n    }\n  }\n\n  public async removeSubTodoFromParent (todoId: string, parentId) {\n    try {\n      const parentTodo: Todo = await dataService.getDoc(parentId, TYPE_TODO);\n      if (parentTodo) {\n        if(!parentTodo.subTodos) parentTodo.subTodos = [];\n        parentTodo.subTodos = _.filter(parentTodo.subTodos, t=>t!== todoId);\n        this.save(parentTodo);\n      }\n    }\n    catch(e) {\n      console.log(e);\n    }\n  }\n\n\n  public async save(doc:Todo, parentId: string|null = null) {\n    console.log(\"------- Save: \", doc, this._project, TYPE_TODO);\n    //see if its new\n    if(doc._new) {\n      delete(doc._new);\n      doc.tags = [];\n      if(this.state.selectedTag !== 'all'){\n        doc.tags.push(this.state.selectedTag); \n      }\n      else {\n        doc.tags.push('tasks');\n      }\n      doc = gamifyService.calculateNewTodo(doc);\n    }\n    const res = await dataService.save({...{done: false}, ...doc}, TYPE_TODO, {project: this._project});\n    if(parentId && doc.id) {\n      this.addSubTodoToParent(doc.id, parentId)\n    }\n    console.log(res);\n    return res;\n\n  }\n\n  public async remove(id: string) {\n    //see if this doc has parent\n    try {\n      const todo: Todo = await dataService.getDoc(id, TYPE_TODO);\n      if (todo) {\n        if(todo.parent) {\n          this.removeSubTodoFromParent(id, todo.parent);\n        }\n      }\n    }\n    catch(e) {\n      console.log(e);\n    }\n    dataService.remove(id, TYPE_TODO);\n  }\n\n  public select(doc:Todo | null) {\n    this.state = {...this._state, ...{ selectedTodo: doc} };\n  }\n\n  public changeDoneFilter(done: boolean) {\n    if(done === this._state.doneTodos) return;\n    this._state = {...this._state, ...{ doneTodos: done} };\n    this.reloadTodos();\n\n  }\n\n  public changeShowSubtodosFilter(show: boolean) {\n    if(show === this._state.showSubTodos) return;\n    this._state = {...this._state, ...{ showSubTodos: show} };\n    this.reloadTodos();\n  }\n\n  public selectTag(tag:string) {\n    if(tag === this._state.selectedTag) return;\n    this._state = {...this._state, ...{ selectedTag: tag} };\n    this.reloadTodos();\n  }\n\n  public async loadTodoList (list:string[]): Promise<Todo[]> {\n    const todos = await dataService.getBulk(list, TYPE_TODO);\n    return todos;\n  }\n\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\n\n\nexport  const todoService = new TodoService(); ","import { useEffect, useState } from 'react';\nimport { Subscription } from 'rxjs';\nimport { dataService } from '../../data/dataService';\nimport { GUEST, authService } from '../../auth/authService';\nimport { gamifyService } from '../../gamify/gamifyService';\nimport { partyService } from '../../parties/party.service';\n\nexport enum AppStatus {\n  loading, auth, guest\n}\n\n// username, authenticated, login, logout, renewToken\nexport function useAppStatus(): [AppStatus] {\n\n  const [appStatus, setAppStatus] = useState({status: AppStatus.loading, dataReady: false, username: GUEST});\n\n\n  console.log('APP Router Status: ', appStatus);\n\n  useEffect(() => {\n    console.log('App Stats Effect::');\n    const subscriptions: Subscription[] = [\n      dataService.getReadySub().subscribe(ready => {\n        console.log('DataService READY', ready, dataService.ready);\n        if(ready === appStatus.dataReady) return;\n          setStatusFunction();\n      }),\n      authService.username$.subscribe(async (username) => {\n        console.log('USERNAME CHANGED: ', username);\n\n        //renew token\n        if(authService.getIsAuthenticated()){\n          authService.renewToken();\n        }\n        \n        setStatusFunction();\n        console.log('USER:::::: ', authService.getUser(), authService.getIsAuthenticated())\n        const userid = authService.getUser().id;\n        await dataService.init( userid, username !== GUEST);\n        console.log(\"Ready to start gamify service\");\n        await gamifyService.init(userid);\n        await partyService.init();\n      }),\n\n    ];\n    // usersService.loadAll();\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[]);\n\n\n  const setStatusFunction = () => {\n    const dataReady = dataService.ready;\n    const username = authService.getUsername();\n    if(dataReady === appStatus.dataReady && username === appStatus.username)\n      return;\n    console.log('STATUS ----------------', dataReady, username, appStatus);\n    \n    if(dataReady){\n      if(username === GUEST)\n        setAppStatus({ status:AppStatus.guest, username: username, dataReady: dataReady });\n      else\n        setAppStatus({ status:AppStatus.auth, username: username, dataReady: dataReady });\n    }\n    else {\n      setAppStatus({ status:AppStatus.loading, username: username, dataReady: dataReady });\n    }\n  };\n\n  return [ appStatus.status ];\n}","import React, { useState, useEffect } from 'react';\nimport { IonHeader, IonIcon, IonBadge } from '@ionic/react';\nimport { Line } from 'rc-progress';\nimport { gamifyService, getInitGamifyState, GamifyState } from '../modules/gamify/gamifyService';\n\n\n\nimport './header.css';\nimport 'rc-progress/assets/index.css';\nimport { heart, star, leaf, logoUsd } from 'ionicons/icons';\n\nconst HeaderWithProgress = ({title}:{title:string}) => {\n\n  const [state, setState] = useState<GamifyState>(getInitGamifyState())\n\n  const {health, maxHealth, experience, maxExperience, level, gold} = state;\n\n  useEffect(() => {\n    const sub = gamifyService.state$.subscribe(s => {\n      setState({...state, ...s});\n    })\n    return () => {\n      sub.unsubscribe();\n    };\n  }, [])\n\n\n  return (\n    <IonHeader className=\"headerWithAvatar\">\n      <div className=\"cityParent\">\n        <img src=\"/assets/pics/hills.svg\" style={{right:'25px'}} className=\"headerHills\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/hills.svg\" style={{right:'200px'}} className=\"headerHills\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/ground.svg\" className=\"headerGround\" alt=\"Ground\"/>\n        <img src=\"/assets/pics/sun.svg\" style={{right:'130px', top: '10px', width:'5%'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud2.svg\" style={{right:'240px', top: '40px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud1.svg\" style={{right:'60px', top: '40px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n        <img src=\"/assets/pics/cloud2.svg\" style={{right:'140px', top: '15px'}} className=\"headerSkyDetail\" alt=\"Hills\"/>\n      </div>\n      <div className=\"statsParent\" >\n        <div className=\"statsBarParent\" >\n          <IonIcon class=\"statsBarIcon\" icon={heart} style={{color: \"#C20114\"}} />\n          <Line trailWidth={0} percent={health/maxHealth * 100} \n                className=\"statsBarLine\"\n                strokeWidth={4} strokeColor=\"#C20114\" />\n          <IonBadge class=\"statsBarBadge\" \n                    color=\"danger\" >{health}/{maxHealth}</IonBadge>\n        </div>\n        <div className=\"statsBarParent\" >\n        <IonIcon class=\"statsBarIcon\" icon={leaf} style={{color: \"#157F1F\"}} />\n          <Line trailWidth={0}  percent={experience/maxExperience * 100} \n                className=\"statsBarLine\"\n                strokeWidth={4} strokeColor=\"#157F1F\" />\n          <IonBadge class=\"statsBarBadge\" \n                    color=\"success\" >{experience}/{maxExperience}</IonBadge>\n        </div>\n        <div className=\"statsBarMoneyParent\" >\n          <IonBadge class=\"statsBarMoneyBadge\" \n                    color=\"warning\" >Gold: {gold}</IonBadge>\n          <IonBadge class=\"statsBarMoneyBadge\" \n                    color=\"success\" >Level: {level}</IonBadge>\n        </div>\n      </div>\n        \n      <h1>{title}</h1>\n    </IonHeader>\n  )\n}\n\nexport default HeaderWithProgress;","import React from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonItem,\n  IonButton} from '@ionic/react';\n\nimport TodoNewComp from './todo.new.component';\nimport TodoListItemComp from './Todo.listitem.component';\nimport { dataService } from '../../modules/data/dataService';\nimport { useTodosCollectionFacade } from './hooks/todos.hook';\nimport './todos.page.css';\nimport HeaderWithProgress from '../../components/HeaderWithProgress';\nimport { useParams } from 'react-router-dom';\nimport { capitalize } from '../../utils';\nimport { getDefaultProject } from '../../modules/data/utilsData';\nimport { authService } from '../../modules/auth/authService';\n\nconst TodosPage  = () => {\n\n  const project = getDefaultProject(authService.userid);\n\n  const { tag } = useParams();\n  const selectedTag = tag || 'tasks';\n  console.log('TAG::: ', selectedTag);\n  const [state, dataFunc] = useTodosCollectionFacade(project, selectedTag)\n  const { docs, selectedTodo, tags } = state;\n\n  console.log(docs);\n  // dataFunc.selectTag(tag? tag: 'all')\n\n  const printTitle = ():string => {\n    if(tag){\n      return 'Todos: ' + capitalize(tag);\n    }\n    return 'Todos';\n    \n  }\n\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title={printTitle()} />\n      <IonContent id=\"todoContent\">\n        \n        <IonItem>  \n          <TodoNewComp parentId ={undefined} \n                       projectId={project.id||''} \n                       saveFunc={dataFunc.save} />\n        </IonItem>\n        <div>\n          <IonButton  color={(state.doneTodos)? 'light':'success'} \n                      class=\"todoHeaderButtons\" \n                      onClick={() => {dataFunc.changeDoneFilter(false)}}\n                      fill=\"clear\">Active</IonButton>\n          <IonButton  color={(!state.doneTodos)? 'light':'success'} \n                      class=\"todoHeaderButtons\" \n                      onClick={() => {dataFunc.changeDoneFilter(true)}}\n                      fill=\"clear\">Finished</IonButton>\n          <IonButton  color={(!state.showSubTodos)? 'light':'tertiary'} \n                      class=\"todoHeaderButtons\" \n                      onClick={() => {dataFunc.changeShowSubTodosFilter(true)}}\n                      fill=\"clear\">Show Children</IonButton>\n          <IonButton  color={(state.showSubTodos)? 'light':'tertiary'} \n                      class=\"todoHeaderButtons\" \n                      onClick={() => {dataFunc.changeShowSubTodosFilter(false)}}\n                      fill=\"clear\">Only Parents</IonButton>\n        </div>\n        <IonList>\n            {docs.map(todo => (\n              <TodoListItemComp   todo={todo} \n                                  tags={tags}\n                                  lastChild = {false}\n                                  selectedTodo={selectedTodo}\n                                  projectId = {project.id}\n                                  dataFunctions={dataFunc}\n                                  key={todo.id} />\n            ))}\n        </IonList>\n        \n\n\n        {/*(selectedTodo )? (\n          <div className=\"floating-menu\">\n            <TodoEditComponent todo={selectedTodo} tags={tags} dataFunctions={dataFunc} />\n          </div>\n        ) : (\n          <></>\n        )*/}\n\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default TodosPage;\n\n","import { useEffect, useState, useRef } from 'react';\nimport { Subscription } from 'rxjs';\nimport { ProjectItem } from '../../../modules/data/models';\nimport { Todo } from '../models';\nimport { TodoService, TodoState, getInitTodoState } from '../todo.service';\n\n\nexport interface DataFunctions {\n  save: {(doc: Todo, parentId?: string|null):Promise<any>},\n  remove: {(id: string)},\n  select: {(doc: Todo | null)},\n  selectTag: {(tag: string)},\n  loadSubTodos: {(list: string[])},\n  changeDoneFilter: {(done:boolean)},\n  changeShowSubTodosFilter: {(show:boolean)}\n}\n\n\n//more simpler then auth hook, just read data\nexport function useTodosCollectionFacade(project: ProjectItem, tag: string): \n                                        [TodoState, DataFunctions]{\n                                \n  const [state, setState] = useState(getInitTodoState());\n  const todoService = useRef(new TodoService());\n\n  todoService.current.selectTag(tag);\n  \n          \n  const dataFunctions = {\n    save: (doc: Todo, parentId?: string|null):Promise<any> => todoService.current.save(doc, parentId),\n    remove: (id) => todoService.current.remove(id), //TODO: allow user to choose, sync or not to sync\n    select: (doc: Todo | null) => todoService.current.select(doc),\n    selectTag: (tag: string) => todoService.current.selectTag(tag),\n    loadSubTodos: (ids: string[]): Promise<Todo[]> => todoService.current.loadTodoList(ids),\n    changeDoneFilter: (done:boolean) => todoService.current.changeDoneFilter(done),\n    changeShowSubTodosFilter: (show: boolean) => todoService.current.changeShowSubtodosFilter(show),\n  }\n\n  useEffect(() => {\n    console.log('TODOS HOOK - UseEffect NEW SERVICE------------------------------');\n    todoService.current.init(project, tag)\n\n    return todoService.current.unsubscribe;\n  }, [project.id])\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      todoService.current.state$.subscribe(state => {\n        console.log('TODO Hook Sub: ', state);\n        setState(state);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[project.id]);\n\n\n  return [state, dataFunctions];\n}","import React from 'react';\nimport { IonHeader, IonToolbar, IonPage, IonTitle, IonContent, IonLabel } from '@ionic/react';\n\n\n\nconst IntroPage: React.FC = () => {\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>Loading</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonLabel>Loading.....</IonLabel>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default IntroPage;\n","import { Subscription, BehaviorSubject } from \"rxjs\";\nimport { PartyProject, TYPE_PARTY } from \"./models\";\nimport { getPostRequest, post } from '../ajax/ajax';\nimport { env } from \"../../env\";\nimport { AuthService, authService } from '../auth/authService';\nimport { loadingService } from \"../loading/loadingService\";\nimport { toastService, ToastType } from \"../toast/toastService\";\nimport { dataService } from \"../data/dataService\";\nimport { waitMS, getChannelFromProjectId } from '../data/utilsData';\nimport { saveIntoArray, saveIntoDocList } from '../../utils';\nimport { Msg, TYPE_MSG } from \"../messages/models\";\nimport { sunny } from 'ionicons/icons';\n\nexport interface PartyState {\n  docs: PartyProject[],\n}\n\nexport const initPartyState = {\n  docs: []\n}\n\n\n\nexport class PartyService {\n  private _subscription: Array<Subscription> = [];\n  \n  private _state: PartyState = initPartyState;\n  public state$ = new BehaviorSubject(this._state);\n  \n  async init(){\n    this.unsubscribe();\n\n\n    const sub1 = dataService.subscribeChanges().subscribe(doc => {\n      console.log(doc);\n      if(doc.type === 'party'){\n        const docs = saveIntoDocList(doc, this._state.docs);\n        this.state = {...this._state, ...{docs}};\n      }\n    });\n    const docs = await dataService.queryByProperty('type', 'equals', 'party', TYPE_PARTY);\n    this.state = {...this._state , ...{docs}};\n\n\n  }\n\n  /*\n    Rights, each digit represents different right\n    0.  0 - Not admin 1- Admin, can change everything\n    1.  (Project item) 0 - can't see, 1 - can see, 2 - can edit\n    2.  (Project children) 0 - can't see, 1 - can see own, 2 - can see all items\n    3.  (Project children edit) 0 -can't edit, 1 can edit/make own, 2 can edit all \n  */\n  public async addUser(id:string, party: PartyProject) {\n    try {\n      console.log('PARTY:::: ', party)\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/sendAddMemberRequest',\n                      { token: authService.getToken(), \n                        channelid: getChannelFromProjectId(party.id),\n                        id: id,\n                        rights: '0121' //see all, edit own items \n                      }), \n                      true, 'Adding member, please wait');\n      console.log(res);\n\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Member invitation sent', ToastType.success);\n\n      waitMS(3000);\n\n      dataService.addSyncCall$.next();\n    }\n    catch (e) {\n      console.log(e);\n    }\n    \n  }\n\n  public save(partyProject: PartyProject){\n    if (!partyProject.id) {\n      this._createParty(partyProject);\n    }\n  }\n\n  //make new party ajax\n  private async _createParty(partyProject: PartyProject) {\n    console.log('Saving party Project::: ', partyProject);\n    loadingService.showLoading('Creating party, please wait, ' +\n                'internet connection required');\n    const res = await dataService.saveNewProject(partyProject, TYPE_PARTY);\n\n    if(!res.success){\n      return toastService.printServerErrors(res);\n    }\n        \n    loadingService.hideLoading();\n\n  }\n\n\n  public async acceptPartyInvitation(msg:Msg){\n    //lets send a request\n    try {\n      const res = await post(getPostRequest(env.AUTH_API_URL +'/channels/acceptChannelInvitation',\n                      { token: authService.getToken(), msgId: msg.id,}, {} ), \n                      true, 'Accept Request sent, waiting for reply.');\n      console.log(res);\n\n      if(!res.success){\n        return toastService.printServerErrors(res);\n      }\n\n      toastService.showMessage('Pary Membership request sent. Please wait for app update.', ToastType.success);\n\n      await waitMS(2000);\n\n      dataService.addSyncCall$.next();\n\n      msg.replied = {accepted: true, date: Date.now()};\n      dataService.save(msg, TYPE_MSG);\n    }\n    catch (e) {\n      console.log(e);\n    }\n\n\n\n   \n  }\n\n  public async rejectPartyInviation(msg:Msg) {\n    const newMsg = {...msg, ...{replied:{accepted: false, date: Date.now()}}}\n    dataService.save(newMsg, TYPE_MSG);\n  }\n\n\n  public get state(): PartyState {\n    return this._state;\n  }\n  public set state(value: PartyState) {\n    console.log('State: ', value);\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\nexport const partyService = new PartyService();","import {\n  IonPage,\n  IonContent} from '@ionic/react';\nimport React, {  } from 'react';\nimport './Home.css';\nimport HeaderWithProgress from '../components/HeaderWithProgress';\n\nconst Home: React.FC = () => {\n\n\n\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title=\"HabitVille\" />\n      <IonContent >\n        Future home of HabitVille\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Home;\n\n","import {\n  IonPage,\n  IonContent,\n  IonHeader,\n  IonTitle,\n  IonToolbar} from '@ionic/react';\nimport React, {  } from 'react';\n\n\nconst NotFound: React.FC = () => {\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>habits</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent >\n        <div style={{padding:'20px'}}>\n          This page does not exist\n        </div>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default NotFound;\n\n","import React from 'react'\nimport {  IonInput, IonLabel, IonItem,\n  IonNote, IonText } from '@ionic/react';\n\n\nconst MyInput = ({data, updateFunction}) => {\n\n\n\n  //const [_data, setData] = useState<FormValueItem>(data); \n\n  /*\n  useEffect(() => {\n    props.attachToForm({name:props.name, value: props.value});\n\n    return props.detachFromForm({name:props.name, value:props.value});\n  },[props]);\n  */\n\n  //console.log(\"MY Input DATA: \", data);\n\n  const handleChange = (event) => {\n    updateFunction({...data, ...{value: event.target.value, dirty: true}});\n  };\n\n  const handleBlur = (event) => {\n    if(data.dirty === true) return;\n    updateFunction({...data, ...{value: event.target.value, dirty: true}});\n  }\n\n  const printErrors = () => {\n    if(data.dirty){\n      const errors =data.errors.map(m => (\n        <IonNote key={m} color=\"danger\">{m}</IonNote>\n      ))\n      return errors;\n    }\n  }\n\n\n  return (\n    <IonItem>\n      <IonLabel position=\"stacked\">\n        {data.displayName}\n        { data.hasValidation?(\n          <IonText color=\"danger\">*</IonText>\n        ):null}\n      </IonLabel>\n      <IonInput \n        name={data.id}\n        value={data.value}\n        type={data.type}\n        onIonBlur={handleBlur}\n        onIonChange={handleChange}></IonInput>\n        {data.messages.map(m => (\n          <IonNote key={m}>{m}</IonNote>\n        ))}\n        {printErrors()}\n    </IonItem>\n  )\n}\n\nexport default MyInput;","import React, { useEffect, useState } from 'react'\nimport MyInput from './myInput';\nimport { saveIntoArray, findById } from '../../utils';\nimport { IonButton } from '@ionic/react';\nimport validator from 'validator';\n\n\n// use to generate form, usually from outside form passed into here\n// so far we can use, ones that have stars have been tested\n// \"text\", \"password\", \"email\", \"number\", \"search\", \"tel\", and \"url\"\nexport interface FormItem { \n  id: string;\n  displayName?: string;\n  type: string;\n  messages?: string[];\n  validators?: any[];  \n  default?: any;\n}\n\nexport interface ValidatorItem {\n  type: string;\n  message?: string|null;\n  options?: any;\n}\n\n\n// use to hold form state\nexport interface FormValueItem {\n  id: string;\n  displayName: string;\n  type: string;\n  value: string;\n  messages: string[];\n  errors: string[];\n  dirty: boolean;\n  hasValidation:boolean;\n  //status: number; //0: untouched, 1: valid, 2: not valid\n}\n\nexport interface OptionsItem {\n  submitButtonText: string;\n}\n\nexport const defaultOptions:OptionsItem = {\n  submitButtonText: \"Submit\",\n}\n\nexport const getFormOptions = (settings:{}) => {\n  return {...defaultOptions, ...settings};\n}\n\nexport interface Props {\n  items: FormItem[],\n  submitFunction: Function,\n  options?: OptionsItem\n}\n\nexport interface State {\n  items: FormValueItem[],\n  valid: boolean\n}\n\nexport function getValidator(type:string, options:any = null, message:string|null = null):ValidatorItem {\n  return {type, options, message};\n}\n\n\n\nconst MyForm = (props:Props) => {\n  const submitFunction = props.submitFunction;\n  const options = props.options|| defaultOptions;\n\n  const [state, setState] = useState<State>({items:[], valid:false});\n\n  useEffect(() => {\n    initForm(props.items);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  },[props.items]);\n\n\n  const initForm = (items) => {\n    let model: FormValueItem[] = [];\n    // go thourgh props and generate our model from schema;\n    if(items) { //no schema, do nothing\n      items.forEach((item:FormItem) => {\n        let messages = item.messages;\n        \n        console.log(typeof(messages));\n        if(typeof(messages) === 'string'){\n          console.log('Messages is string');\n        }\n        else if(Array.isArray(messages)){\n          console.log('messages array');\n        }\n        else {\n          messages = [];\n        }\n\n        model.push(validateItem({\n            id: item.id,\n            displayName: item.displayName || item.id, \n            type: item.type,\n            value: item.default||'', \n            messages,\n            errors: [],\n            dirty:false,\n            hasValidation: (Array.isArray(item.validators) && item.validators.length>0)\n        }));\n      });\n      setState({items: model, valid: validateForm(model)});\n      //console.log(state);\n    }\n  }\n\n  //const updateItem = (id:string, displayName: string, type: string, value:any, messages:string[], hasValidation:boolean, touched:boolean) => {\n  const updateItem = (item:FormValueItem) => {\n    //console.log('Update Item, ', item);\n    const items = saveIntoArray(validateItem(item), state.items, 'id')\n    setState({\n      items: items,\n      valid: validateForm(items)\n    });\n  }\n\n\n\n  const validateItem = (item:FormValueItem): FormValueItem => {\n    const errors: string[] = validate(item.id, item.value);\n    //console.log(item)\n    return {...item, ...{errors}}\n  }\n\n  const validate = (id:string, value:any): string[] => {\n    //console.log(typeof(value));\n\n    if(typeof(value) !== 'string') return [];\n    \n    const item:FormItem = findById(id, props.items, 'id');\n    if(!item.validators)\n      item.validators = [];\n\n    const messages: string[] = [];\n    item.validators.forEach((val:ValidatorItem) => {\n      if(val.type === 'isEmpty') {\n        if(validator.isEmpty(value)){\n          messages.push(val.message || 'Value cannot be empty')\n        }\n      }\n      if(val.type === 'isLength'){\n        if(!validator.isLength(value, val.options)){\n          messages.push(val.message || 'Value length is not valid');\n        }\n      }\n      if(val.type === 'isEmail'){\n        if(!validator.isEmail(value, val.options)){\n          messages.push(val.message || 'Valid Email required');\n        }\n      }\n    });\n\n    //lastly check the whole form\n\n    //if(messages.length === 0)\n    //  validateForm();\n\n    return messages;\n  }\n\n\n  const submit = () => {\n    const form = {};\n    state.items.forEach(item => {\n      form[item.id] = { value: item.value };\n    });\n    submitFunction(form);\n    console.log(state);\n  }\n\n  const validateForm = (items = state.items) => {\n    let errors = 0;\n    items.forEach(item => {\n      errors += item.errors.length;\n    });\n\n    return errors === 0;\n  }\n  \n\n  return (\n    <div>\n        { Object.values(state.items).map((i) => (\n          <MyInput key={i.id} data={i} updateFunction={updateItem} />\n        ))}\n          <IonButton  \n            key={'submitButton'}\n            onClick={submit} \n            disabled={!state.valid}\n            color=\"primary\">{options.submitButtonText}</IonButton>\n    </div>\n  )\n\n};\n\nexport default MyForm;\n\n\n\n/*\n  const attachToForm = (component) => {\n    setInputs({...inputs, ...{[component.props.name]: component}});\n    setModel({...model, ...{[component.props.name]: component.state.value}});\n  };\n\n  const detachFromForm = (component) => {\n    const i = Object.assign({}, inputs);\n    delete i[component.props.name]\n    setInputs(i);\n\n    const m = Object.assign({}, model);\n    delete m[component.props.name];\n    setModel(m);\n  }\n\n  const updateModel = () => {\n    const m = Object.assign({}, model);\n    Object.keys(inputs).forEach((name) => {\n      m[name] = inputs[name].state.value;\n    });\n\n    setModel(m);\n  }\n\n  const submit = (event) => {\n    event.preventDefault();\n    updateModel();\n    console.log(model);\n  }\n\n  const getElement = (type) => {\n    if(type === 'string'){\n      return (\n        <div>type</div>\n      )\n    }\n  }\n*/","import React, { useState, useEffect } from 'react';\nimport { IonButton } from '@ionic/react';\nimport './auth.css';\nimport { useLocation, useHistory } from 'react-router-dom';\n\n\n\n\n\nconst AuthMenuComponent = ({page}: {page:string}) => {\n  const location = useLocation();\n  const history = useHistory();\n  \n  const push = (url:string) => {\n    console.log(location.pathname);\n    if(location.pathname && url !== location.pathname){\n      history.push(url);\n    }\n\n  }\n  \n  \n  return (\n    <div className=\"authMenuParent\" >\n      <IonButton  onClick={() => push('/auth/login')}\n                  size=\"small\"  \n                  color={(page==='login')? 'success':'light'}\n                  fill=\"clear\">\n          Login\n      </IonButton>\n      <IonButton   onClick={() => push('/auth/register')}\n                  size=\"small\"  \n                  color={(page==='register')? 'success':'light'}\n                  fill=\"clear\">\n          Register\n      </IonButton>\n\n    </div>\n  );\n}\n\nexport default AuthMenuComponent;","import React from 'react';\nimport {\n  IonIcon,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonPage\n} from \"@ionic/react\";\nimport { logIn} from 'ionicons/icons';\nimport MyForm, { getValidator, FormItem, getFormOptions } from '../../forms/myForm';\nimport { authService } from '../authService';\nimport { useLocation, useHistory } from 'react-router';\nimport AuthMenuComponent from './auth.menu.component';\nimport './auth.css';\n\nconst LoginPage  = () => {\n\n  console.log(\"LOGIN PAGE\");\n  const location = useLocation();\n  const history = useHistory();\n  console.log(\"LOCATION++++++++++++:::: \", location)\n\n  const options = getFormOptions({\n    submitButtongText: \"Login\"\n  });\n  \n  const form: FormItem[] = [\n    {\n      id: 'id',\n      displayName: 'ID (Username or Email): ',\n      type: 'string',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'ID needs to be between 3 to 50 characters')\n  \n      ],\n    },\n    {\n      id: 'password',\n      displayName: \"Password: \",\n      type: 'password',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'ID needs to be between 3 to 50 characters')\n      ]\n    },\n    \n  ]\n  \n  const submit = async (form) => {\n    console.log(form);\n    authService.loginAndRedirect(\n        form['id'].value, \n        form['password'].value,\n        history,\n        location);\n  }\n\n\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Login</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <div style={{paddingTop:'50px'}} className=\"ion-text-center\">\n          <IonIcon icon={logIn} color=\"primary\" className=\"iconFormCenter\" />\n        </div>\n        <AuthMenuComponent page=\"login\" />\n        <div style={{padding:'20px'}}>\n          <MyForm  items={form} options={options} submitFunction={submit} /> \n        </div>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default LoginPage;\n","import React, {  } from 'react';\n\nimport {\n  IonIcon,\n  IonHeader,\n  IonToolbar,\n  IonTitle,\n  IonContent,\n  IonPage\n} from \"@ionic/react\";\nimport { logIn} from 'ionicons/icons';\nimport MyForm, { getValidator, FormItem, getFormOptions } from '../../forms/myForm';\nimport { authService } from '../authService';\nimport { useLocation, useHistory } from 'react-router';\nimport AuthMenuComponent from './auth.menu.component';\nimport './auth.css';\n\nconst RegisterPage  = () => {\n\n  console.log(\"REGISTER PAGE\");\n  const location = useLocation();\n  const history = useHistory();\n  console.log(\"LOCATION++++++++++++:::: \", location)\n\n  const options = getFormOptions({\n    submitButtongText: \"Login\"\n  });\n  \n  const form: FormItem[] = [\n    {\n      id: 'username',\n      displayName: 'Username: ',\n      type: 'string',\n      validators: [\n        getValidator('isLength', {min:3, max:20}, 'Username needs to be between 3 to 20 characters')\n  \n      ],\n    },\n    {\n      id: 'email',\n      displayName: 'Email: ',\n      type: 'string',\n      validators: [\n        getValidator('isEmail',{}, 'Email is not valid')\n  \n      ],\n    },\n    {\n      id: 'password',\n      displayName: \"Password: \",\n      type: 'password',\n      validators: [\n        getValidator('isLength', {min:3, max:50}, 'Password needs to be between 3 to 50 characters')\n      ]\n    },\n    \n  ]\n  \n  const submit = async (form) => {\n    console.log(form);\n    const res = await authService.register(\n                        form['username'].value, \n                        form['email'].value,\n                        form['password'].value);\n    if(res){\n      authService.loginAndRedirect(\n                        form['username'].value, \n                        form['password'].value,\n                        history,\n                        location)\n    }\n  }\n\n\n\n\n\n\n\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonTitle>Register</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <div style={{paddingTop:'50px'}} className=\"ion-text-center\">\n          <IonIcon  color=\"primary\"\n                    icon={logIn} \n                    className=\"iconFormCenter\" />\n        </div>\n        <AuthMenuComponent page=\"register\" />\n        <div style={{padding:'20px'}}>\n          <MyForm  items={form} options={options} submitFunction={submit} /> \n        </div>\n\n        \n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default RegisterPage;\n","import React, { FunctionComponent } from \"react\";\nimport { Route, Redirect, useLocation } from \"react-router-dom\";\nimport LoginPage from './components/login.page';\nimport RegisterPage from './components/register.page';\n\n\nconst UnauthenticatedRoute = ({ exact, path }: \n  { component: FunctionComponent<{}>, exact: boolean, path: string }) => {\n\n  \n  const location = useLocation();\n  // const history = useHistory();\n  // const params = useParams();\n  // const path = location.pathname;\n  \n  // console.log(\"Location:::: \", location);\n  // console.log('HISTORY:::: ', history);\n  // console.log('PARAMS:::: ', params);\n\n\n  const getRoute = () => {\n    if(location.pathname === '/auth/register'){\n      return <Route path={path} \n                    component={RegisterPage} \n                    exact={exact} />;\n    }\n    else if(location.pathname === '/auth/login'){\n      return <Route\n                path='/auth/login'\n                render={() => <LoginPage />}\n              />\n    }\n    else {\n      return <Redirect to={{\n              pathname: \"/auth/login\",\n              state: {prev: location.pathname}\n            }}/>;\n    }\n  }\n  \n\n  return (\n    getRoute()\n  );\n}\n\n\n\n\n\n/*\n\n\n\n\nconst  PrivateRoute = ({ component: Component, ...rest }) => {\n\n  const [authenticated] = useUserFacade();\n  //const location = useLocation();\n\n  //console.log(location);\n\n\n  return (\n    <Route\n      {...rest}\n      render={props =>\n        authenticated ? (\n          <Component {...props} />\n        ) : (\n          <Redirect\n            to={{ pathname: \"/auth/login\"}}\n          />\n        )\n      }\n    />\n  );\n}\n*/\nexport default UnauthenticatedRoute;","\nimport { Habit, habitStage, TYPE_HABBIT } from './models';\nimport { BehaviorSubject, Subscription } from 'rxjs';\nimport { dataService } from '../../modules/data/dataService';\nimport { saveIntoArray, waitMS } from '../../modules/data/utilsData';\nimport { ProjectItem } from '../../modules/data/models';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\nimport _ from 'lodash';\n\nexport interface habitsState {\n  selected: Habit | null,\n  habits: Habit[],\n  stageFilter: habitStage\n}\n\nexport const getInitHabitsState = (): habitsState => {\n  return {\n    selected: null,\n    habits: [],\n    stageFilter: habitStage.current\n  }\n}\n\nexport class HabitsService {\n\n  // @ts-ignore:  we force init later on in init function\n  private _project: ProjectItem;\n  public getProject():ProjectItem {return this._project}\n  private _state: habitsState = getInitHabitsState();\n\n  public state$ = new BehaviorSubject(this._state);\n\n  private _docs: Habit[] = [];\n\n  public docs$ = new BehaviorSubject(this._docs);\n\n  private _subscription: Array<Subscription> = [];\n\n  public init(project: ProjectItem) {\n    const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n      if (!ready) return;\n      const equals = _.isEqual(project, this._project);\n      if (equals) return;\n\n      await this._init(project);\n\n      dataSub.unsubscribe();\n    });\n\n  }\n\n  async _init(project: ProjectItem) {\n    console.log(\"################################# Init: \", project, TYPE_HABBIT);\n    if (this._project && this._project.id === project.id) return;\n    console.log('Saving....', this._project, project);\n    this._project = project;\n    this._docs = await dataService.getAllByProject(project.id, TYPE_HABBIT);\n    console.log(\"Init Docs: \", this._docs);\n    this.filterhabits();\n\n    //manage changes\n\n    const sub = dataService.subscribeProjectCollectionChanges(project.id, TYPE_HABBIT)\n      .subscribe(doc => {\n        console.log(\"habit Service Subscription: \", doc);\n        if (doc.deleted)\n          this._docs = this._docs.filter(d => d.id !== doc.id);\n        else {\n          console.log('Updating doc: ', doc);\n          this._docs = saveIntoArray(doc, this._docs);\n        }\n        this.filterhabits();\n        //TODO: need to optimize this, maybe start using the view query, see bottom of file\n      });\n    this._subscription.push(sub);\n  }\n\n\n\n  private filterhabits() {\n    console.log(\"Filterhabits\", this._docs);\n    const filtered = this._docs.filter(doc => this.filterFunction(doc));\n    this.state = { ...this._state, ...{ habits: filtered } };\n    console.log(\"Filtered State: \", this._state);\n  }\n\n  private filterFunction(doc: Habit) {\n    return (doc.stage === this._state.stageFilter)\n  }\n\n\n\n  public get state(): habitsState {\n    return this._state;\n  }\n  public set state(value: habitsState) {\n    this._state = value;\n    this.state$.next(this._state);\n  }\n\n  public get docs(): Habit[] {\n    return this._docs;\n  }\n  public set docs(value: Habit[]) {\n    this._docs = value;\n    this.docs$.next(this._docs);\n  }\n\n\n\n  public save(doc: Habit) {\n    console.log(\"Save: \", doc, this._project, TYPE_HABBIT);\n\n    //check if its new, no id, its noew\n    if (!doc.id) {\n      doc = Object.assign(gamifyService.calculateNewHabitRewards(doc));\n    }\n\n    dataService.save({ ...{ done: false }, ...doc }, TYPE_HABBIT, { project: this._project });\n  }\n\n  public remove(id: string) {\n    dataService.remove(id, TYPE_HABBIT);\n  }\n\n  public select(doc: Habit) {\n    this.state = { ...this._state, ...{ selected: doc } };\n  }\n\n  public changeStageFilter(stage: habitStage) {\n    if (stage === this._state.stageFilter) return;\n    this._state = { ...this._state, ...{ stageFilter: stage } };\n    this.filterhabits();\n\n  }\n\n\n  public unsubscribe() {\n    if (!this) return;\n    this._subscription.forEach(sub => {\n      if (sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n","import { useEffect, useState, useRef } from 'react';\nimport { Subscription } from 'rxjs';\nimport { ProjectItem } from '../../../modules/data/models';\nimport { Habit, habitStage } from '../models';\nimport { habitsState, getInitHabitsState,  HabitsService } from '../habits.service';\nimport _ from 'lodash';\n\nexport interface habitDataFunctions {\n  save: {(doc: Habit)},\n  remove: {(id: string)},\n  select: {(doc: Habit)},\n  changeStageFilter: {(stage: habitStage)}\n}\n\n\n//more simpler then auth hook, just read data\nexport function useHabitsCollectionFacade(project: ProjectItem): \n                                        [habitsState, habitDataFunctions]{\n\n  const [state, setState] = useState(getInitHabitsState());\n\n  const habitsService = useRef(new HabitsService());\n  \n          \n  const dataFunctions = {\n    save: (doc: Habit) => {\n      console.log('@@@@@@@@@@@@@@@@@@@@@ Habit Hook Save: ', habitsService.current, doc)\n      habitsService.current.save(doc)\n    },\n    remove: (id) => habitsService.current.remove(id), //TODO: allow user to choose, sync or not to sync\n    select: (doc: Habit) => habitsService.current.select(doc),\n    changeStageFilter: (stage: habitStage) => habitsService.current.changeStageFilter(stage),\n  }\n\n  useEffect(() => {\n    console.log('habitS HOOK - UseEffect NEW SERVICE------------------------------');\n    if(_.isEqual(habitsService.current.getProject(), project)) \n        return;\n    habitsService.current.init(project)\n\n    return habitsService.current.unsubscribe;\n  }, [project])\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      habitsService.current.state$.subscribe(state => {\n        console.log('habits Hook Sub: ', state);\n        setState(state);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[project]);\n\n\n  return [state, dataFunctions];\n}","export const COLOR_PRIMARY = 'primary';\nexport const COLOR_SECONDARY = 'secondary';\nexport const COLOR_TERTIARY = 'tertiary';\nexport const COLOR_SUCCESS = 'success';\nexport const COLOR_WARNING = 'warning';\nexport const COLOR_DANGER = 'danger';\nexport const COLOR_LIGHT = 'light';\nexport const COLOR_MEDIUM = 'medium';\nexport const COLOR_DARK = 'dark';","import React, { useState, useEffect } from 'react';\nimport { IonItem, IonCard, IonCardHeader, IonCardTitle, IonIcon, IonFab, IonFabButton, IonCardContent, IonGrid, IonRow, IonCol, IonNote, IonBadge } from '@ionic/react';\nimport { COLOR_LIGHT, COLOR_DARK, COLOR_SUCCESS } from '../../colors';\nimport { radioButtonOff, checkmarkCircleOutline, cog } from '../../../node_modules/ionicons/icons';\nimport moment from 'moment';\nimport { Habit, MOMENT_DATE_FORMAT, HabitProgress } from './models';\nimport { habitDataFunctions } from './hooks/habits.hook';\nimport './Habit.listitem.component.css';\nimport { saveIntoArray, getIndexById } from '../../modules/data/utilsData';\nimport { calculateCurrentStreak } from './utilsHabits';\nimport { gamifyService } from '../../modules/gamify/gamifyService';\n\n\n\nconst HabitListItemComponent = ({habit, dataFunctions, showEditModalFunction}:\n  {habit:Habit, dataFunctions: habitDataFunctions, showEditModalFunction:{(habit: Habit)}}) => {\n\n  const [doc, setDoc] = useState(habit);\n\n  useEffect(() => {\n    setDoc(habit);\n  }, [habit])\n\n\n  const printDate = (index:number) => {\n    const day =  moment().subtract(index, 'day');\n    return (\n      <>\n      {day.format('DD')} <br /> {day.format('dd')}\n      </>\n    )\n  }\n\n  const printGoal = () => {\n    if(doc.regularityInterval === 'day'){\n      return (\n        <IonItem>\n              <IonNote>\n                Remember, you promised that you will repeat \n                this habit <strong>every day</strong>.\n              </IonNote>\n        </IonItem>\n      )\n    }\n    \n    return (\n      <IonItem>\n        <IonNote>\n          Remember you promised that you will repeat this habit \n          <strong> {doc.regularityValue} times {doc.regularityInterval}</strong>\n        </IonNote>\n      </IonItem>\n    )\n  }\n\n\n\n\n  const printDayIcon = (index: number) => {\n    const day = moment().subtract(index, 'day');\n    let progress = doc.progress.find(obj => day.format(MOMENT_DATE_FORMAT) === obj.date);\n    if(!progress)\n      progress = {date: day.format(MOMENT_DATE_FORMAT), value: 0};\n\n    // @ts-ignore: undefined, but we are forsing assignment just before this\n    return (<IonIcon  onClick={() => updatehabit(index, progress)}\n                      size=\"large\" \n                      key={index}\n                      color={ progress.value > 0? COLOR_SUCCESS:  COLOR_DARK} \n                      icon={progress.value > 0? checkmarkCircleOutline : radioButtonOff} />)\n  }\n\n  const updatehabit = (index: number, progress:{date:string, value:number}) => {\n    console.log(' %%%%%%%%%%%%%%%%%%%%%%%%%%  Update Progress::: ', index, progress);\n    let newProgress: HabitProgress = {date: progress.date, value: (progress.value === 0)? 1: 0 }\n\n    const i = getIndexById(newProgress.date, doc.progress, 'date')\n    if(i !== -1) {\n      newProgress = {...doc.progress[i], ...newProgress }\n    }\n    const progresslist = saveIntoArray(newProgress, doc.progress, 'date');\n    const newDoc = gamifyService.calculateHabitProgressRewards(\n                    calculateCurrentStreak({...doc, ...{progress: progresslist}}), newProgress);\n    console.log('NEW PROGRESSSSSSS:::::::::::::::::::::::;', newDoc);\n    dataFunctions.save(newDoc);\n\n  }\n\n  const print = () => {\n    return (\n        <IonCard>\n          <IonCardHeader>\n            {/*<IonCardSubtitle>Card Subtitle</IonCardSubtitle>*/}\n            <IonCardTitle>{doc.name}</IonCardTitle>\n            <IonBadge class=\"habitBadge\" color=\"success\">{doc.currentStreak}</IonBadge>\n            <IonBadge class=\"habitBadge\" color=\"tertiary\">{doc.bestStreak}</IonBadge>\n          </IonCardHeader>\n          <IonItem>\n            <IonGrid>\n              <IonRow class=\"datecell\">\n                <IonCol>{printDate(6)}</IonCol>\n                <IonCol>{printDate(5)}</IonCol>\n                <IonCol>{printDate(4)}</IonCol>\n                <IonCol>{printDate(3)}</IonCol>\n                <IonCol>{printDate(2)}</IonCol>\n                <IonCol>{printDate(1)}</IonCol>\n                <IonCol>{printDate(0)}</IonCol>\n              </IonRow>\n              <IonRow class=\"datecell\">\n                <IonCol>{printDayIcon(6)}</IonCol>\n                <IonCol>{printDayIcon(5)}</IonCol>\n                <IonCol>{printDayIcon(4)}</IonCol>\n                <IonCol>{printDayIcon(3)}</IonCol>\n                <IonCol>{printDayIcon(2)}</IonCol>\n                <IonCol>{printDayIcon(1)}</IonCol>\n                <IonCol>{printDayIcon(0)}</IonCol>\n              </IonRow>\n            </IonGrid>\n          </IonItem>\n          <IonCardContent>\n            {printGoal()}\n          </IonCardContent>\n          <IonFab horizontal=\"end\" vertical=\"bottom\" edge>\n            <IonFabButton size=\"small\" color={COLOR_LIGHT} onClick={() => showEditModalFunction(doc)}>\n              <IonIcon size=\"large\" icon={cog} />\n            </IonFabButton>\n          </IonFab>\n        </IonCard>\n    );\n  }\n  \n  return print();\n};\n\nexport default HabitListItemComponent;\n\n","import React, { useState } from 'react';\nimport { IonItem, IonLabel, IonIcon, IonInput, IonTextarea, IonButton, IonHeader, IonTitle, IonToolbar, IonContent, IonFooter, IonButtons, IonSelect, IonSelectOption, IonRange, IonFab, IonFabButton, IonAlert, IonSegment, IonSegmentButton } from '@ionic/react';\nimport { arrowBack, trash } from '../../../node_modules/ionicons/icons';\nimport { Habit, habitIntervals, habitDifficulty, printDifficulty } from './models';\nimport { capitalize } from '../../utils';\nimport { COLOR_DANGER } from '../../colors';\n\n\n\ninterface habitState {\n  regularity: {\n    interval: habitIntervals,\n    min: number,\n    max: number,\n  }\n  doc: Habit,\n  showDeleteWarrning: boolean\n}\n\nconst getRegularityValues = (interval: habitIntervals) => {\n  switch (interval) {\n    case habitIntervals.day:\n      return {interval: interval, min:1, max: 1}\n    case habitIntervals.week:\n      return {interval: interval, min:1, max: 6}\n    case habitIntervals.month:\n      return {interval: interval, min:1, max: 25}\n  }\n}\n\nconst HabitAddComponent = ({habit, dismissFunc}:\n  {habit:Habit, dismissFunc: {(habit:Habit|null, action: 'save'|'remove'|'none')}}) => {\n  console.log('Add habits Form:::::: ', habit);\n  const getDefaultRegularityState: habitState = {\n    regularity: getRegularityValues(habit.regularityInterval),\n    doc: new Habit(),\n    showDeleteWarrning: false\n  }\n\n\n  const [state, setState] = useState<habitState>({...getDefaultRegularityState, ...{doc: habit}});\n\n\n\n  console.log(state);\n  const handleChange = (e) => {\n    const newDoc = {...state.doc, ...{[e.target.name]:e.detail.value}}\n    const newState = {...state, ...{doc: newDoc}};\n    setState(newState);\n  }\n\n  const handlerRegularityValue = (e) => {\n    console.log(e);\n    const newDoc = {...state.doc, ...{regularityValue: e.detail.value}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  const handlerRegularityIntervalChange = (value) => {\n    value = value || 'day';\n    const newDoc = {...state.doc, ...{regularityInterval: value, regularityValue: 1}};\n    const newReg = {...state.regularity, ...getRegularityValues(value)};\n    setState({...state, ...{doc:newDoc, regularity: newReg}});\n    console.log(state);\n  }\n\n  const printRegularityLabel = () => {\n\n    const times = (state.doc.regularityValue > 1)? ' times a ': ' time a ';\n    if(state.doc.regularityInterval === 'day'){\n      return 'I will repeat this habit every day.'\n    }\n    \n    return 'I will repeat this habit ' +state.doc.regularityValue + times + state.doc.regularityInterval\n  }\n\n  const handleDifficultyChange = (e) => {\n    const newDoc = {...state.doc, ...{difficulty: e.detail.value}};\n    setState({...state, ...{doc: newDoc}});\n  }\n\n  const printDifficultyLabel = (hab: habitDifficulty): string => {\n    switch(hab) {\n      case habitDifficulty.trivial:\n        return 'Easy peasy lemon squeezy';\n      case habitDifficulty.easy:\n        return 'Piece of Cake';\n      case habitDifficulty.medium:\n        return \"Let's Rock\";\n      case habitDifficulty.hard:\n        return 'No Pain, No Gain';\n      case habitDifficulty.extreme:\n        return 'Death Wish';\n    }\n  }\n\n  const showRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: true}});\n  }\n\n  const hideRemoveWarrning = () => {\n    setState({...state, ...{showDeleteWarrning: false}});\n  }\n\n  const removehabit = () => {\n    hideRemoveWarrning();\n    console.log('REMVE ACTION STATE::::::: ', state);\n    dismissFunc(state.doc, 'remove');\n  }\n\n\n\n  const print = () => {\n      return (\n      <>\n        <IonHeader>\n          <IonToolbar>\n            {/*\n            <IonButtons slot=\"start\">\n              <IonButton> <IonIcon size=\"large\" icon={arrowBack} /></IonButton>\n            </IonButtons>\n            */}\n            <IonTitle>Add Habit</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonItem>\n              <IonLabel position=\"floating\">Name</IonLabel>\n              <IonInput \n                  name=\"name\"\n                  placeholder=\"Read book, Go running ...\" \n                  onIonChange={handleChange}\n                  value={state.doc.name} />\n          </IonItem>\n          <IonItem>\n              <IonLabel position=\"floating\">Note</IonLabel>\n              <IonTextarea \n                  placeholder=\"Enter more information here, motivate yourself...\"\n                  name=\"note\"\n                  onIonChange={handleChange}\n                  value={state.doc.note}></IonTextarea>\n          </IonItem>\n          <IonItem>\n            <IonSegment value={state.doc.regularityInterval}\n                        onIonChange={(e) => handlerRegularityIntervalChange(e.detail.value)}>\n              <IonSegmentButton value=\"day\">\n                <IonLabel>Daily</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"week\">\n                <IonLabel>Weekly</IonLabel>\n              </IonSegmentButton>\n              <IonSegmentButton value=\"month\">\n                <IonLabel>Monthly</IonLabel>\n              </IonSegmentButton>\n            </IonSegment>\n          </IonItem>\n\n          {(state.doc.regularityInterval !== 'day')? (\n            <>\n              <IonRange \n                    min={state.regularity.min}\n                    max={state.regularity.max}\n                    debounce={100}\n                    value={state.doc.regularityValue}\n                    onIonChange={handlerRegularityValue}\n                    color=\"secondary\" >\n                <IonLabel slot=\"start\">{state.regularity.min}</IonLabel>\n                <IonLabel slot=\"end\">{state.regularity.max}</IonLabel>\n              </IonRange>\n            </>\n          ) : (\n          <></> )}\n          <IonItem>\n            <IonLabel>{printRegularityLabel()}</IonLabel>\n          </IonItem>\n\n          <IonRange min={0} \n                    max={4} \n                    debounce={100}\n                    value={state.doc.difficulty}\n                    onIonChange={handleDifficultyChange}\n                    color=\"secondary\">\n              <IonLabel slot=\"start\">{capitalize(printDifficulty(habitDifficulty.trivial))}</IonLabel>\n              <IonLabel slot=\"end\">{capitalize(printDifficulty(habitDifficulty.extreme))}</IonLabel>\n          </IonRange>\n\n          <IonItem>\n            <IonLabel>{printDifficultyLabel(state.doc.difficulty)}</IonLabel>\n          </IonItem>\n        </IonContent> \n\n        <IonFooter>\n          <IonToolbar>\n            <IonTitle>\n              <IonButton onClick={() => dismissFunc(state.doc, 'save')}>Save</IonButton>\n              <IonButton onClick={() => dismissFunc(null, 'none')}>Cancel</IonButton>\n            </IonTitle>\n          </IonToolbar>\n        </IonFooter>\n        <IonFab horizontal=\"end\" vertical=\"bottom\" >\n          <IonFabButton size=\"small\" color={COLOR_DANGER} onClick={() => showRemoveWarrning()}>\n            <IonIcon size=\"large\" icon={trash} />\n          </IonFabButton>\n        </IonFab>\n        <IonAlert\n          isOpen={state.showDeleteWarrning}\n          onDidDismiss={() => hideRemoveWarrning}\n          header={'Warrning!!!'}\n          message={'Are you sure you want to <strong>delete</strong> this habit?'}\n          buttons={[\n            {\n              text: 'Cancel',\n              role: 'cancel',\n              cssClass: 'secondary',\n              \n            },\n            {\n              text: 'Yes Im Sure',\n              handler: () => removehabit()\n            }\n          ]}\n        />\n      </>\n      );\n  }\n  \n  console.log(\"Ready to return form\");\n  return print();\n};\n\nexport default HabitAddComponent;\n","import React, { useState, useReducer } from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonFabButton,\n  IonFab,\n  IonIcon,\n  IonModal} from '@ionic/react';\n\nimport { add } from '../../../node_modules/ionicons/icons';\nimport { useHabitsCollectionFacade } from './hooks/habits.hook';\nimport { Habit } from './models';\nimport HabitListItemComponent from './Habit.listitem.component';\nimport HabitAddComponent from './Habit.add.component';\nimport HeaderWithProgress from '../../components/HeaderWithProgress';\nimport { DataFunctions } from '../todo/hooks/todos.hook';\nimport { authService } from '../../modules/auth/authService';\nimport { getDefaultProject } from '../../modules/data/utilsData';\n\n\nexport interface habitPageState {\n  showModal: boolean,\n  modalHabit: Habit|null,\n}\n\nconst reducer = (state, action): habitPageState => {\n  switch(action.type) {\n    case 'showModal':\n      return {...state, ...{showModal: action.data.showModal, modalHabit: action.data.habit} }\n    case 'hideModal':\n      return state;\n    default:\n      return state;\n  }\n}\n\nexport function getAction(todo:'showModal', data = {}){\n  return {type:todo, data:data};\n}\n\n\nconst HabitsPage: React.FC = () => {\n  console.log(getDefaultProject(authService.userid));\n  const [habitsState, dataFunc] = useHabitsCollectionFacade(getDefaultProject(authService.userid));\n  const [state, dispatch] = useReducer(reducer, {\n    showModal:false,\n    modalHabit: null,\n  })\n\n  console.log('STATE::: ', state);\n  const { habits } = habitsState;\n\n  const addhabit = (habit:Habit = new Habit()) => {\n    console.log('Add habit:  ', habit);\n    dispatch(getAction('showModal', {showModal: true, habit}));\n  }\n\n  const hidehabitModal = () => {\n    dispatch(getAction('showModal', {showModal: false, habit: null}));\n  }\n\n  const habitDismissFunc = (habit: Habit|null, action:'save'|'remove'|'none') => {\n    console.log('habit: ', habit)\n    dispatch(getAction('showModal', {showModal: false, habit: null}));\n    if(action === 'save' && habit != null){\n      dataFunc.save(habit);\n    }\n    else if(action === 'remove' && habit != null && habit.id){\n      dataFunc.remove(habit.id);\n    }\n  }\n\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title=\"Habits\" />\n      <IonContent>\n        \n      <IonList>\n        {habits.map(habit => (\n              <HabitListItemComponent\n                        habit={habit} \n                        dataFunctions={dataFunc}\n                        key={habit.id} \n                        showEditModalFunction={addhabit}\n              />\n        ))}\n      </IonList>\n      {state.showModal? (\n        <IonModal isOpen={state.showModal} onDidDismiss={() => hidehabitModal()}>\n        <HabitAddComponent habit={state.modalHabit||new Habit()} \n                            dismissFunc = {habitDismissFunc}  />\n        </IonModal>\n      ) : (\n        <></>\n      )}\n      \n\n      <IonFab vertical=\"top\" horizontal=\"end\" slot=\"fixed\" edge>\n        <IonFabButton onClick={()=> addhabit()}>\n          <IonIcon icon={add} />\n        </IonFabButton>\n      </IonFab>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default HabitsPage;\n\n","import React, {  } from 'react';\nimport { IonHeader } from '@ionic/react';\n\n\n\n\nconst MenuHeaderWithProgress = () => {\n\n  \n  return (\n    <IonHeader className=\"menuHeaderWithAvatar\">\n      \n      <h1>Menu</h1>\n    </IonHeader>\n  )\n}\n\nexport default MenuHeaderWithProgress;","import { useState } from 'react';\nimport { home, timer, apps, sunny, star, heart, basket, construct, bonfire, checkmark, refresh } from 'ionicons/icons';\n\n\n\nexport interface AppPage {\n  url: string;\n  icon: any;\n  title: string;\n  subPages: AppPage[];\n}\n\n\nexport interface MenuFunctions {\n\n}\n\nexport interface MenuState {\n  appPages: AppPage[];\n}\n\nexport const todoTags: AppPage[] = [\n  {\n    title: 'Today',\n    url: '/todos/today',\n    icon: sunny,\n    subPages: [],\n  },\n  {\n    title: 'Important',\n    url: '/todos/important',\n    icon: star,\n    subPages: []\n  },\n  {\n    title: 'Important',\n    url: '/todos/tasksmain33mmm',\n    icon: checkmark,\n    subPages: []\n  },\n  {\n    title: 'Whish List',\n    url: '/todos/whish',\n    icon: heart,\n    subPages: []\n  },\n  {\n    title: 'Buy',\n    url: '/todos/buy',\n    icon: basket,\n    subPages: []\n  },\n  {\n    title: 'Projects',\n    url: '/todos/projects',\n    icon: construct,\n    subPages: []\n  },\n]\n\n\nexport const getInitMenuState: MenuState = {\n  appPages: [\n    {\n      title: 'Home',\n      url: '/home',\n      icon: home,\n      subPages: []\n    },\n    {\n      title: 'Habits',\n      url: '/habits',\n      icon: refresh,\n      subPages: []\n    },\n    {\n      title: 'Parties',\n      url: '/parties',\n      icon: bonfire,\n      subPages: []\n    },\n    {\n      title: 'Todos',\n      url: '/todos',\n      icon: apps,\n      subPages: todoTags\n    }\n  ]\n};\n\n\n//more simpler then auth hook, just read data\nexport function useMenuHookFacade(): [MenuState, MenuFunctions] {\n\n  const [state, setState] = useState(getInitMenuState);\n\n          \n  const menuFunctions: MenuFunctions = {\n  }\n\n  \n\n\n  return [state, menuFunctions];\n}","import {\n  IonContent,\n  IonIcon,\n  IonItem,\n  IonLabel,\n  IonMenu,\n  IonMenuToggle,\n  IonGrid,\n  IonCol,\n  IonRow,\n  IonButton\n} from '@ionic/react';\nimport React from 'react';\nimport { withRouter, useLocation } from 'react-router-dom';\nimport MenuHeaderWithProgress from './MenuHeaderWithProgress';\nimport { useMenuHookFacade } from '../modules/menu/hooks/menu.hook';\nimport './menu.css';\n\n\nconst Menu = () => {\n\n  const [state,] = useMenuHookFacade();\n  const location = useLocation();\n\n  const path = location.pathname;\n\n  return (\n    <IonMenu key=\"ionmenu_left\" contentId=\"main\" type=\"overlay\">\n      <MenuHeaderWithProgress />\n      <IonContent key=\"menu_left\" >\n        <IonGrid>\n        {state.appPages.map((appPage, index) => {\n          return (\n            <>\n              <IonRow key={appPage.title.replace(' ', '')+appPage.url}>\n                <IonCol class=\"leftMenuCol\">\n                <IonMenuToggle  autoHide={false}>\n                  <IonItem\n                        color={(path.startsWith(appPage.url)? 'light' : '')}   \n                        routerLink={appPage.url} routerDirection=\"none\">\n                    <IonIcon slot=\"start\" icon={appPage.icon} />\n                    <IonLabel>{appPage.title}</IonLabel>\n                  </IonItem>\n                </IonMenuToggle>\n                </IonCol>\n              </IonRow>\n              {(appPage.subPages.length > 0)? (\n                <>\n                  {appPage.subPages.map((subPage, index2) => {\n                    return (\n                      <IonRow key={appPage.title.replace(' ', '')+appPage.url+ '_' + subPage.url}>\n                        <IonCol class=\"leftSubMenuCol\">\n                        <IonMenuToggle autoHide={false}>\n                          <IonButton  fill=\"clear\"  \n                                      color={(path.startsWith(subPage.url)? 'success' : '')}   \n                                      class=\"menuButton\"\n                                      routerLink={subPage.url} \n                                      routerDirection=\"none\">\n                            <IonIcon slot=\"start\" icon={subPage.icon} />\n                            <IonLabel>{subPage.title}</IonLabel>\n                          </IonButton>\n                        </IonMenuToggle>\n                        </IonCol>\n                      </IonRow>\n                    )\n                  })}\n                </>\n              ) : (\n                <div key={appPage.title + \"_empty\"} />\n              )}\n            </>\n        )})}\n        </IonGrid>\n      </IonContent>\n    </IonMenu>\n)};\n\nexport default withRouter(Menu);\n","import React, { useState } from 'react';\nimport { PartyProject } from '../models';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonItem, \n  IonInput, IonLabel, IonTextarea, IonFooter, IonButton } from '@ionic/react';\n\n\n\n\n\nconst PartyEditComponent = ({party, dismissFunc}:\n    {party: PartyProject, dismissFunc:{(party: PartyProject|null, action: 'save'| 'remove' | 'none')}}) => {\n\n  const [state, setState] = useState({party})\n\n\n  const handleChange = (e) => {\n    const newDoc = {...state.party, ...{[e.target.name]:e.detail.value}}\n    const newState = {...state, ...{party: newDoc}};\n    setState(newState);\n  }\n\n\n  return (\n    <>\n      <IonHeader>\n            <IonToolbar>\n              <IonTitle>Add/Edit Party</IonTitle>\n            </IonToolbar>\n      </IonHeader>\n      <IonContent>\n          <IonItem>\n                <IonLabel position=\"floating\">Name</IonLabel>\n                <IonInput \n                    name=\"name\"\n                    placeholder=\"Your Cool Party Name\" \n                    onIonChange={handleChange}\n                    value={state.party.name} />\n            </IonItem>\n            <IonItem>\n                <IonLabel position=\"floating\">Note</IonLabel>\n                <IonTextarea \n                    placeholder=\"More details for your party members\"\n                    name=\"note\"\n                    onIonChange={handleChange}\n                    value={state.party.note}></IonTextarea>\n            </IonItem>\n            <IonFooter>\n              <IonToolbar>\n                <IonTitle>\n                  <IonButton onClick={() => dismissFunc(state.party, 'save')}>Save</IonButton>\n                  <IonButton onClick={() => dismissFunc(null, 'none')}>Cancel</IonButton>\n                </IonTitle>\n              </IonToolbar>\n            </IonFooter>\n      </IonContent>\n    </>\n  );\n}\n\nexport default PartyEditComponent;","import React, { useState, useEffect, useReducer } from 'react';\nimport { PartyProject } from '../models';\nimport { IonCard, IonCardHeader, IonCardTitle, IonCardSubtitle, IonBadge } from '@ionic/react';\nimport { useHistory } from '../../../../node_modules/@types/react-router';\n\n\nconst PartyListItemComponent = ({partyProject, history,  showEditModalFunction}:\n          {partyProject:PartyProject, history, showEditModalFunction:{(party: PartyProject)}}) => {\n\n  const [state, setState] = useState({party: partyProject})\n\n  useEffect(() => {\n    setState({...state, ...{party:partyProject}});\n  }, [partyProject])\n\n  return(\n    <IonCard>\n      <IonCardHeader onClick={() => history.push('/parties/'+ encodeURI(state.party.id||''))}>\n        <IonCardTitle>{state.party.name} \n              <IonBadge>{state.party.members.length}</IonBadge></IonCardTitle>\n        <IonCardSubtitle>{state.party.note}</IonCardSubtitle>\n      </IonCardHeader>\n    </IonCard>\n  )\n\n\n} \n\nexport default PartyListItemComponent;\n\n\n","import { Subscription, BehaviorSubject, Subject } from \"rxjs\";\nimport { dataService } from \"../data/dataService\";\nimport { TYPE_MSG } from \"./models\";\n\nexport interface Message {\n  from: string,\n  message: string, \n  type: string,\n}\n\nexport interface MessagesState {\n  docs: Message[],\n}\n\nexport const initMessageState = {\n  docs: []\n}\n\n\n\nexport class MessageService {\n  private _subscription: Array<Subscription> = [];\n  \n  private _state: MessagesState = initMessageState;\n  public state$ = new BehaviorSubject(this._state);\n  public messages$ = new Subject<Message>()\n  \n  async init(){\n    this.unsubscribe();\n    \n    const sub = dataService.subscribeChanges().subscribe(doc => {\n      console.log(doc);\n    });\n\n    this._subscription.push(sub);\n\n  }\n\n\n  public async getGlobalPartyMessages() {\n    const msgs = await dataService.queryByProperty('messageType', 'equals', 'messageType', TYPE_MSG );\n\n    console.log(msgs);\n    return msgs;\n  }\n \n\n\n  public unsubscribe() {\n    if(!this) return;\n    this._subscription.forEach(sub => {\n      if(sub)\n        sub.unsubscribe();\n    });\n  }\n\n}\n\nexport const messageService = new MessageService();","import React, { useEffect, useReducer } from 'react';\nimport { IonList, IonLabel, IonItem, IonAvatar, IonButton } from '@ionic/react';\nimport { Msg } from '../../messages/models';\nimport { dataService } from '../../data/dataService';\nimport { waitMS } from '../../data/utilsData';\nimport { messageService } from '../../messages/messages.service';\nimport { capitalize, saveIntoDocList } from '../../../utils';\nimport { partyService } from '../party.service';\n\n\nconst reducer = (state, action) => {\n  switch(action.type) {\n    case 'addmsgs':\n      return {...state, ...{msgs: action.data} }\n    case 'addmsg':\n    return {...state, ...{msgs: saveIntoDocList(action.data, state.msgs)} };\n    default:\n      return state;\n  }\n}\n\n\nconst PartyInvitesListComponent = () => {\n\n  const [state, dispatch] = useReducer(reducer, {msgs: []})\n\n  console.log(state);\n\n  useEffect(() => {\n    const sub = dataService.subscribeChanges().subscribe(doc => {\n      if(doc.messageType !== 'party') return;\n      console.log(doc);\n      console.log(state);\n      dispatch({type: 'addmsg', data: doc});\n    });\n    getMessages();\n    return () => {\n      if(sub)sub.unsubscribe();\n    };\n  }, [])\n\n\n  const getMessages = async () => {\n    waitMS(2000);\n    const msgs = await messageService.getGlobalPartyMessages();\n    console.log(msgs);\n    dispatch({type: 'addmsgs', data:[...state.msgs, ...msgs]});\n  }\n\n  const printHeading = (msg:Msg):string => {\n    return capitalize(msg.from);\n  }\n\n  const printNote = (msg:Msg):string => {\n    if(msg.data){\n      if(msg.data.type === 'invite'){\n        let last = '';\n        if(msg.replied && msg.replied.accepted === false){\n          last = ' Rejected';\n        }\n        else if(msg.replied && msg.replied.accepted === true) {\n          last = ' Accepted';\n        }\n        return 'Come join our party: ' + msg.data.name + last;\n      }\n\n      if(msg.data.type === 'inviteaccepted') {\n        return 'Invitation to join \"'+ msg.data.name +'\" has been accepted'\n      }\n    }\n    return msg.message;\n  }\n\n  const printAcceptRejectButtons = (msg:Msg) => {\n    if(msg.data && msg.data.type === 'invite' && msg.replied === undefined){\n      return (\n        <div slot=\"end\">\n          <IonButton onClick={() => partyService.acceptPartyInvitation(msg)} >\n            Accept</IonButton>\n          <IonButton onClick={() => partyService.rejectPartyInviation(msg)}> \n            Reject</IonButton>\n        </div>\n      )\n    }\n  }\n\n  return(\n    <IonList>\n      {state.msgs.map(msg => (\n        <IonItem key={msg.id}> \n          <IonItem>\n            <IonAvatar slot=\"start\">\n              <img  />\n            </IonAvatar>\n            <IonLabel>\n              <h3>{printHeading(msg)}</h3>\n              <p>{printNote(msg)}</p>\n            </IonLabel>\n            {printAcceptRejectButtons(msg)}\n            \n          </IonItem>\n        </IonItem>\n      ))}\n    </IonList>\n  )\n\n\n} \n\nexport default PartyInvitesListComponent;","import React, { useState, useEffect } from 'react';\nimport {\n  IonPage,\n  IonContent,\n  IonList,\n  IonCard,\n  IonCardHeader,\n  IonCardTitle,\n  IonCardSubtitle,\n  IonCardContent,\n  IonLabel,\n  IonButton,\n  IonModal,\n  IonItem} from '@ionic/react';\nimport HeaderWithProgress from '../../../components/HeaderWithProgress';\nimport { authService } from '../../auth/authService';\nimport { PartyProject } from '../models';\nimport PartyEditComponent from '../components/Party.edit.component';\nimport { partyService } from '../party.service';\nimport PartyListItemComponent from '../components/Party.listitem.component';\nimport { useHistory } from 'react-router-dom';\nimport PartyInvitesListComponent from '../components/Party.invites.component';\n\nexport interface state {\n  userId: string,\n  showModal: boolean,\n  party: PartyProject\n  partyList: PartyProject[],\n}\n\nexport const getDefaultState = () => {\n  return {\n    userId: '',\n    showModal: false,\n    party: new PartyProject(),\n    partyList: [],\n  }\n}\n\n\n\nconst PartiesPage = () => {\n  const history = useHistory();\n  const [state, setState] = useState<state>(getDefaultState())\n  console.log('Parties Page:: ', state);\n\n  useEffect(() => {\n    const subs = [\n      authService.username$.subscribe(username => {\n        setState({...state, ...{userId: authService.userid}})\n      }),\n\n      partyService.state$.subscribe(changes => {\n        setState({...state, ...{partyList: changes.docs, userId: authService.userid}});\n      }),\n\n    ]\n    return () => {\n      subs.forEach(sub => {\n        if(sub) sub.unsubscribe();\n      });\n    };\n    // eslint-disable-next-line\n  }, [])\n\n  const editParty = (party:PartyProject = new PartyProject()) => {\n    console.log('Add party:  ', party);\n    setState({...state, ...{showModal: true, party}});\n  }\n\n\n  const modalDismissFunc = (party: PartyProject|null, action:'save'|'remove'|'none') => {\n    console.log('PARTY: ', party)\n    setState({...state, ...{showModal: false, party: new PartyProject()}});\n    if(action === 'save' && party != null){\n      partyService.save(party)\n    }\n    else if(action === 'remove' && party != null && party.id){\n      //dataFunc.remove(habit._id);\n    }\n  }\n\n  const hideModal = () => {\n    setState({...state, ...{showModal: false, party: new PartyProject()}});\n  }\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title=\"Parties\" />\n      <IonContent>\n        {state.showModal? (\n          <IonModal isOpen={state.showModal} onDidDismiss={() => hideModal()}>\n            <PartyEditComponent party={state.party} \n                                dismissFunc = {modalDismissFunc}  />\n          </IonModal>\n        ) : (\n          <></>\n        )}\n        <IonCard>\n          <IonCardHeader>\n            <IonCardTitle>\n              Here you can join friends to conquer those tasks together.\n            </IonCardTitle>\n            <IonCardSubtitle>\n              \n            </IonCardSubtitle>\n          </IonCardHeader>\n          <IonCardContent>\n            <IonLabel>\n              Create your party to go on quests and challenge your friends.\n            </IonLabel>\n            <IonButton onClick={() =>editParty()} >Create Party</IonButton>\n            <br></br><br></br><br></br>\n            <IonLabel>\n              Join your friends party, give them your code: <strong>{state.userId}</strong>\n            </IonLabel>\n            \n          </IonCardContent>\n        </IonCard>\n      <IonList>\n        {state.partyList.map(party => (\n          <PartyListItemComponent partyProject={party} \n                                  history={history}\n                                  key={party.id}\n                                  showEditModalFunction={editParty} />\n        ))}  \n      </IonList>\n      <PartyInvitesListComponent />\n      <IonItem>\n        <IonLabel>To join a party, you can give part leader your id: {state.userId} </IonLabel>\n      </IonItem>\n      \n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default PartiesPage;\n\n","import React, { useState } from 'react';\nimport { IonList, IonModal, IonCard, IonCardContent, IonCardHeader, IonCardTitle, IonFab, IonFabButton, IonIcon } from '@ionic/react';\nimport HabitListItemComponent from './Habit.listitem.component';\nimport { useHabitsCollectionFacade } from './hooks/habits.hook';\nimport { ProjectItem } from '../../modules/data/models';\nimport { Habit } from './models';\nimport { add } from '../../../node_modules/ionicons/icons';\nimport HabitAddComponent from './Habit.add.component';\n\n\nexport interface habitPageState {\n  showModal: boolean,\n  modalhabit: Habit\n}\n\n\nconst HabitListComponent = ({project}:{project: ProjectItem}) => {\n  const [state, dataFunc] = useHabitsCollectionFacade(project);\n  const [modalState, setModalState] = useState({showModal: false, modalhabit: new Habit()});\n\n  const addhabit = (habit:Habit = new Habit()) => {\n    console.log('Add habit:  ', habit);\n    setModalState({showModal: true, modalhabit: habit});\n  }\n\n  const hidehabitModal = () => {\n    setModalState({showModal: false, modalhabit: new Habit()});\n  }\n\n  const habitDismissFunc = (habit: Habit|null, action:'save'|'remove'|'none') => {\n    console.log('habit: ', habit)\n    setModalState({showModal: false, modalhabit: new Habit()});\n    if(action === 'save' && habit != null){\n      dataFunc.save(habit);\n    }\n    else if(action === 'remove' && habit != null && habit.id){\n      dataFunc.remove(habit.id);\n    }\n  }\n\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>Habits</IonCardTitle>\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n          {state.habits.map(habit => (\n                <HabitListItemComponent\n                          habit={habit} \n                          dataFunctions={dataFunc}\n                          key={habit.id} \n                          showEditModalFunction={addhabit}\n                />\n          ))}\n        </IonList>\n        {modalState.showModal? (\n          <IonModal isOpen={modalState.showModal} onDidDismiss={() => hidehabitModal()}>\n          <HabitAddComponent habit={modalState.modalhabit} \n                              dismissFunc = {habitDismissFunc}  />\n          </IonModal>\n        ) : (\n          <></>\n        )}\n      </IonCardContent>\n      <IonFab vertical=\"top\" horizontal=\"end\" slot=\"fixed\">\n        <IonFabButton onClick={()=> addhabit()} size=\"small\">\n          <IonIcon icon={add} />\n        </IonFabButton>\n      </IonFab>\n    </IonCard>\n  )\n}\n\n\n\nexport default HabitListComponent;","import React, { useState } from 'react';\nimport { PartyProject } from '../models';\nimport { IonCard, IonCardTitle, IonCardHeader, IonCardContent, IonList, IonItem, IonAlert, IonFooter, IonButton } from '@ionic/react';\nimport { partyService } from '../party.service';\n\n\nexport interface MembersState {\n  showAddModal: boolean,\n}\n\n\nconst PartyMembersListComponent = ({project}:{project:PartyProject}) => {\n  const [state, setState] = useState<MembersState>({showAddModal: false})\n\n\n  const addMember = () => {\n    setState({...state, ...{showAddModal: true}});\n  }\n\n  const hideAddUser = () => {\n    setState({...state, ...{showAddModal: false}});\n  }\n\n  return (\n    <IonCard>\n      <IonCardHeader>\n        <IonCardTitle>Members</IonCardTitle>\n        {state.showAddModal? (\n          <IonItem>\n            \n          </IonItem>\n        ) : (\n          <></>\n        )}\n      </IonCardHeader>\n      <IonCardContent>\n        <IonList>\n         \n        </IonList>\n        \n      </IonCardContent>\n      <IonFooter>\n        <IonButton onClick={()=>addMember()} fill=\"clear\">Add Member</IonButton>\n      </IonFooter>\n      <IonAlert \n        isOpen={state.showAddModal}\n        onDidDismiss={() => hideAddUser()}\n        header=\"Friend ID:\"\n        subHeader={'Found at bottom of parties page.'}\n        inputs={[\n          {\n            name: 'userid',\n            type: 'text',\n            id: 'adduserid',\n\n\n          }\n        ]}\n        buttons={[\n          {\n            text: 'Cancel',\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: () => {\n              hideAddUser();\n            }\n          },\n          {\n            text: 'Invite User',\n            handler: (data) => {\n              partyService.addUser(data.userid, project);\n              hideAddUser();\n            }\n          }\n        ]}\n      />\n    </IonCard>\n  )\n\n}\nexport default PartyMembersListComponent;","import React, { useState, useEffect, useReducer, useRef } from 'react';\nimport { IonPage, IonContent, IonButton, IonModal } from '@ionic/react';\nimport HeaderWithProgress from '../../../components/HeaderWithProgress';\nimport { PartyProject, TYPE_PARTY } from '../models';\nimport { useParams, useHistory } from 'react-router-dom';\nimport { dataService } from '../../data/dataService';\nimport { HabitsService } from '../../../pages/habits/habits.service';\nimport HabitListComponent from '../../../pages/habits/Habit.list.component';\nimport { waitMS } from '../../../utils';\nimport PartyMembersListComponent from '../components/Members.list.component';\nimport { first } from '../../../../node_modules/rxjs/operators';\n\n\n\ninterface State {\n  party:PartyProject,\n}\n\nconst getInitState = {\n    party: new PartyProject(),\n}\n\n\nconst loadParty = async (id:string, state, setState, history) => {\n  console.log('Loading party');\n  const dataSub = dataService.getReadySub().subscribe(async (ready) => {\n    if(!ready) return;\n    console.log('==============================Load party, ', id);\n    const party = await dataService.getDoc(id, TYPE_PARTY);\n    console.log(party)\n    if(!party){\n      dataSub.unsubscribe();\n      console.log('************************************* couldn load party', id);\n      history.push('/parties');\n      return\n    }\n    setState({...state, ...{party}})\n    dataSub.unsubscribe();\n  })\n  \n}\n\n//*********** Page Start *************/\nconst PartyViewPage = () => {\n  console.log('PARTY PAGE');\n  const {id} = useParams();\n  const history = useHistory();\n  const [state, setState] = useState<State>(getInitState)\n  const habitsService = useRef(new HabitsService());\n\n  //if(!id) return history.push('/parties');\n  console.log('--------------------------------EFFECT: ', id);\n  useEffect(() => {\n    if(id)\n      loadParty(id, state, setState, history)\n    else {\n      console.log('=================================================== no id')\n      history.push('/parties');\n    }\n  }, [id])\n  \n\n\n\n\n\n  return (\n    <IonPage>\n      <HeaderWithProgress title={\"Party: \" + state.party.name} />\n      <IonContent>\n        \n      {state.party.id? (\n        <>\n          <PartyMembersListComponent  project={state.party} />\n          <HabitListComponent project={state.party} />\n        </>\n      ):(<></>)}\n\n      </IonContent>\n    </IonPage>\n  )\n}\n\nexport default PartyViewPage;","import React, {  } from 'react';\nimport { Redirect, Route, useHistory, useLocation } from 'react-router-dom';\nimport UserPage from './modules/auth/components/user.page';\nimport TodosPage from './pages/todo/Todos.page';\nimport IntroPage from './modules/auth/components/intro.page';\nimport { useAppStatus, AppStatus } from './modules/app/hooks/appStatus.hook';\nimport Home from './pages/Home';\nimport NotFound from './pages/NotFound';\nimport UnauthenticatedRoute from './modules/auth/unauthenticatedRoute';\nimport HabitsPage from './pages/habits/Habits.page';\nimport { home, timer, apps } from '../node_modules/ionicons/icons';\nimport { IonSplitPane, IonRouterOutlet } from '../node_modules/@ionic/react';\nimport Menu from './components/Menu';\nimport PartiesPage from './modules/parties/pages/Parties.page';\nimport PartyViewPage from './modules/parties/pages/Party.view.page';\n\nexport const Routes = () => {\n  const [appStatus] = useAppStatus();\n  const history = useHistory();\n  const location = useLocation();\n\n  console.log('APP RERENDER::::::::::::::::::::::::::::::::::::::', appStatus, location, history);\n  \n\n  \n  if(appStatus === AppStatus.auth && location.pathname.startsWith('/auth/')){\n    if(location.state){\n      const newpath = location.state['prev'] || '/';\n      history.push(newpath);\n    }\n    \n  }\n\n  const getRoutes = () => {\n    switch(appStatus){\n      case AppStatus.auth:\n        return (\n          <IonSplitPane when=\"sm\" contentId=\"main\">\n            <Menu key=\"menu\" />\n            <IonRouterOutlet id=\"main\">\n                <Route path=\"/home\" component={Home} exact={true} />           \n                <Route exact path=\"/auth/user\" component={UserPage} />\n                <Route path=\"/todos\" component={TodosPage} exact={true} />\n                <Route path=\"/todos/:tag\" component={TodosPage} exact={true} />\n                <Route path=\"/habits\" component={HabitsPage} exact={true} />\n                <Route path=\"/parties\" component={PartiesPage} exact={true} />\n                <Route path=\"/parties/:id\" component={PartyViewPage} exact={true} />\n                <Route path=\"/\" render={() => <Redirect to=\"/home\" />} exact={true} />\n                <Route path=\"/404\" component={NotFound} />\n                <Redirect to=\"/404\" />\n            </IonRouterOutlet>\n        </IonSplitPane>\n        )\n      case AppStatus.guest:\n          return (\n            <IonRouterOutlet>\n              <UnauthenticatedRoute exact path=\"*\" component={Home} />\n            </IonRouterOutlet>\n          );\n      default:\n          return (\n            <IonRouterOutlet>\n              <Route exact path=\"*\"  component={IntroPage} />\n            </IonRouterOutlet>\n          );\n      \n\n    }\n  }\n\n  return getRoutes();\n}","import React, { useState, useEffect } from 'react';\nimport { IonToast } from '@ionic/react';\nimport { Subscription } from 'rxjs';\nimport { toastService, ToastMessage } from './toastService';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nexport const Toasts: React.FC = () => {\n  const [message, setMessage] = useState<ToastMessage | null>(null);\n\n  useEffect(() => {\n    const subscriptions: Subscription[] = [\n      toastService.messages$.subscribe((m: ToastMessage) =>{\n        setMessage(m);\n      })\n    ];\n    return () => { subscriptions.map(it => it.unsubscribe()) };\n  },[message]);\n\n  console.log('PRINTING TOAST: ', message);\n\n  /*\n  const print = () => {\n    if(message)\n      return <IonToast\n                isOpen={message != null}\n                message={message.message}\n                duration={message.duration}\n                onDidDismiss={() => setMessage(null)}\n              />\n  } \n*/\n\n  return (\n    <div className='toastDiv' >\n      <ToastContainer\n          position=\"top-right\"\n          autoClose={5000}\n          hideProgressBar\n          newestOnTop={false}\n          closeOnClick\n          rtl={false}\n          draggable\n          pauseOnHover\n          />\n    </div>\n  );\n};","import React from 'react';\nimport { IonApp } from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\n\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\n\nimport './theme/my.css';\n\nimport { Loading } from './modules/loading/loading.component';\nimport { Routes } from './routes';\nimport { Toasts } from './modules/toast/toast.component';\n\n\n\nconst App: React.FC = () => (\n  <IonApp>\n    <IonReactRouter>\n      <Loading /><Toasts />\n      <Routes />\n    </IonReactRouter>\n  </IonApp>\n);\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}